{
  "version": 3,
  "sources": ["../../semver/internal/constants.js", "../../semver/internal/debug.js", "../../semver/internal/re.js", "../../semver/internal/parse-options.js", "../../semver/internal/identifiers.js", "../../semver/classes/semver.js", "../../semver/functions/parse.js", "../../semver/functions/valid.js", "../../semver/functions/clean.js", "../../semver/functions/inc.js", "../../semver/functions/diff.js", "../../semver/functions/major.js", "../../semver/functions/minor.js", "../../semver/functions/patch.js", "../../semver/functions/prerelease.js", "../../semver/functions/compare.js", "../../semver/functions/rcompare.js", "../../semver/functions/compare-loose.js", "../../semver/functions/compare-build.js", "../../semver/functions/sort.js", "../../semver/functions/rsort.js", "../../semver/functions/gt.js", "../../semver/functions/lt.js", "../../semver/functions/eq.js", "../../semver/functions/neq.js", "../../semver/functions/gte.js", "../../semver/functions/lte.js", "../../semver/functions/cmp.js", "../../semver/functions/coerce.js", "../../semver/internal/lrucache.js", "../../semver/classes/range.js", "../../semver/classes/comparator.js", "../../semver/functions/satisfies.js", "../../semver/ranges/to-comparators.js", "../../semver/ranges/max-satisfying.js", "../../semver/ranges/min-satisfying.js", "../../semver/ranges/min-version.js", "../../semver/ranges/valid.js", "../../semver/ranges/outside.js", "../../semver/ranges/gtr.js", "../../semver/ranges/ltr.js", "../../semver/ranges/intersects.js", "../../semver/ranges/simplify.js", "../../semver/ranges/subset.js", "../../semver/index.js", "../../punycode/punycode.js", "../../es-errors/type.js", "../../object-inspect/index.js", "../../side-channel-list/index.js", "../../es-object-atoms/index.js", "../../es-errors/index.js", "../../es-errors/eval.js", "../../es-errors/range.js", "../../es-errors/ref.js", "../../es-errors/syntax.js", "../../es-errors/uri.js", "../../math-intrinsics/abs.js", "../../math-intrinsics/floor.js", "../../math-intrinsics/max.js", "../../math-intrinsics/min.js", "../../math-intrinsics/pow.js", "../../math-intrinsics/round.js", "../../math-intrinsics/isNaN.js", "../../math-intrinsics/sign.js", "../../gopd/gOPD.js", "../../gopd/index.js", "../../es-define-property/index.js", "../../has-symbols/shams.js", "../../has-symbols/index.js", "../../get-proto/Reflect.getPrototypeOf.js", "../../get-proto/Object.getPrototypeOf.js", "../../function-bind/implementation.js", "../../function-bind/index.js", "../../call-bind-apply-helpers/functionCall.js", "../../call-bind-apply-helpers/functionApply.js", "../../call-bind-apply-helpers/reflectApply.js", "../../call-bind-apply-helpers/actualApply.js", "../../call-bind-apply-helpers/index.js", "../../dunder-proto/get.js", "../../get-proto/index.js", "../../hasown/index.js", "../../get-intrinsic/index.js", "../../call-bound/index.js", "../../side-channel-map/index.js", "../../side-channel-weakmap/index.js", "../../side-channel/index.js", "../../qs/lib/formats.js", "../../qs/lib/utils.js", "../../qs/lib/stringify.js", "../../qs/lib/parse.js", "../../qs/lib/index.js", "../../url/url.js", "../../reflect-metadata/Reflect.js", "../../@ledgerhq/device-management-kit/src/api/apdu/model/Apdu.ts", "../../@ledgerhq/device-management-kit/src/api/utils/HexaString.ts", "../../@ledgerhq/device-management-kit/src/api/apdu/utils/AppBuilderError.ts", "../../@ledgerhq/device-management-kit/src/api/apdu/utils/ByteArrayBuilder.ts", "../../@ledgerhq/device-management-kit/src/api/apdu/utils/ApduBuilder.ts", "../../@ledgerhq/device-management-kit/src/api/apdu/utils/ByteArrayParser.ts", "../../@ledgerhq/device-management-kit/src/api/apdu/utils/ApduParser.ts", "../../@ledgerhq/device-management-kit/src/api/command/Errors.ts", "../../@ledgerhq/device-management-kit/src/api/command/model/CommandResult.ts", "../../@ledgerhq/device-management-kit/src/api/command/utils/CommandUtils.ts", "../../@ledgerhq/device-management-kit/src/api/Error.ts", "../../@ledgerhq/device-management-kit/src/api/command/utils/CommandErrors.ts", "../../@ledgerhq/device-management-kit/src/api/command/utils/GlobalCommandError.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/CloseAppCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/GetAppAndVersionCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/GetBatteryStatusCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/GetOsVersionCommand.ts", "../../@ledgerhq/device-management-kit/src/api/device/DeviceModel.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/SecureElementFlagsParser.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/ListAppsCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/LoadCertificateCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/OpenAppCommand.ts", "../../@ledgerhq/device-management-kit/src/api/device/DeviceStatus.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/model/DeviceActionState.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/model/UserInteractionRequired.ts", "../../purify-ts/esm/Maybe.js", "../../purify-ts/esm/Either.js", "../../purify-ts/esm/Function.js", "../../purify-ts/esm/NonEmptyList.js", "../../purify-ts/esm/Codec.js", "../../purify-ts/esm/Tuple.js", "../../purify-ts/esm/EitherAsync.js", "../../purify-ts/esm/MaybeAsync.js", "../../xstate/dev/dist/xstate-dev.development.esm.js", "../../xstate/dist/raise-1db27a82.development.esm.js", "../../xstate/actors/dist/xstate-actors.development.esm.js", "../../xstate/dist/log-0acd9069.development.esm.js", "../../xstate/dist/xstate.development.esm.js", "../../@ledgerhq/device-management-kit/src/api/device-action/os/Errors.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/Const.ts", "../../rxjs/node_modules/tslib/tslib.es6.mjs", "../../rxjs/src/internal/util/isFunction.ts", "../../rxjs/src/internal/util/createErrorClass.ts", "../../rxjs/src/internal/util/UnsubscriptionError.ts", "../../rxjs/src/internal/util/arrRemove.ts", "../../rxjs/src/internal/Subscription.ts", "../../rxjs/src/internal/config.ts", "../../rxjs/src/internal/scheduler/timeoutProvider.ts", "../../rxjs/src/internal/util/reportUnhandledError.ts", "../../rxjs/src/internal/util/noop.ts", "../../rxjs/src/internal/NotificationFactories.ts", "../../rxjs/src/internal/util/errorContext.ts", "../../rxjs/src/internal/Subscriber.ts", "../../rxjs/src/internal/symbol/observable.ts", "../../rxjs/src/internal/util/identity.ts", "../../rxjs/src/internal/util/pipe.ts", "../../rxjs/src/internal/Observable.ts", "../../rxjs/src/internal/util/lift.ts", "../../rxjs/src/internal/operators/OperatorSubscriber.ts", "../../rxjs/src/internal/operators/refCount.ts", "../../rxjs/src/internal/observable/ConnectableObservable.ts", "../../rxjs/src/internal/scheduler/performanceTimestampProvider.ts", "../../rxjs/src/internal/scheduler/animationFrameProvider.ts", "../../rxjs/src/internal/observable/dom/animationFrames.ts", "../../rxjs/src/internal/util/ObjectUnsubscribedError.ts", "../../rxjs/src/internal/Subject.ts", "../../rxjs/src/internal/BehaviorSubject.ts", "../../rxjs/src/internal/scheduler/dateTimestampProvider.ts", "../../rxjs/src/internal/ReplaySubject.ts", "../../rxjs/src/internal/AsyncSubject.ts", "../../rxjs/src/internal/scheduler/Action.ts", "../../rxjs/src/internal/scheduler/intervalProvider.ts", "../../rxjs/src/internal/scheduler/AsyncAction.ts", "../../rxjs/src/internal/util/Immediate.ts", "../../rxjs/src/internal/scheduler/immediateProvider.ts", "../../rxjs/src/internal/scheduler/AsapAction.ts", "../../rxjs/src/internal/Scheduler.ts", "../../rxjs/src/internal/scheduler/AsyncScheduler.ts", "../../rxjs/src/internal/scheduler/AsapScheduler.ts", "../../rxjs/src/internal/scheduler/asap.ts", "../../rxjs/src/internal/scheduler/async.ts", "../../rxjs/src/internal/scheduler/QueueAction.ts", "../../rxjs/src/internal/scheduler/QueueScheduler.ts", "../../rxjs/src/internal/scheduler/queue.ts", "../../rxjs/src/internal/scheduler/AnimationFrameAction.ts", "../../rxjs/src/internal/scheduler/AnimationFrameScheduler.ts", "../../rxjs/src/internal/scheduler/animationFrame.ts", "../../rxjs/src/internal/scheduler/VirtualTimeScheduler.ts", "../../rxjs/src/internal/observable/empty.ts", "../../rxjs/src/internal/util/isScheduler.ts", "../../rxjs/src/internal/util/args.ts", "../../rxjs/src/internal/util/isArrayLike.ts", "../../rxjs/src/internal/util/isPromise.ts", "../../rxjs/src/internal/util/isInteropObservable.ts", "../../rxjs/src/internal/util/isAsyncIterable.ts", "../../rxjs/src/internal/util/throwUnobservableError.ts", "../../rxjs/src/internal/symbol/iterator.ts", "../../rxjs/src/internal/util/isIterable.ts", "../../rxjs/src/internal/util/isReadableStreamLike.ts", "../../rxjs/src/internal/observable/innerFrom.ts", "../../rxjs/src/internal/util/executeSchedule.ts", "../../rxjs/src/internal/operators/observeOn.ts", "../../rxjs/src/internal/operators/subscribeOn.ts", "../../rxjs/src/internal/scheduled/scheduleObservable.ts", "../../rxjs/src/internal/scheduled/schedulePromise.ts", "../../rxjs/src/internal/scheduled/scheduleArray.ts", "../../rxjs/src/internal/scheduled/scheduleIterable.ts", "../../rxjs/src/internal/scheduled/scheduleAsyncIterable.ts", "../../rxjs/src/internal/scheduled/scheduleReadableStreamLike.ts", "../../rxjs/src/internal/scheduled/scheduled.ts", "../../rxjs/src/internal/observable/from.ts", "../../rxjs/src/internal/observable/of.ts", "../../rxjs/src/internal/observable/throwError.ts", "../../rxjs/src/internal/Notification.ts", "../../rxjs/src/internal/util/EmptyError.ts", "../../rxjs/src/internal/util/ArgumentOutOfRangeError.ts", "../../rxjs/src/internal/util/NotFoundError.ts", "../../rxjs/src/internal/util/SequenceError.ts", "../../rxjs/src/internal/util/isDate.ts", "../../rxjs/src/internal/operators/timeout.ts", "../../rxjs/src/internal/operators/map.ts", "../../rxjs/src/internal/util/mapOneOrManyArgs.ts", "../../rxjs/src/internal/util/argsArgArrayOrObject.ts", "../../rxjs/src/internal/operators/mergeInternals.ts", "../../rxjs/src/internal/operators/mergeMap.ts", "../../rxjs/src/internal/operators/mergeAll.ts", "../../rxjs/src/internal/observable/timer.ts", "../../rxjs/src/internal/observable/interval.ts", "../../rxjs/src/internal/observable/merge.ts", "../../rxjs/src/internal/observable/never.ts", "../../rxjs/src/internal/util/argsOrArgArray.ts", "../../rxjs/src/internal/operators/scanInternals.ts", "../../rxjs/src/internal/operators/take.ts", "../../rxjs/src/internal/operators/scan.ts", "../../rxjs/src/internal/operators/share.ts", "../../rxjs/src/internal/operators/switchMap.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/xstate-utils/XStateDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/DeviceSessionState.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/GetDeviceStatus/GetDeviceStatusDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/transport/model/Errors.ts", "../../@ledgerhq/device-management-kit/src/api/utils/AppName.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/OpenAppDeviceAction/OpenAppDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/CallTaskInAppDeviceAction/CallTaskInAppDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/GoToDashboard/GoToDashboardDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/ListApps/ListAppsDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/task/GetApplicationsMetadataTask.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/ListLanguagePackCommand.ts", "../../@ledgerhq/device-management-kit/src/api/command/os/GetCustomImageSizeCommand.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/task/GetFirmwareMetadataTask.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/device-action/ListInstalledApps/types.ts", "../../isomorphic-ws/browser.js", "../../@ledgerhq/device-management-kit/src/api/secure-channel/task/types.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/constants.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/utils.ts", "../../@noble/hashes/src/_u64.ts", "../../@noble/hashes/src/crypto.ts", "../../@noble/hashes/src/utils.ts", "../../@noble/hashes/src/sha3.ts", "../../@ledgerhq/device-management-kit/src/internal/crypto/NobleCryptoService.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/model/Errors.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/task/ConnectToSecureChannelTask.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/GetDeviceMetadata/GetDeviceMetadataDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/task/BuildAppsInstallPlanTask.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/task/PredictOutOfMemoryTask.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/InstallOrUpdateApps/InstallOrUpdateAppsDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/ListAppsWithMetadata/ListAppsWithMetadataDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/OpenAppWithDependencies/OpenAppWithDependenciesDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/os/SendCommandInAppDeviceAction/SendCommandInAppDeviceAction.ts", "../../@inversifyjs/common/src/common/calculations/isPromise.ts", "../../@inversifyjs/common/src/services/calculations/stringifyServiceIdentifier.ts", "../../@inversifyjs/common/src/services/models/LazyServiceIdentifier.ts", "../../@inversifyjs/reflect-metadata-utils/src/reflectMetadata/utils/getOwnReflectMetadata.ts", "../../@inversifyjs/reflect-metadata-utils/src/reflectMetadata/utils/getReflectMetadata.ts", "../../@inversifyjs/reflect-metadata-utils/src/reflectMetadata/utils/setReflectMetadata.ts", "../../@inversifyjs/reflect-metadata-utils/src/reflectMetadata/utils/updateOwnReflectMetadata.ts", "../../@inversifyjs/reflect-metadata-utils/src/reflectMetadata/utils/updateReflectMetadata.ts", "../../@inversifyjs/core/src/binding/actions/getBindingId.ts", "../../@inversifyjs/core/src/binding/models/BindingScope.ts", "../../@inversifyjs/core/src/binding/models/BindingType.ts", "../../@inversifyjs/core/src/common/calculations/chain.ts", "../../@inversifyjs/core/src/common/models/OneToManyMapStar.ts", "../../@inversifyjs/core/src/binding/services/ActivationsService.ts", "../../@inversifyjs/core/src/binding/services/BindingService.ts", "../../@inversifyjs/core/src/binding/services/DeactivationsService.ts", "../../@inversifyjs/core/src/decorator/actions/decorate.ts", "../../@inversifyjs/core/src/reflectMetadata/data/classMetadataReflectKey.ts", "../../@inversifyjs/core/src/metadata/calculations/getDefaultClassMetadata.ts", "../../@inversifyjs/core/src/reflectMetadata/data/pendingClassMetadataCountReflectKey.ts", "../../@inversifyjs/core/src/error/models/InversifyCoreError.ts", "../../@inversifyjs/core/src/error/models/InversifyCoreErrorKind.ts", "../../@inversifyjs/core/src/metadata/models/MaybeClassElementMetadataKind.ts", "../../@inversifyjs/core/src/metadata/models/ClassElementMetadataKind.ts", "../../@inversifyjs/core/src/metadata/calculations/getClassMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/isPendingClassMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/validateConstructorMetadataArray.ts", "../../@inversifyjs/core/src/metadata/calculations/throwAtInvalidClassMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/getDefaultPendingClassMetadataCount.ts", "../../@inversifyjs/core/src/metadata/actions/decrementPendingClassMetadataCount.ts", "../../@inversifyjs/core/src/metadata/calculations/buildClassElementMetadataFromMaybeClassElementMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/assertMetadataFromTypescriptIfManaged.ts", "../../@inversifyjs/core/src/metadata/calculations/buildManagedMetadataFromMaybeClassElementMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/buildDefaultManagedMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/buildManagedMetadataFromMaybeManagedMetadata.ts", "../../@inversifyjs/core/src/metadata/actions/updateMaybeClassMetadataProperty.ts", "../../@inversifyjs/core/src/decorator/models/DecoratorInfoKind.ts", "../../@inversifyjs/core/src/metadata/calculations/handleInjectionError.ts", "../../@inversifyjs/core/src/decorator/calculations/getDecoratorInfo.ts", "../../@inversifyjs/core/src/decorator/calculations/stringifyDecoratorInfo.ts", "../../@inversifyjs/core/src/metadata/decorators/injectBase.ts", "../../@inversifyjs/core/src/metadata/actions/updateMaybeClassMetadataConstructorArgument.ts", "../../@inversifyjs/core/src/metadata/decorators/inject.ts", "../../@inversifyjs/core/src/reflectMetadata/data/classIsInjectableFlagReflectKey.ts", "../../@inversifyjs/core/src/metadata/calculations/isUserlandEmittedType.ts", "../../@inversifyjs/core/src/metadata/actions/updateClassMetadataWithTypescriptParameterTypes.ts", "../../@inversifyjs/core/src/reflectMetadata/data/typescriptDesignParameterTypesReflectKey.ts", "../../@inversifyjs/core/src/metadata/calculations/buildClassElementMetadataFromTypescriptParameterType.ts", "../../@inversifyjs/core/src/metadata/decorators/injectable.ts", "../../@inversifyjs/core/src/metadata/actions/setIsInjectableFlag.ts", "../../@inversifyjs/core/src/metadata/calculations/getExtendedConstructorArguments.ts", "../../@inversifyjs/core/src/metadata/calculations/getExtendedProperties.ts", "../../@inversifyjs/core/src/metadata/decorators/injectFrom.ts", "../../@inversifyjs/core/src/metadata/decorators/injectFromBase.ts", "../../@inversifyjs/core/src/metadata/decorators/multiInject.ts", "../../@inversifyjs/core/src/metadata/actions/incrementPendingClassMetadataCount.ts", "../../@inversifyjs/core/src/metadata/calculations/buildMaybeClassElementMetadataFromMaybeClassElementMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/buildDefaultMaybeClassElementMetadata.ts", "../../@inversifyjs/core/src/metadata/decorators/named.ts", "../../@inversifyjs/core/src/metadata/actions/updateMetadataName.ts", "../../@inversifyjs/core/src/metadata/actions/updateMetadataOptional.ts", "../../@inversifyjs/core/src/metadata/decorators/optional.ts", "../../@inversifyjs/core/src/metadata/decorators/postConstruct.ts", "../../@inversifyjs/core/src/metadata/actions/updateMaybeClassMetadataPostConstructor.ts", "../../@inversifyjs/core/src/metadata/decorators/preDestroy.ts", "../../@inversifyjs/core/src/metadata/actions/updateMaybeClassMetadataPreDestroy.ts", "../../@inversifyjs/core/src/metadata/decorators/tagged.ts", "../../@inversifyjs/core/src/metadata/actions/updateMetadataTag.ts", "../../@inversifyjs/core/src/metadata/calculations/buildDefaultUnmanagedMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/buildUnmanagedMetadataFromMaybeClassElementMetadata.ts", "../../@inversifyjs/core/src/metadata/calculations/buildUnmanagedMetadataFromMaybeManagedMetadata.ts", "../../@inversifyjs/core/src/metadata/decorators/unmanaged.ts", "../../@inversifyjs/core/src/metadata/models/ResolvedValueElementMetadataKind.ts", "../../@inversifyjs/core/src/binding/models/BindingConstraintsImplementation.ts", "../../@inversifyjs/core/src/common/models/SingleInmutableLinkedList.ts", "../../@inversifyjs/core/src/planning/calculations/buildFilteredServiceBindings.ts", "../../@inversifyjs/core/src/planning/calculations/isPlanServiceRedirectionBindingNode.ts", "../../@inversifyjs/core/src/planning/calculations/throwErrorWhenUnexpectedBindingsAmountFound.ts", "../../@inversifyjs/core/src/binding/calculations/stringifyBinding.ts", "../../@inversifyjs/core/src/planning/calculations/checkPlanServiceRedirectionBindingNodeSingleInjectionBindings.ts", "../../@inversifyjs/core/src/planning/calculations/checkServiceNodeSingleInjectionBindings.ts", "../../@inversifyjs/core/src/planning/calculations/handlePlanError.ts", "../../@inversifyjs/core/src/error/calculations/isStackOverflowError.ts", "../../@inversifyjs/core/src/planning/calculations/plan.ts", "../../@inversifyjs/core/src/planning/calculations/isInstanceBindingNode.ts", "../../@inversifyjs/core/src/planning/services/PlanResultCacheService.ts", "../../@inversifyjs/core/src/resolution/actions/cacheResolvedValue.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingServiceActivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingActivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveSingletonScopedBinding.ts", "../../@inversifyjs/core/src/resolution/actions/resolveConstantValueBinding.ts", "../../@inversifyjs/core/src/resolution/calculations/resolveConstantValueBindingCallback.ts", "../../@inversifyjs/core/src/common/calculations/getSelf.ts", "../../@inversifyjs/core/src/resolution/actions/resolveScoped.ts", "../../@inversifyjs/core/src/resolution/actions/resolveScopedBinding.ts", "../../@inversifyjs/core/src/resolution/actions/resolveDynamicValueBinding.ts", "../../@inversifyjs/core/src/resolution/calculations/resolveDynamicValueBindingCallback.ts", "../../@inversifyjs/core/src/resolution/actions/resolveFactoryBinding.ts", "../../@inversifyjs/core/src/resolution/calculations/resolveFactoryBindingCallback.ts", "../../@inversifyjs/core/src/resolution/actions/resolvePostConstruct.ts", "../../@inversifyjs/core/src/resolution/actions/resolveInstanceBindingNodeFromConstructorParams.ts", "../../@inversifyjs/core/src/resolution/actions/resolveProviderBinding.ts", "../../@inversifyjs/core/src/resolution/calculations/resolveProviderBindingCallback.ts", "../../@inversifyjs/core/src/resolution/calculations/getInstanceNodeBinding.ts", "../../@inversifyjs/core/src/resolution/calculations/getResolvedValueNodeBinding.ts", "../../@inversifyjs/core/src/resolution/actions/resolve.ts", "../../@inversifyjs/core/src/resolution/actions/setInstanceProperties.ts", "../../@inversifyjs/core/src/resolution/actions/resolveServiceRedirectionBindingNode.ts", "../../@inversifyjs/core/src/resolution/actions/resolveInstanceBindingNode.ts", "../../@inversifyjs/core/src/resolution/actions/resolveInstanceBindingConstructorParams.ts", "../../@inversifyjs/core/src/resolution/actions/resolveInstanceBindingNodeAsyncFromConstructorParams.ts", "../../@inversifyjs/core/src/resolution/actions/resolveResolvedValueBindingNode.ts", "../../@inversifyjs/core/src/resolution/actions/resolveResolvedValueBindingParams.ts", "../../@inversifyjs/core/src/resolution/actions/resolveScopedInstanceBindingNode.ts", "../../@inversifyjs/core/src/resolution/actions/resolveScopedResolvedValueBindingNode.ts", "../../@inversifyjs/core/src/binding/calculations/isScopedBinding.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingPreDestroy.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingServiceDeactivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingDeactivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveBindingsDeactivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveModuleDeactivations.ts", "../../@inversifyjs/core/src/resolution/actions/resolveServiceDeactivations.ts", "../../@inversifyjs/container/src/container/actions/getContainerModuleId.ts", "../../@inversifyjs/container/src/container/models/ContainerModule.ts", "../../@inversifyjs/container/src/binding/models/BindingIdentifier.ts", "../../@inversifyjs/container/src/binding/calculations/isBindingIdentifier.ts", "../../@inversifyjs/container/src/container/binding/utils/BindingConstraintUtils.ts", "../../@inversifyjs/container/src/binding/calculations/buildBindingIdentifier.ts", "../../@inversifyjs/container/src/binding/calculations/isAnyAncestorBindingConstraints.ts", "../../@inversifyjs/container/src/binding/calculations/isBindingConstraintsWithName.ts", "../../@inversifyjs/container/src/binding/calculations/isBindingConstraintsWithServiceId.ts", "../../@inversifyjs/container/src/binding/calculations/isBindingConstraintsWithTag.ts", "../../@inversifyjs/container/src/binding/calculations/isBindingConstraintsWithNoNameNorTags.ts", "../../@inversifyjs/container/src/binding/calculations/isNoAncestorBindingConstraints.ts", "../../@inversifyjs/container/src/binding/calculations/isNotParentBindingConstraints.ts", "../../@inversifyjs/container/src/binding/calculations/isParentBindingConstraints.ts", "../../@inversifyjs/container/src/binding/models/BindingFluentSyntaxImplementation.ts", "../../@inversifyjs/container/src/binding/calculations/isResolvedValueMetadataInjectOptions.ts", "../../@inversifyjs/container/src/binding/calculations/isAnyAncestorBindingConstraintsWithServiceId.ts", "../../@inversifyjs/container/src/binding/calculations/isAnyAncestorBindingConstraintsWithName.ts", "../../@inversifyjs/container/src/binding/calculations/isAnyAncestorBindingConstraintsWithTag.ts", "../../@inversifyjs/container/src/binding/calculations/isNotParentBindingConstraintsWithServiceId.ts", "../../@inversifyjs/container/src/binding/calculations/isNotParentBindingConstraintsWithName.ts", "../../@inversifyjs/container/src/binding/calculations/isNotParentBindingConstraintsWithTag.ts", "../../@inversifyjs/container/src/binding/calculations/isParentBindingConstraintsWithServiceId.ts", "../../@inversifyjs/container/src/binding/calculations/isParentBindingConstraintsWithName.ts", "../../@inversifyjs/container/src/binding/calculations/isParentBindingConstraintsWithTag.ts", "../../@inversifyjs/container/src/binding/calculations/isNoAncestorBindingConstraintsWithServiceId.ts", "../../@inversifyjs/container/src/binding/calculations/isNoAncestorBindingConstraintsWithName.ts", "../../@inversifyjs/container/src/binding/calculations/isNoAncestorBindingConstraintsWithTag.ts", "../../@inversifyjs/container/src/error/models/InversifyContainerError.ts", "../../@inversifyjs/container/src/error/models/InversifyContainerErrorKind.ts", "../../@inversifyjs/container/src/container/services/Container.ts", "../../@inversifyjs/container/src/common/calculations/getFirstIterableResult.ts", "../../@inversifyjs/container/src/common/actions/getFirstIteratorResult.ts", "../../@ledgerhq/device-management-kit/src/api/device-model/data/StaticDeviceModelDataSource.ts", "../../@ledgerhq/device-management-kit/src/api/device-model/model/BleDeviceInfos.ts", "../../@ledgerhq/device-management-kit/src/api/device-model/model/DeviceModel.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/ApduResponse.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/data/FramerConst.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/device-action/GenuineCheck/GenuineCheckDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/device-action/ListInstalledApps/ListInstalledAppsDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/device-action/InstallApp/InstallAppDeviceAction.ts", "../../@ledgerhq/device-management-kit/src/api/secure-channel/device-action/UninstallApp/UninstallAppDeviceAction.ts", "../../uuid/dist/esm-browser/regex.js", "../../uuid/dist/esm-browser/validate.js", "../../uuid/dist/esm-browser/parse.js", "../../uuid/dist/esm-browser/stringify.js", "../../uuid/dist/esm-browser/rng.js", "../../uuid/dist/esm-browser/md5.js", "../../uuid/dist/esm-browser/v35.js", "../../uuid/dist/esm-browser/v3.js", "../../uuid/dist/esm-browser/native.js", "../../uuid/dist/esm-browser/v4.js", "../../uuid/dist/esm-browser/sha1.js", "../../uuid/dist/esm-browser/v5.js", "../../@ledgerhq/device-management-kit/src/api/device-session/utils/FramerUtils.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/data/ApduResponseConst.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/Errors.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/Frame.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/FrameHeader.ts", "../../@ledgerhq/device-management-kit/src/internal/logger-publisher/di/loggerTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/service/DefaultApduReceiverService.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/service/DefaultApduReceiverService.stub.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/service/DefaultApduSenderService.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/service/DefaultApduSenderService.stub.ts", "../../@ledgerhq/device-management-kit/src/api/command/di/commandTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/config/di/configTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/di/deviceSessionTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/di/discoveryTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/di/managerApiTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/send/di/sendTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/transport/di/transportDiTypes.ts", "../../@ledgerhq/device-management-kit/src/api/command/use-case/SendCommandUseCase.ts", "../../@ledgerhq/device-management-kit/src/di.stub.ts", "../../@ledgerhq/device-management-kit/src/api/command/di/commandModule.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/use-case/ExecuteDeviceActionUseCase.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/di/deviceActionTypes.ts", "../../@ledgerhq/device-management-kit/src/api/device-action/di/deviceActionModule.ts", "../../@ledgerhq/device-management-kit/src/internal/config/model/Config.ts", "../../@ledgerhq/device-management-kit/src/internal/config/model/Errors.ts", "../../@ledgerhq/device-management-kit/lib/esm/package.json", "../../@ledgerhq/device-management-kit/src/internal/config/data/LocalConfigDataSource.ts", "../../@ledgerhq/device-management-kit/src/internal/config/data/LocalConfigDataSource.stub.ts", "../../@ledgerhq/device-management-kit/src/internal/config/data/RemoteConfigDataSource.ts", "../../@ledgerhq/device-management-kit/src/internal/config/data/RemoteConfigDataSource.stub.ts", "../../@ledgerhq/device-management-kit/src/internal/config/service/DefaultConfigService.ts", "../../@ledgerhq/device-management-kit/src/internal/config/use-case/GetDmkVersionUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/config/di/configModule.ts", "../../@ledgerhq/device-management-kit/src/internal/device-model/di/deviceModelTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/device-model/di/deviceModelModule.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/use-case/DisableDeviceSessionRefresher.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/service/DefaultDeviceSessionService.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/use-case/CloseSessionsUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/use-case/GetDeviceSessionStateUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/di/deviceSessionModule.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/data/DeviceSessionRefresherConst.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/service/MutexService.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/service/RefresherService.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/DeviceSessionEventDispatcher.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/DevicePinger.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/DeviceSessionRefresher.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/DeviceSessionStateHandler.ts", "../../@ledgerhq/device-management-kit/src/internal/device-session/model/DeviceSession.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/di/secureChannelTypes.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/ConnectUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/DisconnectUseCase.ts", "../../@ledgerhq/device-management-kit/src/api/transport/model/ConnectedDevice.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/GetConnectedDeviceUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/ListConnectedDevicesUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/ListenToAvailableDevicesUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/ListenToConnectedDeviceUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/ReconnectUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/StartDiscoveringUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/use-case/StopDiscoveringUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/discovery/di/discoveryModule.ts", "../../@ledgerhq/device-management-kit/src/api/logger-subscriber/model/LogLevel.ts", "../../@ledgerhq/device-management-kit/src/internal/logger-publisher/service/DefaultLoggerPublisherService.ts", "../../@ledgerhq/device-management-kit/src/internal/logger-publisher/di/loggerModule.ts", "../../axios/lib/helpers/bind.js", "../../axios/lib/utils.js", "../../axios/lib/core/AxiosError.js", "../../axios/lib/helpers/null.js", "../../axios/lib/helpers/toFormData.js", "../../axios/lib/helpers/AxiosURLSearchParams.js", "../../axios/lib/helpers/buildURL.js", "../../axios/lib/core/InterceptorManager.js", "../../axios/lib/defaults/transitional.js", "../../axios/lib/platform/browser/classes/URLSearchParams.js", "../../axios/lib/platform/browser/classes/FormData.js", "../../axios/lib/platform/browser/classes/Blob.js", "../../axios/lib/platform/browser/index.js", "../../axios/lib/platform/common/utils.js", "../../axios/lib/platform/index.js", "../../axios/lib/helpers/toURLEncodedForm.js", "../../axios/lib/helpers/formDataToJSON.js", "../../axios/lib/defaults/index.js", "../../axios/lib/helpers/parseHeaders.js", "../../axios/lib/core/AxiosHeaders.js", "../../axios/lib/core/transformData.js", "../../axios/lib/cancel/isCancel.js", "../../axios/lib/cancel/CanceledError.js", "../../axios/lib/core/settle.js", "../../axios/lib/helpers/parseProtocol.js", "../../axios/lib/helpers/speedometer.js", "../../axios/lib/helpers/throttle.js", "../../axios/lib/helpers/progressEventReducer.js", "../../axios/lib/helpers/isURLSameOrigin.js", "../../axios/lib/helpers/cookies.js", "../../axios/lib/helpers/isAbsoluteURL.js", "../../axios/lib/helpers/combineURLs.js", "../../axios/lib/core/buildFullPath.js", "../../axios/lib/core/mergeConfig.js", "../../axios/lib/helpers/resolveConfig.js", "../../axios/lib/adapters/xhr.js", "../../axios/lib/helpers/composeSignals.js", "../../axios/lib/helpers/trackStream.js", "../../axios/lib/adapters/fetch.js", "../../axios/lib/adapters/adapters.js", "../../axios/lib/core/dispatchRequest.js", "../../axios/lib/env/data.js", "../../axios/lib/helpers/validator.js", "../../axios/lib/core/Axios.js", "../../axios/lib/cancel/CancelToken.js", "../../axios/lib/helpers/spread.js", "../../axios/lib/helpers/isAxiosError.js", "../../axios/lib/helpers/HttpStatusCode.js", "../../axios/lib/axios.js", "../../axios/index.js", "../../@ledgerhq/device-management-kit/src/internal/manager-api/model/Application.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/model/Const.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/model/Errors.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/data/ManagerApiDto.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/data/AxiosManagerApiDataSource.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/service/DefaultManagerApiService.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/use-case/SetProviderUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/manager-api/di/managerApiModule.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/data/DefaultSecureChannelDataSource.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/service/DefaultSecureChannelService.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/di/secureChannelModule.ts", "../../@ledgerhq/device-management-kit/src/internal/secure-channel/model/Const.ts", "../../@ledgerhq/device-management-kit/src/internal/send/use-case/SendApduUseCase.ts", "../../@ledgerhq/device-management-kit/src/internal/send/di/sendModule.ts", "../../@ledgerhq/device-management-kit/src/internal/transport/service/DefaultTransportService.ts", "../../@ledgerhq/device-management-kit/src/internal/transport/di/transportModule.ts", "../../@ledgerhq/device-management-kit/src/di.ts", "../../@ledgerhq/device-management-kit/src/api/DeviceManagementKit.ts", "../../@ledgerhq/device-management-kit/src/api/DeviceManagementKitBuilder.ts", "../../@ledgerhq/device-management-kit/src/api/logger-subscriber/service/ConsoleLogger.ts", "../../@ledgerhq/device-management-kit/src/api/logger-subscriber/service/WebLogsExporterLogger.ts", "../../@ledgerhq/device-management-kit/src/api/transport/model/DeviceConnectionStateMachine.ts", "../../@ledgerhq/device-management-kit/src/api/transport/model/TransportConnectedDevice.ts", "../../@ledgerhq/device-management-kit/src/api/device-model/model/DeviceModel.stub.ts", "../../@ledgerhq/device-management-kit/src/api/device-session/ApduResponse.stub.ts", "../../@ledgerhq/device-management-kit/src/api/transport/model/TransportConnectedDevice.stub.ts", "../../@ledgerhq/device-management-kit/src/api/utils/Base64String.ts"],
  "sourcesContent": ["'use strict'\n\n// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nconst SEMVER_SPEC_VERSION = '2.0.0'\n\nconst MAX_LENGTH = 256\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n/* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nconst MAX_SAFE_COMPONENT_LENGTH = 16\n\n// Max safe length for a build identifier. The max length minus 6 characters for\n// the shortest version with a build 0.0.0+BUILD.\nconst MAX_SAFE_BUILD_LENGTH = MAX_LENGTH - 6\n\nconst RELEASE_TYPES = [\n  'major',\n  'premajor',\n  'minor',\n  'preminor',\n  'patch',\n  'prepatch',\n  'prerelease',\n]\n\nmodule.exports = {\n  MAX_LENGTH,\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_SAFE_INTEGER,\n  RELEASE_TYPES,\n  SEMVER_SPEC_VERSION,\n  FLAG_INCLUDE_PRERELEASE: 0b001,\n  FLAG_LOOSE: 0b010,\n}\n", "'use strict'\n\nconst debug = (\n  typeof process === 'object' &&\n  process.env &&\n  process.env.NODE_DEBUG &&\n  /\\bsemver\\b/i.test(process.env.NODE_DEBUG)\n) ? (...args) => console.error('SEMVER', ...args)\n  : () => {}\n\nmodule.exports = debug\n", "'use strict'\n\nconst {\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_LENGTH,\n} = require('./constants')\nconst debug = require('./debug')\nexports = module.exports = {}\n\n// The actual regexps go on exports.re\nconst re = exports.re = []\nconst safeRe = exports.safeRe = []\nconst src = exports.src = []\nconst safeSrc = exports.safeSrc = []\nconst t = exports.t = {}\nlet R = 0\n\nconst LETTERDASHNUMBER = '[a-zA-Z0-9-]'\n\n// Replace some greedy regex tokens to prevent regex dos issues. These regex are\n// used internally via the safeRe object since all inputs in this library get\n// normalized first to trim and collapse all extra whitespace. The original\n// regexes are exported for userland consumption and lower level usage. A\n// future breaking change could export the safer regex only with a note that\n// all input should have extra whitespace removed.\nconst safeRegexReplacements = [\n  ['\\\\s', 1],\n  ['\\\\d', MAX_LENGTH],\n  [LETTERDASHNUMBER, MAX_SAFE_BUILD_LENGTH],\n]\n\nconst makeSafeRegex = (value) => {\n  for (const [token, max] of safeRegexReplacements) {\n    value = value\n      .split(`${token}*`).join(`${token}{0,${max}}`)\n      .split(`${token}+`).join(`${token}{1,${max}}`)\n  }\n  return value\n}\n\nconst createToken = (name, value, isGlobal) => {\n  const safe = makeSafeRegex(value)\n  const index = R++\n  debug(name, index, value)\n  t[name] = index\n  src[index] = value\n  safeSrc[index] = safe\n  re[index] = new RegExp(value, isGlobal ? 'g' : undefined)\n  safeRe[index] = new RegExp(safe, isGlobal ? 'g' : undefined)\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ncreateToken('NUMERICIDENTIFIER', '0|[1-9]\\\\d*')\ncreateToken('NUMERICIDENTIFIERLOOSE', '\\\\d+')\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ncreateToken('NONNUMERICIDENTIFIER', `\\\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`)\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ncreateToken('MAINVERSION', `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('MAINVERSIONLOOSE', `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n// Non-numberic identifiers include numberic identifiers but can be longer.\n// Therefore non-numberic identifiers must go first.\n\ncreateToken('PRERELEASEIDENTIFIER', `(?:${src[t.NONNUMERICIDENTIFIER]\n}|${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('PRERELEASEIDENTIFIERLOOSE', `(?:${src[t.NONNUMERICIDENTIFIER]\n}|${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ncreateToken('PRERELEASE', `(?:-(${src[t.PRERELEASEIDENTIFIER]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIER]})*))`)\n\ncreateToken('PRERELEASELOOSE', `(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ncreateToken('BUILDIDENTIFIER', `${LETTERDASHNUMBER}+`)\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ncreateToken('BUILD', `(?:\\\\+(${src[t.BUILDIDENTIFIER]\n}(?:\\\\.${src[t.BUILDIDENTIFIER]})*))`)\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ncreateToken('FULLPLAIN', `v?${src[t.MAINVERSION]\n}${src[t.PRERELEASE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('FULL', `^${src[t.FULLPLAIN]}$`)\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ncreateToken('LOOSEPLAIN', `[v=\\\\s]*${src[t.MAINVERSIONLOOSE]\n}${src[t.PRERELEASELOOSE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('LOOSE', `^${src[t.LOOSEPLAIN]}$`)\n\ncreateToken('GTLT', '((?:<|>)?=?)')\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ncreateToken('XRANGEIDENTIFIERLOOSE', `${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`)\ncreateToken('XRANGEIDENTIFIER', `${src[t.NUMERICIDENTIFIER]}|x|X|\\\\*`)\n\ncreateToken('XRANGEPLAIN', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:${src[t.PRERELEASE]})?${\n                     src[t.BUILD]}?` +\n                   `)?)?`)\n\ncreateToken('XRANGEPLAINLOOSE', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:${src[t.PRERELEASELOOSE]})?${\n                          src[t.BUILD]}?` +\n                        `)?)?`)\n\ncreateToken('XRANGE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAIN]}$`)\ncreateToken('XRANGELOOSE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ncreateToken('COERCEPLAIN', `${'(^|[^\\\\d])' +\n              '(\\\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`)\ncreateToken('COERCE', `${src[t.COERCEPLAIN]}(?:$|[^\\\\d])`)\ncreateToken('COERCEFULL', src[t.COERCEPLAIN] +\n              `(?:${src[t.PRERELEASE]})?` +\n              `(?:${src[t.BUILD]})?` +\n              `(?:$|[^\\\\d])`)\ncreateToken('COERCERTL', src[t.COERCE], true)\ncreateToken('COERCERTLFULL', src[t.COERCEFULL], true)\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ncreateToken('LONETILDE', '(?:~>?)')\n\ncreateToken('TILDETRIM', `(\\\\s*)${src[t.LONETILDE]}\\\\s+`, true)\nexports.tildeTrimReplace = '$1~'\n\ncreateToken('TILDE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('TILDELOOSE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ncreateToken('LONECARET', '(?:\\\\^)')\n\ncreateToken('CARETTRIM', `(\\\\s*)${src[t.LONECARET]}\\\\s+`, true)\nexports.caretTrimReplace = '$1^'\n\ncreateToken('CARET', `^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('CARETLOOSE', `^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ncreateToken('COMPARATORLOOSE', `^${src[t.GTLT]}\\\\s*(${src[t.LOOSEPLAIN]})$|^$`)\ncreateToken('COMPARATOR', `^${src[t.GTLT]}\\\\s*(${src[t.FULLPLAIN]})$|^$`)\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ncreateToken('COMPARATORTRIM', `(\\\\s*)${src[t.GTLT]\n}\\\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`, true)\nexports.comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ncreateToken('HYPHENRANGE', `^\\\\s*(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s+-\\\\s+` +\n                   `(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s*$`)\n\ncreateToken('HYPHENRANGELOOSE', `^\\\\s*(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s+-\\\\s+` +\n                        `(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s*$`)\n\n// Star ranges basically just allow anything at all.\ncreateToken('STAR', '(<|>)?=?\\\\s*\\\\*')\n// >=0.0.0 is like a star\ncreateToken('GTE0', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0\\\\s*$')\ncreateToken('GTE0PRE', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0-0\\\\s*$')\n", "'use strict'\n\n// parse out just the options we care about\nconst looseOption = Object.freeze({ loose: true })\nconst emptyOpts = Object.freeze({ })\nconst parseOptions = options => {\n  if (!options) {\n    return emptyOpts\n  }\n\n  if (typeof options !== 'object') {\n    return looseOption\n  }\n\n  return options\n}\nmodule.exports = parseOptions\n", "'use strict'\n\nconst numeric = /^[0-9]+$/\nconst compareIdentifiers = (a, b) => {\n  const anum = numeric.test(a)\n  const bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nconst rcompareIdentifiers = (a, b) => compareIdentifiers(b, a)\n\nmodule.exports = {\n  compareIdentifiers,\n  rcompareIdentifiers,\n}\n", "'use strict'\n\nconst debug = require('../internal/debug')\nconst { MAX_LENGTH, MAX_SAFE_INTEGER } = require('../internal/constants')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst parseOptions = require('../internal/parse-options')\nconst { compareIdentifiers } = require('../internal/identifiers')\nclass SemVer {\n  constructor (version, options) {\n    options = parseOptions(options)\n\n    if (version instanceof SemVer) {\n      if (version.loose === !!options.loose &&\n        version.includePrerelease === !!options.includePrerelease) {\n        return version\n      } else {\n        version = version.version\n      }\n    } else if (typeof version !== 'string') {\n      throw new TypeError(`Invalid version. Must be a string. Got type \"${typeof version}\".`)\n    }\n\n    if (version.length > MAX_LENGTH) {\n      throw new TypeError(\n        `version is longer than ${MAX_LENGTH} characters`\n      )\n    }\n\n    debug('SemVer', version, options)\n    this.options = options\n    this.loose = !!options.loose\n    // this isn't actually relevant for versions, but keep it so that we\n    // don't run into trouble passing this.options around.\n    this.includePrerelease = !!options.includePrerelease\n\n    const m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n    if (!m) {\n      throw new TypeError(`Invalid Version: ${version}`)\n    }\n\n    this.raw = version\n\n    // these are actually numbers\n    this.major = +m[1]\n    this.minor = +m[2]\n    this.patch = +m[3]\n\n    if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n      throw new TypeError('Invalid major version')\n    }\n\n    if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n      throw new TypeError('Invalid minor version')\n    }\n\n    if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n      throw new TypeError('Invalid patch version')\n    }\n\n    // numberify any prerelease numeric ids\n    if (!m[4]) {\n      this.prerelease = []\n    } else {\n      this.prerelease = m[4].split('.').map((id) => {\n        if (/^[0-9]+$/.test(id)) {\n          const num = +id\n          if (num >= 0 && num < MAX_SAFE_INTEGER) {\n            return num\n          }\n        }\n        return id\n      })\n    }\n\n    this.build = m[5] ? m[5].split('.') : []\n    this.format()\n  }\n\n  format () {\n    this.version = `${this.major}.${this.minor}.${this.patch}`\n    if (this.prerelease.length) {\n      this.version += `-${this.prerelease.join('.')}`\n    }\n    return this.version\n  }\n\n  toString () {\n    return this.version\n  }\n\n  compare (other) {\n    debug('SemVer.compare', this.version, this.options, other)\n    if (!(other instanceof SemVer)) {\n      if (typeof other === 'string' && other === this.version) {\n        return 0\n      }\n      other = new SemVer(other, this.options)\n    }\n\n    if (other.version === this.version) {\n      return 0\n    }\n\n    return this.compareMain(other) || this.comparePre(other)\n  }\n\n  compareMain (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    return (\n      compareIdentifiers(this.major, other.major) ||\n      compareIdentifiers(this.minor, other.minor) ||\n      compareIdentifiers(this.patch, other.patch)\n    )\n  }\n\n  comparePre (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    // NOT having a prerelease is > having one\n    if (this.prerelease.length && !other.prerelease.length) {\n      return -1\n    } else if (!this.prerelease.length && other.prerelease.length) {\n      return 1\n    } else if (!this.prerelease.length && !other.prerelease.length) {\n      return 0\n    }\n\n    let i = 0\n    do {\n      const a = this.prerelease[i]\n      const b = other.prerelease[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  compareBuild (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    let i = 0\n    do {\n      const a = this.build[i]\n      const b = other.build[i]\n      debug('build compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  // preminor will bump the version up to the next minor release, and immediately\n  // down to pre-release. premajor and prepatch work the same way.\n  inc (release, identifier, identifierBase) {\n    if (release.startsWith('pre')) {\n      if (!identifier && identifierBase === false) {\n        throw new Error('invalid increment argument: identifier is empty')\n      }\n      // Avoid an invalid semver results\n      if (identifier) {\n        const match = `-${identifier}`.match(this.options.loose ? re[t.PRERELEASELOOSE] : re[t.PRERELEASE])\n        if (!match || match[1] !== identifier) {\n          throw new Error(`invalid identifier: ${identifier}`)\n        }\n      }\n    }\n\n    switch (release) {\n      case 'premajor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor = 0\n        this.major++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'preminor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'prepatch':\n        // If this is already a prerelease, it will bump to the next version\n        // drop any prereleases that might already exist, since they are not\n        // relevant at this point.\n        this.prerelease.length = 0\n        this.inc('patch', identifier, identifierBase)\n        this.inc('pre', identifier, identifierBase)\n        break\n      // If the input is a non-prerelease version, this acts the same as\n      // prepatch.\n      case 'prerelease':\n        if (this.prerelease.length === 0) {\n          this.inc('patch', identifier, identifierBase)\n        }\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'release':\n        if (this.prerelease.length === 0) {\n          throw new Error(`version ${this.raw} is not a prerelease`)\n        }\n        this.prerelease.length = 0\n        break\n\n      case 'major':\n        // If this is a pre-major version, bump up to the same major version.\n        // Otherwise increment major.\n        // 1.0.0-5 bumps to 1.0.0\n        // 1.1.0 bumps to 2.0.0\n        if (\n          this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0\n        ) {\n          this.major++\n        }\n        this.minor = 0\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'minor':\n        // If this is a pre-minor version, bump up to the same minor version.\n        // Otherwise increment minor.\n        // 1.2.0-5 bumps to 1.2.0\n        // 1.2.1 bumps to 1.3.0\n        if (this.patch !== 0 || this.prerelease.length === 0) {\n          this.minor++\n        }\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'patch':\n        // If this is not a pre-release version, it will increment the patch.\n        // If it is a pre-release it will bump up to the same patch version.\n        // 1.2.0-5 patches to 1.2.0\n        // 1.2.0 patches to 1.2.1\n        if (this.prerelease.length === 0) {\n          this.patch++\n        }\n        this.prerelease = []\n        break\n      // This probably shouldn't be used publicly.\n      // 1.0.0 'pre' would become 1.0.0-0 which is the wrong direction.\n      case 'pre': {\n        const base = Number(identifierBase) ? 1 : 0\n\n        if (this.prerelease.length === 0) {\n          this.prerelease = [base]\n        } else {\n          let i = this.prerelease.length\n          while (--i >= 0) {\n            if (typeof this.prerelease[i] === 'number') {\n              this.prerelease[i]++\n              i = -2\n            }\n          }\n          if (i === -1) {\n            // didn't increment anything\n            if (identifier === this.prerelease.join('.') && identifierBase === false) {\n              throw new Error('invalid increment argument: identifier already exists')\n            }\n            this.prerelease.push(base)\n          }\n        }\n        if (identifier) {\n          // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n          // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n          let prerelease = [identifier, base]\n          if (identifierBase === false) {\n            prerelease = [identifier]\n          }\n          if (compareIdentifiers(this.prerelease[0], identifier) === 0) {\n            if (isNaN(this.prerelease[1])) {\n              this.prerelease = prerelease\n            }\n          } else {\n            this.prerelease = prerelease\n          }\n        }\n        break\n      }\n      default:\n        throw new Error(`invalid increment argument: ${release}`)\n    }\n    this.raw = this.format()\n    if (this.build.length) {\n      this.raw += `+${this.build.join('.')}`\n    }\n    return this\n  }\n}\n\nmodule.exports = SemVer\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst parse = (version, options, throwErrors = false) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    if (!throwErrors) {\n      return null\n    }\n    throw er\n  }\n}\n\nmodule.exports = parse\n", "'use strict'\n\nconst parse = require('./parse')\nconst valid = (version, options) => {\n  const v = parse(version, options)\n  return v ? v.version : null\n}\nmodule.exports = valid\n", "'use strict'\n\nconst parse = require('./parse')\nconst clean = (version, options) => {\n  const s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\nmodule.exports = clean\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\n\nconst inc = (version, release, options, identifier, identifierBase) => {\n  if (typeof (options) === 'string') {\n    identifierBase = identifier\n    identifier = options\n    options = undefined\n  }\n\n  try {\n    return new SemVer(\n      version instanceof SemVer ? version.version : version,\n      options\n    ).inc(release, identifier, identifierBase).version\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = inc\n", "'use strict'\n\nconst parse = require('./parse.js')\n\nconst diff = (version1, version2) => {\n  const v1 = parse(version1, null, true)\n  const v2 = parse(version2, null, true)\n  const comparison = v1.compare(v2)\n\n  if (comparison === 0) {\n    return null\n  }\n\n  const v1Higher = comparison > 0\n  const highVersion = v1Higher ? v1 : v2\n  const lowVersion = v1Higher ? v2 : v1\n  const highHasPre = !!highVersion.prerelease.length\n  const lowHasPre = !!lowVersion.prerelease.length\n\n  if (lowHasPre && !highHasPre) {\n    // Going from prerelease -> no prerelease requires some special casing\n\n    // If the low version has only a major, then it will always be a major\n    // Some examples:\n    // 1.0.0-1 -> 1.0.0\n    // 1.0.0-1 -> 1.1.1\n    // 1.0.0-1 -> 2.0.0\n    if (!lowVersion.patch && !lowVersion.minor) {\n      return 'major'\n    }\n\n    // If the main part has no difference\n    if (lowVersion.compareMain(highVersion) === 0) {\n      if (lowVersion.minor && !lowVersion.patch) {\n        return 'minor'\n      }\n      return 'patch'\n    }\n  }\n\n  // add the `pre` prefix if we are going to a prerelease version\n  const prefix = highHasPre ? 'pre' : ''\n\n  if (v1.major !== v2.major) {\n    return prefix + 'major'\n  }\n\n  if (v1.minor !== v2.minor) {\n    return prefix + 'minor'\n  }\n\n  if (v1.patch !== v2.patch) {\n    return prefix + 'patch'\n  }\n\n  // high and low are preleases\n  return 'prerelease'\n}\n\nmodule.exports = diff\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst major = (a, loose) => new SemVer(a, loose).major\nmodule.exports = major\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst minor = (a, loose) => new SemVer(a, loose).minor\nmodule.exports = minor\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst patch = (a, loose) => new SemVer(a, loose).patch\nmodule.exports = patch\n", "'use strict'\n\nconst parse = require('./parse')\nconst prerelease = (version, options) => {\n  const parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\nmodule.exports = prerelease\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst compare = (a, b, loose) =>\n  new SemVer(a, loose).compare(new SemVer(b, loose))\n\nmodule.exports = compare\n", "'use strict'\n\nconst compare = require('./compare')\nconst rcompare = (a, b, loose) => compare(b, a, loose)\nmodule.exports = rcompare\n", "'use strict'\n\nconst compare = require('./compare')\nconst compareLoose = (a, b) => compare(a, b, true)\nmodule.exports = compareLoose\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst compareBuild = (a, b, loose) => {\n  const versionA = new SemVer(a, loose)\n  const versionB = new SemVer(b, loose)\n  return versionA.compare(versionB) || versionA.compareBuild(versionB)\n}\nmodule.exports = compareBuild\n", "'use strict'\n\nconst compareBuild = require('./compare-build')\nconst sort = (list, loose) => list.sort((a, b) => compareBuild(a, b, loose))\nmodule.exports = sort\n", "'use strict'\n\nconst compareBuild = require('./compare-build')\nconst rsort = (list, loose) => list.sort((a, b) => compareBuild(b, a, loose))\nmodule.exports = rsort\n", "'use strict'\n\nconst compare = require('./compare')\nconst gt = (a, b, loose) => compare(a, b, loose) > 0\nmodule.exports = gt\n", "'use strict'\n\nconst compare = require('./compare')\nconst lt = (a, b, loose) => compare(a, b, loose) < 0\nmodule.exports = lt\n", "'use strict'\n\nconst compare = require('./compare')\nconst eq = (a, b, loose) => compare(a, b, loose) === 0\nmodule.exports = eq\n", "'use strict'\n\nconst compare = require('./compare')\nconst neq = (a, b, loose) => compare(a, b, loose) !== 0\nmodule.exports = neq\n", "'use strict'\n\nconst compare = require('./compare')\nconst gte = (a, b, loose) => compare(a, b, loose) >= 0\nmodule.exports = gte\n", "'use strict'\n\nconst compare = require('./compare')\nconst lte = (a, b, loose) => compare(a, b, loose) <= 0\nmodule.exports = lte\n", "'use strict'\n\nconst eq = require('./eq')\nconst neq = require('./neq')\nconst gt = require('./gt')\nconst gte = require('./gte')\nconst lt = require('./lt')\nconst lte = require('./lte')\n\nconst cmp = (a, op, b, loose) => {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError(`Invalid operator: ${op}`)\n  }\n}\nmodule.exports = cmp\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst parse = require('./parse')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst coerce = (version, options) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version === 'number') {\n    version = String(version)\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  options = options || {}\n\n  let match = null\n  if (!options.rtl) {\n    match = version.match(options.includePrerelease ? re[t.COERCEFULL] : re[t.COERCE])\n  } else {\n    // Find the right-most coercible string that does not share\n    // a terminus with a more left-ward coercible string.\n    // Eg, '1.2.3.4' wants to coerce '2.3.4', not '3.4' or '4'\n    // With includePrerelease option set, '1.2.3.4-rc' wants to coerce '2.3.4-rc', not '2.3.4'\n    //\n    // Walk through the string checking with a /g regexp\n    // Manually set the index so as to pick up overlapping matches.\n    // Stop when we get a match that ends at the string end, since no\n    // coercible string can be more right-ward without the same terminus.\n    const coerceRtlRegex = options.includePrerelease ? re[t.COERCERTLFULL] : re[t.COERCERTL]\n    let next\n    while ((next = coerceRtlRegex.exec(version)) &&\n        (!match || match.index + match[0].length !== version.length)\n    ) {\n      if (!match ||\n            next.index + next[0].length !== match.index + match[0].length) {\n        match = next\n      }\n      coerceRtlRegex.lastIndex = next.index + next[1].length + next[2].length\n    }\n    // leave it in a clean state\n    coerceRtlRegex.lastIndex = -1\n  }\n\n  if (match === null) {\n    return null\n  }\n\n  const major = match[2]\n  const minor = match[3] || '0'\n  const patch = match[4] || '0'\n  const prerelease = options.includePrerelease && match[5] ? `-${match[5]}` : ''\n  const build = options.includePrerelease && match[6] ? `+${match[6]}` : ''\n\n  return parse(`${major}.${minor}.${patch}${prerelease}${build}`, options)\n}\nmodule.exports = coerce\n", "'use strict'\n\nclass LRUCache {\n  constructor () {\n    this.max = 1000\n    this.map = new Map()\n  }\n\n  get (key) {\n    const value = this.map.get(key)\n    if (value === undefined) {\n      return undefined\n    } else {\n      // Remove the key from the map and add it to the end\n      this.map.delete(key)\n      this.map.set(key, value)\n      return value\n    }\n  }\n\n  delete (key) {\n    return this.map.delete(key)\n  }\n\n  set (key, value) {\n    const deleted = this.delete(key)\n\n    if (!deleted && value !== undefined) {\n      // If cache is full, delete the least recently used item\n      if (this.map.size >= this.max) {\n        const firstKey = this.map.keys().next().value\n        this.delete(firstKey)\n      }\n\n      this.map.set(key, value)\n    }\n\n    return this\n  }\n}\n\nmodule.exports = LRUCache\n", "'use strict'\n\nconst SPACE_CHARACTERS = /\\s+/g\n\n// hoisted class for cyclic dependency\nclass Range {\n  constructor (range, options) {\n    options = parseOptions(options)\n\n    if (range instanceof Range) {\n      if (\n        range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease\n      ) {\n        return range\n      } else {\n        return new Range(range.raw, options)\n      }\n    }\n\n    if (range instanceof Comparator) {\n      // just put it in the set and return\n      this.raw = range.value\n      this.set = [[range]]\n      this.formatted = undefined\n      return this\n    }\n\n    this.options = options\n    this.loose = !!options.loose\n    this.includePrerelease = !!options.includePrerelease\n\n    // First reduce all whitespace as much as possible so we do not have to rely\n    // on potentially slow regexes like \\s*. This is then stored and used for\n    // future error messages as well.\n    this.raw = range.trim().replace(SPACE_CHARACTERS, ' ')\n\n    // First, split on ||\n    this.set = this.raw\n      .split('||')\n      // map the range to a 2d array of comparators\n      .map(r => this.parseRange(r.trim()))\n      // throw out any comparator lists that are empty\n      // this generally means that it was not a valid range, which is allowed\n      // in loose mode, but will still throw if the WHOLE range is invalid.\n      .filter(c => c.length)\n\n    if (!this.set.length) {\n      throw new TypeError(`Invalid SemVer Range: ${this.raw}`)\n    }\n\n    // if we have any that are not the null set, throw out null sets.\n    if (this.set.length > 1) {\n      // keep the first one, in case they're all null sets\n      const first = this.set[0]\n      this.set = this.set.filter(c => !isNullSet(c[0]))\n      if (this.set.length === 0) {\n        this.set = [first]\n      } else if (this.set.length > 1) {\n        // if we have any that are *, then the range is just *\n        for (const c of this.set) {\n          if (c.length === 1 && isAny(c[0])) {\n            this.set = [c]\n            break\n          }\n        }\n      }\n    }\n\n    this.formatted = undefined\n  }\n\n  get range () {\n    if (this.formatted === undefined) {\n      this.formatted = ''\n      for (let i = 0; i < this.set.length; i++) {\n        if (i > 0) {\n          this.formatted += '||'\n        }\n        const comps = this.set[i]\n        for (let k = 0; k < comps.length; k++) {\n          if (k > 0) {\n            this.formatted += ' '\n          }\n          this.formatted += comps[k].toString().trim()\n        }\n      }\n    }\n    return this.formatted\n  }\n\n  format () {\n    return this.range\n  }\n\n  toString () {\n    return this.range\n  }\n\n  parseRange (range) {\n    // memoize range parsing for performance.\n    // this is a very hot path, and fully deterministic.\n    const memoOpts =\n      (this.options.includePrerelease && FLAG_INCLUDE_PRERELEASE) |\n      (this.options.loose && FLAG_LOOSE)\n    const memoKey = memoOpts + ':' + range\n    const cached = cache.get(memoKey)\n    if (cached) {\n      return cached\n    }\n\n    const loose = this.options.loose\n    // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n    const hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n    range = range.replace(hr, hyphenReplace(this.options.includePrerelease))\n    debug('hyphen replace', range)\n\n    // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n    range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n    debug('comparator trim', range)\n\n    // `~ 1.2.3` => `~1.2.3`\n    range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n    debug('tilde trim', range)\n\n    // `^ 1.2.3` => `^1.2.3`\n    range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n    debug('caret trim', range)\n\n    // At this point, the range is completely trimmed and\n    // ready to be split into comparators.\n\n    let rangeList = range\n      .split(' ')\n      .map(comp => parseComparator(comp, this.options))\n      .join(' ')\n      .split(/\\s+/)\n      // >=0.0.0 is equivalent to *\n      .map(comp => replaceGTE0(comp, this.options))\n\n    if (loose) {\n      // in loose mode, throw out any that are not valid comparators\n      rangeList = rangeList.filter(comp => {\n        debug('loose invalid filter', comp, this.options)\n        return !!comp.match(re[t.COMPARATORLOOSE])\n      })\n    }\n    debug('range list', rangeList)\n\n    // if any comparators are the null set, then replace with JUST null set\n    // if more than one comparator, remove any * comparators\n    // also, don't include the same comparator more than once\n    const rangeMap = new Map()\n    const comparators = rangeList.map(comp => new Comparator(comp, this.options))\n    for (const comp of comparators) {\n      if (isNullSet(comp)) {\n        return [comp]\n      }\n      rangeMap.set(comp.value, comp)\n    }\n    if (rangeMap.size > 1 && rangeMap.has('')) {\n      rangeMap.delete('')\n    }\n\n    const result = [...rangeMap.values()]\n    cache.set(memoKey, result)\n    return result\n  }\n\n  intersects (range, options) {\n    if (!(range instanceof Range)) {\n      throw new TypeError('a Range is required')\n    }\n\n    return this.set.some((thisComparators) => {\n      return (\n        isSatisfiable(thisComparators, options) &&\n        range.set.some((rangeComparators) => {\n          return (\n            isSatisfiable(rangeComparators, options) &&\n            thisComparators.every((thisComparator) => {\n              return rangeComparators.every((rangeComparator) => {\n                return thisComparator.intersects(rangeComparator, options)\n              })\n            })\n          )\n        })\n      )\n    })\n  }\n\n  // if ANY of the sets match ALL of its comparators, then pass\n  test (version) {\n    if (!version) {\n      return false\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    for (let i = 0; i < this.set.length; i++) {\n      if (testSet(this.set[i], version, this.options)) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nmodule.exports = Range\n\nconst LRU = require('../internal/lrucache')\nconst cache = new LRU()\n\nconst parseOptions = require('../internal/parse-options')\nconst Comparator = require('./comparator')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst {\n  safeRe: re,\n  t,\n  comparatorTrimReplace,\n  tildeTrimReplace,\n  caretTrimReplace,\n} = require('../internal/re')\nconst { FLAG_INCLUDE_PRERELEASE, FLAG_LOOSE } = require('../internal/constants')\n\nconst isNullSet = c => c.value === '<0.0.0-0'\nconst isAny = c => c.value === ''\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nconst isSatisfiable = (comparators, options) => {\n  let result = true\n  const remainingComparators = comparators.slice()\n  let testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every((otherComparator) => {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nconst parseComparator = (comp, options) => {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nconst isX = id => !id || id.toLowerCase() === 'x' || id === '*'\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nconst replaceTildes = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceTilde(c, options))\n    .join(' ')\n}\n\nconst replaceTilde = (comp, options) => {\n  const r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('tilde', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = `>=${M}.${m}.${p}-${pr\n      } <${M}.${+m + 1}.0-0`\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nconst replaceCarets = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceCaret(c, options))\n    .join(' ')\n}\n\nconst replaceCaret = (comp, options) => {\n  debug('caret', comp, options)\n  const r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  const z = options.includePrerelease ? '-0' : ''\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('caret', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr\n        } <${+M + 1}.0.0-0`\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p\n        } <${+M + 1}.0.0-0`\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nconst replaceXRanges = (comp, options) => {\n  debug('replaceXRanges', comp, options)\n  return comp\n    .split(/\\s+/)\n    .map((c) => replaceXRange(c, options))\n    .join(' ')\n}\n\nconst replaceXRange = (comp, options) => {\n  comp = comp.trim()\n  const r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    const xM = isX(M)\n    const xm = xM || isX(m)\n    const xp = xm || isX(p)\n    const anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0'\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nconst replaceStars = (comp, options) => {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp\n    .trim()\n    .replace(re[t.STAR], '')\n}\n\nconst replaceGTE0 = (comp, options) => {\n  debug('replaceGTE0', comp, options)\n  return comp\n    .trim()\n    .replace(re[options.includePrerelease ? t.GTE0PRE : t.GTE0], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\n// TODO build?\nconst hyphenReplace = incPr => ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr) => {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = `>=${fM}.0.0${incPr ? '-0' : ''}`\n  } else if (isX(fp)) {\n    from = `>=${fM}.${fm}.0${incPr ? '-0' : ''}`\n  } else if (fpr) {\n    from = `>=${from}`\n  } else {\n    from = `>=${from}${incPr ? '-0' : ''}`\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = `<${+tM + 1}.0.0-0`\n  } else if (isX(tp)) {\n    to = `<${tM}.${+tm + 1}.0-0`\n  } else if (tpr) {\n    to = `<=${tM}.${tm}.${tp}-${tpr}`\n  } else if (incPr) {\n    to = `<${tM}.${tm}.${+tp + 1}-0`\n  } else {\n    to = `<=${to}`\n  }\n\n  return `${from} ${to}`.trim()\n}\n\nconst testSet = (set, version, options) => {\n  for (let i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (let i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === Comparator.ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        const allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n", "'use strict'\n\nconst ANY = Symbol('SemVer ANY')\n// hoisted class for cyclic dependency\nclass Comparator {\n  static get ANY () {\n    return ANY\n  }\n\n  constructor (comp, options) {\n    options = parseOptions(options)\n\n    if (comp instanceof Comparator) {\n      if (comp.loose === !!options.loose) {\n        return comp\n      } else {\n        comp = comp.value\n      }\n    }\n\n    comp = comp.trim().split(/\\s+/).join(' ')\n    debug('comparator', comp, options)\n    this.options = options\n    this.loose = !!options.loose\n    this.parse(comp)\n\n    if (this.semver === ANY) {\n      this.value = ''\n    } else {\n      this.value = this.operator + this.semver.version\n    }\n\n    debug('comp', this)\n  }\n\n  parse (comp) {\n    const r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n    const m = comp.match(r)\n\n    if (!m) {\n      throw new TypeError(`Invalid comparator: ${comp}`)\n    }\n\n    this.operator = m[1] !== undefined ? m[1] : ''\n    if (this.operator === '=') {\n      this.operator = ''\n    }\n\n    // if it literally is just '>' or '' then allow anything.\n    if (!m[2]) {\n      this.semver = ANY\n    } else {\n      this.semver = new SemVer(m[2], this.options.loose)\n    }\n  }\n\n  toString () {\n    return this.value\n  }\n\n  test (version) {\n    debug('Comparator.test', version, this.options.loose)\n\n    if (this.semver === ANY || version === ANY) {\n      return true\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    return cmp(version, this.operator, this.semver, this.options)\n  }\n\n  intersects (comp, options) {\n    if (!(comp instanceof Comparator)) {\n      throw new TypeError('a Comparator is required')\n    }\n\n    if (this.operator === '') {\n      if (this.value === '') {\n        return true\n      }\n      return new Range(comp.value, options).test(this.value)\n    } else if (comp.operator === '') {\n      if (comp.value === '') {\n        return true\n      }\n      return new Range(this.value, options).test(comp.semver)\n    }\n\n    options = parseOptions(options)\n\n    // Special cases where nothing can possibly be lower\n    if (options.includePrerelease &&\n      (this.value === '<0.0.0-0' || comp.value === '<0.0.0-0')) {\n      return false\n    }\n    if (!options.includePrerelease &&\n      (this.value.startsWith('<0.0.0') || comp.value.startsWith('<0.0.0'))) {\n      return false\n    }\n\n    // Same direction increasing (> or >=)\n    if (this.operator.startsWith('>') && comp.operator.startsWith('>')) {\n      return true\n    }\n    // Same direction decreasing (< or <=)\n    if (this.operator.startsWith('<') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // same SemVer and both sides are inclusive (<= or >=)\n    if (\n      (this.semver.version === comp.semver.version) &&\n      this.operator.includes('=') && comp.operator.includes('=')) {\n      return true\n    }\n    // opposite directions less than\n    if (cmp(this.semver, '<', comp.semver, options) &&\n      this.operator.startsWith('>') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // opposite directions greater than\n    if (cmp(this.semver, '>', comp.semver, options) &&\n      this.operator.startsWith('<') && comp.operator.startsWith('>')) {\n      return true\n    }\n    return false\n  }\n}\n\nmodule.exports = Comparator\n\nconst parseOptions = require('../internal/parse-options')\nconst { safeRe: re, t } = require('../internal/re')\nconst cmp = require('../functions/cmp')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst Range = require('./range')\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst satisfies = (version, range, options) => {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\nmodule.exports = satisfies\n", "'use strict'\n\nconst Range = require('../classes/range')\n\n// Mostly just for testing and legacy API reasons\nconst toComparators = (range, options) =>\n  new Range(range, options).set\n    .map(comp => comp.map(c => c.value).join(' ').trim().split(' '))\n\nmodule.exports = toComparators\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\n\nconst maxSatisfying = (versions, range, options) => {\n  let max = null\n  let maxSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\nmodule.exports = maxSatisfying\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst minSatisfying = (versions, range, options) => {\n  let min = null\n  let minSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\nmodule.exports = minSatisfying\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst gt = require('../functions/gt')\n\nconst minVersion = (range, loose) => {\n  range = new Range(range, loose)\n\n  let minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let setMin = null\n    comparators.forEach((comparator) => {\n      // Clone to avoid manipulating the comparator's semver object.\n      const compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!setMin || gt(compver, setMin)) {\n            setMin = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error(`Unexpected operation: ${comparator.operator}`)\n      }\n    })\n    if (setMin && (!minver || gt(minver, setMin))) {\n      minver = setMin\n    }\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\nmodule.exports = minVersion\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst validRange = (range, options) => {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = validRange\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Comparator = require('../classes/comparator')\nconst { ANY } = Comparator\nconst Range = require('../classes/range')\nconst satisfies = require('../functions/satisfies')\nconst gt = require('../functions/gt')\nconst lt = require('../functions/lt')\nconst lte = require('../functions/lte')\nconst gte = require('../functions/gte')\n\nconst outside = (version, range, hilo, options) => {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  let gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisfies the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let high = null\n    let low = null\n\n    comparators.forEach((comparator) => {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nmodule.exports = outside\n", "'use strict'\n\n// Determine if version is greater than all the versions possible in the range.\nconst outside = require('./outside')\nconst gtr = (version, range, options) => outside(version, range, '>', options)\nmodule.exports = gtr\n", "'use strict'\n\nconst outside = require('./outside')\n// Determine if version is less than all the versions possible in the range\nconst ltr = (version, range, options) => outside(version, range, '<', options)\nmodule.exports = ltr\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst intersects = (r1, r2, options) => {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2, options)\n}\nmodule.exports = intersects\n", "'use strict'\n\n// given a set of versions and a range, create a \"simplified\" range\n// that includes the same versions that the original range does\n// If the original range is shorter than the simplified one, return that.\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\nmodule.exports = (versions, range, options) => {\n  const set = []\n  let first = null\n  let prev = null\n  const v = versions.sort((a, b) => compare(a, b, options))\n  for (const version of v) {\n    const included = satisfies(version, range, options)\n    if (included) {\n      prev = version\n      if (!first) {\n        first = version\n      }\n    } else {\n      if (prev) {\n        set.push([first, prev])\n      }\n      prev = null\n      first = null\n    }\n  }\n  if (first) {\n    set.push([first, null])\n  }\n\n  const ranges = []\n  for (const [min, max] of set) {\n    if (min === max) {\n      ranges.push(min)\n    } else if (!max && min === v[0]) {\n      ranges.push('*')\n    } else if (!max) {\n      ranges.push(`>=${min}`)\n    } else if (min === v[0]) {\n      ranges.push(`<=${max}`)\n    } else {\n      ranges.push(`${min} - ${max}`)\n    }\n  }\n  const simplified = ranges.join(' || ')\n  const original = typeof range.raw === 'string' ? range.raw : String(range)\n  return simplified.length < original.length ? simplified : range\n}\n", "'use strict'\n\nconst Range = require('../classes/range.js')\nconst Comparator = require('../classes/comparator.js')\nconst { ANY } = Comparator\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\n\n// Complex range `r1 || r2 || ...` is a subset of `R1 || R2 || ...` iff:\n// - Every simple range `r1, r2, ...` is a null set, OR\n// - Every simple range `r1, r2, ...` which is not a null set is a subset of\n//   some `R1, R2, ...`\n//\n// Simple range `c1 c2 ...` is a subset of simple range `C1 C2 ...` iff:\n// - If c is only the ANY comparator\n//   - If C is only the ANY comparator, return true\n//   - Else if in prerelease mode, return false\n//   - else replace c with `[>=0.0.0]`\n// - If C is only the ANY comparator\n//   - if in prerelease mode, return true\n//   - else replace C with `[>=0.0.0]`\n// - Let EQ be the set of = comparators in c\n// - If EQ is more than one, return true (null set)\n// - Let GT be the highest > or >= comparator in c\n// - Let LT be the lowest < or <= comparator in c\n// - If GT and LT, and GT.semver > LT.semver, return true (null set)\n// - If any C is a = range, and GT or LT are set, return false\n// - If EQ\n//   - If GT, and EQ does not satisfy GT, return true (null set)\n//   - If LT, and EQ does not satisfy LT, return true (null set)\n//   - If EQ satisfies every C, return true\n//   - Else return false\n// - If GT\n//   - If GT.semver is lower than any > or >= comp in C, return false\n//   - If GT is >=, and GT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the GT.semver tuple, return false\n// - If LT\n//   - If LT.semver is greater than any < or <= comp in C, return false\n//   - If LT is <=, and LT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the LT.semver tuple, return false\n// - Else return true\n\nconst subset = (sub, dom, options = {}) => {\n  if (sub === dom) {\n    return true\n  }\n\n  sub = new Range(sub, options)\n  dom = new Range(dom, options)\n  let sawNonNull = false\n\n  OUTER: for (const simpleSub of sub.set) {\n    for (const simpleDom of dom.set) {\n      const isSub = simpleSubset(simpleSub, simpleDom, options)\n      sawNonNull = sawNonNull || isSub !== null\n      if (isSub) {\n        continue OUTER\n      }\n    }\n    // the null set is a subset of everything, but null simple ranges in\n    // a complex range should be ignored.  so if we saw a non-null range,\n    // then we know this isn't a subset, but if EVERY simple range was null,\n    // then it is a subset.\n    if (sawNonNull) {\n      return false\n    }\n  }\n  return true\n}\n\nconst minimumVersionWithPreRelease = [new Comparator('>=0.0.0-0')]\nconst minimumVersion = [new Comparator('>=0.0.0')]\n\nconst simpleSubset = (sub, dom, options) => {\n  if (sub === dom) {\n    return true\n  }\n\n  if (sub.length === 1 && sub[0].semver === ANY) {\n    if (dom.length === 1 && dom[0].semver === ANY) {\n      return true\n    } else if (options.includePrerelease) {\n      sub = minimumVersionWithPreRelease\n    } else {\n      sub = minimumVersion\n    }\n  }\n\n  if (dom.length === 1 && dom[0].semver === ANY) {\n    if (options.includePrerelease) {\n      return true\n    } else {\n      dom = minimumVersion\n    }\n  }\n\n  const eqSet = new Set()\n  let gt, lt\n  for (const c of sub) {\n    if (c.operator === '>' || c.operator === '>=') {\n      gt = higherGT(gt, c, options)\n    } else if (c.operator === '<' || c.operator === '<=') {\n      lt = lowerLT(lt, c, options)\n    } else {\n      eqSet.add(c.semver)\n    }\n  }\n\n  if (eqSet.size > 1) {\n    return null\n  }\n\n  let gtltComp\n  if (gt && lt) {\n    gtltComp = compare(gt.semver, lt.semver, options)\n    if (gtltComp > 0) {\n      return null\n    } else if (gtltComp === 0 && (gt.operator !== '>=' || lt.operator !== '<=')) {\n      return null\n    }\n  }\n\n  // will iterate one or zero times\n  for (const eq of eqSet) {\n    if (gt && !satisfies(eq, String(gt), options)) {\n      return null\n    }\n\n    if (lt && !satisfies(eq, String(lt), options)) {\n      return null\n    }\n\n    for (const c of dom) {\n      if (!satisfies(eq, String(c), options)) {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  let higher, lower\n  let hasDomLT, hasDomGT\n  // if the subset has a prerelease, we need a comparator in the superset\n  // with the same tuple and a prerelease, or it's not a subset\n  let needDomLTPre = lt &&\n    !options.includePrerelease &&\n    lt.semver.prerelease.length ? lt.semver : false\n  let needDomGTPre = gt &&\n    !options.includePrerelease &&\n    gt.semver.prerelease.length ? gt.semver : false\n  // exception: <1.2.3-0 is the same as <1.2.3\n  if (needDomLTPre && needDomLTPre.prerelease.length === 1 &&\n      lt.operator === '<' && needDomLTPre.prerelease[0] === 0) {\n    needDomLTPre = false\n  }\n\n  for (const c of dom) {\n    hasDomGT = hasDomGT || c.operator === '>' || c.operator === '>='\n    hasDomLT = hasDomLT || c.operator === '<' || c.operator === '<='\n    if (gt) {\n      if (needDomGTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomGTPre.major &&\n            c.semver.minor === needDomGTPre.minor &&\n            c.semver.patch === needDomGTPre.patch) {\n          needDomGTPre = false\n        }\n      }\n      if (c.operator === '>' || c.operator === '>=') {\n        higher = higherGT(gt, c, options)\n        if (higher === c && higher !== gt) {\n          return false\n        }\n      } else if (gt.operator === '>=' && !satisfies(gt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (lt) {\n      if (needDomLTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomLTPre.major &&\n            c.semver.minor === needDomLTPre.minor &&\n            c.semver.patch === needDomLTPre.patch) {\n          needDomLTPre = false\n        }\n      }\n      if (c.operator === '<' || c.operator === '<=') {\n        lower = lowerLT(lt, c, options)\n        if (lower === c && lower !== lt) {\n          return false\n        }\n      } else if (lt.operator === '<=' && !satisfies(lt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (!c.operator && (lt || gt) && gtltComp !== 0) {\n      return false\n    }\n  }\n\n  // if there was a < or >, and nothing in the dom, then must be false\n  // UNLESS it was limited by another range in the other direction.\n  // Eg, >1.0.0 <1.0.1 is still a subset of <2.0.0\n  if (gt && hasDomLT && !lt && gtltComp !== 0) {\n    return false\n  }\n\n  if (lt && hasDomGT && !gt && gtltComp !== 0) {\n    return false\n  }\n\n  // we needed a prerelease range in a specific tuple, but didn't get one\n  // then this isn't a subset.  eg >=1.2.3-pre is not a subset of >=1.0.0,\n  // because it includes prereleases in the 1.2.3 tuple\n  if (needDomGTPre || needDomLTPre) {\n    return false\n  }\n\n  return true\n}\n\n// >=1.2.3 is lower than >1.2.3\nconst higherGT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp > 0 ? a\n    : comp < 0 ? b\n    : b.operator === '>' && a.operator === '>=' ? b\n    : a\n}\n\n// <=1.2.3 is higher than <1.2.3\nconst lowerLT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp < 0 ? a\n    : comp > 0 ? b\n    : b.operator === '<' && a.operator === '<=' ? b\n    : a\n}\n\nmodule.exports = subset\n", "'use strict'\n\n// just pre-load all the stuff that index.js lazily exports\nconst internalRe = require('./internal/re')\nconst constants = require('./internal/constants')\nconst SemVer = require('./classes/semver')\nconst identifiers = require('./internal/identifiers')\nconst parse = require('./functions/parse')\nconst valid = require('./functions/valid')\nconst clean = require('./functions/clean')\nconst inc = require('./functions/inc')\nconst diff = require('./functions/diff')\nconst major = require('./functions/major')\nconst minor = require('./functions/minor')\nconst patch = require('./functions/patch')\nconst prerelease = require('./functions/prerelease')\nconst compare = require('./functions/compare')\nconst rcompare = require('./functions/rcompare')\nconst compareLoose = require('./functions/compare-loose')\nconst compareBuild = require('./functions/compare-build')\nconst sort = require('./functions/sort')\nconst rsort = require('./functions/rsort')\nconst gt = require('./functions/gt')\nconst lt = require('./functions/lt')\nconst eq = require('./functions/eq')\nconst neq = require('./functions/neq')\nconst gte = require('./functions/gte')\nconst lte = require('./functions/lte')\nconst cmp = require('./functions/cmp')\nconst coerce = require('./functions/coerce')\nconst Comparator = require('./classes/comparator')\nconst Range = require('./classes/range')\nconst satisfies = require('./functions/satisfies')\nconst toComparators = require('./ranges/to-comparators')\nconst maxSatisfying = require('./ranges/max-satisfying')\nconst minSatisfying = require('./ranges/min-satisfying')\nconst minVersion = require('./ranges/min-version')\nconst validRange = require('./ranges/valid')\nconst outside = require('./ranges/outside')\nconst gtr = require('./ranges/gtr')\nconst ltr = require('./ranges/ltr')\nconst intersects = require('./ranges/intersects')\nconst simplifyRange = require('./ranges/simplify')\nconst subset = require('./ranges/subset')\nmodule.exports = {\n  parse,\n  valid,\n  clean,\n  inc,\n  diff,\n  major,\n  minor,\n  patch,\n  prerelease,\n  compare,\n  rcompare,\n  compareLoose,\n  compareBuild,\n  sort,\n  rsort,\n  gt,\n  lt,\n  eq,\n  neq,\n  gte,\n  lte,\n  cmp,\n  coerce,\n  Comparator,\n  Range,\n  satisfies,\n  toComparators,\n  maxSatisfying,\n  minSatisfying,\n  minVersion,\n  validRange,\n  outside,\n  gtr,\n  ltr,\n  intersects,\n  simplifyRange,\n  subset,\n  SemVer,\n  re: internalRe.re,\n  src: internalRe.src,\n  tokens: internalRe.t,\n  SEMVER_SPEC_VERSION: constants.SEMVER_SPEC_VERSION,\n  RELEASE_TYPES: constants.RELEASE_TYPES,\n  compareIdentifiers: identifiers.compareIdentifiers,\n  rcompareIdentifiers: identifiers.rcompareIdentifiers,\n}\n", "/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n", "'use strict';\n\n/** @type {import('./type')} */\nmodule.exports = TypeError;\n", "var hasMap = typeof Map === 'function' && Map.prototype;\nvar mapSizeDescriptor = Object.getOwnPropertyDescriptor && hasMap ? Object.getOwnPropertyDescriptor(Map.prototype, 'size') : null;\nvar mapSize = hasMap && mapSizeDescriptor && typeof mapSizeDescriptor.get === 'function' ? mapSizeDescriptor.get : null;\nvar mapForEach = hasMap && Map.prototype.forEach;\nvar hasSet = typeof Set === 'function' && Set.prototype;\nvar setSizeDescriptor = Object.getOwnPropertyDescriptor && hasSet ? Object.getOwnPropertyDescriptor(Set.prototype, 'size') : null;\nvar setSize = hasSet && setSizeDescriptor && typeof setSizeDescriptor.get === 'function' ? setSizeDescriptor.get : null;\nvar setForEach = hasSet && Set.prototype.forEach;\nvar hasWeakMap = typeof WeakMap === 'function' && WeakMap.prototype;\nvar weakMapHas = hasWeakMap ? WeakMap.prototype.has : null;\nvar hasWeakSet = typeof WeakSet === 'function' && WeakSet.prototype;\nvar weakSetHas = hasWeakSet ? WeakSet.prototype.has : null;\nvar hasWeakRef = typeof WeakRef === 'function' && WeakRef.prototype;\nvar weakRefDeref = hasWeakRef ? WeakRef.prototype.deref : null;\nvar booleanValueOf = Boolean.prototype.valueOf;\nvar objectToString = Object.prototype.toString;\nvar functionToString = Function.prototype.toString;\nvar $match = String.prototype.match;\nvar $slice = String.prototype.slice;\nvar $replace = String.prototype.replace;\nvar $toUpperCase = String.prototype.toUpperCase;\nvar $toLowerCase = String.prototype.toLowerCase;\nvar $test = RegExp.prototype.test;\nvar $concat = Array.prototype.concat;\nvar $join = Array.prototype.join;\nvar $arrSlice = Array.prototype.slice;\nvar $floor = Math.floor;\nvar bigIntValueOf = typeof BigInt === 'function' ? BigInt.prototype.valueOf : null;\nvar gOPS = Object.getOwnPropertySymbols;\nvar symToString = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? Symbol.prototype.toString : null;\nvar hasShammedSymbols = typeof Symbol === 'function' && typeof Symbol.iterator === 'object';\n// ie, `has-tostringtag/shams\nvar toStringTag = typeof Symbol === 'function' && Symbol.toStringTag && (typeof Symbol.toStringTag === hasShammedSymbols ? 'object' : 'symbol')\n    ? Symbol.toStringTag\n    : null;\nvar isEnumerable = Object.prototype.propertyIsEnumerable;\n\nvar gPO = (typeof Reflect === 'function' ? Reflect.getPrototypeOf : Object.getPrototypeOf) || (\n    [].__proto__ === Array.prototype // eslint-disable-line no-proto\n        ? function (O) {\n            return O.__proto__; // eslint-disable-line no-proto\n        }\n        : null\n);\n\nfunction addNumericSeparator(num, str) {\n    if (\n        num === Infinity\n        || num === -Infinity\n        || num !== num\n        || (num && num > -1000 && num < 1000)\n        || $test.call(/e/, str)\n    ) {\n        return str;\n    }\n    var sepRegex = /[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;\n    if (typeof num === 'number') {\n        var int = num < 0 ? -$floor(-num) : $floor(num); // trunc(num)\n        if (int !== num) {\n            var intStr = String(int);\n            var dec = $slice.call(str, intStr.length + 1);\n            return $replace.call(intStr, sepRegex, '$&_') + '.' + $replace.call($replace.call(dec, /([0-9]{3})/g, '$&_'), /_$/, '');\n        }\n    }\n    return $replace.call(str, sepRegex, '$&_');\n}\n\nvar utilInspect = require('./util.inspect');\nvar inspectCustom = utilInspect.custom;\nvar inspectSymbol = isSymbol(inspectCustom) ? inspectCustom : null;\n\nvar quotes = {\n    __proto__: null,\n    'double': '\"',\n    single: \"'\"\n};\nvar quoteREs = {\n    __proto__: null,\n    'double': /([\"\\\\])/g,\n    single: /(['\\\\])/g\n};\n\nmodule.exports = function inspect_(obj, options, depth, seen) {\n    var opts = options || {};\n\n    if (has(opts, 'quoteStyle') && !has(quotes, opts.quoteStyle)) {\n        throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');\n    }\n    if (\n        has(opts, 'maxStringLength') && (typeof opts.maxStringLength === 'number'\n            ? opts.maxStringLength < 0 && opts.maxStringLength !== Infinity\n            : opts.maxStringLength !== null\n        )\n    ) {\n        throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');\n    }\n    var customInspect = has(opts, 'customInspect') ? opts.customInspect : true;\n    if (typeof customInspect !== 'boolean' && customInspect !== 'symbol') {\n        throw new TypeError('option \"customInspect\", if provided, must be `true`, `false`, or `\\'symbol\\'`');\n    }\n\n    if (\n        has(opts, 'indent')\n        && opts.indent !== null\n        && opts.indent !== '\\t'\n        && !(parseInt(opts.indent, 10) === opts.indent && opts.indent > 0)\n    ) {\n        throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');\n    }\n    if (has(opts, 'numericSeparator') && typeof opts.numericSeparator !== 'boolean') {\n        throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');\n    }\n    var numericSeparator = opts.numericSeparator;\n\n    if (typeof obj === 'undefined') {\n        return 'undefined';\n    }\n    if (obj === null) {\n        return 'null';\n    }\n    if (typeof obj === 'boolean') {\n        return obj ? 'true' : 'false';\n    }\n\n    if (typeof obj === 'string') {\n        return inspectString(obj, opts);\n    }\n    if (typeof obj === 'number') {\n        if (obj === 0) {\n            return Infinity / obj > 0 ? '0' : '-0';\n        }\n        var str = String(obj);\n        return numericSeparator ? addNumericSeparator(obj, str) : str;\n    }\n    if (typeof obj === 'bigint') {\n        var bigIntStr = String(obj) + 'n';\n        return numericSeparator ? addNumericSeparator(obj, bigIntStr) : bigIntStr;\n    }\n\n    var maxDepth = typeof opts.depth === 'undefined' ? 5 : opts.depth;\n    if (typeof depth === 'undefined') { depth = 0; }\n    if (depth >= maxDepth && maxDepth > 0 && typeof obj === 'object') {\n        return isArray(obj) ? '[Array]' : '[Object]';\n    }\n\n    var indent = getIndent(opts, depth);\n\n    if (typeof seen === 'undefined') {\n        seen = [];\n    } else if (indexOf(seen, obj) >= 0) {\n        return '[Circular]';\n    }\n\n    function inspect(value, from, noIndent) {\n        if (from) {\n            seen = $arrSlice.call(seen);\n            seen.push(from);\n        }\n        if (noIndent) {\n            var newOpts = {\n                depth: opts.depth\n            };\n            if (has(opts, 'quoteStyle')) {\n                newOpts.quoteStyle = opts.quoteStyle;\n            }\n            return inspect_(value, newOpts, depth + 1, seen);\n        }\n        return inspect_(value, opts, depth + 1, seen);\n    }\n\n    if (typeof obj === 'function' && !isRegExp(obj)) { // in older engines, regexes are callable\n        var name = nameOf(obj);\n        var keys = arrObjKeys(obj, inspect);\n        return '[Function' + (name ? ': ' + name : ' (anonymous)') + ']' + (keys.length > 0 ? ' { ' + $join.call(keys, ', ') + ' }' : '');\n    }\n    if (isSymbol(obj)) {\n        var symString = hasShammedSymbols ? $replace.call(String(obj), /^(Symbol\\(.*\\))_[^)]*$/, '$1') : symToString.call(obj);\n        return typeof obj === 'object' && !hasShammedSymbols ? markBoxed(symString) : symString;\n    }\n    if (isElement(obj)) {\n        var s = '<' + $toLowerCase.call(String(obj.nodeName));\n        var attrs = obj.attributes || [];\n        for (var i = 0; i < attrs.length; i++) {\n            s += ' ' + attrs[i].name + '=' + wrapQuotes(quote(attrs[i].value), 'double', opts);\n        }\n        s += '>';\n        if (obj.childNodes && obj.childNodes.length) { s += '...'; }\n        s += '</' + $toLowerCase.call(String(obj.nodeName)) + '>';\n        return s;\n    }\n    if (isArray(obj)) {\n        if (obj.length === 0) { return '[]'; }\n        var xs = arrObjKeys(obj, inspect);\n        if (indent && !singleLineValues(xs)) {\n            return '[' + indentedJoin(xs, indent) + ']';\n        }\n        return '[ ' + $join.call(xs, ', ') + ' ]';\n    }\n    if (isError(obj)) {\n        var parts = arrObjKeys(obj, inspect);\n        if (!('cause' in Error.prototype) && 'cause' in obj && !isEnumerable.call(obj, 'cause')) {\n            return '{ [' + String(obj) + '] ' + $join.call($concat.call('[cause]: ' + inspect(obj.cause), parts), ', ') + ' }';\n        }\n        if (parts.length === 0) { return '[' + String(obj) + ']'; }\n        return '{ [' + String(obj) + '] ' + $join.call(parts, ', ') + ' }';\n    }\n    if (typeof obj === 'object' && customInspect) {\n        if (inspectSymbol && typeof obj[inspectSymbol] === 'function' && utilInspect) {\n            return utilInspect(obj, { depth: maxDepth - depth });\n        } else if (customInspect !== 'symbol' && typeof obj.inspect === 'function') {\n            return obj.inspect();\n        }\n    }\n    if (isMap(obj)) {\n        var mapParts = [];\n        if (mapForEach) {\n            mapForEach.call(obj, function (value, key) {\n                mapParts.push(inspect(key, obj, true) + ' => ' + inspect(value, obj));\n            });\n        }\n        return collectionOf('Map', mapSize.call(obj), mapParts, indent);\n    }\n    if (isSet(obj)) {\n        var setParts = [];\n        if (setForEach) {\n            setForEach.call(obj, function (value) {\n                setParts.push(inspect(value, obj));\n            });\n        }\n        return collectionOf('Set', setSize.call(obj), setParts, indent);\n    }\n    if (isWeakMap(obj)) {\n        return weakCollectionOf('WeakMap');\n    }\n    if (isWeakSet(obj)) {\n        return weakCollectionOf('WeakSet');\n    }\n    if (isWeakRef(obj)) {\n        return weakCollectionOf('WeakRef');\n    }\n    if (isNumber(obj)) {\n        return markBoxed(inspect(Number(obj)));\n    }\n    if (isBigInt(obj)) {\n        return markBoxed(inspect(bigIntValueOf.call(obj)));\n    }\n    if (isBoolean(obj)) {\n        return markBoxed(booleanValueOf.call(obj));\n    }\n    if (isString(obj)) {\n        return markBoxed(inspect(String(obj)));\n    }\n    // note: in IE 8, sometimes `global !== window` but both are the prototypes of each other\n    /* eslint-env browser */\n    if (typeof window !== 'undefined' && obj === window) {\n        return '{ [object Window] }';\n    }\n    if (\n        (typeof globalThis !== 'undefined' && obj === globalThis)\n        || (typeof global !== 'undefined' && obj === global)\n    ) {\n        return '{ [object globalThis] }';\n    }\n    if (!isDate(obj) && !isRegExp(obj)) {\n        var ys = arrObjKeys(obj, inspect);\n        var isPlainObject = gPO ? gPO(obj) === Object.prototype : obj instanceof Object || obj.constructor === Object;\n        var protoTag = obj instanceof Object ? '' : 'null prototype';\n        var stringTag = !isPlainObject && toStringTag && Object(obj) === obj && toStringTag in obj ? $slice.call(toStr(obj), 8, -1) : protoTag ? 'Object' : '';\n        var constructorTag = isPlainObject || typeof obj.constructor !== 'function' ? '' : obj.constructor.name ? obj.constructor.name + ' ' : '';\n        var tag = constructorTag + (stringTag || protoTag ? '[' + $join.call($concat.call([], stringTag || [], protoTag || []), ': ') + '] ' : '');\n        if (ys.length === 0) { return tag + '{}'; }\n        if (indent) {\n            return tag + '{' + indentedJoin(ys, indent) + '}';\n        }\n        return tag + '{ ' + $join.call(ys, ', ') + ' }';\n    }\n    return String(obj);\n};\n\nfunction wrapQuotes(s, defaultStyle, opts) {\n    var style = opts.quoteStyle || defaultStyle;\n    var quoteChar = quotes[style];\n    return quoteChar + s + quoteChar;\n}\n\nfunction quote(s) {\n    return $replace.call(String(s), /\"/g, '&quot;');\n}\n\nfunction canTrustToString(obj) {\n    return !toStringTag || !(typeof obj === 'object' && (toStringTag in obj || typeof obj[toStringTag] !== 'undefined'));\n}\nfunction isArray(obj) { return toStr(obj) === '[object Array]' && canTrustToString(obj); }\nfunction isDate(obj) { return toStr(obj) === '[object Date]' && canTrustToString(obj); }\nfunction isRegExp(obj) { return toStr(obj) === '[object RegExp]' && canTrustToString(obj); }\nfunction isError(obj) { return toStr(obj) === '[object Error]' && canTrustToString(obj); }\nfunction isString(obj) { return toStr(obj) === '[object String]' && canTrustToString(obj); }\nfunction isNumber(obj) { return toStr(obj) === '[object Number]' && canTrustToString(obj); }\nfunction isBoolean(obj) { return toStr(obj) === '[object Boolean]' && canTrustToString(obj); }\n\n// Symbol and BigInt do have Symbol.toStringTag by spec, so that can't be used to eliminate false positives\nfunction isSymbol(obj) {\n    if (hasShammedSymbols) {\n        return obj && typeof obj === 'object' && obj instanceof Symbol;\n    }\n    if (typeof obj === 'symbol') {\n        return true;\n    }\n    if (!obj || typeof obj !== 'object' || !symToString) {\n        return false;\n    }\n    try {\n        symToString.call(obj);\n        return true;\n    } catch (e) {}\n    return false;\n}\n\nfunction isBigInt(obj) {\n    if (!obj || typeof obj !== 'object' || !bigIntValueOf) {\n        return false;\n    }\n    try {\n        bigIntValueOf.call(obj);\n        return true;\n    } catch (e) {}\n    return false;\n}\n\nvar hasOwn = Object.prototype.hasOwnProperty || function (key) { return key in this; };\nfunction has(obj, key) {\n    return hasOwn.call(obj, key);\n}\n\nfunction toStr(obj) {\n    return objectToString.call(obj);\n}\n\nfunction nameOf(f) {\n    if (f.name) { return f.name; }\n    var m = $match.call(functionToString.call(f), /^function\\s*([\\w$]+)/);\n    if (m) { return m[1]; }\n    return null;\n}\n\nfunction indexOf(xs, x) {\n    if (xs.indexOf) { return xs.indexOf(x); }\n    for (var i = 0, l = xs.length; i < l; i++) {\n        if (xs[i] === x) { return i; }\n    }\n    return -1;\n}\n\nfunction isMap(x) {\n    if (!mapSize || !x || typeof x !== 'object') {\n        return false;\n    }\n    try {\n        mapSize.call(x);\n        try {\n            setSize.call(x);\n        } catch (s) {\n            return true;\n        }\n        return x instanceof Map; // core-js workaround, pre-v2.5.0\n    } catch (e) {}\n    return false;\n}\n\nfunction isWeakMap(x) {\n    if (!weakMapHas || !x || typeof x !== 'object') {\n        return false;\n    }\n    try {\n        weakMapHas.call(x, weakMapHas);\n        try {\n            weakSetHas.call(x, weakSetHas);\n        } catch (s) {\n            return true;\n        }\n        return x instanceof WeakMap; // core-js workaround, pre-v2.5.0\n    } catch (e) {}\n    return false;\n}\n\nfunction isWeakRef(x) {\n    if (!weakRefDeref || !x || typeof x !== 'object') {\n        return false;\n    }\n    try {\n        weakRefDeref.call(x);\n        return true;\n    } catch (e) {}\n    return false;\n}\n\nfunction isSet(x) {\n    if (!setSize || !x || typeof x !== 'object') {\n        return false;\n    }\n    try {\n        setSize.call(x);\n        try {\n            mapSize.call(x);\n        } catch (m) {\n            return true;\n        }\n        return x instanceof Set; // core-js workaround, pre-v2.5.0\n    } catch (e) {}\n    return false;\n}\n\nfunction isWeakSet(x) {\n    if (!weakSetHas || !x || typeof x !== 'object') {\n        return false;\n    }\n    try {\n        weakSetHas.call(x, weakSetHas);\n        try {\n            weakMapHas.call(x, weakMapHas);\n        } catch (s) {\n            return true;\n        }\n        return x instanceof WeakSet; // core-js workaround, pre-v2.5.0\n    } catch (e) {}\n    return false;\n}\n\nfunction isElement(x) {\n    if (!x || typeof x !== 'object') { return false; }\n    if (typeof HTMLElement !== 'undefined' && x instanceof HTMLElement) {\n        return true;\n    }\n    return typeof x.nodeName === 'string' && typeof x.getAttribute === 'function';\n}\n\nfunction inspectString(str, opts) {\n    if (str.length > opts.maxStringLength) {\n        var remaining = str.length - opts.maxStringLength;\n        var trailer = '... ' + remaining + ' more character' + (remaining > 1 ? 's' : '');\n        return inspectString($slice.call(str, 0, opts.maxStringLength), opts) + trailer;\n    }\n    var quoteRE = quoteREs[opts.quoteStyle || 'single'];\n    quoteRE.lastIndex = 0;\n    // eslint-disable-next-line no-control-regex\n    var s = $replace.call($replace.call(str, quoteRE, '\\\\$1'), /[\\x00-\\x1f]/g, lowbyte);\n    return wrapQuotes(s, 'single', opts);\n}\n\nfunction lowbyte(c) {\n    var n = c.charCodeAt(0);\n    var x = {\n        8: 'b',\n        9: 't',\n        10: 'n',\n        12: 'f',\n        13: 'r'\n    }[n];\n    if (x) { return '\\\\' + x; }\n    return '\\\\x' + (n < 0x10 ? '0' : '') + $toUpperCase.call(n.toString(16));\n}\n\nfunction markBoxed(str) {\n    return 'Object(' + str + ')';\n}\n\nfunction weakCollectionOf(type) {\n    return type + ' { ? }';\n}\n\nfunction collectionOf(type, size, entries, indent) {\n    var joinedEntries = indent ? indentedJoin(entries, indent) : $join.call(entries, ', ');\n    return type + ' (' + size + ') {' + joinedEntries + '}';\n}\n\nfunction singleLineValues(xs) {\n    for (var i = 0; i < xs.length; i++) {\n        if (indexOf(xs[i], '\\n') >= 0) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction getIndent(opts, depth) {\n    var baseIndent;\n    if (opts.indent === '\\t') {\n        baseIndent = '\\t';\n    } else if (typeof opts.indent === 'number' && opts.indent > 0) {\n        baseIndent = $join.call(Array(opts.indent + 1), ' ');\n    } else {\n        return null;\n    }\n    return {\n        base: baseIndent,\n        prev: $join.call(Array(depth + 1), baseIndent)\n    };\n}\n\nfunction indentedJoin(xs, indent) {\n    if (xs.length === 0) { return ''; }\n    var lineJoiner = '\\n' + indent.prev + indent.base;\n    return lineJoiner + $join.call(xs, ',' + lineJoiner) + '\\n' + indent.prev;\n}\n\nfunction arrObjKeys(obj, inspect) {\n    var isArr = isArray(obj);\n    var xs = [];\n    if (isArr) {\n        xs.length = obj.length;\n        for (var i = 0; i < obj.length; i++) {\n            xs[i] = has(obj, i) ? inspect(obj[i], obj) : '';\n        }\n    }\n    var syms = typeof gOPS === 'function' ? gOPS(obj) : [];\n    var symMap;\n    if (hasShammedSymbols) {\n        symMap = {};\n        for (var k = 0; k < syms.length; k++) {\n            symMap['$' + syms[k]] = syms[k];\n        }\n    }\n\n    for (var key in obj) { // eslint-disable-line no-restricted-syntax\n        if (!has(obj, key)) { continue; } // eslint-disable-line no-restricted-syntax, no-continue\n        if (isArr && String(Number(key)) === key && key < obj.length) { continue; } // eslint-disable-line no-restricted-syntax, no-continue\n        if (hasShammedSymbols && symMap['$' + key] instanceof Symbol) {\n            // this is to prevent shammed Symbols, which are stored as strings, from being included in the string key section\n            continue; // eslint-disable-line no-restricted-syntax, no-continue\n        } else if ($test.call(/[^\\w$]/, key)) {\n            xs.push(inspect(key, obj) + ': ' + inspect(obj[key], obj));\n        } else {\n            xs.push(key + ': ' + inspect(obj[key], obj));\n        }\n    }\n    if (typeof gOPS === 'function') {\n        for (var j = 0; j < syms.length; j++) {\n            if (isEnumerable.call(obj, syms[j])) {\n                xs.push('[' + inspect(syms[j]) + ']: ' + inspect(obj[syms[j]], obj));\n            }\n        }\n    }\n    return xs;\n}\n", "'use strict';\n\nvar inspect = require('object-inspect');\n\nvar $TypeError = require('es-errors/type');\n\n/*\n* This function traverses the list returning the node corresponding to the given key.\n*\n* That node is also moved to the head of the list, so that if it's accessed again we don't need to traverse the whole list.\n* By doing so, all the recently used nodes can be accessed relatively quickly.\n*/\n/** @type {import('./list.d.ts').listGetNode} */\n// eslint-disable-next-line consistent-return\nvar listGetNode = function (list, key, isDelete) {\n\t/** @type {typeof list | NonNullable<(typeof list)['next']>} */\n\tvar prev = list;\n\t/** @type {(typeof list)['next']} */\n\tvar curr;\n\t// eslint-disable-next-line eqeqeq\n\tfor (; (curr = prev.next) != null; prev = curr) {\n\t\tif (curr.key === key) {\n\t\t\tprev.next = curr.next;\n\t\t\tif (!isDelete) {\n\t\t\t\t// eslint-disable-next-line no-extra-parens\n\t\t\t\tcurr.next = /** @type {NonNullable<typeof list.next>} */ (list.next);\n\t\t\t\tlist.next = curr; // eslint-disable-line no-param-reassign\n\t\t\t}\n\t\t\treturn curr;\n\t\t}\n\t}\n};\n\n/** @type {import('./list.d.ts').listGet} */\nvar listGet = function (objects, key) {\n\tif (!objects) {\n\t\treturn void undefined;\n\t}\n\tvar node = listGetNode(objects, key);\n\treturn node && node.value;\n};\n/** @type {import('./list.d.ts').listSet} */\nvar listSet = function (objects, key, value) {\n\tvar node = listGetNode(objects, key);\n\tif (node) {\n\t\tnode.value = value;\n\t} else {\n\t\t// Prepend the new node to the beginning of the list\n\t\tobjects.next = /** @type {import('./list.d.ts').ListNode<typeof value, typeof key>} */ ({ // eslint-disable-line no-param-reassign, no-extra-parens\n\t\t\tkey: key,\n\t\t\tnext: objects.next,\n\t\t\tvalue: value\n\t\t});\n\t}\n};\n/** @type {import('./list.d.ts').listHas} */\nvar listHas = function (objects, key) {\n\tif (!objects) {\n\t\treturn false;\n\t}\n\treturn !!listGetNode(objects, key);\n};\n/** @type {import('./list.d.ts').listDelete} */\n// eslint-disable-next-line consistent-return\nvar listDelete = function (objects, key) {\n\tif (objects) {\n\t\treturn listGetNode(objects, key, true);\n\t}\n};\n\n/** @type {import('.')} */\nmodule.exports = function getSideChannelList() {\n\t/** @typedef {ReturnType<typeof getSideChannelList>} Channel */\n\t/** @typedef {Parameters<Channel['get']>[0]} K */\n\t/** @typedef {Parameters<Channel['set']>[1]} V */\n\n\t/** @type {import('./list.d.ts').RootNode<V, K> | undefined} */ var $o;\n\n\t/** @type {Channel} */\n\tvar channel = {\n\t\tassert: function (key) {\n\t\t\tif (!channel.has(key)) {\n\t\t\t\tthrow new $TypeError('Side channel does not contain ' + inspect(key));\n\t\t\t}\n\t\t},\n\t\t'delete': function (key) {\n\t\t\tvar root = $o && $o.next;\n\t\t\tvar deletedNode = listDelete($o, key);\n\t\t\tif (deletedNode && root && root === deletedNode) {\n\t\t\t\t$o = void undefined;\n\t\t\t}\n\t\t\treturn !!deletedNode;\n\t\t},\n\t\tget: function (key) {\n\t\t\treturn listGet($o, key);\n\t\t},\n\t\thas: function (key) {\n\t\t\treturn listHas($o, key);\n\t\t},\n\t\tset: function (key, value) {\n\t\t\tif (!$o) {\n\t\t\t\t// Initialize the linked list as an empty node, so that we don't have to special-case handling of the first node: we can always refer to it as (previous node).next, instead of something like (list).head\n\t\t\t\t$o = {\n\t\t\t\t\tnext: void undefined\n\t\t\t\t};\n\t\t\t}\n\t\t\t// eslint-disable-next-line no-extra-parens\n\t\t\tlistSet(/** @type {NonNullable<typeof $o>} */ ($o), key, value);\n\t\t}\n\t};\n\t// @ts-expect-error TODO: figure out why this is erroring\n\treturn channel;\n};\n", "'use strict';\n\n/** @type {import('.')} */\nmodule.exports = Object;\n", "'use strict';\n\n/** @type {import('.')} */\nmodule.exports = Error;\n", "'use strict';\n\n/** @type {import('./eval')} */\nmodule.exports = EvalError;\n", "'use strict';\n\n/** @type {import('./range')} */\nmodule.exports = RangeError;\n", "'use strict';\n\n/** @type {import('./ref')} */\nmodule.exports = ReferenceError;\n", "'use strict';\n\n/** @type {import('./syntax')} */\nmodule.exports = SyntaxError;\n", "'use strict';\n\n/** @type {import('./uri')} */\nmodule.exports = URIError;\n", "'use strict';\n\n/** @type {import('./abs')} */\nmodule.exports = Math.abs;\n", "'use strict';\n\n/** @type {import('./floor')} */\nmodule.exports = Math.floor;\n", "'use strict';\n\n/** @type {import('./max')} */\nmodule.exports = Math.max;\n", "'use strict';\n\n/** @type {import('./min')} */\nmodule.exports = Math.min;\n", "'use strict';\n\n/** @type {import('./pow')} */\nmodule.exports = Math.pow;\n", "'use strict';\n\n/** @type {import('./round')} */\nmodule.exports = Math.round;\n", "'use strict';\n\n/** @type {import('./isNaN')} */\nmodule.exports = Number.isNaN || function isNaN(a) {\n\treturn a !== a;\n};\n", "'use strict';\n\nvar $isNaN = require('./isNaN');\n\n/** @type {import('./sign')} */\nmodule.exports = function sign(number) {\n\tif ($isNaN(number) || number === 0) {\n\t\treturn number;\n\t}\n\treturn number < 0 ? -1 : +1;\n};\n", "'use strict';\n\n/** @type {import('./gOPD')} */\nmodule.exports = Object.getOwnPropertyDescriptor;\n", "'use strict';\n\n/** @type {import('.')} */\nvar $gOPD = require('./gOPD');\n\nif ($gOPD) {\n\ttry {\n\t\t$gOPD([], 'length');\n\t} catch (e) {\n\t\t// IE 8 has a broken gOPD\n\t\t$gOPD = null;\n\t}\n}\n\nmodule.exports = $gOPD;\n", "'use strict';\n\n/** @type {import('.')} */\nvar $defineProperty = Object.defineProperty || false;\nif ($defineProperty) {\n\ttry {\n\t\t$defineProperty({}, 'a', { value: 1 });\n\t} catch (e) {\n\t\t// IE 8 has a broken defineProperty\n\t\t$defineProperty = false;\n\t}\n}\n\nmodule.exports = $defineProperty;\n", "'use strict';\n\n/** @type {import('./shams')} */\n/* eslint complexity: [2, 18], max-statements: [2, 33] */\nmodule.exports = function hasSymbols() {\n\tif (typeof Symbol !== 'function' || typeof Object.getOwnPropertySymbols !== 'function') { return false; }\n\tif (typeof Symbol.iterator === 'symbol') { return true; }\n\n\t/** @type {{ [k in symbol]?: unknown }} */\n\tvar obj = {};\n\tvar sym = Symbol('test');\n\tvar symObj = Object(sym);\n\tif (typeof sym === 'string') { return false; }\n\n\tif (Object.prototype.toString.call(sym) !== '[object Symbol]') { return false; }\n\tif (Object.prototype.toString.call(symObj) !== '[object Symbol]') { return false; }\n\n\t// temp disabled per https://github.com/ljharb/object.assign/issues/17\n\t// if (sym instanceof Symbol) { return false; }\n\t// temp disabled per https://github.com/WebReflection/get-own-property-symbols/issues/4\n\t// if (!(symObj instanceof Symbol)) { return false; }\n\n\t// if (typeof Symbol.prototype.toString !== 'function') { return false; }\n\t// if (String(sym) !== Symbol.prototype.toString.call(sym)) { return false; }\n\n\tvar symVal = 42;\n\tobj[sym] = symVal;\n\tfor (var _ in obj) { return false; } // eslint-disable-line no-restricted-syntax, no-unreachable-loop\n\tif (typeof Object.keys === 'function' && Object.keys(obj).length !== 0) { return false; }\n\n\tif (typeof Object.getOwnPropertyNames === 'function' && Object.getOwnPropertyNames(obj).length !== 0) { return false; }\n\n\tvar syms = Object.getOwnPropertySymbols(obj);\n\tif (syms.length !== 1 || syms[0] !== sym) { return false; }\n\n\tif (!Object.prototype.propertyIsEnumerable.call(obj, sym)) { return false; }\n\n\tif (typeof Object.getOwnPropertyDescriptor === 'function') {\n\t\t// eslint-disable-next-line no-extra-parens\n\t\tvar descriptor = /** @type {PropertyDescriptor} */ (Object.getOwnPropertyDescriptor(obj, sym));\n\t\tif (descriptor.value !== symVal || descriptor.enumerable !== true) { return false; }\n\t}\n\n\treturn true;\n};\n", "'use strict';\n\nvar origSymbol = typeof Symbol !== 'undefined' && Symbol;\nvar hasSymbolSham = require('./shams');\n\n/** @type {import('.')} */\nmodule.exports = function hasNativeSymbols() {\n\tif (typeof origSymbol !== 'function') { return false; }\n\tif (typeof Symbol !== 'function') { return false; }\n\tif (typeof origSymbol('foo') !== 'symbol') { return false; }\n\tif (typeof Symbol('bar') !== 'symbol') { return false; }\n\n\treturn hasSymbolSham();\n};\n", "'use strict';\n\n/** @type {import('./Reflect.getPrototypeOf')} */\nmodule.exports = (typeof Reflect !== 'undefined' && Reflect.getPrototypeOf) || null;\n", "'use strict';\n\nvar $Object = require('es-object-atoms');\n\n/** @type {import('./Object.getPrototypeOf')} */\nmodule.exports = $Object.getPrototypeOf || null;\n", "'use strict';\n\n/* eslint no-invalid-this: 1 */\n\nvar ERROR_MESSAGE = 'Function.prototype.bind called on incompatible ';\nvar toStr = Object.prototype.toString;\nvar max = Math.max;\nvar funcType = '[object Function]';\n\nvar concatty = function concatty(a, b) {\n    var arr = [];\n\n    for (var i = 0; i < a.length; i += 1) {\n        arr[i] = a[i];\n    }\n    for (var j = 0; j < b.length; j += 1) {\n        arr[j + a.length] = b[j];\n    }\n\n    return arr;\n};\n\nvar slicy = function slicy(arrLike, offset) {\n    var arr = [];\n    for (var i = offset || 0, j = 0; i < arrLike.length; i += 1, j += 1) {\n        arr[j] = arrLike[i];\n    }\n    return arr;\n};\n\nvar joiny = function (arr, joiner) {\n    var str = '';\n    for (var i = 0; i < arr.length; i += 1) {\n        str += arr[i];\n        if (i + 1 < arr.length) {\n            str += joiner;\n        }\n    }\n    return str;\n};\n\nmodule.exports = function bind(that) {\n    var target = this;\n    if (typeof target !== 'function' || toStr.apply(target) !== funcType) {\n        throw new TypeError(ERROR_MESSAGE + target);\n    }\n    var args = slicy(arguments, 1);\n\n    var bound;\n    var binder = function () {\n        if (this instanceof bound) {\n            var result = target.apply(\n                this,\n                concatty(args, arguments)\n            );\n            if (Object(result) === result) {\n                return result;\n            }\n            return this;\n        }\n        return target.apply(\n            that,\n            concatty(args, arguments)\n        );\n\n    };\n\n    var boundLength = max(0, target.length - args.length);\n    var boundArgs = [];\n    for (var i = 0; i < boundLength; i++) {\n        boundArgs[i] = '$' + i;\n    }\n\n    bound = Function('binder', 'return function (' + joiny(boundArgs, ',') + '){ return binder.apply(this,arguments); }')(binder);\n\n    if (target.prototype) {\n        var Empty = function Empty() {};\n        Empty.prototype = target.prototype;\n        bound.prototype = new Empty();\n        Empty.prototype = null;\n    }\n\n    return bound;\n};\n", "'use strict';\n\nvar implementation = require('./implementation');\n\nmodule.exports = Function.prototype.bind || implementation;\n", "'use strict';\n\n/** @type {import('./functionCall')} */\nmodule.exports = Function.prototype.call;\n", "'use strict';\n\n/** @type {import('./functionApply')} */\nmodule.exports = Function.prototype.apply;\n", "'use strict';\n\n/** @type {import('./reflectApply')} */\nmodule.exports = typeof Reflect !== 'undefined' && Reflect && Reflect.apply;\n", "'use strict';\n\nvar bind = require('function-bind');\n\nvar $apply = require('./functionApply');\nvar $call = require('./functionCall');\nvar $reflectApply = require('./reflectApply');\n\n/** @type {import('./actualApply')} */\nmodule.exports = $reflectApply || bind.call($call, $apply);\n", "'use strict';\n\nvar bind = require('function-bind');\nvar $TypeError = require('es-errors/type');\n\nvar $call = require('./functionCall');\nvar $actualApply = require('./actualApply');\n\n/** @type {(args: [Function, thisArg?: unknown, ...args: unknown[]]) => Function} TODO FIXME, find a way to use import('.') */\nmodule.exports = function callBindBasic(args) {\n\tif (args.length < 1 || typeof args[0] !== 'function') {\n\t\tthrow new $TypeError('a function is required');\n\t}\n\treturn $actualApply(bind, $call, args);\n};\n", "'use strict';\n\nvar callBind = require('call-bind-apply-helpers');\nvar gOPD = require('gopd');\n\nvar hasProtoAccessor;\ntry {\n\t// eslint-disable-next-line no-extra-parens, no-proto\n\thasProtoAccessor = /** @type {{ __proto__?: typeof Array.prototype }} */ ([]).__proto__ === Array.prototype;\n} catch (e) {\n\tif (!e || typeof e !== 'object' || !('code' in e) || e.code !== 'ERR_PROTO_ACCESS') {\n\t\tthrow e;\n\t}\n}\n\n// eslint-disable-next-line no-extra-parens\nvar desc = !!hasProtoAccessor && gOPD && gOPD(Object.prototype, /** @type {keyof typeof Object.prototype} */ ('__proto__'));\n\nvar $Object = Object;\nvar $getPrototypeOf = $Object.getPrototypeOf;\n\n/** @type {import('./get')} */\nmodule.exports = desc && typeof desc.get === 'function'\n\t? callBind([desc.get])\n\t: typeof $getPrototypeOf === 'function'\n\t\t? /** @type {import('./get')} */ function getDunder(value) {\n\t\t\t// eslint-disable-next-line eqeqeq\n\t\t\treturn $getPrototypeOf(value == null ? value : $Object(value));\n\t\t}\n\t\t: false;\n", "'use strict';\n\nvar reflectGetProto = require('./Reflect.getPrototypeOf');\nvar originalGetProto = require('./Object.getPrototypeOf');\n\nvar getDunderProto = require('dunder-proto/get');\n\n/** @type {import('.')} */\nmodule.exports = reflectGetProto\n\t? function getProto(O) {\n\t\t// @ts-expect-error TS can't narrow inside a closure, for some reason\n\t\treturn reflectGetProto(O);\n\t}\n\t: originalGetProto\n\t\t? function getProto(O) {\n\t\t\tif (!O || (typeof O !== 'object' && typeof O !== 'function')) {\n\t\t\t\tthrow new TypeError('getProto: not an object');\n\t\t\t}\n\t\t\t// @ts-expect-error TS can't narrow inside a closure, for some reason\n\t\t\treturn originalGetProto(O);\n\t\t}\n\t\t: getDunderProto\n\t\t\t? function getProto(O) {\n\t\t\t\t// @ts-expect-error TS can't narrow inside a closure, for some reason\n\t\t\t\treturn getDunderProto(O);\n\t\t\t}\n\t\t\t: null;\n", "'use strict';\n\nvar call = Function.prototype.call;\nvar $hasOwn = Object.prototype.hasOwnProperty;\nvar bind = require('function-bind');\n\n/** @type {import('.')} */\nmodule.exports = bind.call(call, $hasOwn);\n", "'use strict';\n\nvar undefined;\n\nvar $Object = require('es-object-atoms');\n\nvar $Error = require('es-errors');\nvar $EvalError = require('es-errors/eval');\nvar $RangeError = require('es-errors/range');\nvar $ReferenceError = require('es-errors/ref');\nvar $SyntaxError = require('es-errors/syntax');\nvar $TypeError = require('es-errors/type');\nvar $URIError = require('es-errors/uri');\n\nvar abs = require('math-intrinsics/abs');\nvar floor = require('math-intrinsics/floor');\nvar max = require('math-intrinsics/max');\nvar min = require('math-intrinsics/min');\nvar pow = require('math-intrinsics/pow');\nvar round = require('math-intrinsics/round');\nvar sign = require('math-intrinsics/sign');\n\nvar $Function = Function;\n\n// eslint-disable-next-line consistent-return\nvar getEvalledConstructor = function (expressionSyntax) {\n\ttry {\n\t\treturn $Function('\"use strict\"; return (' + expressionSyntax + ').constructor;')();\n\t} catch (e) {}\n};\n\nvar $gOPD = require('gopd');\nvar $defineProperty = require('es-define-property');\n\nvar throwTypeError = function () {\n\tthrow new $TypeError();\n};\nvar ThrowTypeError = $gOPD\n\t? (function () {\n\t\ttry {\n\t\t\t// eslint-disable-next-line no-unused-expressions, no-caller, no-restricted-properties\n\t\t\targuments.callee; // IE 8 does not throw here\n\t\t\treturn throwTypeError;\n\t\t} catch (calleeThrows) {\n\t\t\ttry {\n\t\t\t\t// IE 8 throws on Object.getOwnPropertyDescriptor(arguments, '')\n\t\t\t\treturn $gOPD(arguments, 'callee').get;\n\t\t\t} catch (gOPDthrows) {\n\t\t\t\treturn throwTypeError;\n\t\t\t}\n\t\t}\n\t}())\n\t: throwTypeError;\n\nvar hasSymbols = require('has-symbols')();\n\nvar getProto = require('get-proto');\nvar $ObjectGPO = require('get-proto/Object.getPrototypeOf');\nvar $ReflectGPO = require('get-proto/Reflect.getPrototypeOf');\n\nvar $apply = require('call-bind-apply-helpers/functionApply');\nvar $call = require('call-bind-apply-helpers/functionCall');\n\nvar needsEval = {};\n\nvar TypedArray = typeof Uint8Array === 'undefined' || !getProto ? undefined : getProto(Uint8Array);\n\nvar INTRINSICS = {\n\t__proto__: null,\n\t'%AggregateError%': typeof AggregateError === 'undefined' ? undefined : AggregateError,\n\t'%Array%': Array,\n\t'%ArrayBuffer%': typeof ArrayBuffer === 'undefined' ? undefined : ArrayBuffer,\n\t'%ArrayIteratorPrototype%': hasSymbols && getProto ? getProto([][Symbol.iterator]()) : undefined,\n\t'%AsyncFromSyncIteratorPrototype%': undefined,\n\t'%AsyncFunction%': needsEval,\n\t'%AsyncGenerator%': needsEval,\n\t'%AsyncGeneratorFunction%': needsEval,\n\t'%AsyncIteratorPrototype%': needsEval,\n\t'%Atomics%': typeof Atomics === 'undefined' ? undefined : Atomics,\n\t'%BigInt%': typeof BigInt === 'undefined' ? undefined : BigInt,\n\t'%BigInt64Array%': typeof BigInt64Array === 'undefined' ? undefined : BigInt64Array,\n\t'%BigUint64Array%': typeof BigUint64Array === 'undefined' ? undefined : BigUint64Array,\n\t'%Boolean%': Boolean,\n\t'%DataView%': typeof DataView === 'undefined' ? undefined : DataView,\n\t'%Date%': Date,\n\t'%decodeURI%': decodeURI,\n\t'%decodeURIComponent%': decodeURIComponent,\n\t'%encodeURI%': encodeURI,\n\t'%encodeURIComponent%': encodeURIComponent,\n\t'%Error%': $Error,\n\t'%eval%': eval, // eslint-disable-line no-eval\n\t'%EvalError%': $EvalError,\n\t'%Float16Array%': typeof Float16Array === 'undefined' ? undefined : Float16Array,\n\t'%Float32Array%': typeof Float32Array === 'undefined' ? undefined : Float32Array,\n\t'%Float64Array%': typeof Float64Array === 'undefined' ? undefined : Float64Array,\n\t'%FinalizationRegistry%': typeof FinalizationRegistry === 'undefined' ? undefined : FinalizationRegistry,\n\t'%Function%': $Function,\n\t'%GeneratorFunction%': needsEval,\n\t'%Int8Array%': typeof Int8Array === 'undefined' ? undefined : Int8Array,\n\t'%Int16Array%': typeof Int16Array === 'undefined' ? undefined : Int16Array,\n\t'%Int32Array%': typeof Int32Array === 'undefined' ? undefined : Int32Array,\n\t'%isFinite%': isFinite,\n\t'%isNaN%': isNaN,\n\t'%IteratorPrototype%': hasSymbols && getProto ? getProto(getProto([][Symbol.iterator]())) : undefined,\n\t'%JSON%': typeof JSON === 'object' ? JSON : undefined,\n\t'%Map%': typeof Map === 'undefined' ? undefined : Map,\n\t'%MapIteratorPrototype%': typeof Map === 'undefined' || !hasSymbols || !getProto ? undefined : getProto(new Map()[Symbol.iterator]()),\n\t'%Math%': Math,\n\t'%Number%': Number,\n\t'%Object%': $Object,\n\t'%Object.getOwnPropertyDescriptor%': $gOPD,\n\t'%parseFloat%': parseFloat,\n\t'%parseInt%': parseInt,\n\t'%Promise%': typeof Promise === 'undefined' ? undefined : Promise,\n\t'%Proxy%': typeof Proxy === 'undefined' ? undefined : Proxy,\n\t'%RangeError%': $RangeError,\n\t'%ReferenceError%': $ReferenceError,\n\t'%Reflect%': typeof Reflect === 'undefined' ? undefined : Reflect,\n\t'%RegExp%': RegExp,\n\t'%Set%': typeof Set === 'undefined' ? undefined : Set,\n\t'%SetIteratorPrototype%': typeof Set === 'undefined' || !hasSymbols || !getProto ? undefined : getProto(new Set()[Symbol.iterator]()),\n\t'%SharedArrayBuffer%': typeof SharedArrayBuffer === 'undefined' ? undefined : SharedArrayBuffer,\n\t'%String%': String,\n\t'%StringIteratorPrototype%': hasSymbols && getProto ? getProto(''[Symbol.iterator]()) : undefined,\n\t'%Symbol%': hasSymbols ? Symbol : undefined,\n\t'%SyntaxError%': $SyntaxError,\n\t'%ThrowTypeError%': ThrowTypeError,\n\t'%TypedArray%': TypedArray,\n\t'%TypeError%': $TypeError,\n\t'%Uint8Array%': typeof Uint8Array === 'undefined' ? undefined : Uint8Array,\n\t'%Uint8ClampedArray%': typeof Uint8ClampedArray === 'undefined' ? undefined : Uint8ClampedArray,\n\t'%Uint16Array%': typeof Uint16Array === 'undefined' ? undefined : Uint16Array,\n\t'%Uint32Array%': typeof Uint32Array === 'undefined' ? undefined : Uint32Array,\n\t'%URIError%': $URIError,\n\t'%WeakMap%': typeof WeakMap === 'undefined' ? undefined : WeakMap,\n\t'%WeakRef%': typeof WeakRef === 'undefined' ? undefined : WeakRef,\n\t'%WeakSet%': typeof WeakSet === 'undefined' ? undefined : WeakSet,\n\n\t'%Function.prototype.call%': $call,\n\t'%Function.prototype.apply%': $apply,\n\t'%Object.defineProperty%': $defineProperty,\n\t'%Object.getPrototypeOf%': $ObjectGPO,\n\t'%Math.abs%': abs,\n\t'%Math.floor%': floor,\n\t'%Math.max%': max,\n\t'%Math.min%': min,\n\t'%Math.pow%': pow,\n\t'%Math.round%': round,\n\t'%Math.sign%': sign,\n\t'%Reflect.getPrototypeOf%': $ReflectGPO\n};\n\nif (getProto) {\n\ttry {\n\t\tnull.error; // eslint-disable-line no-unused-expressions\n\t} catch (e) {\n\t\t// https://github.com/tc39/proposal-shadowrealm/pull/384#issuecomment-1364264229\n\t\tvar errorProto = getProto(getProto(e));\n\t\tINTRINSICS['%Error.prototype%'] = errorProto;\n\t}\n}\n\nvar doEval = function doEval(name) {\n\tvar value;\n\tif (name === '%AsyncFunction%') {\n\t\tvalue = getEvalledConstructor('async function () {}');\n\t} else if (name === '%GeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('function* () {}');\n\t} else if (name === '%AsyncGeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('async function* () {}');\n\t} else if (name === '%AsyncGenerator%') {\n\t\tvar fn = doEval('%AsyncGeneratorFunction%');\n\t\tif (fn) {\n\t\t\tvalue = fn.prototype;\n\t\t}\n\t} else if (name === '%AsyncIteratorPrototype%') {\n\t\tvar gen = doEval('%AsyncGenerator%');\n\t\tif (gen && getProto) {\n\t\t\tvalue = getProto(gen.prototype);\n\t\t}\n\t}\n\n\tINTRINSICS[name] = value;\n\n\treturn value;\n};\n\nvar LEGACY_ALIASES = {\n\t__proto__: null,\n\t'%ArrayBufferPrototype%': ['ArrayBuffer', 'prototype'],\n\t'%ArrayPrototype%': ['Array', 'prototype'],\n\t'%ArrayProto_entries%': ['Array', 'prototype', 'entries'],\n\t'%ArrayProto_forEach%': ['Array', 'prototype', 'forEach'],\n\t'%ArrayProto_keys%': ['Array', 'prototype', 'keys'],\n\t'%ArrayProto_values%': ['Array', 'prototype', 'values'],\n\t'%AsyncFunctionPrototype%': ['AsyncFunction', 'prototype'],\n\t'%AsyncGenerator%': ['AsyncGeneratorFunction', 'prototype'],\n\t'%AsyncGeneratorPrototype%': ['AsyncGeneratorFunction', 'prototype', 'prototype'],\n\t'%BooleanPrototype%': ['Boolean', 'prototype'],\n\t'%DataViewPrototype%': ['DataView', 'prototype'],\n\t'%DatePrototype%': ['Date', 'prototype'],\n\t'%ErrorPrototype%': ['Error', 'prototype'],\n\t'%EvalErrorPrototype%': ['EvalError', 'prototype'],\n\t'%Float32ArrayPrototype%': ['Float32Array', 'prototype'],\n\t'%Float64ArrayPrototype%': ['Float64Array', 'prototype'],\n\t'%FunctionPrototype%': ['Function', 'prototype'],\n\t'%Generator%': ['GeneratorFunction', 'prototype'],\n\t'%GeneratorPrototype%': ['GeneratorFunction', 'prototype', 'prototype'],\n\t'%Int8ArrayPrototype%': ['Int8Array', 'prototype'],\n\t'%Int16ArrayPrototype%': ['Int16Array', 'prototype'],\n\t'%Int32ArrayPrototype%': ['Int32Array', 'prototype'],\n\t'%JSONParse%': ['JSON', 'parse'],\n\t'%JSONStringify%': ['JSON', 'stringify'],\n\t'%MapPrototype%': ['Map', 'prototype'],\n\t'%NumberPrototype%': ['Number', 'prototype'],\n\t'%ObjectPrototype%': ['Object', 'prototype'],\n\t'%ObjProto_toString%': ['Object', 'prototype', 'toString'],\n\t'%ObjProto_valueOf%': ['Object', 'prototype', 'valueOf'],\n\t'%PromisePrototype%': ['Promise', 'prototype'],\n\t'%PromiseProto_then%': ['Promise', 'prototype', 'then'],\n\t'%Promise_all%': ['Promise', 'all'],\n\t'%Promise_reject%': ['Promise', 'reject'],\n\t'%Promise_resolve%': ['Promise', 'resolve'],\n\t'%RangeErrorPrototype%': ['RangeError', 'prototype'],\n\t'%ReferenceErrorPrototype%': ['ReferenceError', 'prototype'],\n\t'%RegExpPrototype%': ['RegExp', 'prototype'],\n\t'%SetPrototype%': ['Set', 'prototype'],\n\t'%SharedArrayBufferPrototype%': ['SharedArrayBuffer', 'prototype'],\n\t'%StringPrototype%': ['String', 'prototype'],\n\t'%SymbolPrototype%': ['Symbol', 'prototype'],\n\t'%SyntaxErrorPrototype%': ['SyntaxError', 'prototype'],\n\t'%TypedArrayPrototype%': ['TypedArray', 'prototype'],\n\t'%TypeErrorPrototype%': ['TypeError', 'prototype'],\n\t'%Uint8ArrayPrototype%': ['Uint8Array', 'prototype'],\n\t'%Uint8ClampedArrayPrototype%': ['Uint8ClampedArray', 'prototype'],\n\t'%Uint16ArrayPrototype%': ['Uint16Array', 'prototype'],\n\t'%Uint32ArrayPrototype%': ['Uint32Array', 'prototype'],\n\t'%URIErrorPrototype%': ['URIError', 'prototype'],\n\t'%WeakMapPrototype%': ['WeakMap', 'prototype'],\n\t'%WeakSetPrototype%': ['WeakSet', 'prototype']\n};\n\nvar bind = require('function-bind');\nvar hasOwn = require('hasown');\nvar $concat = bind.call($call, Array.prototype.concat);\nvar $spliceApply = bind.call($apply, Array.prototype.splice);\nvar $replace = bind.call($call, String.prototype.replace);\nvar $strSlice = bind.call($call, String.prototype.slice);\nvar $exec = bind.call($call, RegExp.prototype.exec);\n\n/* adapted from https://github.com/lodash/lodash/blob/4.17.15/dist/lodash.js#L6735-L6744 */\nvar rePropName = /[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g;\nvar reEscapeChar = /\\\\(\\\\)?/g; /** Used to match backslashes in property paths. */\nvar stringToPath = function stringToPath(string) {\n\tvar first = $strSlice(string, 0, 1);\n\tvar last = $strSlice(string, -1);\n\tif (first === '%' && last !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected closing `%`');\n\t} else if (last === '%' && first !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected opening `%`');\n\t}\n\tvar result = [];\n\t$replace(string, rePropName, function (match, number, quote, subString) {\n\t\tresult[result.length] = quote ? $replace(subString, reEscapeChar, '$1') : number || match;\n\t});\n\treturn result;\n};\n/* end adaptation */\n\nvar getBaseIntrinsic = function getBaseIntrinsic(name, allowMissing) {\n\tvar intrinsicName = name;\n\tvar alias;\n\tif (hasOwn(LEGACY_ALIASES, intrinsicName)) {\n\t\talias = LEGACY_ALIASES[intrinsicName];\n\t\tintrinsicName = '%' + alias[0] + '%';\n\t}\n\n\tif (hasOwn(INTRINSICS, intrinsicName)) {\n\t\tvar value = INTRINSICS[intrinsicName];\n\t\tif (value === needsEval) {\n\t\t\tvalue = doEval(intrinsicName);\n\t\t}\n\t\tif (typeof value === 'undefined' && !allowMissing) {\n\t\t\tthrow new $TypeError('intrinsic ' + name + ' exists, but is not available. Please file an issue!');\n\t\t}\n\n\t\treturn {\n\t\t\talias: alias,\n\t\t\tname: intrinsicName,\n\t\t\tvalue: value\n\t\t};\n\t}\n\n\tthrow new $SyntaxError('intrinsic ' + name + ' does not exist!');\n};\n\nmodule.exports = function GetIntrinsic(name, allowMissing) {\n\tif (typeof name !== 'string' || name.length === 0) {\n\t\tthrow new $TypeError('intrinsic name must be a non-empty string');\n\t}\n\tif (arguments.length > 1 && typeof allowMissing !== 'boolean') {\n\t\tthrow new $TypeError('\"allowMissing\" argument must be a boolean');\n\t}\n\n\tif ($exec(/^%?[^%]*%?$/, name) === null) {\n\t\tthrow new $SyntaxError('`%` may not be present anywhere but at the beginning and end of the intrinsic name');\n\t}\n\tvar parts = stringToPath(name);\n\tvar intrinsicBaseName = parts.length > 0 ? parts[0] : '';\n\n\tvar intrinsic = getBaseIntrinsic('%' + intrinsicBaseName + '%', allowMissing);\n\tvar intrinsicRealName = intrinsic.name;\n\tvar value = intrinsic.value;\n\tvar skipFurtherCaching = false;\n\n\tvar alias = intrinsic.alias;\n\tif (alias) {\n\t\tintrinsicBaseName = alias[0];\n\t\t$spliceApply(parts, $concat([0, 1], alias));\n\t}\n\n\tfor (var i = 1, isOwn = true; i < parts.length; i += 1) {\n\t\tvar part = parts[i];\n\t\tvar first = $strSlice(part, 0, 1);\n\t\tvar last = $strSlice(part, -1);\n\t\tif (\n\t\t\t(\n\t\t\t\t(first === '\"' || first === \"'\" || first === '`')\n\t\t\t\t|| (last === '\"' || last === \"'\" || last === '`')\n\t\t\t)\n\t\t\t&& first !== last\n\t\t) {\n\t\t\tthrow new $SyntaxError('property names with quotes must have matching quotes');\n\t\t}\n\t\tif (part === 'constructor' || !isOwn) {\n\t\t\tskipFurtherCaching = true;\n\t\t}\n\n\t\tintrinsicBaseName += '.' + part;\n\t\tintrinsicRealName = '%' + intrinsicBaseName + '%';\n\n\t\tif (hasOwn(INTRINSICS, intrinsicRealName)) {\n\t\t\tvalue = INTRINSICS[intrinsicRealName];\n\t\t} else if (value != null) {\n\t\t\tif (!(part in value)) {\n\t\t\t\tif (!allowMissing) {\n\t\t\t\t\tthrow new $TypeError('base intrinsic for ' + name + ' exists, but the property is not available.');\n\t\t\t\t}\n\t\t\t\treturn void undefined;\n\t\t\t}\n\t\t\tif ($gOPD && (i + 1) >= parts.length) {\n\t\t\t\tvar desc = $gOPD(value, part);\n\t\t\t\tisOwn = !!desc;\n\n\t\t\t\t// By convention, when a data property is converted to an accessor\n\t\t\t\t// property to emulate a data property that does not suffer from\n\t\t\t\t// the override mistake, that accessor's getter is marked with\n\t\t\t\t// an `originalValue` property. Here, when we detect this, we\n\t\t\t\t// uphold the illusion by pretending to see that original data\n\t\t\t\t// property, i.e., returning the value rather than the getter\n\t\t\t\t// itself.\n\t\t\t\tif (isOwn && 'get' in desc && !('originalValue' in desc.get)) {\n\t\t\t\t\tvalue = desc.get;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = value[part];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisOwn = hasOwn(value, part);\n\t\t\t\tvalue = value[part];\n\t\t\t}\n\n\t\t\tif (isOwn && !skipFurtherCaching) {\n\t\t\t\tINTRINSICS[intrinsicRealName] = value;\n\t\t\t}\n\t\t}\n\t}\n\treturn value;\n};\n", "'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\nvar callBindBasic = require('call-bind-apply-helpers');\n\n/** @type {(thisArg: string, searchString: string, position?: number) => number} */\nvar $indexOf = callBindBasic([GetIntrinsic('%String.prototype.indexOf%')]);\n\n/** @type {import('.')} */\nmodule.exports = function callBoundIntrinsic(name, allowMissing) {\n\t/* eslint no-extra-parens: 0 */\n\n\tvar intrinsic = /** @type {(this: unknown, ...args: unknown[]) => unknown} */ (GetIntrinsic(name, !!allowMissing));\n\tif (typeof intrinsic === 'function' && $indexOf(name, '.prototype.') > -1) {\n\t\treturn callBindBasic(/** @type {const} */ ([intrinsic]));\n\t}\n\treturn intrinsic;\n};\n", "'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\nvar callBound = require('call-bound');\nvar inspect = require('object-inspect');\n\nvar $TypeError = require('es-errors/type');\nvar $Map = GetIntrinsic('%Map%', true);\n\n/** @type {<K, V>(thisArg: Map<K, V>, key: K) => V} */\nvar $mapGet = callBound('Map.prototype.get', true);\n/** @type {<K, V>(thisArg: Map<K, V>, key: K, value: V) => void} */\nvar $mapSet = callBound('Map.prototype.set', true);\n/** @type {<K, V>(thisArg: Map<K, V>, key: K) => boolean} */\nvar $mapHas = callBound('Map.prototype.has', true);\n/** @type {<K, V>(thisArg: Map<K, V>, key: K) => boolean} */\nvar $mapDelete = callBound('Map.prototype.delete', true);\n/** @type {<K, V>(thisArg: Map<K, V>) => number} */\nvar $mapSize = callBound('Map.prototype.size', true);\n\n/** @type {import('.')} */\nmodule.exports = !!$Map && /** @type {Exclude<import('.'), false>} */ function getSideChannelMap() {\n\t/** @typedef {ReturnType<typeof getSideChannelMap>} Channel */\n\t/** @typedef {Parameters<Channel['get']>[0]} K */\n\t/** @typedef {Parameters<Channel['set']>[1]} V */\n\n\t/** @type {Map<K, V> | undefined} */ var $m;\n\n\t/** @type {Channel} */\n\tvar channel = {\n\t\tassert: function (key) {\n\t\t\tif (!channel.has(key)) {\n\t\t\t\tthrow new $TypeError('Side channel does not contain ' + inspect(key));\n\t\t\t}\n\t\t},\n\t\t'delete': function (key) {\n\t\t\tif ($m) {\n\t\t\t\tvar result = $mapDelete($m, key);\n\t\t\t\tif ($mapSize($m) === 0) {\n\t\t\t\t\t$m = void undefined;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tget: function (key) { // eslint-disable-line consistent-return\n\t\t\tif ($m) {\n\t\t\t\treturn $mapGet($m, key);\n\t\t\t}\n\t\t},\n\t\thas: function (key) {\n\t\t\tif ($m) {\n\t\t\t\treturn $mapHas($m, key);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tset: function (key, value) {\n\t\t\tif (!$m) {\n\t\t\t\t// @ts-expect-error TS can't handle narrowing a variable inside a closure\n\t\t\t\t$m = new $Map();\n\t\t\t}\n\t\t\t$mapSet($m, key, value);\n\t\t}\n\t};\n\n\t// @ts-expect-error TODO: figure out why TS is erroring here\n\treturn channel;\n};\n", "'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\nvar callBound = require('call-bound');\nvar inspect = require('object-inspect');\nvar getSideChannelMap = require('side-channel-map');\n\nvar $TypeError = require('es-errors/type');\nvar $WeakMap = GetIntrinsic('%WeakMap%', true);\n\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => V} */\nvar $weakMapGet = callBound('WeakMap.prototype.get', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K, value: V) => void} */\nvar $weakMapSet = callBound('WeakMap.prototype.set', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => boolean} */\nvar $weakMapHas = callBound('WeakMap.prototype.has', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => boolean} */\nvar $weakMapDelete = callBound('WeakMap.prototype.delete', true);\n\n/** @type {import('.')} */\nmodule.exports = $WeakMap\n\t? /** @type {Exclude<import('.'), false>} */ function getSideChannelWeakMap() {\n\t\t/** @typedef {ReturnType<typeof getSideChannelWeakMap>} Channel */\n\t\t/** @typedef {Parameters<Channel['get']>[0]} K */\n\t\t/** @typedef {Parameters<Channel['set']>[1]} V */\n\n\t\t/** @type {WeakMap<K & object, V> | undefined} */ var $wm;\n\t\t/** @type {Channel | undefined} */ var $m;\n\n\t\t/** @type {Channel} */\n\t\tvar channel = {\n\t\t\tassert: function (key) {\n\t\t\t\tif (!channel.has(key)) {\n\t\t\t\t\tthrow new $TypeError('Side channel does not contain ' + inspect(key));\n\t\t\t\t}\n\t\t\t},\n\t\t\t'delete': function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapDelete($wm, key);\n\t\t\t\t\t}\n\t\t\t\t} else if (getSideChannelMap) {\n\t\t\t\t\tif ($m) {\n\t\t\t\t\t\treturn $m['delete'](key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tget: function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapGet($wm, key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn $m && $m.get(key);\n\t\t\t},\n\t\t\thas: function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapHas($wm, key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!$m && $m.has(key);\n\t\t\t},\n\t\t\tset: function (key, value) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif (!$wm) {\n\t\t\t\t\t\t$wm = new $WeakMap();\n\t\t\t\t\t}\n\t\t\t\t\t$weakMapSet($wm, key, value);\n\t\t\t\t} else if (getSideChannelMap) {\n\t\t\t\t\tif (!$m) {\n\t\t\t\t\t\t$m = getSideChannelMap();\n\t\t\t\t\t}\n\t\t\t\t\t// eslint-disable-next-line no-extra-parens\n\t\t\t\t\t/** @type {NonNullable<typeof $m>} */ ($m).set(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// @ts-expect-error TODO: figure out why this is erroring\n\t\treturn channel;\n\t}\n\t: getSideChannelMap;\n", "'use strict';\n\nvar $TypeError = require('es-errors/type');\nvar inspect = require('object-inspect');\nvar getSideChannelList = require('side-channel-list');\nvar getSideChannelMap = require('side-channel-map');\nvar getSideChannelWeakMap = require('side-channel-weakmap');\n\nvar makeChannel = getSideChannelWeakMap || getSideChannelMap || getSideChannelList;\n\n/** @type {import('.')} */\nmodule.exports = function getSideChannel() {\n\t/** @typedef {ReturnType<typeof getSideChannel>} Channel */\n\n\t/** @type {Channel | undefined} */ var $channelData;\n\n\t/** @type {Channel} */\n\tvar channel = {\n\t\tassert: function (key) {\n\t\t\tif (!channel.has(key)) {\n\t\t\t\tthrow new $TypeError('Side channel does not contain ' + inspect(key));\n\t\t\t}\n\t\t},\n\t\t'delete': function (key) {\n\t\t\treturn !!$channelData && $channelData['delete'](key);\n\t\t},\n\t\tget: function (key) {\n\t\t\treturn $channelData && $channelData.get(key);\n\t\t},\n\t\thas: function (key) {\n\t\t\treturn !!$channelData && $channelData.has(key);\n\t\t},\n\t\tset: function (key, value) {\n\t\t\tif (!$channelData) {\n\t\t\t\t$channelData = makeChannel();\n\t\t\t}\n\n\t\t\t$channelData.set(key, value);\n\t\t}\n\t};\n\t// @ts-expect-error TODO: figure out why this is erroring\n\treturn channel;\n};\n", "'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nvar Format = {\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n\nmodule.exports = {\n    'default': Format.RFC3986,\n    formatters: {\n        RFC1738: function (value) {\n            return replace.call(value, percentTwenties, '+');\n        },\n        RFC3986: function (value) {\n            return String(value);\n        }\n    },\n    RFC1738: Format.RFC1738,\n    RFC3986: Format.RFC3986\n};\n", "'use strict';\n\nvar formats = require('./formats');\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    while (queue.length > 1) {\n        var item = queue.pop();\n        var obj = item.obj[item.prop];\n\n        if (isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? { __proto__: null } : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    /* eslint no-param-reassign: 0 */\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object' && typeof source !== 'function') {\n        if (isArray(target)) {\n            target.push(source);\n        } else if (target && typeof target === 'object') {\n            if (\n                (options && (options.plainObjects || options.allowPrototypes))\n                || !has.call(Object.prototype, source)\n            ) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (!target || typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (isArray(target) && !isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (isArray(target) && isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                var targetItem = target[i];\n                if (targetItem && typeof targetItem === 'object' && item && typeof item === 'object') {\n                    target[i] = merge(targetItem, item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str, defaultDecoder, charset) {\n    var strWithoutPlus = str.replace(/\\+/g, ' ');\n    if (charset === 'iso-8859-1') {\n        // unescape never throws, no try...catch needed:\n        return strWithoutPlus.replace(/%[0-9a-f]{2}/gi, unescape);\n    }\n    // utf-8\n    try {\n        return decodeURIComponent(strWithoutPlus);\n    } catch (e) {\n        return strWithoutPlus;\n    }\n};\n\nvar limit = 1024;\n\n/* eslint operator-linebreak: [2, \"before\"] */\n\nvar encode = function encode(str, defaultEncoder, charset, kind, format) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = str;\n    if (typeof str === 'symbol') {\n        string = Symbol.prototype.toString.call(str);\n    } else if (typeof str !== 'string') {\n        string = String(str);\n    }\n\n    if (charset === 'iso-8859-1') {\n        return escape(string).replace(/%u[0-9a-f]{4}/gi, function ($0) {\n            return '%26%23' + parseInt($0.slice(2), 16) + '%3B';\n        });\n    }\n\n    var out = '';\n    for (var j = 0; j < string.length; j += limit) {\n        var segment = string.length >= limit ? string.slice(j, j + limit) : string;\n        var arr = [];\n\n        for (var i = 0; i < segment.length; ++i) {\n            var c = segment.charCodeAt(i);\n            if (\n                c === 0x2D // -\n                || c === 0x2E // .\n                || c === 0x5F // _\n                || c === 0x7E // ~\n                || (c >= 0x30 && c <= 0x39) // 0-9\n                || (c >= 0x41 && c <= 0x5A) // a-z\n                || (c >= 0x61 && c <= 0x7A) // A-Z\n                || (format === formats.RFC1738 && (c === 0x28 || c === 0x29)) // ( )\n            ) {\n                arr[arr.length] = segment.charAt(i);\n                continue;\n            }\n\n            if (c < 0x80) {\n                arr[arr.length] = hexTable[c];\n                continue;\n            }\n\n            if (c < 0x800) {\n                arr[arr.length] = hexTable[0xC0 | (c >> 6)]\n                    + hexTable[0x80 | (c & 0x3F)];\n                continue;\n            }\n\n            if (c < 0xD800 || c >= 0xE000) {\n                arr[arr.length] = hexTable[0xE0 | (c >> 12)]\n                    + hexTable[0x80 | ((c >> 6) & 0x3F)]\n                    + hexTable[0x80 | (c & 0x3F)];\n                continue;\n            }\n\n            i += 1;\n            c = 0x10000 + (((c & 0x3FF) << 10) | (segment.charCodeAt(i) & 0x3FF));\n\n            arr[arr.length] = hexTable[0xF0 | (c >> 18)]\n                + hexTable[0x80 | ((c >> 12) & 0x3F)]\n                + hexTable[0x80 | ((c >> 6) & 0x3F)]\n                + hexTable[0x80 | (c & 0x3F)];\n        }\n\n        out += arr.join('');\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    compactQueue(queue);\n\n    return value;\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (!obj || typeof obj !== 'object') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nvar combine = function combine(a, b) {\n    return [].concat(a, b);\n};\n\nvar maybeMap = function maybeMap(val, fn) {\n    if (isArray(val)) {\n        var mapped = [];\n        for (var i = 0; i < val.length; i += 1) {\n            mapped.push(fn(val[i]));\n        }\n        return mapped;\n    }\n    return fn(val);\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    combine: combine,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    maybeMap: maybeMap,\n    merge: merge\n};\n", "'use strict';\n\nvar getSideChannel = require('side-channel');\nvar utils = require('./utils');\nvar formats = require('./formats');\nvar has = Object.prototype.hasOwnProperty;\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) {\n        return prefix + '[]';\n    },\n    comma: 'comma',\n    indices: function indices(prefix, key) {\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) {\n        return prefix;\n    }\n};\n\nvar isArray = Array.isArray;\nvar push = Array.prototype.push;\nvar pushToArray = function (arr, valueOrArray) {\n    push.apply(arr, isArray(valueOrArray) ? valueOrArray : [valueOrArray]);\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaultFormat = formats['default'];\nvar defaults = {\n    addQueryPrefix: false,\n    allowDots: false,\n    allowEmptyArrays: false,\n    arrayFormat: 'indices',\n    charset: 'utf-8',\n    charsetSentinel: false,\n    commaRoundTrip: false,\n    delimiter: '&',\n    encode: true,\n    encodeDotInKeys: false,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    filter: void undefined,\n    format: defaultFormat,\n    formatter: formats.formatters[defaultFormat],\n    // deprecated\n    indices: false,\n    serializeDate: function serializeDate(date) {\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar isNonNullishPrimitive = function isNonNullishPrimitive(v) {\n    return typeof v === 'string'\n        || typeof v === 'number'\n        || typeof v === 'boolean'\n        || typeof v === 'symbol'\n        || typeof v === 'bigint';\n};\n\nvar sentinel = {};\n\nvar stringify = function stringify(\n    object,\n    prefix,\n    generateArrayPrefix,\n    commaRoundTrip,\n    allowEmptyArrays,\n    strictNullHandling,\n    skipNulls,\n    encodeDotInKeys,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    format,\n    formatter,\n    encodeValuesOnly,\n    charset,\n    sideChannel\n) {\n    var obj = object;\n\n    var tmpSc = sideChannel;\n    var step = 0;\n    var findFlag = false;\n    while ((tmpSc = tmpSc.get(sentinel)) !== void undefined && !findFlag) {\n        // Where object last appeared in the ref tree\n        var pos = tmpSc.get(object);\n        step += 1;\n        if (typeof pos !== 'undefined') {\n            if (pos === step) {\n                throw new RangeError('Cyclic object value');\n            } else {\n                findFlag = true; // Break while\n            }\n        }\n        if (typeof tmpSc.get(sentinel) === 'undefined') {\n            step = 0;\n        }\n    }\n\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (generateArrayPrefix === 'comma' && isArray(obj)) {\n        obj = utils.maybeMap(obj, function (value) {\n            if (value instanceof Date) {\n                return serializeDate(value);\n            }\n            return value;\n        });\n    }\n\n    if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder, charset, 'key', format) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (isNonNullishPrimitive(obj) || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder, charset, 'key', format);\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder, charset, 'value', format))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (generateArrayPrefix === 'comma' && isArray(obj)) {\n        // we need to join elements in\n        if (encodeValuesOnly && encoder) {\n            obj = utils.maybeMap(obj, encoder);\n        }\n        objKeys = [{ value: obj.length > 0 ? obj.join(',') || null : void undefined }];\n    } else if (isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    var encodedPrefix = encodeDotInKeys ? String(prefix).replace(/\\./g, '%2E') : String(prefix);\n\n    var adjustedPrefix = commaRoundTrip && isArray(obj) && obj.length === 1 ? encodedPrefix + '[]' : encodedPrefix;\n\n    if (allowEmptyArrays && isArray(obj) && obj.length === 0) {\n        return adjustedPrefix + '[]';\n    }\n\n    for (var j = 0; j < objKeys.length; ++j) {\n        var key = objKeys[j];\n        var value = typeof key === 'object' && key && typeof key.value !== 'undefined'\n            ? key.value\n            : obj[key];\n\n        if (skipNulls && value === null) {\n            continue;\n        }\n\n        var encodedKey = allowDots && encodeDotInKeys ? String(key).replace(/\\./g, '%2E') : String(key);\n        var keyPrefix = isArray(obj)\n            ? typeof generateArrayPrefix === 'function' ? generateArrayPrefix(adjustedPrefix, encodedKey) : adjustedPrefix\n            : adjustedPrefix + (allowDots ? '.' + encodedKey : '[' + encodedKey + ']');\n\n        sideChannel.set(object, step);\n        var valueSideChannel = getSideChannel();\n        valueSideChannel.set(sentinel, sideChannel);\n        pushToArray(values, stringify(\n            value,\n            keyPrefix,\n            generateArrayPrefix,\n            commaRoundTrip,\n            allowEmptyArrays,\n            strictNullHandling,\n            skipNulls,\n            encodeDotInKeys,\n            generateArrayPrefix === 'comma' && encodeValuesOnly && isArray(obj) ? null : encoder,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            format,\n            formatter,\n            encodeValuesOnly,\n            charset,\n            valueSideChannel\n        ));\n    }\n\n    return values;\n};\n\nvar normalizeStringifyOptions = function normalizeStringifyOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (typeof opts.allowEmptyArrays !== 'undefined' && typeof opts.allowEmptyArrays !== 'boolean') {\n        throw new TypeError('`allowEmptyArrays` option can only be `true` or `false`, when provided');\n    }\n\n    if (typeof opts.encodeDotInKeys !== 'undefined' && typeof opts.encodeDotInKeys !== 'boolean') {\n        throw new TypeError('`encodeDotInKeys` option can only be `true` or `false`, when provided');\n    }\n\n    if (opts.encoder !== null && typeof opts.encoder !== 'undefined' && typeof opts.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var charset = opts.charset || defaults.charset;\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n\n    var format = formats['default'];\n    if (typeof opts.format !== 'undefined') {\n        if (!has.call(formats.formatters, opts.format)) {\n            throw new TypeError('Unknown format option provided.');\n        }\n        format = opts.format;\n    }\n    var formatter = formats.formatters[format];\n\n    var filter = defaults.filter;\n    if (typeof opts.filter === 'function' || isArray(opts.filter)) {\n        filter = opts.filter;\n    }\n\n    var arrayFormat;\n    if (opts.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = opts.arrayFormat;\n    } else if ('indices' in opts) {\n        arrayFormat = opts.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = defaults.arrayFormat;\n    }\n\n    if ('commaRoundTrip' in opts && typeof opts.commaRoundTrip !== 'boolean') {\n        throw new TypeError('`commaRoundTrip` must be a boolean, or absent');\n    }\n\n    var allowDots = typeof opts.allowDots === 'undefined' ? opts.encodeDotInKeys === true ? true : defaults.allowDots : !!opts.allowDots;\n\n    return {\n        addQueryPrefix: typeof opts.addQueryPrefix === 'boolean' ? opts.addQueryPrefix : defaults.addQueryPrefix,\n        allowDots: allowDots,\n        allowEmptyArrays: typeof opts.allowEmptyArrays === 'boolean' ? !!opts.allowEmptyArrays : defaults.allowEmptyArrays,\n        arrayFormat: arrayFormat,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        commaRoundTrip: !!opts.commaRoundTrip,\n        delimiter: typeof opts.delimiter === 'undefined' ? defaults.delimiter : opts.delimiter,\n        encode: typeof opts.encode === 'boolean' ? opts.encode : defaults.encode,\n        encodeDotInKeys: typeof opts.encodeDotInKeys === 'boolean' ? opts.encodeDotInKeys : defaults.encodeDotInKeys,\n        encoder: typeof opts.encoder === 'function' ? opts.encoder : defaults.encoder,\n        encodeValuesOnly: typeof opts.encodeValuesOnly === 'boolean' ? opts.encodeValuesOnly : defaults.encodeValuesOnly,\n        filter: filter,\n        format: format,\n        formatter: formatter,\n        serializeDate: typeof opts.serializeDate === 'function' ? opts.serializeDate : defaults.serializeDate,\n        skipNulls: typeof opts.skipNulls === 'boolean' ? opts.skipNulls : defaults.skipNulls,\n        sort: typeof opts.sort === 'function' ? opts.sort : null,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling\n    };\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = normalizeStringifyOptions(opts);\n\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[options.arrayFormat];\n    var commaRoundTrip = generateArrayPrefix === 'comma' && options.commaRoundTrip;\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (options.sort) {\n        objKeys.sort(options.sort);\n    }\n\n    var sideChannel = getSideChannel();\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n        var value = obj[key];\n\n        if (options.skipNulls && value === null) {\n            continue;\n        }\n        pushToArray(keys, stringify(\n            value,\n            key,\n            generateArrayPrefix,\n            commaRoundTrip,\n            options.allowEmptyArrays,\n            options.strictNullHandling,\n            options.skipNulls,\n            options.encodeDotInKeys,\n            options.encode ? options.encoder : null,\n            options.filter,\n            options.sort,\n            options.allowDots,\n            options.serializeDate,\n            options.format,\n            options.formatter,\n            options.encodeValuesOnly,\n            options.charset,\n            sideChannel\n        ));\n    }\n\n    var joined = keys.join(options.delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    if (options.charsetSentinel) {\n        if (options.charset === 'iso-8859-1') {\n            // encodeURIComponent('&#10003;'), the \"numeric entity\" representation of a checkmark\n            prefix += 'utf8=%26%2310003%3B&';\n        } else {\n            // encodeURIComponent('')\n            prefix += 'utf8=%E2%9C%93&';\n        }\n    }\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n", "'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar defaults = {\n    allowDots: false,\n    allowEmptyArrays: false,\n    allowPrototypes: false,\n    allowSparse: false,\n    arrayLimit: 20,\n    charset: 'utf-8',\n    charsetSentinel: false,\n    comma: false,\n    decodeDotInKeys: false,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    duplicates: 'combine',\n    ignoreQueryPrefix: false,\n    interpretNumericEntities: false,\n    parameterLimit: 1000,\n    parseArrays: true,\n    plainObjects: false,\n    strictDepth: false,\n    strictNullHandling: false,\n    throwOnLimitExceeded: false\n};\n\nvar interpretNumericEntities = function (str) {\n    return str.replace(/&#(\\d+);/g, function ($0, numberStr) {\n        return String.fromCharCode(parseInt(numberStr, 10));\n    });\n};\n\nvar parseArrayValue = function (val, options, currentArrayLength) {\n    if (val && typeof val === 'string' && options.comma && val.indexOf(',') > -1) {\n        return val.split(',');\n    }\n\n    if (options.throwOnLimitExceeded && currentArrayLength >= options.arrayLimit) {\n        throw new RangeError('Array limit exceeded. Only ' + options.arrayLimit + ' element' + (options.arrayLimit === 1 ? '' : 's') + ' allowed in an array.');\n    }\n\n    return val;\n};\n\n// This is what browsers will submit when the  character occurs in an\n// application/x-www-form-urlencoded body and the encoding of the page containing\n// the form is iso-8859-1, or when the submitted form has an accept-charset\n// attribute of iso-8859-1. Presumably also with other charsets that do not contain\n// the  character, such as us-ascii.\nvar isoSentinel = 'utf8=%26%2310003%3B'; // encodeURIComponent('&#10003;')\n\n// These are the percent-encoded utf-8 octets representing a checkmark, indicating that the request actually is utf-8 encoded.\nvar charsetSentinel = 'utf8=%E2%9C%93'; // encodeURIComponent('')\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = { __proto__: null };\n\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    cleanStr = cleanStr.replace(/%5B/gi, '[').replace(/%5D/gi, ']');\n\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(\n        options.delimiter,\n        options.throwOnLimitExceeded ? limit + 1 : limit\n    );\n\n    if (options.throwOnLimitExceeded && parts.length > limit) {\n        throw new RangeError('Parameter limit exceeded. Only ' + limit + ' parameter' + (limit === 1 ? '' : 's') + ' allowed.');\n    }\n\n    var skipIndex = -1; // Keep track of where the utf8 sentinel was found\n    var i;\n\n    var charset = options.charset;\n    if (options.charsetSentinel) {\n        for (i = 0; i < parts.length; ++i) {\n            if (parts[i].indexOf('utf8=') === 0) {\n                if (parts[i] === charsetSentinel) {\n                    charset = 'utf-8';\n                } else if (parts[i] === isoSentinel) {\n                    charset = 'iso-8859-1';\n                }\n                skipIndex = i;\n                i = parts.length; // The eslint settings do not allow break;\n            }\n        }\n    }\n\n    for (i = 0; i < parts.length; ++i) {\n        if (i === skipIndex) {\n            continue;\n        }\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key;\n        var val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder, charset, 'key');\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder, charset, 'key');\n\n            val = utils.maybeMap(\n                parseArrayValue(\n                    part.slice(pos + 1),\n                    options,\n                    isArray(obj[key]) ? obj[key].length : 0\n                ),\n                function (encodedVal) {\n                    return options.decoder(encodedVal, defaults.decoder, charset, 'value');\n                }\n            );\n        }\n\n        if (val && options.interpretNumericEntities && charset === 'iso-8859-1') {\n            val = interpretNumericEntities(String(val));\n        }\n\n        if (part.indexOf('[]=') > -1) {\n            val = isArray(val) ? [val] : val;\n        }\n\n        var existing = has.call(obj, key);\n        if (existing && options.duplicates === 'combine') {\n            obj[key] = utils.combine(obj[key], val);\n        } else if (!existing || options.duplicates === 'last') {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options, valuesParsed) {\n    var currentArrayLength = 0;\n    if (chain.length > 0 && chain[chain.length - 1] === '[]') {\n        var parentKey = chain.slice(0, -1).join('');\n        currentArrayLength = Array.isArray(val) && val[parentKey] ? val[parentKey].length : 0;\n    }\n\n    var leaf = valuesParsed ? val : parseArrayValue(val, options, currentArrayLength);\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]' && options.parseArrays) {\n            obj = options.allowEmptyArrays && (leaf === '' || (options.strictNullHandling && leaf === null))\n                ? []\n                : utils.combine([], leaf);\n        } else {\n            obj = options.plainObjects ? { __proto__: null } : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var decodedRoot = options.decodeDotInKeys ? cleanRoot.replace(/%2E/g, '.') : cleanRoot;\n            var index = parseInt(decodedRoot, 10);\n            if (!options.parseArrays && decodedRoot === '') {\n                obj = { 0: leaf };\n            } else if (\n                !isNaN(index)\n                && root !== decodedRoot\n                && String(index) === decodedRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else if (decodedRoot !== '__proto__') {\n                obj[decodedRoot] = leaf;\n            }\n        }\n\n        leaf = obj;\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options, valuesParsed) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = options.depth > 0 && brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while (options.depth > 0 && (segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, check strictDepth option for throw, else just add whatever is left\n\n    if (segment) {\n        if (options.strictDepth === true) {\n            throw new RangeError('Input depth exceeded depth option of ' + options.depth + ' and strictDepth is true');\n        }\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options, valuesParsed);\n};\n\nvar normalizeParseOptions = function normalizeParseOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (typeof opts.allowEmptyArrays !== 'undefined' && typeof opts.allowEmptyArrays !== 'boolean') {\n        throw new TypeError('`allowEmptyArrays` option can only be `true` or `false`, when provided');\n    }\n\n    if (typeof opts.decodeDotInKeys !== 'undefined' && typeof opts.decodeDotInKeys !== 'boolean') {\n        throw new TypeError('`decodeDotInKeys` option can only be `true` or `false`, when provided');\n    }\n\n    if (opts.decoder !== null && typeof opts.decoder !== 'undefined' && typeof opts.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n\n    if (typeof opts.throwOnLimitExceeded !== 'undefined' && typeof opts.throwOnLimitExceeded !== 'boolean') {\n        throw new TypeError('`throwOnLimitExceeded` option must be a boolean');\n    }\n\n    var charset = typeof opts.charset === 'undefined' ? defaults.charset : opts.charset;\n\n    var duplicates = typeof opts.duplicates === 'undefined' ? defaults.duplicates : opts.duplicates;\n\n    if (duplicates !== 'combine' && duplicates !== 'first' && duplicates !== 'last') {\n        throw new TypeError('The duplicates option must be either combine, first, or last');\n    }\n\n    var allowDots = typeof opts.allowDots === 'undefined' ? opts.decodeDotInKeys === true ? true : defaults.allowDots : !!opts.allowDots;\n\n    return {\n        allowDots: allowDots,\n        allowEmptyArrays: typeof opts.allowEmptyArrays === 'boolean' ? !!opts.allowEmptyArrays : defaults.allowEmptyArrays,\n        allowPrototypes: typeof opts.allowPrototypes === 'boolean' ? opts.allowPrototypes : defaults.allowPrototypes,\n        allowSparse: typeof opts.allowSparse === 'boolean' ? opts.allowSparse : defaults.allowSparse,\n        arrayLimit: typeof opts.arrayLimit === 'number' ? opts.arrayLimit : defaults.arrayLimit,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        comma: typeof opts.comma === 'boolean' ? opts.comma : defaults.comma,\n        decodeDotInKeys: typeof opts.decodeDotInKeys === 'boolean' ? opts.decodeDotInKeys : defaults.decodeDotInKeys,\n        decoder: typeof opts.decoder === 'function' ? opts.decoder : defaults.decoder,\n        delimiter: typeof opts.delimiter === 'string' || utils.isRegExp(opts.delimiter) ? opts.delimiter : defaults.delimiter,\n        // eslint-disable-next-line no-implicit-coercion, no-extra-parens\n        depth: (typeof opts.depth === 'number' || opts.depth === false) ? +opts.depth : defaults.depth,\n        duplicates: duplicates,\n        ignoreQueryPrefix: opts.ignoreQueryPrefix === true,\n        interpretNumericEntities: typeof opts.interpretNumericEntities === 'boolean' ? opts.interpretNumericEntities : defaults.interpretNumericEntities,\n        parameterLimit: typeof opts.parameterLimit === 'number' ? opts.parameterLimit : defaults.parameterLimit,\n        parseArrays: opts.parseArrays !== false,\n        plainObjects: typeof opts.plainObjects === 'boolean' ? opts.plainObjects : defaults.plainObjects,\n        strictDepth: typeof opts.strictDepth === 'boolean' ? !!opts.strictDepth : defaults.strictDepth,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling,\n        throwOnLimitExceeded: typeof opts.throwOnLimitExceeded === 'boolean' ? opts.throwOnLimitExceeded : false\n    };\n};\n\nmodule.exports = function (str, opts) {\n    var options = normalizeParseOptions(opts);\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? { __proto__: null } : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? { __proto__: null } : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options, typeof str === 'string');\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    if (options.allowSparse === true) {\n        return obj;\n    }\n\n    return utils.compact(obj);\n};\n", "'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n", "/*\n * Copyright Joyent, Inc. and other Node contributors.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to permit\n * persons to whom the Software is furnished to do so, subject to the\n * following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n * NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n * USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n'use strict';\n\nvar punycode = require('punycode/');\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n/*\n * define these here so at least they only have to be\n * compiled once on the first module load.\n */\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n  portPattern = /:[0-9]*$/,\n\n  // Special case for a simple path URL\n  simplePathPattern = /^(\\/\\/?(?!\\/)[^?\\s]*)(\\?[^\\s]*)?$/,\n\n  /*\n   * RFC 2396: characters reserved for delimiting URLs.\n   * We actually just auto-escape these.\n   */\n  delims = [\n    '<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'\n  ],\n\n  // RFC 2396: characters not allowed for various reasons.\n  unwise = [\n    '{', '}', '|', '\\\\', '^', '`'\n  ].concat(delims),\n\n  // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n  autoEscape = ['\\''].concat(unwise),\n  /*\n   * Characters that are never ever allowed in a hostname.\n   * Note that any invalid chars are also handled, but these\n   * are the ones that are *expected* to be seen, so we fast-path\n   * them.\n   */\n  nonHostChars = [\n    '%', '/', '?', ';', '#'\n  ].concat(autoEscape),\n  hostEndingChars = [\n    '/', '?', '#'\n  ],\n  hostnameMaxLen = 255,\n  hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n  hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n  // protocols that can allow \"unsafe\" and \"unwise\" chars.\n  unsafeProtocol = {\n    javascript: true,\n    'javascript:': true\n  },\n  // protocols that never have a hostname.\n  hostlessProtocol = {\n    javascript: true,\n    'javascript:': true\n  },\n  // protocols that always contain a // bit.\n  slashedProtocol = {\n    http: true,\n    https: true,\n    ftp: true,\n    gopher: true,\n    file: true,\n    'http:': true,\n    'https:': true,\n    'ftp:': true,\n    'gopher:': true,\n    'file:': true\n  },\n  querystring = require('qs');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && typeof url === 'object' && url instanceof Url) { return url; }\n\n  var u = new Url();\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function (url, parseQueryString, slashesDenoteHost) {\n  if (typeof url !== 'string') {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  /*\n   * Copy chrome, IE, opera backslash-handling behavior.\n   * Back slashes before the query string get converted to forward slashes\n   * See: https://code.google.com/p/chromium/issues/detail?id=25916\n   */\n  var queryIndex = url.indexOf('?'),\n    splitter = queryIndex !== -1 && queryIndex < url.indexOf('#') ? '?' : '#',\n    uSplit = url.split(splitter),\n    slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  /*\n   * trim before proceeding.\n   * This is to support parse stuff like \"  http://foo.com  \\n\"\n   */\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  /*\n   * figure out if it's got a host\n   * user@server is *always* interpreted as a hostname, and url\n   * resolution will treat //foo/bar as host=foo,path=bar because that's\n   * how the browser resolves relative URLs.\n   */\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@/]+@[^@/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] && (slashes || (proto && !slashedProtocol[proto]))) {\n\n    /*\n     * there's a hostname.\n     * the first instance of /, ?, ;, or # ends the host.\n     *\n     * If there is an @ in the hostname, then non-host chars *are* allowed\n     * to the left of the last @ sign, unless some host-ending character\n     * comes *before* the @-sign.\n     * URLs are obnoxious.\n     *\n     * ex:\n     * http://a@b@c/ => user:a@b host:c\n     * http://a@b?@c => user:a host:c path:/?@c\n     */\n\n    /*\n     * v0.12 TODO(isaacs): This is not quite how Chrome does things.\n     * Review our test case against browsers more comprehensively.\n     */\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) { hostEnd = hec; }\n    }\n\n    /*\n     * at this point, either we have an explicit point where the\n     * auth portion cannot go past, or the last @ char is the decider.\n     */\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      /*\n       * atSign must be in auth portion.\n       * http://a@b/c@d => host:b auth:a path:/c@d\n       */\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    /*\n     * Now we have a portion which is definitely the auth.\n     * Pull that off.\n     */\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) { hostEnd = hec; }\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1) { hostEnd = rest.length; }\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    /*\n     * we've indicated that there is a hostname,\n     * so even if it's empty, it has to be present.\n     */\n    this.hostname = this.hostname || '';\n\n    /*\n     * if hostname begins with [ and ends with ]\n     * assume that it's an IPv6 address.\n     */\n    var ipv6Hostname = this.hostname[0] === '[' && this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) { continue; }\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              /*\n               * we replace non-ASCII char with a temporary placeholder\n               * we need this to make sure size of hostname is not\n               * broken by replacing non-ASCII by nothing\n               */\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      /*\n       * IDNA Support: Returns a punycoded representation of \"domain\".\n       * It only converts parts of the domain name that\n       * have non-ASCII characters, i.e. it doesn't matter if\n       * you call it with a domain that already is ASCII-only.\n       */\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    /*\n     * strip [ and ] from the hostname\n     * the host field still retains them, though\n     */\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  /*\n   * now rest is set to the post-host stuff.\n   * chop off any delim chars.\n   */\n  if (!unsafeProtocol[lowerProto]) {\n\n    /*\n     * First, make 100% sure that any \"autoEscape\" chars get\n     * escaped, even if encodeURIComponent doesn't think they\n     * need to be.\n     */\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1) { continue; }\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) { this.pathname = rest; }\n  if (slashedProtocol[lowerProto] && this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  // to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  /*\n   * ensure it's an object, and not a string url.\n   * If it's an obj, this is a no-op.\n   * this way, you can call url_format() on strings\n   * to clean up potentially wonky urls.\n   */\n  if (typeof obj === 'string') { obj = urlParse(obj); }\n  if (!(obj instanceof Url)) { return Url.prototype.format.call(obj); }\n  return obj.format();\n}\n\nUrl.prototype.format = function () {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n    pathname = this.pathname || '',\n    hash = this.hash || '',\n    host = false,\n    query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ? this.hostname : '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query && typeof this.query === 'object' && Object.keys(this.query).length) {\n    query = querystring.stringify(this.query, {\n      arrayFormat: 'repeat',\n      addQueryPrefix: false\n    });\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') { protocol += ':'; }\n\n  /*\n   * only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n   * unless they had them to begin with.\n   */\n  if (this.slashes || (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') { pathname = '/' + pathname; }\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') { hash = '#' + hash; }\n  if (search && search.charAt(0) !== '?') { search = '?' + search; }\n\n  pathname = pathname.replace(/[?#]/g, function (match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function (relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) { return relative; }\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function (relative) {\n  if (typeof relative === 'string') {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  /*\n   * hash is always overridden, no matter what.\n   * even href=\"\" will remove it.\n   */\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol') { result[rkey] = relative[rkey]; }\n    }\n\n    // urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] && result.hostname && !result.pathname) {\n      result.pathname = '/';\n      result.path = result.pathname;\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    /*\n     * if it's a known url protocol, then changing\n     * the protocol does weird things\n     * first, if it's not file:, then we MUST have a host,\n     * and if there was a path\n     * to begin with, then we MUST have a path.\n     * if it is file:, then the host is dropped,\n     * because that's known to be hostless.\n     * anything else is assumed to be absolute.\n     */\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift())) { }\n      if (!relative.host) { relative.host = ''; }\n      if (!relative.hostname) { relative.hostname = ''; }\n      if (relPath[0] !== '') { relPath.unshift(''); }\n      if (relPath.length < 2) { relPath.unshift(''); }\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = result.pathname && result.pathname.charAt(0) === '/',\n    isRelAbs = relative.host || relative.pathname && relative.pathname.charAt(0) === '/',\n    mustEndAbs = isRelAbs || isSourceAbs || (result.host && relative.pathname),\n    removeAllDots = mustEndAbs,\n    srcPath = result.pathname && result.pathname.split('/') || [],\n    relPath = relative.pathname && relative.pathname.split('/') || [],\n    psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  /*\n   * if the url is a non-slashed url, then relative\n   * links like ../.. should be able\n   * to crawl up to the hostname, as well.  This is strange.\n   * result.protocol has already been set by now.\n   * Later on, put the first path part into the host field.\n   */\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') { srcPath[0] = result.host; } else { srcPath.unshift(result.host); }\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') { relPath[0] = relative.host; } else { relPath.unshift(relative.host); }\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = relative.host || relative.host === '' ? relative.host : result.host;\n    result.hostname = relative.hostname || relative.hostname === '' ? relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    /*\n     * it's relative\n     * throw away the existing file, and take the new path instead.\n     */\n    if (!srcPath) { srcPath = []; }\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (relative.search != null) {\n    /*\n     * just pull out the search.\n     * like href='?foo'.\n     * Put this after the other two cases because it simplifies the booleans\n     */\n    if (psychotic) {\n      result.host = srcPath.shift();\n      result.hostname = result.host;\n      /*\n       * occationaly the auth can get stuck only in host\n       * this especially happens in cases like\n       * url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n       */\n      var authInHost = result.host && result.host.indexOf('@') > 0 ? result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.hostname = authInHost.shift();\n        result.host = result.hostname;\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    // to support http.request\n    if (result.pathname !== null || result.search !== null) {\n      result.path = (result.pathname ? result.pathname : '') + (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    /*\n     * no path at all.  easy.\n     * we've already handled the other stuff above.\n     */\n    result.pathname = null;\n    // to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  /*\n   * if a url ENDs in . or .., then it must get a trailing slash.\n   * however, if it ends in anything else non-slashy,\n   * then it must NOT get a trailing slash.\n   */\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (result.host || relative.host || srcPath.length > 1) && (last === '.' || last === '..') || last === '';\n\n  /*\n   * strip single dots, resolve double dots to parent dir\n   * if the path tries to go above the root, `up` ends up > 0\n   */\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' && (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' || (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = isAbsolute ? '' : srcPath.length ? srcPath.shift() : '';\n    result.host = result.hostname;\n    /*\n     * occationaly the auth can get stuck only in host\n     * this especially happens in cases like\n     * url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n     */\n    var authInHost = result.host && result.host.indexOf('@') > 0 ? result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.hostname = authInHost.shift();\n      result.host = result.hostname;\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (srcPath.length > 0) {\n    result.pathname = srcPath.join('/');\n  } else {\n    result.pathname = null;\n    result.path = null;\n  }\n\n  // to support request.http\n  if (result.pathname !== null || result.search !== null) {\n    result.path = (result.pathname ? result.pathname : '') + (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function () {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) { this.hostname = host; }\n};\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n", "/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof globalThis === \"object\" ? globalThis :\n            typeof global === \"object\" ? global :\n                typeof self === \"object\" ? self :\n                    typeof this === \"object\" ? this :\n                        sloppyModeThis();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect !== \"undefined\") {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter, root);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                if (previous)\n                    previous(key, value);\n            };\n        }\n        function functionThis() {\n            try {\n                return Function(\"return this;\")();\n            }\n            catch (_) { }\n        }\n        function indirectEvalThis() {\n            try {\n                return (void 0, eval)(\"(function() { return this; })()\");\n            }\n            catch (_) { }\n        }\n        function sloppyModeThis() {\n            return functionThis() || indirectEvalThis();\n        }\n    })(function (exporter, root) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var _Map = typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        var registrySymbol = supportsSymbol ? Symbol.for(\"@reflect-metadata:registry\") : undefined;\n        var metadataRegistry = GetOrCreateMetadataRegistry();\n        var metadataProvider = CreateMetadataProvider(metadataRegistry);\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var provider = GetMetadataProvider(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return provider.OrdinaryDeleteMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return ToBoolean(provider.OrdinaryHasOwnMetadata(MetadataKey, O, P));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return;\n            return provider.OrdinaryGetOwnMetadata(MetadataKey, O, P);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ true);\n            provider.OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var provider = GetMetadataProvider(O, P, /*create*/ false);\n            if (!provider) {\n                return [];\n            }\n            return provider.OrdinaryOwnMetadataKeys(O, P);\n        }\n        // 6 ECMAScript Data Types and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        function SameValueZero(x, y) {\n            return x === y || x !== x && y !== y;\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // Global metadata registry\n        // - Allows `import \"reflect-metadata\"` and `import \"reflect-metadata/no-conflict\"` to interoperate.\n        // - Uses isolated metadata if `Reflect` is frozen before the registry can be installed.\n        /**\n         * Creates a registry used to allow multiple `reflect-metadata` providers.\n         */\n        function CreateMetadataRegistry() {\n            var fallback;\n            if (!IsUndefined(registrySymbol) &&\n                typeof root.Reflect !== \"undefined\" &&\n                !(registrySymbol in root.Reflect) &&\n                typeof root.Reflect.defineMetadata === \"function\") {\n                // interoperate with older version of `reflect-metadata` that did not support a registry.\n                fallback = CreateFallbackProvider(root.Reflect);\n            }\n            var first;\n            var second;\n            var rest;\n            var targetProviderMap = new _WeakMap();\n            var registry = {\n                registerProvider: registerProvider,\n                getProvider: getProvider,\n                setProvider: setProvider,\n            };\n            return registry;\n            function registerProvider(provider) {\n                if (!Object.isExtensible(registry)) {\n                    throw new Error(\"Cannot add provider to a frozen registry.\");\n                }\n                switch (true) {\n                    case fallback === provider: break;\n                    case IsUndefined(first):\n                        first = provider;\n                        break;\n                    case first === provider: break;\n                    case IsUndefined(second):\n                        second = provider;\n                        break;\n                    case second === provider: break;\n                    default:\n                        if (rest === undefined)\n                            rest = new _Set();\n                        rest.add(provider);\n                        break;\n                }\n            }\n            function getProviderNoCache(O, P) {\n                if (!IsUndefined(first)) {\n                    if (first.isProviderFor(O, P))\n                        return first;\n                    if (!IsUndefined(second)) {\n                        if (second.isProviderFor(O, P))\n                            return first;\n                        if (!IsUndefined(rest)) {\n                            var iterator = GetIterator(rest);\n                            while (true) {\n                                var next = IteratorStep(iterator);\n                                if (!next) {\n                                    return undefined;\n                                }\n                                var provider = IteratorValue(next);\n                                if (provider.isProviderFor(O, P)) {\n                                    IteratorClose(iterator);\n                                    return provider;\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!IsUndefined(fallback) && fallback.isProviderFor(O, P)) {\n                    return fallback;\n                }\n                return undefined;\n            }\n            function getProvider(O, P) {\n                var providerMap = targetProviderMap.get(O);\n                var provider;\n                if (!IsUndefined(providerMap)) {\n                    provider = providerMap.get(P);\n                }\n                if (!IsUndefined(provider)) {\n                    return provider;\n                }\n                provider = getProviderNoCache(O, P);\n                if (!IsUndefined(provider)) {\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return provider;\n            }\n            function hasProvider(provider) {\n                if (IsUndefined(provider))\n                    throw new TypeError();\n                return first === provider || second === provider || !IsUndefined(rest) && rest.has(provider);\n            }\n            function setProvider(O, P, provider) {\n                if (!hasProvider(provider)) {\n                    throw new Error(\"Metadata provider not registered.\");\n                }\n                var existingProvider = getProvider(O, P);\n                if (existingProvider !== provider) {\n                    if (!IsUndefined(existingProvider)) {\n                        return false;\n                    }\n                    var providerMap = targetProviderMap.get(O);\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return true;\n            }\n        }\n        /**\n         * Gets or creates the shared registry of metadata providers.\n         */\n        function GetOrCreateMetadataRegistry() {\n            var metadataRegistry;\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                metadataRegistry = root.Reflect[registrySymbol];\n            }\n            if (IsUndefined(metadataRegistry)) {\n                metadataRegistry = CreateMetadataRegistry();\n            }\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                Object.defineProperty(root.Reflect, registrySymbol, {\n                    enumerable: false,\n                    configurable: false,\n                    writable: false,\n                    value: metadataRegistry\n                });\n            }\n            return metadataRegistry;\n        }\n        function CreateMetadataProvider(registry) {\n            // [[Metadata]] internal slot\n            // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n            var metadata = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var targetMetadata = metadata.get(O);\n                    if (IsUndefined(targetMetadata))\n                        return false;\n                    return targetMetadata.has(P);\n                },\n                OrdinaryDefineOwnMetadata: OrdinaryDefineOwnMetadata,\n                OrdinaryHasOwnMetadata: OrdinaryHasOwnMetadata,\n                OrdinaryGetOwnMetadata: OrdinaryGetOwnMetadata,\n                OrdinaryOwnMetadataKeys: OrdinaryOwnMetadataKeys,\n                OrdinaryDeleteMetadata: OrdinaryDeleteMetadata,\n            };\n            metadataRegistry.registerProvider(provider);\n            return provider;\n            function GetOrCreateMetadataMap(O, P, Create) {\n                var targetMetadata = metadata.get(O);\n                var createdTargetMetadata = false;\n                if (IsUndefined(targetMetadata)) {\n                    if (!Create)\n                        return undefined;\n                    targetMetadata = new _Map();\n                    metadata.set(O, targetMetadata);\n                    createdTargetMetadata = true;\n                }\n                var metadataMap = targetMetadata.get(P);\n                if (IsUndefined(metadataMap)) {\n                    if (!Create)\n                        return undefined;\n                    metadataMap = new _Map();\n                    targetMetadata.set(P, metadataMap);\n                    if (!registry.setProvider(O, P, provider)) {\n                        targetMetadata.delete(P);\n                        if (createdTargetMetadata) {\n                            metadata.delete(O);\n                        }\n                        throw new Error(\"Wrong provider for target.\");\n                    }\n                }\n                return metadataMap;\n            }\n            // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n            function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                return ToBoolean(metadataMap.has(MetadataKey));\n            }\n            // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n            function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return undefined;\n                return metadataMap.get(MetadataKey);\n            }\n            // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n            function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n                metadataMap.set(MetadataKey, MetadataValue);\n            }\n            // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n            function OrdinaryOwnMetadataKeys(O, P) {\n                var keys = [];\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return keys;\n                var keysObj = metadataMap.keys();\n                var iterator = GetIterator(keysObj);\n                var k = 0;\n                while (true) {\n                    var next = IteratorStep(iterator);\n                    if (!next) {\n                        keys.length = k;\n                        return keys;\n                    }\n                    var nextValue = IteratorValue(next);\n                    try {\n                        keys[k] = nextValue;\n                    }\n                    catch (e) {\n                        try {\n                            IteratorClose(iterator);\n                        }\n                        finally {\n                            throw e;\n                        }\n                    }\n                    k++;\n                }\n            }\n            function OrdinaryDeleteMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                if (!metadataMap.delete(MetadataKey))\n                    return false;\n                if (metadataMap.size === 0) {\n                    var targetMetadata = metadata.get(O);\n                    if (!IsUndefined(targetMetadata)) {\n                        targetMetadata.delete(P);\n                        if (targetMetadata.size === 0) {\n                            metadata.delete(targetMetadata);\n                        }\n                    }\n                }\n                return true;\n            }\n        }\n        function CreateFallbackProvider(reflect) {\n            var defineMetadata = reflect.defineMetadata, hasOwnMetadata = reflect.hasOwnMetadata, getOwnMetadata = reflect.getOwnMetadata, getOwnMetadataKeys = reflect.getOwnMetadataKeys, deleteMetadata = reflect.deleteMetadata;\n            var metadataOwner = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var metadataPropertySet = metadataOwner.get(O);\n                    if (!IsUndefined(metadataPropertySet) && metadataPropertySet.has(P)) {\n                        return true;\n                    }\n                    if (getOwnMetadataKeys(O, P).length) {\n                        if (IsUndefined(metadataPropertySet)) {\n                            metadataPropertySet = new _Set();\n                            metadataOwner.set(O, metadataPropertySet);\n                        }\n                        metadataPropertySet.add(P);\n                        return true;\n                    }\n                    return false;\n                },\n                OrdinaryDefineOwnMetadata: defineMetadata,\n                OrdinaryHasOwnMetadata: hasOwnMetadata,\n                OrdinaryGetOwnMetadata: getOwnMetadata,\n                OrdinaryOwnMetadataKeys: getOwnMetadataKeys,\n                OrdinaryDeleteMetadata: deleteMetadata,\n            };\n            return provider;\n        }\n        /**\n         * Gets the metadata provider for an object. If the object has no metadata provider and this is for a create operation,\n         * then this module's metadata provider is assigned to the object.\n         */\n        function GetMetadataProvider(O, P, Create) {\n            var registeredProvider = metadataRegistry.getProvider(O, P);\n            if (!IsUndefined(registeredProvider)) {\n                return registeredProvider;\n            }\n            if (Create) {\n                if (metadataRegistry.setProvider(O, P, metadataProvider)) {\n                    return metadataProvider;\n                }\n                throw new Error(\"Illegal state.\");\n            }\n            return undefined;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            var Map = /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (SameValueZero(key, this._cacheKey)) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (!SameValueZero(this._cacheKey, key)) {\n                        this._cacheIndex = -1;\n                        for (var i = 0; i < this._keys.length; i++) {\n                            if (SameValueZero(this._keys[i], key)) {\n                                this._cacheIndex = i;\n                                break;\n                            }\n                        }\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            return Map;\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            var Set = /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.keys(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n            return Set;\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    var array = new Uint8Array(size);\n                    if (typeof crypto !== \"undefined\") {\n                        crypto.getRandomValues(array);\n                    }\n                    else if (typeof msCrypto !== \"undefined\") {\n                        msCrypto.getRandomValues(array);\n                    }\n                    else {\n                        FillRandomBytes(array, size);\n                    }\n                    return array;\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122  4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n", "/**\n * An APDU command that can be sent to a device.\n * DO NOT USE THIS CLASS DIRECTLY, use ApduBuilder instead.\n */\nexport class Apdu {\n  /**\n   * Instruction class (1 byte)\n   */\n  readonly cla: number;\n\n  /**\n   * Instruction code (1 byte)\n   */\n  readonly ins: number;\n\n  /**\n   * Instruction parameter 1 (2 bytes)\n   */\n  readonly p1: number;\n\n  /**\n   * Instruction parameter 2 (2 bytes)\n   */\n  readonly p2: number;\n\n  /**\n   * Bytes of data\n   */\n  readonly data: Uint8Array;\n\n  constructor(\n    cla: number,\n    ins: number,\n    p1: number,\n    p2: number,\n    data?: Uint8Array,\n  ) {\n    this.cla = cla;\n    this.ins = ins;\n    this.p1 = p1;\n    this.p2 = p2;\n    this.data = data ?? new Uint8Array();\n  }\n\n  /**\n   * Get the raw binary data of the APDU command\n   * @returns {Uint8Array} - The raw APDU command\n   */\n  getRawApdu(): Uint8Array {\n    const header = Uint8Array.from([\n      this.cla,\n      this.ins,\n      this.p1,\n      this.p2,\n      this.data.length,\n    ]);\n\n    const apdu = new Uint8Array(header.length + this.data.length);\n    apdu.set(header, 0);\n\n    if (this.data.length > 0) {\n      apdu.set(this.data, header.length);\n    }\n\n    return apdu;\n  }\n}\n", "export type HexaString = `0x${string}`;\n\nexport function isHexaString(value: unknown): value is HexaString {\n  return typeof value === \"string\" && /^0x[0-9a-fA-F]*$/.test(value);\n}\n\nexport function hexaStringToBuffer(value: string): Uint8Array | null {\n  if (value.startsWith(\"0x\")) {\n    value = value.slice(2);\n  }\n  if (value.length === 0) {\n    return new Uint8Array();\n  }\n  if (value.length % 2 !== 0) {\n    value = \"0\" + value;\n  }\n  if (/^[0-9a-fA-F]*$/.test(value) === false) {\n    return null;\n  }\n  const bytes = value.match(/.{1,2}/g)?.map((byte) => parseInt(byte, 16));\n  if (!bytes || bytes.some(isNaN)) {\n    return null;\n  }\n  return new Uint8Array(bytes);\n}\n\nexport function bufferToHexaString(\n  value: Uint8Array,\n  withPrefix?: true,\n): HexaString;\nexport function bufferToHexaString(\n  value: Uint8Array,\n  withPrefix?: false,\n): string;\nexport function bufferToHexaString(\n  value: Uint8Array,\n  withPrefix: boolean = true,\n): HexaString | string {\n  const prefix = withPrefix ? \"0x\" : \"\";\n  return `${prefix}${Array.from(value, (byte) =>\n    byte.toString(16).padStart(2, \"0\"),\n  ).join(\"\")}`;\n}\n", "import { type DmkError } from \"@api/Error\";\n\nimport { APDU_MAX_PAYLOAD } from \"./ApduBuilder\";\n\ninterface DmkAppBuilderError extends DmkError {\n  readonly message: string;\n}\n\nexport class ValueOverflowError implements DmkAppBuilderError {\n  readonly _tag = \"ValueOverflow\";\n  readonly originalError?: Error;\n  readonly message: string;\n  constructor(value: string, max: number | bigint = APDU_MAX_PAYLOAD) {\n    this.message = `Value overflow for ${value}, max is ${max}`;\n  }\n}\n\nexport class DataOverflowError implements DmkAppBuilderError {\n  readonly _tag = \"DataOverflow\";\n  readonly message: string;\n  readonly originalError?: Error;\n  constructor(value: string, remaining = 0) {\n    this.message =\n      remaining === 0\n        ? `this.data is already full (value: ${value})`\n        : `this.data will overflow with \"${value}\", remaining bytes: ${remaining}`;\n  }\n}\n\nexport class HexaStringEncodeError implements DmkAppBuilderError {\n  readonly _tag = \"HexaString\";\n  readonly message: string;\n  readonly originalError?: Error;\n  constructor(value: string) {\n    this.message = `Invalid encoded hexa string or length is null: ${value}`;\n  }\n}\n\n/**\n * Type for all possible errors that can be thrown by the AppBuilder.\n */\nexport type AppBuilderError =\n  | ValueOverflowError\n  | DataOverflowError\n  | HexaStringEncodeError;\n", "import { hexaStringToBuffer } from \"@api/utils/HexaString\";\n\nimport {\n  type AppBuilderError,\n  DataOverflowError,\n  HexaStringEncodeError,\n  ValueOverflowError,\n} from \"./AppBuilderError\";\n\nconst MAX_32_BIT_UINT = 0xffffffff;\n\n/**\n * ByteArrayBuilder is a utility class to help build APDU payloads.\n * It allows to easily add data to the payload of an APDU command\n * and to encode this data in different formats.\n *\n * @example\n * ```\n * const builder = new ByteArrayBuilder(255)\n *  .add8BitUIntToData(0x05)\n *  .add16BitUIntToData(0x0607)\n *  .addHexaStringToData(\"0x0809\")\n *  .addAsciiStringToData(\"hello\")\n *\n * const payload = builder.build();\n * const builderErrors = builder.getErrors();\n * ```\n */\nexport class ByteArrayBuilder {\n  private data: Uint8Array = new Uint8Array();\n  private readonly errors: AppBuilderError[] = []; // Custom Error\n\n  constructor(private maxPayloadSize: number = MAX_32_BIT_UINT) {}\n\n  // ==========\n  // Public API\n  // ==========\n\n  /**\n   * Build a new payload instance with the current state of the builder\n   * @returns {payload} - Returns a new payload instance\n   */\n  build = (): Uint8Array => this.data;\n\n  /**\n   * Try to build a new payload instance with the current state of the builder\n   * if the builder don't contain any error.\n   * @returns {payload | undefined} - Returns a new payload instance or undefined\n   */\n  tryBuild = (): Uint8Array | undefined => {\n    return this.hasErrors() ? undefined : this.data;\n  };\n\n  /**\n   * Add a 8-bit unsigned integer to the payload (max value 0xff = 255)\n   * @param value: number | bigint - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add8BitUIntToData = (value: number | bigint): ByteArrayBuilder => {\n    return this.addNumberToData(value, 8n, false, false);\n  };\n\n  /**\n   * Add a 16-bit unsigned integer to the payload (max value 0xffff = 65535)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add16BitUIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 16n, false, bigEndian);\n  };\n\n  /**\n   * Add a 32-bit unsigned integer to the payload (max value 0xffffffff = 4294967295)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add32BitUIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 32n, false, bigEndian);\n  };\n\n  /**\n   * Add a 64-bit unsigned integer to the payload (max value 0xffffffffffffffff = 18446744073709551615)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add64BitUIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 64n, false, bigEndian);\n  };\n\n  /**\n   * Add a 128-bit unsigned integer to the payload\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add128BitUIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 128n, false, bigEndian);\n  };\n\n  /**\n   * Add a 256-bit unsigned integer to the payload\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add256BitUIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 256n, false, bigEndian);\n  };\n\n  /**\n   * Add a 16-bit signed integer to the payload (value between -0x8000 to 0x7fff)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add16BitIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 16n, true, bigEndian);\n  };\n\n  /**\n   * Add a 32-bit signed integer to the payload (value between -0x80000000 to 0x7fffffff)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add32BitIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 32n, true, bigEndian);\n  };\n\n  /**\n   * Add a 64-bit signed integer to the payload (value between -0x8000000000000000 to 0x7fffffffffffffff)\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add64BitIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 64n, true, bigEndian);\n  };\n\n  /**\n   * Add a 128-bit signed integer to the payload\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add128BitIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 128n, true, bigEndian);\n  };\n\n  /**\n   * Add a 256-bit signed integer to the payload\n   * @param value: number | bigint - The value to add to the data\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  add256BitIntToData = (\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    return this.addNumberToData(value, 256n, true, bigEndian);\n  };\n\n  /**\n   * Add a Uint8Array to the payload if it has enough remaining space\n   * @param value: Uint8Array - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  addBufferToData = (value: Uint8Array): ByteArrayBuilder => {\n    if (!this.hasEnoughLengthRemaining(value)) {\n      this.errors.push(new DataOverflowError(value.toString()));\n      return this;\n    }\n\n    this.data = Uint8Array.from([...this.data, ...value]);\n    return this;\n  };\n\n  /**\n   * Add a string to the payload if it has enough remaining space\n   * and it can be formatted as a hexadecimal string\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  addHexaStringToData = (value: string): ByteArrayBuilder => {\n    const result = hexaStringToBuffer(value);\n    if (result === null || result.length === 0) {\n      this.errors.push(new HexaStringEncodeError(value));\n      return this;\n    }\n    this.addBufferToData(result);\n    return this;\n  };\n\n  /**\n   * Add an ascii string to the data field if it has enough remaining space\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  addAsciiStringToData = (value: string): ByteArrayBuilder => {\n    const bytes = new TextEncoder().encode(value);\n    this.addBufferToData(bytes);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded hexadecimal string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInLVFromHexa = (value: string): ByteArrayBuilder => {\n    const result = hexaStringToBuffer(value);\n    if (result === null || result.length === 0) {\n      this.errors.push(new HexaStringEncodeError(value));\n      return this;\n    }\n\n    if (!this.hasEnoughLengthRemaining(result, true)) {\n      this.errors.push(new DataOverflowError(value));\n      return this;\n    }\n    // values are always being well formatted at this point\n    // therefore no status test is needed\n    this.add8BitUIntToData(result.length);\n    this.addBufferToData(result);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded buffer to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: Uint8Array - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInLVFromBuffer = (value: Uint8Array): ByteArrayBuilder => {\n    if (!this.hasEnoughLengthRemaining(value, true)) {\n      this.errors.push(new DataOverflowError(value.toString()));\n      return this;\n    }\n\n    this.add8BitUIntToData(value.length);\n    this.addBufferToData(value);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded ascii string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInLVFromAscii = (value: string): ByteArrayBuilder => {\n    if (!this.hasEnoughLengthRemaining(value, true)) {\n      this.errors.push(new DataOverflowError(value));\n      return this;\n    }\n\n    this.add8BitUIntToData(value.length);\n    this.addAsciiStringToData(value);\n    return this;\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded ascii string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromAscii = (tag: number, value: string): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    return this.encodeInLVFromAscii(value);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded hexadecimal string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: string - The value to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromHexa = (tag: number, value: string): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    return this.encodeInLVFromHexa(value);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded hexadecimal string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: Uint8Array - The buffer to add to the data\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromBuffer = (\n    tag: number,\n    value: Uint8Array,\n  ): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    return this.encodeInLVFromBuffer(value);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded uint8 to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: number - The number to add\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromUInt8 = (tag: number, value: number): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    this.add8BitUIntToData(1);\n    return this.add8BitUIntToData(value);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded uint16 to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: number | bigint - The number to add\n   * @param bigEndian: boolean - Endianness used to encode the number\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromUInt16 = (\n    tag: number,\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    this.add8BitUIntToData(2);\n    return this.add16BitUIntToData(value, bigEndian);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded uint32 to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: number | bigint - The number to add\n   * @param bigEndian: boolean - Endianness used to encode the number\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromUInt32 = (\n    tag: number,\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    this.add8BitUIntToData(4);\n    return this.add32BitUIntToData(value, bigEndian);\n  };\n\n  /**\n   * Add a Tag-Length-Value encoded uint64 to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param tag: number - The tag to add to the data\n   * @param value: number | bigint - The number to add\n   * @param bigEndian: boolean - Endianness used to encode the number\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  encodeInTLVFromUInt64 = (\n    tag: number,\n    value: number | bigint,\n    bigEndian: boolean = true,\n  ): ByteArrayBuilder => {\n    this.add8BitUIntToData(tag);\n    this.add8BitUIntToData(8);\n    return this.add64BitUIntToData(value, bigEndian);\n  };\n\n  /**\n   * Returns the remaining payload length\n   * @returns {number}\n   */\n  getAvailablePayloadLength = (): number => {\n    return this.maxPayloadSize - this.data.length;\n  };\n\n  /**\n   * Returns the current errors\n   * @returns {AppBuilderError[]} - Returns an array of errors\n   */\n  getErrors = (): AppBuilderError[] => this.errors;\n\n  /**\n   * Verifies if the builder contains errors\n   * @returns {boolean} - Returns wether the builder contains errors or not\n   */\n  hasErrors = (): boolean => this.errors.length !== 0;\n\n  // ===========\n  // Private API\n  // ===========\n\n  /**\n   * Check if there is enough space to add a value to the data field\n   * @param value {string | Uint8Array | number[]} - Value to add to the data\n   * @param hasLv {boolean} - Length-Value encoding flag\n   * @returns {boolean} - Returns true if there is enough space to add the value\n   */\n  private hasEnoughLengthRemaining = (\n    value: string | Uint8Array | number[],\n    hasLv: boolean = false,\n  ): boolean => {\n    return (\n      this.data.length + value.length + (hasLv ? 1 : 0) <= this.maxPayloadSize\n    );\n  };\n\n  /**\n   * Add a number to the payload\n   * @param value: number | bigint - The value to add to the data\n   * @param sizeInBits: bigint - The number size in bits, for example 16 for a uint16\n   * @param signed: boolean - Whether the value is signed or unsigned.\n   * @param bigEndian: boolean - True to encode in big endian, false for little endian\n   * @returns {ByteArrayBuilder} - Returns the current instance of ByteArrayBuilder\n   */\n  private addNumberToData(\n    value: number | bigint,\n    sizeInBits: bigint,\n    signed: boolean,\n    bigEndian: boolean,\n  ): ByteArrayBuilder {\n    // Convert the number to two's complement and check its bounds\n    let converted = this.checkBoundsAndConvert(value, sizeInBits, signed);\n    if (converted === undefined) {\n      return this;\n    }\n\n    // Compute the buffer\n    const sizeInBytes = Number(sizeInBits) / 8;\n    const buffer = new Uint8Array(sizeInBytes);\n    if (bigEndian) {\n      for (let i = sizeInBytes - 1; i >= 0; i--) {\n        buffer[i] = Number(converted & 0xffn);\n        converted >>= 8n;\n      }\n    } else {\n      for (let i = 0; i < sizeInBytes; i++) {\n        buffer[i] = Number(converted & 0xffn);\n        converted >>= 8n;\n      }\n    }\n    return this.addBufferToData(buffer);\n  }\n\n  /**\n   * Checks the bounds of a signed or unsigned integer value and converts it to two's complement if it is signed and negative.\n   * @param value The value to check and convert.\n   * @param sizeInBits The size of the value in bits.\n   * @param signed Whether the value is signed or unsigned.\n   * @returns The converted value, or null if the value is out of bounds.\n   */\n  private checkBoundsAndConvert(\n    value: number | bigint,\n    sizeInBits: bigint,\n    signed: boolean,\n  ): bigint | undefined {\n    // Normalize the value to a bigint\n    if (typeof value === \"number\") {\n      if (!Number.isInteger(value) || value > Number.MAX_SAFE_INTEGER) {\n        this.errors.push(new ValueOverflowError(value.toString()));\n        return;\n      }\n      value = BigInt(value);\n    }\n\n    if (!signed) {\n      // Check if the value is within the bounds of an unsigned integer\n      const limit = 1n << sizeInBits;\n      if (value < 0 || value >= limit) {\n        this.errors.push(new ValueOverflowError(value.toString(), limit - 1n));\n        return;\n      }\n    } else {\n      // Check if the value is within the bounds of a signed integer\n      const limit = 1n << (sizeInBits - 1n);\n      if (value >= limit || value < -limit) {\n        this.errors.push(new ValueOverflowError(value.toString(), limit - 1n));\n        return;\n      }\n\n      // Convert the value to two's complement if it is negative\n      // https://en.wikipedia.org/wiki/Two%27s_complement\n      if (value < 0n) {\n        const mask = (1n << sizeInBits) - 1n;\n        value = -value;\n        value = (~value & mask) + 1n;\n      }\n    }\n    return value;\n  }\n}\n", "import { Apdu } from \"@api/apdu/model/Apdu\";\n\nimport { type AppBuilderError } from \"./AppBuilderError\";\nimport { ByteArrayBuilder } from \"./ByteArrayBuilder\";\n\nexport const HEADER_LENGTH = 5;\nexport const APDU_MAX_PAYLOAD = 255;\nexport const APDU_MAX_SIZE = APDU_MAX_PAYLOAD + 5;\n\nexport type ApduBuilderArgs = {\n  readonly ins: number;\n  readonly cla: number;\n  readonly p1: number;\n  readonly p2: number;\n};\n\n/**\n * ApduBuilder is a utility class to help build APDU commands.\n * It allows to easily add data to the data field of the APDU command\n * and to encode this data in different formats.\n *\n * @example\n * ```\n * const apduBuilder = new ApduBuilder({ ins: 0x01, cla: 0x02, p1: 0x03, p2: 0x04 })\n *  .add8BitUIntToData(0x05)\n *  .add16BitUIntToData(0x0607)\n *  .addHexaStringToData(\"0x0809\")\n *  .addAsciiStringToData(\"hello\")\n *\n * const apdu = apduBuilder.build();\n * const builderErrors = apduBuilder.getErrors();\n * ```\n */\nexport class ApduBuilder {\n  private readonly _ins: number;\n  private readonly _cla: number;\n  private readonly _p1: number;\n  private readonly p2: number;\n  private data: ByteArrayBuilder = new ByteArrayBuilder(APDU_MAX_PAYLOAD);\n\n  constructor({ ins, cla, p1, p2 }: ApduBuilderArgs) {\n    this._cla = cla & 0xff;\n    this._ins = ins & 0xff;\n    this._p1 = p1 & 0xff;\n    this.p2 = p2 & 0xff;\n  }\n\n  // ==========\n  // Public API\n  // ==========\n\n  /**\n   * Build a new Apdu instance with the current state of the builder\n   * @returns {Apdu} - Returns a new Apdu instance\n   */\n  build = (): Apdu =>\n    new Apdu(this._cla, this._ins, this._p1, this.p2, this.data.build());\n\n  /**\n   * Add a 8-bit unsigned integer to the data field (max value 0xff = 255)\n   * @param value?: number - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  add8BitUIntToData = (value: number): ApduBuilder => {\n    this.data.add8BitUIntToData(value);\n    return this;\n  };\n\n  /**\n   * Add a 16-bit unsigned integer to the data field (max value 0xffff = 65535)\n   * @param value: number - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  add16BitUIntToData = (value: number): ApduBuilder => {\n    this.data.add16BitUIntToData(value);\n    return this;\n  };\n\n  /**\n   * Add a 32-bit unsigned integer to the data field (max value 0xffffffff = 4294967295)\n   * @param value: number - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  add32BitUIntToData = (value: number): ApduBuilder => {\n    this.data.add32BitUIntToData(value);\n    return this;\n  };\n\n  /**\n   * Add a Uint8Array to the data field if it has enough remaining space\n   * @param value: Uint8Array - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  addBufferToData = (value: Uint8Array): ApduBuilder => {\n    this.data.addBufferToData(value);\n    return this;\n  };\n\n  /**\n   * Add a string to the data field if it has enough remaining space\n   * and it can be formatted as a hexadecimal string\n   * @param value: string - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  addHexaStringToData = (value: string): ApduBuilder => {\n    this.data.addHexaStringToData(value);\n    return this;\n  };\n\n  /**\n   * Add an ascii string to the data field if it has enough remaining space\n   * @param value: string - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  addAsciiStringToData = (value: string): ApduBuilder => {\n    this.data.addAsciiStringToData(value);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded hexadecimal string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: string - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  encodeInLVFromHexa = (value: string): ApduBuilder => {\n    this.data.encodeInLVFromHexa(value);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded buffer to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: Uint8Array - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  encodeInLVFromBuffer = (value: Uint8Array): ApduBuilder => {\n    this.data.encodeInLVFromBuffer(value);\n    return this;\n  };\n\n  /**\n   * Add a Length-Value encoded ascii string to the data field if it has enough remaining space\n   * Length-Value encoding is a way to encode data in a binary format with the first byte\n   * being the length of the data and the following bytes being the data itself\n   * @param value: string - The value to add to the data\n   * @returns {ApduBuilder} - Returns the current instance of ApduBuilder\n   */\n  encodeInLVFromAscii = (value: string): ApduBuilder => {\n    this.data.encodeInLVFromAscii(value);\n    return this;\n  };\n\n  /**\n   * Returns the remaining payload length\n   * @returns {number}\n   */\n  getAvailablePayloadLength = (): number =>\n    this.data.getAvailablePayloadLength();\n\n  /**\n   * Returns the current errors\n   * @returns {AppBuilderError[]} - Returns an array of errors\n   */\n  getErrors = (): AppBuilderError[] => this.data.getErrors();\n}\n", "import { bufferToHexaString, type HexaString } from \"@api/utils/HexaString\";\n\nexport type TaggedField = {\n  readonly tag: number;\n  readonly value: Uint8Array;\n  readonly tlv: Uint8Array;\n};\n\n/**\n * ByteArrayParser is a utility class to help parse a byte array.\n *\n * It provides methods to extract fields of different types from the buffer.\n *\n * @example\n * ```\n * const parser = new ByteArrayParser(buffer);\n * const targetId = parser.encodeToHexaString(parser.extractFieldByLength(4));\n * const seVersion = parser.encodeToString(parser.extractFieldLVEncoded());\n * ```\n */\nexport class ByteArrayParser {\n  private index: number = 0;\n\n  constructor(private readonly buffer: Uint8Array) {}\n\n  // ==========\n  // Public API\n  // ==========\n\n  /**\n   * Test if the length is greater than the response length\n   * @param length: number\n   * @returns {boolean} - Returns false if the length is greater than the response length\n   */\n  testMinimalLength(length: number): boolean {\n    return length <= this.buffer.length - this.index;\n  }\n\n  /**\n   * Extract a single byte from the response\n   * @returns {number | undefined} - Returns the byte extracted from the response\n   */\n  extract8BitUInt(): number | undefined {\n    if (this.outOfRange(1)) return;\n    return this.buffer[this.index++];\n  }\n\n  /**\n   * Extract a 16-bit unsigned integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 16-bit unsigned integer extracted from the response\n   */\n  extract16BitUInt(bigEndian: boolean = true): number | undefined {\n    const value = this.extractNumber(16n, false, bigEndian);\n    return value === undefined ? undefined : Number(value);\n  }\n\n  /**\n   * Extract a 16-bit signed integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 16-bit signed integer extracted from the response\n   */\n  extract16BitInt(bigEndian: boolean = true): number | undefined {\n    const value = this.extractNumber(16n, true, bigEndian);\n    return value === undefined ? undefined : Number(value);\n  }\n\n  /**\n   * Extract a 32-bit unsigned integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 32-bit unsigned integer extracted from the response\n   */\n  extract32BitUInt(bigEndian: boolean = true): number | undefined {\n    const value = this.extractNumber(32n, false, bigEndian);\n    return value === undefined ? undefined : Number(value);\n  }\n\n  /**\n   * Extract a 32-bit signed integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 32-bit signed integer extracted from the response\n   */\n  extract32BitInt(bigEndian: boolean = true): number | undefined {\n    const value = this.extractNumber(32n, true, bigEndian);\n    return value === undefined ? undefined : Number(value);\n  }\n\n  /**\n   * Extract a 64-bit unsigned integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 64-bit unsigned integer extracted from the response\n   */\n  extract64BitUInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(64n, false, bigEndian);\n  }\n\n  /**\n   * Extract a 64-bit signed integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 64-bit signed integer extracted from the response\n   */\n  extract64BitInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(64n, true, bigEndian);\n  }\n\n  /**\n   * Extract a 128-bit unsigned integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 128-bit unsigned integer extracted from the response\n   */\n  extract128BitUInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(128n, false, bigEndian);\n  }\n\n  /**\n   * Extract a 128-bit signed integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 128-bit signed integer extracted from the response\n   */\n  extract128BitInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(128n, true, bigEndian);\n  }\n\n  /**\n   * Extract a 256-bit unsigned integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 256-bit unsigned integer extracted from the response\n   */\n  extract256BitUInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(256n, false, bigEndian);\n  }\n\n  /**\n   * Extract a 256-bit signed integer from the response\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {number | undefined} - Returns the 256-bit signed integer extracted from the response\n   */\n  extract256BitInt(bigEndian: boolean = true): bigint | undefined {\n    return this.extractNumber(256n, true, bigEndian);\n  }\n\n  /**\n   * Extract a field of a specified length from the response\n   * @param length: number - The length of the field to extract\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldByLength(length: number): Uint8Array | undefined {\n    if (this.outOfRange(length)) return;\n    if (length === 0) return new Uint8Array();\n    const field = this.buffer.slice(this.index, this.index + length);\n    this.index += length;\n    return field;\n  }\n\n  /**\n   * Extract a field from the response that is length-value encoded\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldLVEncoded(): Uint8Array | undefined {\n    // extract Length field\n    const length = this.extract8BitUInt();\n    if (length === undefined) return;\n    else if (length === 0) return new Uint8Array();\n    const field = this.extractFieldByLength(length);\n    // if the field is inconsistent then roll back to the initial point\n    if (field === undefined) this.index--;\n    return field;\n  }\n\n  /**\n   * Extract a field from the response that is tag-length-value encoded\n   * @returns {TaggedField | undefined} - Returns the field extracted from the response\n   */\n  extractFieldTLVEncoded(): TaggedField | undefined {\n    if (this.outOfRange(2)) return;\n\n    const startIndex = this.index;\n    const tag = this.extract8BitUInt();\n    const value = this.extractFieldLVEncoded();\n\n    if (tag === undefined || value === undefined) {\n      this.index--;\n      return;\n    }\n    const endIndex = this.index;\n    return { tag, value, tlv: this.buffer.slice(startIndex, endIndex) };\n  }\n\n  /**\n   * Encode a value to a hexadecimal string\n   * @param value {Uint8Array} - The value to encode\n   * @param prefix {boolean} - Whether to add a prefix to the encoded value\n   * @returns {string} - The encoded value as a hexadecimal string\n   */\n  encodeToHexaString(value?: Uint8Array, prefix?: false): string;\n  encodeToHexaString(value?: Uint8Array, prefix?: true): HexaString;\n  encodeToHexaString(\n    value?: Uint8Array,\n    prefix: boolean = false,\n  ): HexaString | string {\n    if (value === undefined || value.length === 0) return \"\";\n    const result = bufferToHexaString(value);\n    return prefix ? result : result.slice(2);\n  }\n\n  /**\n   * Encode a value to an ASCII string\n   * @param value {Uint8Array} - The value to encode\n   * @returns {string} - The encoded value as an ASCII string\n   */\n  encodeToString(value?: Uint8Array): string {\n    let result = \"\";\n    let index = 0;\n\n    if (!value) return result;\n\n    while (index <= value.length) {\n      const item = value[index];\n      if (item) result += String.fromCharCode(item);\n      index++;\n    }\n\n    return result;\n  }\n\n  /**\n   * Get the current index of the parser\n   * @returns {number} - The current index of the parser\n   */\n  getCurrentIndex(): number {\n    return this.index;\n  }\n\n  /**\n   * Reset the index of the parser to 0\n   */\n  resetIndex() {\n    this.index = 0;\n  }\n\n  /**\n   * Get the remaining length of the response\n   * @returns {number} - The remaining length of the response\n   */\n  getUnparsedRemainingLength(): number {\n    return this.buffer.length - this.index;\n  }\n\n  // ===========\n  // Private API\n  // ===========\n\n  /**\n   * Check whether the expected length is out of range\n   * @param length: number\n   * @returns {boolean} - Returns true if the expected length is out of range\n   */\n  private outOfRange(length: number): boolean {\n    return this.index + length > this.buffer.length;\n  }\n\n  /**\n   * Extract a number from the buffer\n   * @param sizeInBits: bigint - The number size in bits, for example 16 for a uint16\n   * @param signed: boolean - True is the number can be signed and converted to two's compliment\n   * @param bigEndian: boolean - True to decode in big endian, false for little endian\n   * @returns {bigint | undefined} - Returns the number extracted from the buffer\n   */\n  private extractNumber(\n    sizeInBits: bigint,\n    signed: boolean,\n    bigEndian: boolean,\n  ): bigint | undefined {\n    // Check the range\n    const sizeInBytes: number = Number(sizeInBits) / 8;\n    if (this.outOfRange(sizeInBytes)) return;\n\n    // Compute the number\n    let value: bigint = 0n;\n    if (bigEndian) {\n      for (let i = 0; i < sizeInBytes; i++) {\n        value = (value << 8n) | BigInt(this.buffer[i + this.index]!);\n      }\n    } else {\n      for (let i = sizeInBytes - 1; i >= 0; i--) {\n        value = (value << 8n) | BigInt(this.buffer[i + this.index]!);\n      }\n    }\n\n    // Convert the value to two's complement if it is negative\n    // https://en.wikipedia.org/wiki/Two%27s_complement\n    if (signed) {\n      const limit = 1n << (sizeInBits - 1n);\n      if (value & limit) {\n        value -= limit << 1n;\n      }\n    }\n\n    this.index += sizeInBytes;\n    return value;\n  }\n}\n", "import { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type HexaString } from \"@api/utils/HexaString\";\n\nimport { ByteArrayParser } from \"./ByteArrayParser\";\n\nexport type TaggedField = {\n  readonly tag: number;\n  readonly value: Uint8Array;\n};\n\n/**\n * ApduParser is a utility class to help parse APDU responses.\n *\n * It provides methods to extract fields of different types from the response.\n *\n * @example\n * ```\n * const parser = new ApduParser(apduResponse);\n * const targetId = parser.encodeToHexaString(parser.extractFieldByLength(4));\n * const seVersion = parser.encodeToString(parser.extractFieldLVEncoded());\n * ```\n */\nexport class ApduParser {\n  private parser: ByteArrayParser;\n\n  constructor(response: ApduResponse) {\n    this.parser = new ByteArrayParser(response.data);\n  }\n\n  /**\n   * Test if the length is greater than the response length\n   * @param length: number\n   * @returns {boolean} - Returns false if the length is greater than the response length\n   */\n  testMinimalLength = (length: number): boolean =>\n    this.parser.testMinimalLength(length);\n\n  /**\n   * Extract a single byte from the response\n   * @returns {number | undefined} - Returns the byte extracted from the response\n   */\n  extract8BitUInt = (): number | undefined => this.parser.extract8BitUInt();\n\n  /**\n   * Extract a 16-bit unsigned integer (Big Endian coding) from the response\n   * @returns {number | undefined} - Returns the 16-bit unsigned integer extracted from the response\n   */\n  extract16BitUInt = (): number | undefined => this.parser.extract16BitUInt();\n\n  /**\n   * Extract a 32-bit unsigned integer (Big Endian coding) from the response\n   * @returns {number | undefined} - Returns the 32-bit unsigned integer extracted from the response\n   */\n  extract32BitUInt = (): number | undefined => this.parser.extract32BitUInt();\n\n  /**\n   * Extract a field of a specified length from the response\n   * @param length: number - The length of the field to extract\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldByLength = (length: number): Uint8Array | undefined =>\n    this.parser.extractFieldByLength(length);\n\n  /**\n   * Extract a field from the response that is length-value encoded\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldLVEncoded = (): Uint8Array | undefined =>\n    this.parser.extractFieldLVEncoded();\n\n  /**\n   * Extract a field from the response that is tag-length-value encoded\n   * @returns {TaggedField | undefined} - Returns the field extracted from the response\n   */\n  extractFieldTLVEncoded = (): TaggedField | undefined =>\n    this.parser.extractFieldTLVEncoded();\n\n  /**\n   * Encode a value to a hexadecimal string\n   * @param value {Uint8Array} - The value to encode\n   * @param prefix {boolean} - Whether to add a prefix to the encoded value\n   * @returns {string} - The encoded value as a hexadecimal string\n   */\n  encodeToHexaString(value?: Uint8Array, prefix?: false): string;\n  encodeToHexaString(value?: Uint8Array, prefix?: true): HexaString;\n  encodeToHexaString(\n    value?: Uint8Array,\n    prefix: boolean = false,\n  ): HexaString | string {\n    return prefix\n      ? this.parser.encodeToHexaString(value, true)\n      : this.parser.encodeToHexaString(value, false);\n  }\n\n  /**\n   * Encode a value to an ASCII string\n   * @param value {Uint8Array} - The value to encode\n   * @returns {string} - The encoded value as an ASCII string\n   */\n  encodeToString = (value?: Uint8Array): string =>\n    this.parser.encodeToString(value);\n\n  /**\n   * Get the remaining length of the response\n   * @returns {number} - The remaining length of the response\n   */\n  getUnparsedRemainingLength = (): number =>\n    this.parser.getUnparsedRemainingLength();\n}\n", "import { type DmkError } from \"@api/Error\";\n\nexport class InvalidStatusWordError implements DmkError {\n  readonly _tag = \"InvalidStatusWordError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Invalid status word.\");\n  }\n}\n\nexport class InvalidBatteryStatusTypeError implements DmkError {\n  readonly _tag = \"InvalidBatteryStatusTypeError\";\n  readonly originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Invalid battery status type.\");\n  }\n}\n\nexport class InvalidBatteryDataError implements DmkError {\n  readonly _tag = \"InvalidBatteryDataError\";\n  readonly originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Invalid battery data.\");\n  }\n}\n\nexport class InvalidBatteryFlagsError implements DmkError {\n  readonly _tag = \"InvalidBatteryFlagsError\";\n  readonly originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Invalid battery flags.\");\n  }\n}\n\nexport class InvalidResponseFormatError implements DmkError {\n  readonly _tag = \"InvalidResponseFormatError\";\n  readonly originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Invalid response format.\");\n  }\n}\n\nexport class InvalidGetFirmwareMetadataResponseError implements DmkError {\n  readonly _tag = \"InvalidGetFirmwareMetadataResponseError\";\n  readonly originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(\n      message ?? \"Invalid Firmware Metadata response error.\",\n    );\n  }\n}\n", "import {\n  type InvalidBatteryDataError,\n  type InvalidBatteryStatusTypeError,\n  type InvalidGetFirmwareMetadataResponseError,\n  type InvalidResponseFormatError,\n  type InvalidStatusWordError,\n} from \"@api/command/Errors\";\nimport { type GlobalCommandErrorStatusCode } from \"@api/command/utils/GlobalCommandError\";\nimport {\n  type DeviceExchangeError,\n  type UnknownDeviceExchangeError,\n} from \"@api/Error\";\n\nexport enum CommandResultStatus {\n  Error = \"ERROR\",\n  Success = \"SUCCESS\",\n}\nexport type CommandSuccessResult<Data> = {\n  status: CommandResultStatus.Success;\n  data: Data;\n};\nexport type CommandErrorResult<SpecificErrorCodes = void> = {\n  error:\n    | DeviceExchangeError<SpecificErrorCodes | GlobalCommandErrorStatusCode>\n    | InvalidBatteryDataError\n    | InvalidBatteryStatusTypeError\n    | InvalidResponseFormatError\n    | InvalidStatusWordError\n    | InvalidGetFirmwareMetadataResponseError\n    | UnknownDeviceExchangeError;\n  status: CommandResultStatus.Error;\n};\nexport type CommandResult<Data, SpecificErrorCodes = void> =\n  | CommandSuccessResult<Data>\n  | CommandErrorResult<SpecificErrorCodes>;\n\nexport function CommandResultFactory<Data, SpecificErrorCodes = void>({\n  data,\n  error,\n}:\n  | { data: Data; error?: undefined }\n  | {\n      data?: undefined;\n      error:\n        | DeviceExchangeError<SpecificErrorCodes>\n        | InvalidBatteryDataError\n        | InvalidBatteryStatusTypeError\n        | InvalidResponseFormatError\n        | InvalidStatusWordError\n        | InvalidGetFirmwareMetadataResponseError\n        | UnknownDeviceExchangeError;\n    }): CommandResult<Data, SpecificErrorCodes> {\n  if (error) {\n    return {\n      status: CommandResultStatus.Error,\n      error,\n    };\n  }\n  return {\n    status: CommandResultStatus.Success,\n    data,\n  };\n}\n\nexport function isSuccessCommandResult<Data, StatusCode>(\n  result: CommandResult<Data, StatusCode>,\n): result is CommandSuccessResult<Data> {\n  return result.status === CommandResultStatus.Success;\n}\n", "import { type ApduResponse } from \"@api/device-session/ApduResponse\";\n\nexport class CommandUtils {\n  static isValidStatusCode(statusCode: Uint8Array) {\n    return statusCode.length === 2;\n  }\n\n  static isSuccessResponse({ statusCode }: ApduResponse) {\n    if (!CommandUtils.isValidStatusCode(statusCode)) {\n      return false;\n    }\n\n    return statusCode[0] === 0x90 && statusCode[1] === 0x00;\n  }\n\n  static isLockedDeviceResponse({ statusCode }: ApduResponse) {\n    if (!CommandUtils.isValidStatusCode(statusCode)) {\n      return false;\n    }\n\n    return (\n      (statusCode[0] === 0x55 && statusCode[1] === 0x15) ||\n      (statusCode[0] === 0x69 && statusCode[1] === 0x82) ||\n      (statusCode[0] === 0x53 && statusCode[1] === 0x03)\n    );\n  }\n\n  static isRefusedByUser({ statusCode }: ApduResponse) {\n    if (!CommandUtils.isValidStatusCode(statusCode)) {\n      return false;\n    }\n\n    return (\n      (statusCode[0] === 0x55 && statusCode[1] === 0x01) ||\n      (statusCode[0] === 0x69 && statusCode[1] === 0x85)\n    );\n  }\n\n  static isAppAlreadyInstalled({ statusCode }: ApduResponse) {\n    if (!CommandUtils.isValidStatusCode(statusCode)) {\n      return false;\n    }\n\n    return (\n      (statusCode[0] === 0x6a && statusCode[1] === 0x80) ||\n      (statusCode[0] === 0x6a && statusCode[1] === 0x81) ||\n      (statusCode[0] === 0x6a && statusCode[1] === 0x8e) ||\n      (statusCode[0] === 0x6a && statusCode[1] === 0x8f)\n    );\n  }\n\n  static isOutOfMemory({ statusCode }: ApduResponse) {\n    if (!CommandUtils.isValidStatusCode(statusCode)) {\n      return false;\n    }\n\n    return (\n      (statusCode[0] === 0x6a && statusCode[1] === 0x84) ||\n      (statusCode[0] === 0x6a && statusCode[1] === 0x85) ||\n      (statusCode[0] === 0x51 && statusCode[1] === 0x02) ||\n      (statusCode[0] === 0x51 && statusCode[1] === 0x03)\n    );\n  }\n\n  static isApduThatTriggersDisconnection(apdu: Uint8Array) {\n    /**\n     * Map of known APDUs that trigger a disconnection.\n     */\n    const apduMap = new Map();\n    apduMap.set(\"openApp\", new Uint8Array([0xe0, 0xd8, 0x00, 0x00]));\n    apduMap.set(\"closeApp\", new Uint8Array([0xb0, 0xa7, 0x00, 0x00]));\n    // TODO: add more APDUs that trigger a disconnection (e.g firmware flashing ?)\n\n    // check if apdu first 4 UintArray is included in apduMap\n    return Array.from(apduMap.values()).some((value: Uint8Array) => {\n      for (let i = 0; i < 4; i++) {\n        if (value[i] !== apdu[i]) {\n          return false;\n        }\n      }\n      return true;\n    });\n  }\n}\n", "export interface DmkError {\n  readonly _tag: string;\n  readonly originalError?: unknown;\n  message?: string;\n}\n\nexport type DeviceExchangeErrorArgs<SpecificErrorCodes> = {\n  tag: string;\n  originalError?: unknown;\n  errorCode: SpecificErrorCodes;\n  message: string;\n};\n\nexport type CommandErrorArgs<SpecificErrorCodes> = Omit<\n  DeviceExchangeErrorArgs<SpecificErrorCodes>,\n  \"tag\"\n>;\n\nexport abstract class DeviceExchangeError<SpecificErrorCodes = void> {\n  readonly _tag: string;\n  readonly originalError?: unknown;\n  readonly errorCode: SpecificErrorCodes;\n  readonly message: string;\n\n  protected constructor({\n    tag,\n    errorCode,\n    originalError,\n    message,\n  }: DeviceExchangeErrorArgs<SpecificErrorCodes>) {\n    this._tag = tag;\n    this.originalError = originalError;\n    this.errorCode = errorCode;\n    this.message = message ?? \"An error occured during device exchange.\";\n  }\n}\n\nexport class UnknownDeviceExchangeError implements DmkError {\n  readonly _tag = \"UnknownDeviceExchangeError\";\n  readonly originalError?: unknown;\n  readonly message: string;\n\n  constructor(originalError?: unknown) {\n    this.originalError = originalError;\n    this.message = \"Unexpected device exchange error happened.\";\n  }\n}\n\nexport class DeviceBusyError implements DmkError {\n  readonly _tag = \"DeviceBusyError\";\n  originalError?: Error;\n\n  constructor(originalError?: Error) {\n    this.originalError =\n      originalError ?? new Error(\"Device is busy, please try again later\");\n  }\n}\n", "import { type DeviceExchangeErrorArgs } from \"@api/Error\";\n\n/**\n * CommandErrors dictionary utility type\n */\nexport type CommandErrors<SpecificErrorCodes extends string> = Record<\n  SpecificErrorCodes,\n  Pick<DeviceExchangeErrorArgs<SpecificErrorCodes>, \"message\"> &\n    Partial<Pick<DeviceExchangeErrorArgs<SpecificErrorCodes>, \"tag\">>\n>;\n\n/**\n * Typeguard to check if an error status code is handled\n *\n * @param errorCode\n * @param errors\n */\nexport const isCommandErrorCode = <SpecificErrorCodes extends string>(\n  errorCode: string,\n  errors: CommandErrors<SpecificErrorCodes>,\n): errorCode is SpecificErrorCodes => Object.keys(errors).includes(errorCode);\n", "import { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport {\n  type CommandErrorArgs,\n  DeviceExchangeError,\n  UnknownDeviceExchangeError,\n} from \"@api/Error\";\n\nimport { type CommandErrors, isCommandErrorCode } from \"./CommandErrors\";\n\n/**\n * Status word list of global errors that any command could result\n */\nexport type GlobalCommandErrorStatusCode =\n  | \"5515\"\n  | \"5501\"\n  | \"5502\"\n  | \"5223\"\n  | \"6e00\"\n  | \"6d00\";\n\n/**\n * Global command error class\n */\nexport class GlobalCommandError extends DeviceExchangeError<GlobalCommandErrorStatusCode> {\n  constructor(args: CommandErrorArgs<GlobalCommandErrorStatusCode>) {\n    super({ tag: \"GlobalCommandError\", ...args });\n  }\n}\n\n/**\n * Global errors dictionary that links a global status code to an error message\n */\nexport const GLOBAL_ERRORS: CommandErrors<GlobalCommandErrorStatusCode> = {\n  \"5515\": { message: \"Device is locked.\", tag: \"DeviceLockedError\" },\n  \"5501\": { message: \"Action refused on device.\", tag: \"ActionRefusedError\" },\n  \"5502\": { message: \"Pin is not set\", tag: \"PinNotSetError\" },\n  \"5223\": { message: \"Device internal error\", tag: \"DeviceInternalError\" },\n  \"6e00\": { message: \"CLA not supported\", tag: \"DeviceInternalError\" },\n  \"6d00\": { message: \"INS not supported\", tag: \"DeviceInternalError\" },\n};\n\n/**\n * Global error handler utility class\n */\nexport class GlobalCommandErrorHandler {\n  /**\n   * Static method to get a handled GlobalCommandError or an unhandled DmkError from an apdu response\n   * @param apduResponse\n   */\n  static handle(\n    apduResponse: ApduResponse,\n  ): GlobalCommandError | UnknownDeviceExchangeError {\n    const parser = new ApduParser(apduResponse);\n    const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n    if (isCommandErrorCode(errorCode, GLOBAL_ERRORS)) {\n      return new GlobalCommandError({ ...GLOBAL_ERRORS[errorCode], errorCode });\n    }\n    return new UnknownDeviceExchangeError({\n      message: \"UnknownError\",\n      errorCode,\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { type Command } from \"@api/command/Command\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\n\nexport type CloseAppCommandResult = CommandResult<void>;\n\n/**\n * The command to close a runnint application on the device.\n */\nexport class CloseAppCommand implements Command<void> {\n  readonly name = \"closeApp\";\n  readonly args = undefined;\n\n  readonly triggersDisconnection = true;\n\n  getApdu(): Apdu {\n    const closeAppApduArgs: ApduBuilderArgs = {\n      cla: 0xb0,\n      ins: 0xa7,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(closeAppApduArgs).build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): CommandResult<void> {\n    if (CommandUtils.isSuccessResponse(apduResponse)) {\n      return CommandResultFactory({\n        data: undefined,\n      });\n    }\n    return CommandResultFactory({\n      error: GlobalCommandErrorHandler.handle(apduResponse),\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport { InvalidResponseFormatError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\n\nexport type GetAppAndVersionResponse = {\n  /**\n   * The name of the application currently running on the device.\n   */\n  readonly name: string;\n  /**\n   * The version of the application currently running on the device.\n   */\n  readonly version: string;\n  /**\n   * Flags that are used to provide additional information about the application.\n   */\n  readonly flags?: number | Uint8Array;\n};\n\nexport type GetAppAndVersionCommandResult =\n  CommandResult<GetAppAndVersionResponse>;\n\n/**\n * Command to get information about the application currently running on the\n * device.\n */\nexport class GetAppAndVersionCommand\n  implements Command<GetAppAndVersionResponse>\n{\n  readonly name = \"getAppAndVersion\";\n  readonly args = undefined;\n\n  getApdu(): Apdu {\n    const getAppAndVersionApduArgs: ApduBuilderArgs = {\n      cla: 0xb0,\n      ins: 0x01,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(getAppAndVersionApduArgs).build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): GetAppAndVersionCommandResult {\n    if (!CommandUtils.isSuccessResponse(apduResponse)) {\n      return CommandResultFactory({\n        error: GlobalCommandErrorHandler.handle(apduResponse),\n      });\n    }\n    const parser = new ApduParser(apduResponse);\n\n    if (parser.extract8BitUInt() !== 1) {\n      return CommandResultFactory({\n        error: new InvalidResponseFormatError(\n          \"getAppAndVersion: format not supported\",\n        ),\n      });\n    }\n\n    const name = parser.encodeToString(parser.extractFieldLVEncoded());\n    const version = parser.encodeToString(parser.extractFieldLVEncoded());\n\n    if (parser.getUnparsedRemainingLength() === 0) {\n      return CommandResultFactory({\n        data: { name, version },\n      });\n    }\n\n    const flags = parser.extractFieldLVEncoded();\n    return CommandResultFactory({\n      data: { name, version, flags },\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport {\n  InvalidBatteryDataError,\n  InvalidBatteryStatusTypeError,\n} from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\n\n/**\n * The type of battery information to retrieve.\n */\nexport enum BatteryStatusType {\n  /**\n   * The command response will be the battery percentage.\n   */\n  BATTERY_PERCENTAGE = 0x00,\n  /**\n   * The command response will be the battery voltage in mV.\n   */\n  BATTERY_VOLTAGE = 0x01,\n  /**\n   * The command response will be the battery temperature in degree celsius\n   */\n  BATTERY_TEMPERATURE = 0x02,\n  /**\n   * The command response will be the battery current in mA.\n   */\n  BATTERY_CURRENT = 0x03,\n  /**\n   * The command response will be the battery status (cf. `BatteryStatusFlags`)\n   */\n  BATTERY_FLAGS = 0x04,\n}\n\nexport enum ChargingMode {\n  NONE = 0x00,\n  USB = 0x01,\n  QI = 0x02,\n}\n\nenum FlagMasks {\n  CHARGING = 0x00000001,\n  USB = 0x00000002,\n  USB_POWERED = 0x00000008,\n  BLE = 0x00000004,\n  ISSUE_BATTERY = 0x00000080,\n  ISSUE_CHARGING = 0x00000010,\n  ISSUE_TEMPERATURE = 0x00000020,\n}\n\nexport type BatteryStatusFlags = {\n  readonly charging: ChargingMode;\n  readonly issueCharging: boolean;\n  readonly issueTemperature: boolean;\n  readonly issueBattery: boolean;\n};\n\n/**\n * The response type depends on the `statusType` parameter sent with the command,\n * cf. `BatteryStatusType`.\n */\nexport type GetBatteryStatusResponse = number | BatteryStatusFlags;\n\nexport type GetBatteryStatusArgs = {\n  readonly statusType: BatteryStatusType;\n};\n\n/**\n * Command to get the battery status of the device.\n * The parameter statusType defines the type of information to retrieve, cf.\n * `BatteryStatusType`.\n *\n * WARNING: this command should not be sent within a logic of polling as it is\n * going to decrease the overall performance of the communication with the device.\n */\nexport class GetBatteryStatusCommand\n  implements Command<GetBatteryStatusResponse, GetBatteryStatusArgs>\n{\n  readonly name = \"getBatteryStatus\";\n  readonly args: GetBatteryStatusArgs;\n\n  constructor(args: GetBatteryStatusArgs) {\n    this.args = args;\n  }\n\n  getApdu(): Apdu {\n    const getBatteryStatusArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: 0x10,\n      p1: 0x00,\n      p2: this.args.statusType,\n    };\n    return new ApduBuilder(getBatteryStatusArgs).build();\n  }\n\n  parseResponse(\n    apduResponse: ApduResponse,\n  ): CommandResult<GetBatteryStatusResponse> {\n    const parser = new ApduParser(apduResponse);\n\n    switch (this.args.statusType) {\n      case BatteryStatusType.BATTERY_PERCENTAGE: {\n        const percentage = parser.extract8BitUInt();\n        if (percentage === undefined) {\n          return CommandResultFactory({\n            error: new InvalidBatteryDataError(\"Cannot parse APDU response\"),\n          });\n        }\n        return CommandResultFactory({\n          data: percentage > 100 ? -1 : percentage,\n        });\n      }\n      case BatteryStatusType.BATTERY_VOLTAGE: {\n        const data = parser.extract16BitUInt();\n        if (data === undefined) {\n          return CommandResultFactory({\n            error: new InvalidBatteryDataError(\"Cannot parse APDU response\"),\n          });\n        }\n        return CommandResultFactory({\n          data,\n        });\n      }\n      case BatteryStatusType.BATTERY_TEMPERATURE:\n      case BatteryStatusType.BATTERY_CURRENT: {\n        const data = parser.extract8BitUInt();\n        if (data === undefined) {\n          return CommandResultFactory({\n            error: new InvalidBatteryDataError(\"Cannot parse APDU response\"),\n          });\n        }\n        return CommandResultFactory({\n          data: (data << 24) >> 24,\n        });\n      }\n      case BatteryStatusType.BATTERY_FLAGS: {\n        const flags = parser.extract32BitUInt();\n        if (flags === undefined) {\n          return CommandResultFactory({\n            error: new InvalidBatteryDataError(\"Cannot parse APDU response\"),\n          });\n        }\n        const chargingUSB = !!(flags & FlagMasks.USB_POWERED);\n        const chargingQi = !chargingUSB && !!(flags & FlagMasks.CHARGING);\n        return CommandResultFactory({\n          data: {\n            charging: chargingQi\n              ? ChargingMode.QI\n              : chargingUSB\n                ? ChargingMode.USB\n                : ChargingMode.NONE,\n            issueCharging: !!(flags & FlagMasks.ISSUE_CHARGING),\n            issueTemperature: !!(flags & FlagMasks.ISSUE_TEMPERATURE),\n            issueBattery: !!(flags & FlagMasks.ISSUE_BATTERY),\n          },\n        });\n      }\n      default:\n        return CommandResultFactory({\n          error: new InvalidBatteryStatusTypeError(\n            \"One or some case(s) not covered\",\n          ),\n        });\n    }\n  }\n}\n", "import { coerce, gte } from \"semver\";\n\nimport { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport { InvalidStatusWordError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { DeviceModelId } from \"@api/device/DeviceModel\";\nimport {\n  type DeviceGeneralState,\n  type EndorsementInformation,\n  type OnboardingStatus,\n  type WordsInformation,\n} from \"@api/device/SecureElementFlags\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\n\nimport { SecureElementFlagsParser } from \"./SecureElementFlagsParser\";\n\n/**\n * Response of the GetOsVersionCommand.\n */\nexport type GetOsVersionResponse = {\n  /**\n   * Indicated if the device is running in bootloader mode.\n   * It can happens during a firmware update process.\n   */\n  readonly isBootloader: boolean;\n\n  /**\n   * Indicated if the device firmware is an OS Updater (OSU).\n   * It can happens during a firmware update process.\n   */\n  readonly isOsu: boolean;\n\n  /**\n   * Target identifier.\n   */\n  readonly targetId: number;\n\n  /**\n   * Target identifier of the secure element.\n   * Not always available when the device is in bootloader mode.\n   */\n  readonly seTargetId: number | undefined;\n\n  /**\n   * Target identifier of the microcontroller unit (MCU).\n   * Only available when the device is in bootloader mode.\n   */\n  readonly mcuTargetId: number | undefined;\n\n  /**\n   * Version of BOLOS on the secure element (SE).\n   * {@link https://developers.ledger.com/docs/device-app/architecture/bolos/hardware-architecture | Hardware Architecture}\n   */\n  readonly seVersion: string;\n\n  /**\n   * Secure element flags.\n   * Used to represent the current state of the secure element.\n   */\n  readonly seFlags: Uint8Array;\n\n  /**\n   * Version of the microcontroller unit (MCU) SEPH, which is the SE-MCU link protocol.\n   * {@link https://developers.ledger.com/docs/device-app/architecture/bolos/hardware-architecture | Hardware Architecture}\n   */\n  readonly mcuSephVersion: string;\n\n  /**\n   * Version of the MCU bootloader.\n   */\n  readonly mcuBootloaderVersion: string;\n\n  /**\n   * Hardware revision version.\n   * Only available for Ledger Nano X in which case it's \"00\" or \"01\".\n   */\n  readonly hwVersion: string;\n\n  /**\n   * Identifier of the installed language pack.\n   * Can be one of:\n   * - \"00\": English\n   * - \"01\": French\n   * - \"02\": Spanish\n   * - \"03\": Portuguese\n   * - \"04\": German\n   * - \"05\": Russian\n   * - \"06\": Turkish\n   */\n  readonly langId: number | undefined;\n\n  /**\n   * State for Ledger Recover. // [SHOULD] Add more information about this field\n   */\n  readonly recoverState: number | undefined;\n\n  /**\n   * The parsed secure element flags.\n   */\n  readonly secureElementFlags: DeviceGeneralState &\n    EndorsementInformation &\n    WordsInformation &\n    OnboardingStatus;\n};\n\nexport type GetOsVersionCommandResult = CommandResult<GetOsVersionResponse>;\n\n/**\n * Command to get information about the device firmware.\n */\nexport class GetOsVersionCommand implements Command<GetOsVersionResponse> {\n  readonly name = \"getOsVersion\";\n  readonly args = undefined;\n\n  getApdu(): Apdu {\n    const getOsVersionApduArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: 0x01,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(getOsVersionApduArgs).build();\n  }\n\n  parseResponse(\n    apduResponse: ApduResponse,\n    deviceModelId: DeviceModelId,\n  ): GetOsVersionCommandResult {\n    if (!CommandUtils.isSuccessResponse(apduResponse)) {\n      return CommandResultFactory({\n        error: GlobalCommandErrorHandler.handle(apduResponse),\n      });\n    }\n    const parser = new ApduParser(apduResponse);\n    const targetId = parser.extract32BitUInt();\n    if (targetId === undefined) {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Missing target ID in OS version\"),\n      });\n    }\n\n    let version = parser.encodeToString(parser.extractFieldLVEncoded());\n    let seFlags = parser.extractFieldLVEncoded() ?? new Uint8Array(0);\n    const seFlagsParser = new SecureElementFlagsParser(seFlags);\n    // This is the parsed secure element flags.\n    const secureElementFlags = { ...seFlagsParser.generalDeviceState() };\n\n    // Handle old firmwares with no version\n    if (!version) {\n      version = \"0.0.0\";\n      seFlags = new Uint8Array();\n    }\n\n    const isBootloader = (targetId & 0xf0000000) !== 0x30000000;\n    const isOsu = version.includes(\"-osu\");\n    let seVersion: string = \"\";\n    let mcuSephVersion: string = \"\";\n    let mcuBootloaderVersion: string = \"\";\n    let hwVersion: string = \"\";\n    let mcuTargetId: number | undefined = undefined;\n    let seTargetId: number | undefined = undefined;\n    let langId: number | undefined = undefined;\n    let recoverState: number | undefined = undefined;\n\n    if (isBootloader) {\n      mcuBootloaderVersion = version;\n      mcuTargetId = targetId;\n\n      const seData = parser.extractFieldLVEncoded();\n      if (seData) {\n        if (seData.length >= 5) {\n          // It means it's a version followed by the seTargetId\n          seVersion = parser.encodeToString(seData);\n          seTargetId = parseInt(\n            parser.encodeToHexaString(parser.extractFieldLVEncoded()),\n            16,\n          );\n        } else {\n          // It's the seTargetId\n          seTargetId = parseInt(parser.encodeToHexaString(seData), 16);\n        }\n      }\n    } else {\n      seVersion = version;\n      seTargetId = targetId;\n\n      mcuSephVersion = parser.encodeToString(parser.extractFieldLVEncoded());\n\n      if (this.isBootloaderVersionSupported(seVersion, deviceModelId)) {\n        mcuBootloaderVersion = parser.encodeToString(\n          parser.extractFieldLVEncoded(),\n        );\n      }\n\n      if (this.isHardwareVersionSupported(seVersion, deviceModelId)) {\n        hwVersion = parser.encodeToHexaString(parser.extractFieldLVEncoded());\n      } else {\n        hwVersion = \"00\";\n      }\n\n      if (this.isLocalizationSupported(seVersion, deviceModelId)) {\n        const langIdBuffer = parser.extractFieldLVEncoded();\n        if (langIdBuffer !== undefined) {\n          langId = parseInt(parser.encodeToHexaString(langIdBuffer), 16);\n        }\n      }\n\n      if (this.isRecoverSupported(seVersion, deviceModelId)) {\n        const recoverStateBuffer = parser.extractFieldLVEncoded();\n        if (recoverStateBuffer !== undefined) {\n          recoverState = parseInt(\n            parser.encodeToHexaString(recoverStateBuffer),\n            16,\n          );\n        }\n      }\n    }\n\n    return CommandResultFactory({\n      data: {\n        isBootloader,\n        isOsu,\n        targetId,\n        seTargetId,\n        mcuTargetId,\n        seVersion,\n        seFlags,\n        mcuSephVersion,\n        mcuBootloaderVersion,\n        hwVersion,\n        langId,\n        recoverState,\n        secureElementFlags,\n      },\n    });\n  }\n\n  private isBootloaderVersionSupported(\n    seVersion: string,\n    deviceModelId: DeviceModelId,\n  ): boolean {\n    const version = coerce(seVersion) ?? \"\";\n    switch (deviceModelId) {\n      case DeviceModelId.NANO_S:\n      case DeviceModelId.NANO_X:\n        return gte(version, \"2.0.0\");\n      default:\n        return true;\n    }\n  }\n\n  private isHardwareVersionSupported(\n    seVersion: string,\n    deviceModelId: DeviceModelId,\n  ): boolean {\n    const version = coerce(seVersion) ?? \"\";\n    switch (deviceModelId) {\n      case DeviceModelId.NANO_X:\n        return gte(version, \"2.0.0\");\n      default:\n        return false;\n    }\n  }\n\n  private isLocalizationSupported(\n    seVersion: string,\n    deviceModelId: DeviceModelId,\n  ): boolean {\n    const version = coerce(seVersion) ?? \"\";\n    switch (deviceModelId) {\n      case DeviceModelId.NANO_S:\n        return false;\n      case DeviceModelId.NANO_SP:\n        return gte(version, \"1.1.0\");\n      case DeviceModelId.NANO_X:\n        return gte(version, \"2.1.0\");\n      default:\n        return true;\n    }\n  }\n\n  private isRecoverSupported(\n    seVersion: string,\n    deviceModelId: DeviceModelId,\n  ): boolean {\n    const version = coerce(seVersion) ?? \"\";\n    switch (deviceModelId) {\n      case DeviceModelId.NANO_S:\n        return false;\n      case DeviceModelId.NANO_SP:\n        return gte(version, \"1.1.2\");\n      case DeviceModelId.NANO_X:\n        return gte(version, \"2.2.3\");\n      case DeviceModelId.STAX:\n        return gte(version, \"1.4.0\");\n      case DeviceModelId.FLEX:\n        return gte(version, \"1.0.1\");\n      default:\n        return true;\n    }\n  }\n}\n", "export enum DeviceModelId {\n  NANO_S = \"nanoS\",\n  NANO_SP = \"nanoSP\",\n  NANO_X = \"nanoX\",\n  STAX = \"stax\",\n  FLEX = \"flex\",\n  APEX = \"apexp\",\n}\n\n/**\n * Unique identifier for a device.\n *\n * NB: This identifier is generated at runtime and is not persisted. It cannot\n * be used to identify a device across sessions.\n * There is in fact no way to identify a device across sessions, which is a\n * privacy feature of Ledger devices.\n */\nexport type DeviceId = string;\n\nexport type DeviceModelArgs = {\n  readonly id: DeviceId;\n  readonly model: DeviceModelId;\n  readonly name: string;\n};\n\nexport class DeviceModel {\n  public readonly id: DeviceId;\n  public readonly model: DeviceModelId;\n  public readonly name: string;\n\n  constructor({ id, model, name }: DeviceModelArgs) {\n    this.id = id;\n    this.model = model;\n    this.name = name;\n  }\n}\n\nexport const LEDGER_VENDOR_ID = 0x2c97;\n", "import {\n  type DeviceGeneralState,\n  type EndorsementInformation,\n  type OnboardingStatus,\n  type WordsInformation,\n} from \"@api/device/SecureElementFlags\";\n\n/**\n * Secure element flags parser class.\n */\nexport class SecureElementFlagsParser {\n  /**\n   * Creates an instance of SecureElementFlags parser.\n   * @param seFlags - The secure element flags as an Uint8Array, it comes from the response of the GetOsVersionCommand.\n   */\n  constructor(private readonly seFlags: Uint8Array) {\n    if (this.seFlags.length !== 4) {\n      throw new Error(\"Invalid secure element flags length\");\n    }\n  }\n\n  /**\n   * Retrieves the general device state based on the secure element flags, which is the first byte of the flags.\n   * @returns {DeviceGeneralState}\n   */\n  generalDeviceState(): DeviceGeneralState {\n    const firstByte = this.seFlags[0] ?? 0x00;\n\n    return {\n      isPinValidated: this._checkNthBitInByte(firstByte, 1),\n      hasMcuSerialNumber: this._checkNthBitInByte(firstByte, 2),\n      hasValidCertificate: this._checkNthBitInByte(firstByte, 3),\n      isCustomAuthorityConnectionAllowed: this._checkNthBitInByte(firstByte, 4),\n      isSecureConnectionAllowed: this._checkNthBitInByte(firstByte, 5),\n      isOnboarded: this._checkNthBitInByte(firstByte, 6),\n      isMcuCodeSigned: this._checkNthBitInByte(firstByte, 7),\n      isInRecoveryMode: this._checkNthBitInByte(firstByte, 8),\n    };\n  }\n\n  /**\n   * Retrieves the endorsement information based on the secure element flags, which is the second byte of the flags.\n   * @returns {EndorsementInformation}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  endorsementInformation(): EndorsementInformation {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Retrieves the words information based on the secure element flags, which is the third byte of the flags.\n   * @returns {WordsInformation}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  wordsInformation(): WordsInformation {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Retrieves the onboarding status based on the secure element flags, which is the fourth byte of the flags.\n   * @returns {OnboardingStatus}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  onboardingStatus(): OnboardingStatus {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Check the nth bit in a byte, returns true if the bit is set, false otherwise.\n   * @param byte - The byte to check.\n   * @param n - The bit number to check.\n   * @returns {boolean} - True if the bit is set, false otherwise.\n   */\n  _checkNthBitInByte(byte: number, n: number): boolean {\n    return ((byte >> (8 - n)) & 1) === 1;\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport {\n  type CommandErrors,\n  isCommandErrorCode,\n} from \"@api/command/utils/CommandErrors\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type CommandErrorArgs, DeviceExchangeError } from \"@api/Error\";\n\nexport type AppResponse = {\n  readonly appEntryLength: number;\n  readonly appSizeInBlocks: number;\n  readonly appCodeHash: string;\n  readonly appFullHash: string;\n  readonly appName: string;\n};\n\nexport type ListAppsResponse = AppResponse[];\n\nexport type ListAppsArgs = {\n  readonly isContinue: boolean;\n};\n\nexport type ListAppsErrorCodes = \"6624\";\n\nconst LIST_APP_ERRORS: CommandErrors<ListAppsErrorCodes> = {\n  \"6624\": { message: \"Invalid state (List applications command must be sent)\" },\n};\n\nexport type ListAppsCommandResult = CommandResult<\n  ListAppsResponse,\n  ListAppsErrorCodes\n>;\n\nexport class ListAppsCommandError extends DeviceExchangeError<ListAppsErrorCodes> {\n  constructor({ message, errorCode }: CommandErrorArgs<ListAppsErrorCodes>) {\n    super({ message, errorCode, tag: \"ListAppsCommandError\" });\n  }\n}\n\nexport class ListAppsCommand\n  implements Command<ListAppsResponse, ListAppsArgs, ListAppsErrorCodes>\n{\n  readonly name = \"listApps\";\n  readonly args: ListAppsArgs;\n\n  constructor(args = { isContinue: false }) {\n    this.args = args;\n  }\n\n  getApdu(): Apdu {\n    const listAppApduArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: this.args.isContinue ? 0xdf : 0xde,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(listAppApduArgs).build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): ListAppsCommandResult {\n    const res = [];\n    const parser = new ApduParser(apduResponse);\n\n    if (!CommandUtils.isSuccessResponse(apduResponse)) {\n      const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n      if (isCommandErrorCode(errorCode, LIST_APP_ERRORS)) {\n        return CommandResultFactory({\n          error: new ListAppsCommandError({\n            ...LIST_APP_ERRORS[errorCode],\n            errorCode,\n          }),\n        });\n      }\n      return CommandResultFactory({\n        error: GlobalCommandErrorHandler.handle(apduResponse),\n      });\n    }\n\n    if (apduResponse.data.length <= 0) {\n      return CommandResultFactory({\n        data: [],\n      });\n    }\n\n    // [NOTE] version of parsing, not used for now, skipping 1 byte\n    parser.extract8BitUInt()!;\n\n    while (parser.getUnparsedRemainingLength() > 0) {\n      const appEntryLength = parser.extract8BitUInt()!;\n      const appSizeInBlocks = parser.extract16BitUInt()!;\n      parser.extract16BitUInt()!; // Skip 2 bytes (flags, missing in doc for now)\n      const appCodeHash = parser.encodeToHexaString(\n        parser.extractFieldByLength(0x20), // 32 bytes\n      );\n      const appFullHash = parser.encodeToHexaString(\n        parser.extractFieldByLength(0x20), // 32 bytes\n      );\n\n      const appName = parser.encodeToString(parser.extractFieldLVEncoded());\n\n      res.push({\n        appEntryLength,\n        appSizeInBlocks,\n        appCodeHash,\n        appFullHash,\n        appName,\n      });\n    }\n\n    return CommandResultFactory({\n      data: res,\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport {\n  type CommandErrors,\n  isCommandErrorCode,\n} from \"@api/command/utils/CommandErrors\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { DeviceExchangeError } from \"@api/Error\";\nimport { type Command, type CommandErrorArgs } from \"@api/types\";\n\nexport type LoadCertificateArgs = {\n  readonly keyUsage: number;\n  readonly certificate: Uint8Array;\n};\n\nexport type LoadCertificateErrorCodes =\n  | \"422f\"\n  | \"4230\"\n  | \"4231\"\n  | \"4232\"\n  | \"4233\"\n  | \"4234\"\n  | \"4235\"\n  | \"4236\"\n  | \"4237\"\n  | \"4238\"\n  | \"4239\"\n  | \"422d\"\n  | \"3301\"\n  | \"422e\"\n  | \"5720\"\n  | \"4118\"\n  | \"ffff\";\n\nconst LOAD_CERTIFICATE_ERRORS: CommandErrors<LoadCertificateErrorCodes> = {\n  \"422f\": { message: \"Incorrect structure type\" },\n  \"4230\": { message: \"Incorrect certificate version\" },\n  \"4231\": { message: \"Incorrect certificate validity\" },\n  \"4232\": { message: \"Incorrect certificate validity index\" },\n  \"4233\": { message: \"Unknown signer key ID\" },\n  \"4234\": { message: \"Unknown signature algorithm\" },\n  \"4235\": { message: \"Unknown public key ID\" },\n  \"4236\": { message: \"Unknown public key usage\" },\n  \"4237\": { message: \"Incorrect elliptic curve ID\" },\n  \"4238\": {\n    message: \"Incorrect signature algorithm associated to the public key\",\n  },\n  \"4239\": { message: \"Unknown target device\" },\n  \"422d\": { message: \"Unknown certificate tag\" },\n  \"3301\": { message: \"Failed to hash data\" },\n  \"422e\": {\n    message: \"expected_key_usage doesn't match certificate key usage\",\n  },\n  \"5720\": { message: \"Failed to verify signature\" },\n  \"4118\": {\n    message: \"trusted_name buffer is too small to contain the trusted name\",\n  },\n  ffff: { message: \"Cryptography-related error\" },\n};\n\nexport class LoadCertificateCommandError extends DeviceExchangeError<LoadCertificateErrorCodes> {\n  constructor({\n    message,\n    errorCode,\n  }: CommandErrorArgs<LoadCertificateErrorCodes>) {\n    super({ tag: \"ProvidePkiCertificateCommandError\", message, errorCode });\n  }\n}\n\nexport type LoadCertificateCommandResult = CommandResult<\n  void,\n  LoadCertificateErrorCodes\n>;\n\n/**\n * The command to load a certificate on the device.\n */\nexport class LoadCertificateCommand\n  implements Command<void, LoadCertificateArgs, LoadCertificateErrorCodes>\n{\n  readonly name = \"loadCertificate\";\n  readonly args: LoadCertificateArgs;\n  readonly triggersDisconnection = false;\n\n  constructor(args: LoadCertificateArgs) {\n    this.args = args;\n  }\n\n  getApdu(): Apdu {\n    const providePkiApduArgs: ApduBuilderArgs = {\n      cla: 0xb0,\n      ins: 0x06,\n      p1: this.args.keyUsage,\n      p2: 0x00,\n    };\n    return new ApduBuilder(providePkiApduArgs)\n      .addBufferToData(this.args.certificate)\n      .build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): LoadCertificateCommandResult {\n    if (CommandUtils.isSuccessResponse(apduResponse)) {\n      return CommandResultFactory({\n        data: undefined,\n      });\n    }\n    const parser = new ApduParser(apduResponse);\n    const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n    if (isCommandErrorCode(errorCode, LOAD_CERTIFICATE_ERRORS)) {\n      return CommandResultFactory({\n        error: new LoadCertificateCommandError({\n          ...LOAD_CERTIFICATE_ERRORS[errorCode],\n          errorCode,\n        }),\n      });\n    }\n    return CommandResultFactory({\n      error: GlobalCommandErrorHandler.handle(apduResponse),\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport {\n  type CommandErrors,\n  isCommandErrorCode,\n} from \"@api/command/utils/CommandErrors\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type CommandErrorArgs, DeviceExchangeError } from \"@api/Error\";\n\nexport type OpenAppArgs = {\n  readonly appName: string;\n};\n\nexport type OpenAppErrorCodes = \"670a\" | \"6807\";\n\nconst OPEN_APP_ERRORS: CommandErrors<OpenAppErrorCodes> = {\n  \"670a\": { message: \"No app name provided\" },\n  \"6807\": { message: \"Unknown application name\" },\n};\n\nexport class OpenAppCommandError extends DeviceExchangeError<OpenAppErrorCodes> {\n  constructor({ message, errorCode }: CommandErrorArgs<OpenAppErrorCodes>) {\n    super({ tag: \"OpenAppCommandError\", message, errorCode });\n  }\n}\n\nexport type OpenAppCommandResult = CommandResult<void, OpenAppErrorCodes>;\n\n/**\n * The command to open an application on the device.\n */\nexport class OpenAppCommand\n  implements Command<void, OpenAppArgs, OpenAppErrorCodes>\n{\n  readonly name = \"openApp\";\n  readonly args: OpenAppArgs;\n\n  readonly triggersDisconnection = true;\n\n  constructor(args: OpenAppArgs) {\n    this.args = args;\n  }\n\n  getApdu(): Apdu {\n    const openAppApduArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: 0xd8,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(openAppApduArgs)\n      .addAsciiStringToData(this.args.appName)\n      .build();\n  }\n\n  parseResponse(\n    apduResponse: ApduResponse,\n  ): CommandResult<void, OpenAppErrorCodes> {\n    if (CommandUtils.isSuccessResponse(apduResponse)) {\n      return CommandResultFactory({\n        data: undefined,\n      });\n    }\n    const parser = new ApduParser(apduResponse);\n    const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n    if (isCommandErrorCode(errorCode, OPEN_APP_ERRORS)) {\n      return CommandResultFactory({\n        error: new OpenAppCommandError({\n          ...OPEN_APP_ERRORS[errorCode],\n          errorCode,\n        }),\n      });\n    }\n    return CommandResultFactory({\n      error: GlobalCommandErrorHandler.handle(apduResponse),\n    });\n  }\n}\n", "export enum DeviceStatus {\n  LOCKED = \"LOCKED\",\n  BUSY = \"BUSY\",\n  CONNECTED = \"CONNECTED\",\n  NOT_CONNECTED = \"NOT CONNECTED\",\n}\n", "/**\n * The status of a device action.\n */\nexport enum DeviceActionStatus {\n  NotStarted = \"not-started\",\n  Pending = \"pending\",\n  Stopped = \"stopped\",\n  Completed = \"completed\",\n  Error = \"error\",\n}\n\nexport type DeviceActionState<Output, Error, IntermediateValue> =\n  | { readonly status: DeviceActionStatus.NotStarted }\n  | {\n      readonly status: DeviceActionStatus.Pending;\n      readonly intermediateValue: IntermediateValue;\n    }\n  | { readonly status: DeviceActionStatus.Stopped }\n  | { readonly status: DeviceActionStatus.Completed; readonly output: Output }\n  | { readonly status: DeviceActionStatus.Error; readonly error: Error };\n", "/**\n * The user interaction required on the device to move further in a device action.\n * This is used to inform the users about the action they need to take on the device.\n */\nexport enum UserInteractionRequired {\n  None = \"none\",\n  UnlockDevice = \"unlock-device\",\n  AllowSecureConnection = \"allow-secure-connection\",\n  ConfirmOpenApp = \"confirm-open-app\",\n  SignTransaction = \"sign-transaction\",\n  SignTypedData = \"sign-typed-data\",\n  AllowListApps = \"allow-list-apps\",\n  VerifyAddress = \"verify-address\",\n  SignPersonalMessage = \"sign-personal-message\",\n  SignDelegationAuthorization = \"sign-delegation-authorization\",\n  Web3ChecksOptIn = \"web3-checks-opt-in\",\n  VerifySafeAddress = \"verify-safe-address\",\n}\n", "import { Left, Right } from './Either.js';\nexport const Maybe = {\n    of(value) {\n        return just(value);\n    },\n    empty() {\n        return nothing;\n    },\n    zero() {\n        return nothing;\n    },\n    fromNullable(value) {\n        return value == null ? nothing : just(value);\n    },\n    fromFalsy(value) {\n        return value ? just(value) : nothing;\n    },\n    fromPredicate(pred, value) {\n        switch (arguments.length) {\n            case 1:\n                return (value) => Maybe.fromPredicate(pred, value);\n            default:\n                return pred(value) ? just(value) : nothing;\n        }\n    },\n    mapMaybe(f, list) {\n        switch (arguments.length) {\n            case 1:\n                return (list) => Maybe.mapMaybe(f, list);\n            default:\n                return Maybe.catMaybes(list.map(f));\n        }\n    },\n    catMaybes(list) {\n        let res = [];\n        for (const e of list) {\n            if (e.isJust()) {\n                res.push(e.extract());\n            }\n        }\n        return res;\n    },\n    encase(thunk) {\n        try {\n            return just(thunk());\n        }\n        catch {\n            return nothing;\n        }\n    },\n    isMaybe(x) {\n        return x instanceof Just || x instanceof Nothing;\n    },\n    sequence(maybes) {\n        let res = [];\n        for (const m of maybes) {\n            if (m.isJust()) {\n                res.push(m.extract());\n            }\n            else {\n                return nothing;\n            }\n        }\n        return just(res);\n    },\n    'fantasy-land/of'(value) {\n        return this.of(value);\n    },\n    'fantasy-land/empty'() {\n        return this.empty();\n    },\n    'fantasy-land/zero'() {\n        return this.zero();\n    }\n};\nclass Just {\n    constructor(__value) {\n        this.__value = __value;\n        this['fantasy-land/equals'] = this.equals;\n        this['fantasy-land/map'] = this.map;\n        this['fantasy-land/ap'] = this.ap;\n        this['fantasy-land/alt'] = this.alt;\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/reduce'] = this.reduce;\n        this['fantasy-land/extend'] = this.extend;\n        this['fantasy-land/filter'] = this.filter;\n    }\n    isJust() {\n        return true;\n    }\n    isNothing() {\n        return false;\n    }\n    inspect() {\n        return `Just(${this.__value})`;\n    }\n    toString() {\n        return this.inspect();\n    }\n    toJSON() {\n        const value = this.__value;\n        return value instanceof Date ? value.toJSON() : value;\n    }\n    equals(other) {\n        return this.extract() === other.extract();\n    }\n    map(f) {\n        return just(f(this.__value));\n    }\n    ap(maybeF) {\n        return maybeF.isJust() ? this.map(maybeF.extract()) : nothing;\n    }\n    alt(_) {\n        return this;\n    }\n    altLazy(_) {\n        return this;\n    }\n    chain(f) {\n        return f(this.__value);\n    }\n    chainNullable(f) {\n        return Maybe.fromNullable(f(this.__value));\n    }\n    join() {\n        return this.__value;\n    }\n    reduce(reducer, initialValue) {\n        return reducer(initialValue, this.__value);\n    }\n    extend(f) {\n        return just(f(this));\n    }\n    unsafeCoerce() {\n        return this.__value;\n    }\n    caseOf(patterns) {\n        return '_' in patterns ? patterns._() : patterns.Just(this.__value);\n    }\n    orDefault(_) {\n        return this.__value;\n    }\n    orDefaultLazy(_) {\n        return this.__value;\n    }\n    toList() {\n        return [this.__value];\n    }\n    mapOrDefault(f, _) {\n        return f(this.__value);\n    }\n    extract() {\n        return this.__value;\n    }\n    extractNullable() {\n        return this.__value;\n    }\n    toEither(_) {\n        return Right(this.__value);\n    }\n    ifJust(effect) {\n        return effect(this.__value), this;\n    }\n    ifNothing(_) {\n        return this;\n    }\n    filter(pred) {\n        return pred(this.__value) ? just(this.__value) : nothing;\n    }\n}\nJust.prototype.constructor = Maybe;\nclass Nothing {\n    constructor() {\n        this['fantasy-land/equals'] = this.equals;\n        this['fantasy-land/map'] = this.map;\n        this['fantasy-land/ap'] = this.ap;\n        this['fantasy-land/alt'] = this.alt;\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/reduce'] = this.reduce;\n        this['fantasy-land/extend'] = this.extend;\n        this['fantasy-land/filter'] = this.filter;\n    }\n    isJust() {\n        return false;\n    }\n    isNothing() {\n        return true;\n    }\n    inspect() {\n        return 'Nothing';\n    }\n    toString() {\n        return this.inspect();\n    }\n    toJSON() {\n        return this.__value;\n    }\n    equals(other) {\n        return this.extract() === other.extract();\n    }\n    map(_) {\n        return nothing;\n    }\n    ap(_) {\n        return nothing;\n    }\n    alt(other) {\n        return other;\n    }\n    altLazy(other) {\n        return other();\n    }\n    chain(_) {\n        return nothing;\n    }\n    chainNullable(_) {\n        return nothing;\n    }\n    join() {\n        return nothing;\n    }\n    reduce(_, initialValue) {\n        return initialValue;\n    }\n    extend(_) {\n        return nothing;\n    }\n    unsafeCoerce() {\n        throw new Error('Maybe#unsafeCoerce was ran on a Nothing');\n    }\n    caseOf(patterns) {\n        return '_' in patterns ? patterns._() : patterns.Nothing();\n    }\n    orDefault(defaultValue) {\n        return defaultValue;\n    }\n    orDefaultLazy(getDefaultValue) {\n        return getDefaultValue();\n    }\n    toList() {\n        return [];\n    }\n    mapOrDefault(_, defaultValue) {\n        return defaultValue;\n    }\n    extract() {\n        return undefined;\n    }\n    extractNullable() {\n        return null;\n    }\n    toEither(left) {\n        return Left(left);\n    }\n    ifJust(_) {\n        return this;\n    }\n    ifNothing(effect) {\n        return effect(), this;\n    }\n    filter(_) {\n        return nothing;\n    }\n}\nNothing.prototype.constructor = Maybe;\n/** Constructs a Just. Represents an optional value that exists */\nconst just = (value) => new Just(value);\n/** Represents a missing value, you can think of it as a smart 'null' */\nconst nothing = new Nothing();\nexport { just as Just, nothing as Nothing };\n", "import { Just, Nothing } from './Maybe.js';\nexport const Either = {\n    of(value) {\n        return right(value);\n    },\n    lefts(list) {\n        let result = [];\n        for (const x of list) {\n            if (x.isLeft()) {\n                result.push(x.extract());\n            }\n        }\n        return result;\n    },\n    rights(list) {\n        let result = [];\n        for (const x of list) {\n            if (x.isRight()) {\n                result.push(x.extract());\n            }\n        }\n        return result;\n    },\n    encase(throwsF) {\n        try {\n            return right(throwsF());\n        }\n        catch (e) {\n            return left(e);\n        }\n    },\n    sequence(eithers) {\n        let res = [];\n        for (const e of eithers) {\n            if (e.isLeft()) {\n                return e;\n            }\n            res.push(e.extract());\n        }\n        return right(res);\n    },\n    isEither(x) {\n        return x instanceof Left || x instanceof Right;\n    },\n    'fantasy-land/of'(value) {\n        return Either.of(value);\n    }\n};\nclass Right {\n    constructor(__value) {\n        this.__value = __value;\n        this._ = 'R';\n        this['fantasy-land/bimap'] = this.bimap;\n        this['fantasy-land/map'] = this.map;\n        this['fantasy-land/ap'] = this.ap;\n        this['fantasy-land/equals'] = this.equals;\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/alt'] = this.alt;\n        this['fantasy-land/reduce'] = this.reduce;\n        this['fantasy-land/extend'] = this.extend;\n    }\n    isLeft() {\n        return false;\n    }\n    isRight() {\n        return true;\n    }\n    toJSON() {\n        return this.__value;\n    }\n    inspect() {\n        return `Right(${this.__value})`;\n    }\n    toString() {\n        return this.inspect();\n    }\n    bimap(_, g) {\n        return right(g(this.__value));\n    }\n    map(f) {\n        return right(f(this.__value));\n    }\n    mapLeft(_) {\n        return this;\n    }\n    ap(other) {\n        return other.isRight() ? this.map(other.extract()) : other;\n    }\n    equals(other) {\n        return other.isRight() ? this.__value === other.extract() : false;\n    }\n    chain(f) {\n        return f(this.__value);\n    }\n    chainLeft(_) {\n        return this;\n    }\n    join() {\n        return this.__value;\n    }\n    alt(_) {\n        return this;\n    }\n    altLazy(_) {\n        return this;\n    }\n    reduce(reducer, initialValue) {\n        return reducer(initialValue, this.__value);\n    }\n    extend(f) {\n        return right(f(this));\n    }\n    unsafeCoerce() {\n        return this.__value;\n    }\n    caseOf(patterns) {\n        return '_' in patterns ? patterns._() : patterns.Right(this.__value);\n    }\n    leftOrDefault(defaultValue) {\n        return defaultValue;\n    }\n    orDefault(_) {\n        return this.__value;\n    }\n    orDefaultLazy(_) {\n        return this.__value;\n    }\n    leftOrDefaultLazy(getDefaultValue) {\n        return getDefaultValue();\n    }\n    ifLeft(_) {\n        return this;\n    }\n    ifRight(effect) {\n        return effect(this.__value), this;\n    }\n    toMaybe() {\n        return Just(this.__value);\n    }\n    leftToMaybe() {\n        return Nothing;\n    }\n    extract() {\n        return this.__value;\n    }\n    swap() {\n        return left(this.__value);\n    }\n}\nRight.prototype.constructor = Either;\nclass Left {\n    constructor(__value) {\n        this.__value = __value;\n        this._ = 'L';\n        this['fantasy-land/bimap'] = this.bimap;\n        this['fantasy-land/map'] = this.map;\n        this['fantasy-land/ap'] = this.ap;\n        this['fantasy-land/equals'] = this.equals;\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/alt'] = this.alt;\n        this['fantasy-land/reduce'] = this.reduce;\n        this['fantasy-land/extend'] = this.extend;\n    }\n    isLeft() {\n        return true;\n    }\n    isRight() {\n        return false;\n    }\n    toJSON() {\n        return this.__value;\n    }\n    inspect() {\n        return `Left(${JSON.stringify(this.__value)})`;\n    }\n    toString() {\n        return this.inspect();\n    }\n    bimap(f, _) {\n        return left(f(this.__value));\n    }\n    map(_) {\n        return this;\n    }\n    mapLeft(f) {\n        return left(f(this.__value));\n    }\n    ap(other) {\n        return other.isLeft() ? other : this;\n    }\n    equals(other) {\n        return other.isLeft() ? other.extract() === this.__value : false;\n    }\n    chain(_) {\n        return this;\n    }\n    chainLeft(f) {\n        return f(this.__value);\n    }\n    join() {\n        return this;\n    }\n    alt(other) {\n        return other;\n    }\n    altLazy(other) {\n        return other();\n    }\n    reduce(_, initialValue) {\n        return initialValue;\n    }\n    extend(_) {\n        return this;\n    }\n    unsafeCoerce() {\n        if (this.__value instanceof Error) {\n            throw this.__value;\n        }\n        throw new Error('Either#unsafeCoerce was ran on a Left');\n    }\n    caseOf(patterns) {\n        return '_' in patterns ? patterns._() : patterns.Left(this.__value);\n    }\n    leftOrDefault(_) {\n        return this.__value;\n    }\n    orDefault(defaultValue) {\n        return defaultValue;\n    }\n    orDefaultLazy(getDefaultValue) {\n        return getDefaultValue();\n    }\n    leftOrDefaultLazy(_) {\n        return this.__value;\n    }\n    ifLeft(effect) {\n        return effect(this.__value), this;\n    }\n    ifRight(_) {\n        return this;\n    }\n    toMaybe() {\n        return Nothing;\n    }\n    leftToMaybe() {\n        return Just(this.__value);\n    }\n    extract() {\n        return this.__value;\n    }\n    swap() {\n        return right(this.__value);\n    }\n}\nLeft.prototype.constructor = Either;\nconst left = (value) => new Left(value);\nconst right = (value) => new Right(value);\nexport { left as Left, right as Right };\n", "/** The identity function, returns the value it was given */\nexport const identity = (x) => x;\n/** Returns a function that always returns the same value. Also known as `const` in other languages */\nexport const always = (x) => () => x;\nexport const Order = {\n    LT: 'LT',\n    EQ: 'EQ',\n    GT: 'GT'\n};\n/** Compares two values using the default \"<\" and \">\" operators */\nexport const compare = (x, y) => {\n    if (x > y) {\n        return Order.GT;\n    }\n    else if (x < y) {\n        return Order.LT;\n    }\n    else {\n        return Order.EQ;\n    }\n};\n/** Maps the Order enum to the values expected by the standard ECMAScript library when doing comparison (Array.prototype.sort, for example) */\nexport const orderToNumber = (order) => {\n    switch (order) {\n        case Order.LT:\n            return -1;\n        case Order.EQ:\n            return 0;\n        case Order.GT:\n            return 1;\n    }\n};\n/** Takes a function that receives multiple arguments and returns a \"curried\" version of that function that can take any number of those arguments and if they are less than needed a new function that takes the rest of them will be returned */\nexport const curry = (fn) => function currify(...args) {\n    return args.length >= fn.length\n        ? fn.apply(undefined, args)\n        : currify.bind(undefined, ...args);\n};\n", "import { Just, Nothing } from './Maybe.js';\nconst NonEmptyListConstructor = (list) => list;\nexport const NonEmptyList = Object.assign(NonEmptyListConstructor, {\n    fromArray: (source) => NonEmptyList.isNonEmpty(source) ? Just(source) : Nothing,\n    unsafeCoerce: (source) => {\n        if (NonEmptyList.isNonEmpty(source)) {\n            return source;\n        }\n        throw new Error('NonEmptyList#unsafeCoerce was ran on an empty array');\n    },\n    fromTuple: (source) => NonEmptyList(source.toArray()),\n    head: (list) => list[0],\n    last: (list) => list[list.length - 1],\n    isNonEmpty: (list) => list.length > 0,\n    tail: (list) => list.slice(1)\n});\n", "import { Either, Right, Left } from './Either.js';\nimport { identity } from './Function.js';\nimport { Maybe, Just, Nothing } from './Maybe.js';\nimport { NonEmptyList } from './NonEmptyList.js';\nconst serializeValue = (_, value) => {\n    return typeof value === 'bigint' ? value.toString() : value;\n};\nconst isEmptySchema = (schema) => Object.keys(schema).length === 0;\nconst isObject = (obj) => typeof obj === 'object' && obj !== null && !Array.isArray(obj);\nconst reportError = (expectedType, input) => {\n    let receivedString = '';\n    switch (typeof input) {\n        case 'undefined':\n            receivedString = 'undefined';\n            break;\n        case 'object':\n            receivedString =\n                input === null\n                    ? 'null'\n                    : Array.isArray(input)\n                        ? 'an array with value ' + JSON.stringify(input, serializeValue)\n                        : 'an object with value ' + JSON.stringify(input, serializeValue);\n            break;\n        case 'boolean':\n            receivedString = 'a boolean';\n            break;\n        case 'symbol':\n            receivedString = 'a symbol';\n            break;\n        case 'function':\n            receivedString = 'a function';\n            break;\n        case 'bigint':\n            receivedString = `a bigint with value ${input.toString()}`;\n    }\n    receivedString =\n        receivedString ||\n            `a ${typeof input} with value ${JSON.stringify(input, serializeValue)}`;\n    return `Expected ${expectedType}, but received ${receivedString}`;\n};\nconst removeOneOfWithSingleElement = (schema) => {\n    const schemaKeys = Object.keys(schema);\n    if (schemaKeys.length === 1 &&\n        schema.oneOf?.length === 1 &&\n        typeof schema.oneOf[0] === 'object') {\n        Object.assign(schema, schema.oneOf[0]);\n        delete schema.oneOf;\n    }\n    return schema;\n};\nconst flattenNestedOneOf = (schema) => {\n    if (Array.isArray(schema.oneOf)) {\n        for (let i = 0; i < schema.oneOf.length; i++) {\n            const e = schema.oneOf[i];\n            if (typeof e === 'object' && e.oneOf) {\n                schema.oneOf.splice(i, 1);\n                schema.oneOf.push(...e.oneOf);\n                return optimizeSchema(schema);\n            }\n        }\n    }\n    return schema;\n};\nconst optimizeSchema = (schema) => {\n    flattenNestedOneOf(schema);\n    removeOneOfWithSingleElement(schema);\n    return schema;\n};\nexport const Codec = {\n    /** Creates a codec for any JSON object */\n    interface(properties) {\n        const keys = Object.keys(properties);\n        const decode = (input) => {\n            if (!isObject(input)) {\n                return Left(reportError('an object', input));\n            }\n            const result = {};\n            for (const key of keys) {\n                if (!input.hasOwnProperty(key) &&\n                    !properties[key]._isOptional) {\n                    return Left(`Problem with property \"${key}\": it does not exist in received object ${JSON.stringify(input, serializeValue)}`);\n                }\n                const decodedProperty = properties[key].decode(input[key]);\n                if (decodedProperty.isLeft()) {\n                    return Left(`Problem with the value of property \"${key}\": ${decodedProperty.extract()}`);\n                }\n                const value = decodedProperty.extract();\n                if (value !== undefined) {\n                    result[key] = value;\n                }\n            }\n            return Right(result);\n        };\n        const encode = (input) => {\n            const result = {};\n            for (const key of keys) {\n                result[key] = properties[key].encode(input[key]);\n            }\n            return result;\n        };\n        return {\n            decode,\n            encode,\n            unsafeDecode: (input) => decode(input).mapLeft(Error).unsafeCoerce(),\n            schema: () => keys.reduce((acc, key) => {\n                const isOptional = properties[key]._isOptional;\n                if (!isOptional) {\n                    acc.required.push(key);\n                }\n                acc.properties[key] = optimizeSchema(properties[key].schema());\n                return acc;\n            }, {\n                type: 'object',\n                properties: {},\n                required: []\n            })\n        };\n    },\n    /** Creates a codec for any type, you can add your own deserialization/validation logic in the decode argument */\n    custom({ decode, encode, schema }) {\n        return {\n            decode,\n            encode,\n            unsafeDecode: (input) => decode(input).mapLeft(Error).unsafeCoerce(),\n            schema: schema ?? (() => ({}))\n        };\n    }\n};\n/** A codec for any string value. Most of the time you will use it to implement an interface codec (see the Codec#interface example above). Encoding a string acts like the identity function */\nexport const string = Codec.custom({\n    decode: (input) => typeof input === 'string'\n        ? Right(input)\n        : Left(reportError('a string', input)),\n    encode: identity,\n    schema: () => ({ type: 'string' })\n});\n/** A codec for any number value. This includes anything that has a typeof number - NaN, Infinity etc. Encoding a number acts like the identity function */\nexport const number = Codec.custom({\n    decode: (input) => typeof input === 'number'\n        ? Right(input)\n        : Left(reportError('a number', input)),\n    encode: identity,\n    schema: () => ({ type: 'number' })\n});\n/** A codec for null only */\nexport const nullType = Codec.custom({\n    decode: (input) => input === null ? Right(input) : Left(reportError('a null', input)),\n    encode: identity,\n    schema: () => ({ type: 'null' })\n});\nconst undefinedType = Codec.custom({\n    decode: (input) => input === undefined\n        ? Right(input)\n        : Left(reportError('an undefined', input)),\n    encode: identity\n});\nexport const optional = (codec) => ({\n    ...oneOf([codec, undefinedType]),\n    schema: codec.schema,\n    _isOptional: true\n});\n/** A codec for a value T or null. Keep in mind if you use `nullable` inside `Codec.interface` the property will still be required */\nexport const nullable = (codec) => oneOf([codec, nullType]);\n/** A codec for a boolean value */\nexport const boolean = Codec.custom({\n    decode: (input) => typeof input === 'boolean'\n        ? Right(input)\n        : Left(reportError('a boolean', input)),\n    encode: identity,\n    schema: () => ({ type: 'boolean' })\n});\n/** A codec that can never fail, but of course you get no type information. Encoding an unknown acts like the identity function */\nexport const unknown = Codec.custom({\n    decode: Right,\n    encode: identity,\n    schema: () => ({})\n});\n/** A codec for a TypeScript enum */\nexport const enumeration = (e) => {\n    const enumValues = Object.values(e);\n    return Codec.custom({\n        decode: (input) => {\n            return oneOf([string, number])\n                .decode(input)\n                .chain((x) => {\n                const enumIndex = enumValues.indexOf(x);\n                return enumIndex !== -1\n                    ? Right(enumValues[enumIndex])\n                    : Left(reportError('an enum member', input));\n            });\n        },\n        encode: identity,\n        schema: () => ({ enum: enumValues })\n    });\n};\n/** A codec combinator that receives a list of codecs and runs them one after another during decode and resolves to whichever returns Right or to Left if all fail */\nexport const oneOf = (codecs) => Codec.custom({\n    decode: (input) => {\n        let errors = [];\n        for (const codec of codecs) {\n            const res = codec.decode(input);\n            if (res.isRight()) {\n                return res;\n            }\n            else {\n                errors.push(res.extract());\n            }\n        }\n        return Left(`One of the following problems occured: ${errors\n            .map((err, i) => `(${i}) ${err}`)\n            .join(', ')}`);\n    },\n    encode: (input) => {\n        for (const codec of codecs) {\n            const res = Either.encase(() => codec.encode(input))\n                .mapLeft((_) => '')\n                .chain(codec.decode);\n            if (res.isRight()) {\n                return codec.encode(input);\n            }\n        }\n        return input;\n    },\n    schema: () => ({ oneOf: codecs.map((x) => x.schema()) })\n});\n/** A codec for an array */\nexport const array = (codec) => Codec.custom({\n    decode: (input) => {\n        if (!Array.isArray(input)) {\n            return Left(reportError('an array', input));\n        }\n        else {\n            const result = [];\n            for (let i = 0; i < input.length; i++) {\n                const decoded = codec.decode(input[i]);\n                if (decoded.isRight()) {\n                    result.push(decoded.extract());\n                }\n                else {\n                    return Left(`Problem with the value at index ${i}: ${decoded.extract()}`);\n                }\n            }\n            return Right(result);\n        }\n    },\n    encode: (input) => input.map(codec.encode),\n    schema: () => ({\n        type: 'array',\n        items: codec.schema()\n    })\n});\nconst numberString = Codec.custom({\n    decode: (input) => string\n        .decode(input)\n        .chain((x) => isFinite(+x) ? Right(x) : Left(reportError('a number', input))),\n    encode: identity,\n    schema: number.schema\n});\n/** A codec for an object without specific properties, its restrictions are equivalent to the Record<K, V> type so you can only check for number and string keys */\nexport const record = (keyCodec, valueCodec) => Codec.custom({\n    decode: (input) => {\n        const result = {};\n        const keyCodecOverride = keyCodec === number ? numberString : keyCodec;\n        if (!isObject(input)) {\n            return Left(reportError('an object', input));\n        }\n        for (const key of Object.keys(input)) {\n            if (input.hasOwnProperty(key)) {\n                const decodedKey = keyCodecOverride.decode(key);\n                const decodedValue = valueCodec.decode(input[key]);\n                if (decodedKey.isRight() && decodedValue.isRight()) {\n                    result[decodedKey.extract()] = decodedValue.extract();\n                }\n                else if (decodedKey.isLeft()) {\n                    return Left(`Problem with key type of property \"${key}\": ${decodedKey.extract()}`);\n                }\n                else if (decodedValue.isLeft()) {\n                    return Left(`Problem with the value of property \"${key}\": ${decodedValue.extract()}`);\n                }\n            }\n        }\n        return Right(result);\n    },\n    encode: (input) => {\n        const result = {};\n        for (const key in input) {\n            if (input.hasOwnProperty(key)) {\n                result[keyCodec.encode(key)] = valueCodec.encode(input[key]);\n            }\n        }\n        return result;\n    },\n    schema: () => ({\n        type: 'object',\n        additionalProperties: valueCodec.schema()\n    })\n});\n/** A codec that only succeeds decoding when the value is exactly what you've constructed the codec with */\nexport const exactly = (...expectedValues) => Codec.custom({\n    decode: (input) => expectedValues.includes(input)\n        ? Right(input)\n        : Left(reportError(expectedValues.map((x) => JSON.stringify(x)).join(', '), input)),\n    encode: identity,\n    schema: () => ({\n        oneOf: expectedValues.map((value) => ({\n            type: typeof value,\n            enum: [value]\n        }))\n    })\n});\n/** A special codec used when dealing with recursive data structures, it allows a codec to be recursively defined by itself */\nexport const lazy = (getCodec) => Codec.custom({\n    decode: (input) => getCodec().decode(input),\n    encode: (input) => getCodec().encode(input),\n    schema: () => ({\n        $comment: 'Lazy codecs are not supported when generating a JSON schema'\n    })\n});\n/** A codec for purify's Maybe type. Encode runs Maybe#toJSON, which effectively returns the value inside if it's a Just or undefined if it's Nothing */\nexport const maybe = (codec) => {\n    const baseCodec = Codec.custom({\n        decode: (input) => Maybe.fromNullable(input).caseOf({\n            Just: (x) => codec.decode(x).map(Just),\n            Nothing: () => Right(Nothing)\n        }),\n        encode: (input) => input.map(codec.encode).orDefault(undefined),\n        schema: () => isEmptySchema(codec.schema())\n            ? {}\n            : { oneOf: [codec.schema(), { type: 'null' }] }\n    });\n    return {\n        ...baseCodec,\n        _isOptional: true\n    };\n};\n/** A codec for purify's NEL type */\nexport const nonEmptyList = (codec) => {\n    const arrayCodec = array(codec);\n    return Codec.custom({\n        decode: (input) => arrayCodec\n            .decode(input)\n            .chain((x) => NonEmptyList.fromArray(x).toEither(`Expected an array with one or more elements, but received an empty array`)),\n        encode: arrayCodec.encode,\n        schema: () => ({ ...arrayCodec.schema(), minItems: 1 })\n    });\n};\n/** The same as the array decoder, but accepts a fixed amount of array elements and you can specify each element type, much like the tuple type */\nexport const tuple = (codecs) => Codec.custom({\n    decode: (input) => {\n        if (!Array.isArray(input)) {\n            return Left(reportError('an array', input));\n        }\n        else if (codecs.length !== input.length) {\n            return Left(`Expected an array of length ${codecs.length}, but received an array with length of ${input.length}`);\n        }\n        else {\n            const result = [];\n            for (let i = 0; i < codecs.length; i++) {\n                const decoded = codecs[i].decode(input[i]);\n                if (decoded.isRight()) {\n                    result.push(decoded.extract());\n                }\n                else {\n                    return Left(`Problem with the value at index ${i}: ${decoded.extract()}`);\n                }\n            }\n            return Right(result);\n        }\n    },\n    encode: (input) => input.map((x, i) => codecs[i].encode(x)),\n    schema: () => ({\n        type: 'array',\n        items: codecs.map((x) => x.schema()),\n        additionalItems: false,\n        minItems: codecs.length,\n        maxItems: codecs.length\n    })\n});\n/** A codec for a parsable date string, on successful decoding it resolves to a Date object. The validity of the date string during decoding is decided by the browser implementation of Date.parse. Encode runs toISOString on the passed in date object */\nexport const date = Codec.custom({\n    decode: (input) => string\n        .decode(input)\n        .mapLeft((err) => `Problem with date string: ${err}`)\n        .chain((x) => Number.isNaN(Date.parse(x))\n        ? Left('Expected a valid date string, but received a string that cannot be parsed')\n        : Right(new Date(x))),\n    encode: (input) => input.toISOString(),\n    schema: () => ({ type: 'string', format: 'date-time' })\n});\n/** Creates an intersection between two codecs. If the provided codecs are not for an object, the second decode result will be returned */\nexport const intersect = (t, u) => Codec.custom({\n    decode: (input) => {\n        const et = t.decode(input);\n        if (et.isLeft()) {\n            return et;\n        }\n        const eu = u.decode(input);\n        if (eu.isLeft()) {\n            return eu;\n        }\n        const valuet = et.extract();\n        const valueu = eu.extract();\n        return isObject(valuet) && isObject(valueu)\n            ? Right(Object.assign(valuet, valueu))\n            : Right(valueu);\n    },\n    encode: (input) => {\n        const valuet = t.encode(input);\n        const valueu = u.encode(input);\n        return isObject(valuet) && isObject(valueu)\n            ? Object.assign(valuet, valueu)\n            : valueu;\n    },\n    schema: () => ({ allOf: [t, u].map((x) => x.schema()) })\n});\n/** A codec for the built-in Map type */\nexport const map = (keyCodec, valueCodec) => Codec.custom({\n    decode: (input) => array(tuple([keyCodec, valueCodec]))\n        .decode(input)\n        .map((pairs) => new Map(pairs)),\n    encode: (input) => Array.from(input.entries()).map(([k, v]) => [\n        keyCodec.encode(k),\n        valueCodec.encode(v)\n    ]),\n    schema: () => ({\n        type: 'array',\n        items: {\n            type: 'array',\n            items: [keyCodec.schema(), valueCodec.schema()],\n            additionalItems: false,\n            minItems: 2,\n            maxItems: 2\n        }\n    })\n});\nconst oneofRegex = /^(One of the following problems occured:)\\s/;\nconst oneOfCounterRegex = /\\(\\d\\)\\s/;\nconst oneOfSeparatorRegex = /\\, (?=\\()/g;\nconst failureRegex = /^(Expected ).+(, but received )/;\nconst failureReceivedSeparator = ' with value';\nconst missingPropertyMarker = 'Problem with property \"';\nconst badPropertyMarker = 'Problem with the value of property \"';\nconst badPropertyKeyMarker = 'Problem with key type of property \"';\nconst dateFailureMarket = 'Problem with date string: ';\nconst indexMarker = 'Problem with the value at index ';\nconst expectedTypesMap = {\n    'an object': 'object',\n    'a number': 'number',\n    'a string': 'string',\n    'an undefined': 'undefined',\n    'a boolean': 'boolean',\n    'an array': 'array',\n    'a null': 'null',\n    'an enum member': 'enum'\n};\nconst receivedTypesMap = {\n    'a string': 'string',\n    'a number': 'number',\n    null: 'null',\n    undefined: 'undefined',\n    'a boolean': 'boolean',\n    'an array': 'array',\n    'an object': 'object',\n    'a symbol': 'symbol',\n    'a function': 'function',\n    'a bigint': 'bigint'\n};\nconst receivedTypesWithoutValue = [\n    'null',\n    'undefined',\n    'boolean',\n    'symbol',\n    'function',\n    'bigint'\n];\n/** Turns a string error message produced by a built-in purify codec into a meta object */\nexport const parseError = (error) => {\n    const oneOfCheck = error.match(oneofRegex);\n    // One of the following problems occured: (0) *, (1) *\n    if (oneOfCheck) {\n        const remainer = error.replace(oneOfCheck[0], '');\n        return {\n            type: 'oneOf',\n            errors: remainer\n                .split(oneOfSeparatorRegex)\n                .map((x) => parseError(x.replace(x.match(oneOfCounterRegex)[0], '')))\n        };\n    }\n    const failureCheck = error.match(failureRegex);\n    // Expected an object, but received an array with value []\n    if (failureCheck) {\n        const receivedTypeRaw = error.split(failureCheck[2]).pop();\n        const receivedType = receivedTypesMap[receivedTypeRaw.split(failureReceivedSeparator)[0]];\n        if (receivedType) {\n            const expectedTypeRaw = error\n                .replace(failureCheck[1], '')\n                .split(failureCheck[2])[0];\n            return {\n                type: 'failure',\n                expectedType: expectedTypesMap[expectedTypeRaw],\n                receivedType,\n                receivedValue: receivedTypesWithoutValue.includes(receivedType)\n                    ? undefined\n                    : JSON.parse(receivedTypeRaw.split(failureReceivedSeparator).pop())\n            };\n        }\n    }\n    // Problem with property \"a\": it does not exist in received object {}\n    if (error.startsWith(missingPropertyMarker)) {\n        const property = error.replace(missingPropertyMarker, '').split('\": ')[0];\n        return {\n            type: 'property',\n            property,\n            error: {\n                type: 'failure',\n                receivedType: 'undefined'\n            }\n        };\n    }\n    // Problem with the value of property \"a\": *\n    // Problem with key type of property \"a\": *\n    if (error.startsWith(badPropertyMarker) ||\n        error.startsWith(badPropertyKeyMarker)) {\n        const [property, ...restOfError] = error\n            .replace(badPropertyMarker, '')\n            .replace(badPropertyKeyMarker, '')\n            .split(/\": (.+)/);\n        return {\n            type: 'property',\n            property: property,\n            error: parseError(restOfError.join(''))\n        };\n    }\n    // Problem with date string: *\n    if (error.startsWith(dateFailureMarket)) {\n        return parseError(error.replace(dateFailureMarket, ''));\n    }\n    //  Problem with the value at index 0: *\n    if (error.startsWith(indexMarker)) {\n        const [index, ...restOfError] = error\n            .replace(indexMarker, '')\n            .split(/: (.+)/);\n        return {\n            type: 'index',\n            index: Number(index),\n            error: parseError(restOfError.join(''))\n        };\n    }\n    return { type: 'custom', message: error };\n};\n", "class TupleImpl {\n    constructor(first, second) {\n        this.first = first;\n        this.second = second;\n        this.length = 2;\n        this['fantasy-land/equals'] = this.equals;\n        this['fantasy-land/bimap'] = this.bimap;\n        this['fantasy-land/map'] = this.map;\n        this['fantasy-land/reduce'] = this.reduce;\n        this['fantasy-land/ap'] = this.ap;\n        this[0] = first;\n        this[1] = second;\n    }\n    *[Symbol.iterator]() {\n        yield this.first;\n        yield this.second;\n    }\n    toJSON() {\n        return this.toArray();\n    }\n    inspect() {\n        return `Tuple(${JSON.stringify(this.first)}, ${JSON.stringify(this.second)})`;\n    }\n    toString() {\n        return this.inspect();\n    }\n    fst() {\n        return this.first;\n    }\n    snd() {\n        return this.second;\n    }\n    equals(other) {\n        return this.first === other.fst() && this.second === other.snd();\n    }\n    bimap(f, g) {\n        return Tuple(f(this.first), g(this.second));\n    }\n    mapFirst(f) {\n        return Tuple(f(this.first), this.second);\n    }\n    map(f) {\n        return Tuple(this.first, f(this.second));\n    }\n    reduce(reducer, initialValue) {\n        return reducer(initialValue, this.second);\n    }\n    toArray() {\n        return [this.first, this.second];\n    }\n    swap() {\n        return Tuple(this.second, this.first);\n    }\n    ap(f) {\n        return Tuple(this.first, f.snd()(this.second));\n    }\n    every(pred) {\n        return pred(this.first) && pred(this.second);\n    }\n    some(pred) {\n        return pred(this.first) || pred(this.second);\n    }\n}\nexport const Tuple = Object.assign((fst, snd) => new TupleImpl(fst, snd), {\n    fromArray: ([fst, snd]) => {\n        return Tuple(fst, snd);\n    },\n    fanout: (...args) => {\n        const [f, g, value] = args;\n        switch (args.length) {\n            case 3:\n                return Tuple(f(value), g(value));\n            case 2:\n                return (value) => Tuple.fanout(f, g, value);\n            default:\n                return (g) => (value) => Tuple.fanout(f, g, value);\n        }\n    }\n});\nTupleImpl.prototype.constructor = Tuple;\n", "var _a;\nimport { Either, Left, Right } from './Either.js';\nimport { MaybeAsync } from './MaybeAsync.js';\nconst helpers = {\n    liftEither(either) {\n        if (either.isRight()) {\n            return Promise.resolve(either.extract());\n        }\n        throw either.extract();\n    },\n    fromPromise(promise) {\n        return promise.then(helpers.liftEither);\n    },\n    throwE(error) {\n        throw error;\n    }\n};\nclass EitherAsyncImpl {\n    constructor(runPromise) {\n        this.runPromise = runPromise;\n        this[_a] = 'EitherAsync';\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/alt'] = this.alt;\n        this.then = (onfulfilled, onrejected) => {\n            return this.run().then(onfulfilled, onrejected);\n        };\n    }\n    leftOrDefault(defaultValue) {\n        return this.run().then((x) => x.leftOrDefault(defaultValue));\n    }\n    orDefault(defaultValue) {\n        return this.run().then((x) => x.orDefault(defaultValue));\n    }\n    join() {\n        return EitherAsync(async (helpers) => {\n            const either = await this;\n            if (either.isRight()) {\n                const nestedEither = await either.extract();\n                return helpers.liftEither(nestedEither);\n            }\n            return helpers.liftEither(either);\n        });\n    }\n    ap(eitherF) {\n        return EitherAsync(async (helpers) => {\n            const otherValue = await eitherF;\n            if (otherValue.isRight()) {\n                const thisValue = await this.run();\n                if (thisValue.isRight()) {\n                    return otherValue.extract()(thisValue.extract());\n                }\n                else {\n                    return helpers.liftEither(thisValue);\n                }\n            }\n            return helpers.liftEither(otherValue);\n        });\n    }\n    alt(other) {\n        return EitherAsync(async (helpers) => {\n            const thisValue = await this.run();\n            if (thisValue.isRight()) {\n                return thisValue.extract();\n            }\n            else {\n                const otherValue = await other;\n                return helpers.liftEither(otherValue);\n            }\n        });\n    }\n    extend(f) {\n        return EitherAsync(async (helpers) => {\n            const either = await this.run();\n            if (either.isRight()) {\n                const v = EitherAsync.liftEither(either);\n                return helpers.liftEither(Right(f(v)));\n            }\n            return helpers.liftEither(either);\n        });\n    }\n    async run() {\n        try {\n            return Right(await this.runPromise(helpers));\n        }\n        catch (e) {\n            return Left(e);\n        }\n    }\n    bimap(f, g) {\n        return EitherAsync(async (helpers) => {\n            const either = await this.run();\n            try {\n                return (await helpers.liftEither(either.bimap(f, g)));\n            }\n            catch (e) {\n                throw await e;\n            }\n        });\n    }\n    map(f) {\n        return EitherAsync((helpers) => this.runPromise(helpers).then(f));\n    }\n    mapLeft(f) {\n        return EitherAsync(async (helpers) => {\n            try {\n                return await this.runPromise(helpers);\n            }\n            catch (e) {\n                throw await f(e);\n            }\n        });\n    }\n    chain(f) {\n        return EitherAsync(async (helpers) => {\n            const value = await this.runPromise(helpers);\n            return helpers.fromPromise(f(value));\n        });\n    }\n    chainLeft(f) {\n        return EitherAsync(async (helpers) => {\n            try {\n                return await this.runPromise(helpers);\n            }\n            catch (e) {\n                return helpers.fromPromise(f(e));\n            }\n        });\n    }\n    toMaybeAsync() {\n        return MaybeAsync(async ({ liftMaybe }) => {\n            const either = await this.run();\n            return liftMaybe(either.toMaybe());\n        });\n    }\n    swap() {\n        return EitherAsync(async (helpers) => {\n            const either = await this.run();\n            if (either.isRight())\n                helpers.throwE(either.extract());\n            return helpers.liftEither(Right(either.extract()));\n        });\n    }\n    ifLeft(effect) {\n        return EitherAsync(async (helpers) => {\n            const either = await this.run();\n            either.ifLeft(effect);\n            return helpers.liftEither(either);\n        });\n    }\n    ifRight(effect) {\n        return EitherAsync(async (helpers) => {\n            const either = await this.run();\n            either.ifRight(effect);\n            return helpers.liftEither(either);\n        });\n    }\n    void() {\n        return this.map((_) => { });\n    }\n    caseOf(patterns) {\n        return this.run().then((x) => x.caseOf(patterns));\n    }\n    finally(effect) {\n        return EitherAsync(({ fromPromise }) => fromPromise(this.run().finally(effect)));\n    }\n}\n_a = Symbol.toStringTag;\nexport const EitherAsync = Object.assign((runPromise) => new EitherAsyncImpl(runPromise), {\n    fromPromise: (f) => EitherAsync(({ fromPromise: fP }) => fP(f())),\n    liftEither: (either) => EitherAsync(({ liftEither }) => liftEither(either)),\n    lefts: (list) => Promise.all(list.map((x) => x.run())).then(Either.lefts),\n    rights: (list) => Promise.all(list.map((x) => x.run())).then(Either.rights),\n    sequence: (eas) => EitherAsync(async (helpers) => {\n        let res = [];\n        for await (const e of eas) {\n            if (e.isLeft()) {\n                return helpers.liftEither(e);\n            }\n            res.push(e.extract());\n        }\n        return helpers.liftEither(Right(res));\n    }),\n    all: (eas) => EitherAsync.fromPromise(async () => Promise.all(eas).then(Either.sequence))\n});\nEitherAsyncImpl.prototype.constructor = EitherAsync;\n", "var _a;\nimport { Maybe, Just, Nothing } from './Maybe.js';\nimport { EitherAsync } from './EitherAsync.js';\nconst helpers = {\n    liftMaybe(maybe) {\n        if (maybe.isJust()) {\n            return Promise.resolve(maybe.extract());\n        }\n        throw Nothing;\n    },\n    fromPromise(promise) {\n        return promise.then(helpers.liftMaybe);\n    }\n};\nclass MaybeAsyncImpl {\n    constructor(runPromise) {\n        this.runPromise = runPromise;\n        this[_a] = 'MaybeAsync';\n        this['fantasy-land/chain'] = this.chain;\n        this['fantasy-land/filter'] = this.filter;\n        this['fantasy-land/alt'] = this.alt;\n    }\n    orDefault(defaultValue) {\n        return this.run().then((x) => x.orDefault(defaultValue));\n    }\n    join() {\n        return MaybeAsync(async (helpers) => {\n            const maybe = await this.run();\n            if (maybe.isJust()) {\n                const nestedMaybe = await maybe.extract();\n                return helpers.liftMaybe(nestedMaybe);\n            }\n            return helpers.liftMaybe(Nothing);\n        });\n    }\n    ap(maybeF) {\n        return MaybeAsync(async (helpers) => {\n            const otherValue = await maybeF;\n            if (otherValue.isJust()) {\n                const thisValue = await this.run();\n                if (thisValue.isJust()) {\n                    return otherValue.extract()(thisValue.extract());\n                }\n                else {\n                    return helpers.liftMaybe(Nothing);\n                }\n            }\n            return helpers.liftMaybe(Nothing);\n        });\n    }\n    alt(other) {\n        return MaybeAsync(async (helpers) => {\n            const thisValue = await this.run();\n            if (thisValue.isJust()) {\n                return thisValue.extract();\n            }\n            else {\n                const otherValue = await other;\n                return helpers.liftMaybe(otherValue);\n            }\n        });\n    }\n    extend(f) {\n        return MaybeAsync(async (helpers) => {\n            const maybe = await this.run();\n            if (maybe.isJust()) {\n                const v = MaybeAsync.liftMaybe(maybe);\n                return helpers.liftMaybe(Just(f(v)));\n            }\n            return helpers.liftMaybe(Nothing);\n        });\n    }\n    filter(pred) {\n        return MaybeAsync(async (helpers) => {\n            const value = await this.run();\n            return helpers.liftMaybe(value.filter(pred));\n        });\n    }\n    async run() {\n        try {\n            return Just(await this.runPromise(helpers));\n        }\n        catch {\n            return Nothing;\n        }\n    }\n    map(f) {\n        return MaybeAsync((helpers) => this.runPromise(helpers).then(f));\n    }\n    chain(f) {\n        return MaybeAsync(async (helpers) => {\n            const value = await this.runPromise(helpers);\n            return helpers.fromPromise(f(value));\n        });\n    }\n    toEitherAsync(error) {\n        return EitherAsync(async ({ liftEither }) => {\n            const maybe = await this.run();\n            return liftEither(maybe.toEither(error));\n        });\n    }\n    ifJust(effect) {\n        return MaybeAsync(async (helpers) => {\n            const maybe = await this.run();\n            maybe.ifJust(effect);\n            return helpers.liftMaybe(maybe);\n        });\n    }\n    ifNothing(effect) {\n        return MaybeAsync(async (helpers) => {\n            const maybe = await this.run();\n            maybe.ifNothing(effect);\n            return helpers.liftMaybe(maybe);\n        });\n    }\n    void() {\n        return this.map((_) => { });\n    }\n    caseOf(patterns) {\n        return this.run().then((x) => x.caseOf(patterns));\n    }\n    finally(effect) {\n        return MaybeAsync(({ fromPromise }) => fromPromise(this.run().finally(effect)));\n    }\n    then(onfulfilled, onrejected) {\n        return this.run().then(onfulfilled, onrejected);\n    }\n}\n_a = Symbol.toStringTag;\nexport const MaybeAsync = Object.assign((runPromise) => new MaybeAsyncImpl(runPromise), {\n    catMaybes: (list) => Promise.all(list).then(Maybe.catMaybes),\n    fromPromise: (f) => MaybeAsync(({ fromPromise: fP }) => fP(f())),\n    liftMaybe: (maybe) => MaybeAsync(({ liftMaybe }) => liftMaybe(maybe))\n});\nMaybeAsyncImpl.prototype.constructor = MaybeAsync;\n", "// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/globalThis\nfunction getGlobal() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  {\n    console.warn('XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues');\n  }\n}\nfunction getDevTools() {\n  const w = getGlobal();\n  if (w.__xstate__) {\n    return w.__xstate__;\n  }\n  return undefined;\n}\nfunction registerService(service) {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  const devTools = getDevTools();\n  if (devTools) {\n    devTools.register(service);\n  }\n}\nconst devToolsAdapter = service => {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  const devTools = getDevTools();\n  if (devTools) {\n    devTools.register(service);\n  }\n};\n\nexport { devToolsAdapter, getGlobal, registerService };\n", "import { devToolsAdapter } from '../dev/dist/xstate-dev.development.esm.js';\n\nclass Mailbox {\n  constructor(_process) {\n    this._process = _process;\n    this._active = false;\n    this._current = null;\n    this._last = null;\n  }\n  start() {\n    this._active = true;\n    this.flush();\n  }\n  clear() {\n    // we can't set _current to null because we might be currently processing\n    // and enqueue following clear shouldnt start processing the enqueued item immediately\n    if (this._current) {\n      this._current.next = null;\n      this._last = this._current;\n    }\n  }\n  enqueue(event) {\n    const enqueued = {\n      value: event,\n      next: null\n    };\n    if (this._current) {\n      this._last.next = enqueued;\n      this._last = enqueued;\n      return;\n    }\n    this._current = enqueued;\n    this._last = enqueued;\n    if (this._active) {\n      this.flush();\n    }\n  }\n  flush() {\n    while (this._current) {\n      // atm the given _process is responsible for implementing proper try/catch handling\n      // we assume here that this won't throw in a way that can affect this mailbox\n      const consumed = this._current;\n      this._process(consumed.value);\n      this._current = consumed.next;\n    }\n    this._last = null;\n  }\n}\n\nconst STATE_DELIMITER = '.';\nconst TARGETLESS_KEY = '';\nconst NULL_EVENT = '';\nconst STATE_IDENTIFIER = '#';\nconst WILDCARD = '*';\nconst XSTATE_INIT = 'xstate.init';\nconst XSTATE_ERROR = 'xstate.error';\nconst XSTATE_STOP = 'xstate.stop';\n\n/**\n * Returns an event that represents an implicit event that is sent after the\n * specified `delay`.\n *\n * @param delayRef The delay in milliseconds\n * @param id The state node ID where this event is handled\n */\nfunction createAfterEvent(delayRef, id) {\n  return {\n    type: `xstate.after.${delayRef}.${id}`\n  };\n}\n\n/**\n * Returns an event that represents that a final state node has been reached in\n * the parent state node.\n *\n * @param id The final state node's parent state node `id`\n * @param output The data to pass into the event\n */\nfunction createDoneStateEvent(id, output) {\n  return {\n    type: `xstate.done.state.${id}`,\n    output\n  };\n}\n\n/**\n * Returns an event that represents that an invoked service has terminated.\n *\n * An invoked service is terminated when it has reached a top-level final state\n * node, but not when it is canceled.\n *\n * @param invokeId The invoked service ID\n * @param output The data to pass into the event\n */\nfunction createDoneActorEvent(invokeId, output) {\n  return {\n    type: `xstate.done.actor.${invokeId}`,\n    output,\n    actorId: invokeId\n  };\n}\nfunction createErrorActorEvent(id, error) {\n  return {\n    type: `xstate.error.actor.${id}`,\n    error,\n    actorId: id\n  };\n}\nfunction createInitEvent(input) {\n  return {\n    type: XSTATE_INIT,\n    input\n  };\n}\n\n/**\n * This function makes sure that unhandled errors are thrown in a separate\n * macrotask. It allows those errors to be detected by global error handlers and\n * reported to bug tracking services without interrupting our own stack of\n * execution.\n *\n * @param err Error to be thrown\n */\nfunction reportUnhandledError(err) {\n  setTimeout(() => {\n    throw err;\n  });\n}\n\nconst symbolObservable = (() => typeof Symbol === 'function' && Symbol.observable || '@@observable')();\n\nfunction matchesState(parentStateId, childStateId) {\n  const parentStateValue = toStateValue(parentStateId);\n  const childStateValue = toStateValue(childStateId);\n  if (typeof childStateValue === 'string') {\n    if (typeof parentStateValue === 'string') {\n      return childStateValue === parentStateValue;\n    }\n\n    // Parent more specific than child\n    return false;\n  }\n  if (typeof parentStateValue === 'string') {\n    return parentStateValue in childStateValue;\n  }\n  return Object.keys(parentStateValue).every(key => {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\nfunction toStatePath(stateId) {\n  if (isArray(stateId)) {\n    return stateId;\n  }\n  const result = [];\n  let segment = '';\n  for (let i = 0; i < stateId.length; i++) {\n    const char = stateId.charCodeAt(i);\n    switch (char) {\n      // \\\n      case 92:\n        // consume the next character\n        segment += stateId[i + 1];\n        // and skip over it\n        i++;\n        continue;\n      // .\n      case 46:\n        result.push(segment);\n        segment = '';\n        continue;\n    }\n    segment += stateId[i];\n  }\n  result.push(segment);\n  return result;\n}\nfunction toStateValue(stateValue) {\n  if (isMachineSnapshot(stateValue)) {\n    return stateValue.value;\n  }\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n  const statePath = toStatePath(stateValue);\n  return pathToStateValue(statePath);\n}\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n  const value = {};\n  let marker = value;\n  for (let i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      const previous = marker;\n      marker = {};\n      previous[statePath[i]] = marker;\n    }\n  }\n  return value;\n}\nfunction mapValues(collection, iteratee) {\n  const result = {};\n  const collectionKeys = Object.keys(collection);\n  for (let i = 0; i < collectionKeys.length; i++) {\n    const key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n  return result;\n}\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n  return [value];\n}\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n  return toArrayStrict(value);\n}\nfunction resolveOutput(mapper, context, event, self) {\n  if (typeof mapper === 'function') {\n    return mapper({\n      context,\n      event,\n      self\n    });\n  }\n  if (!!mapper && typeof mapper === 'object' && Object.values(mapper).some(val => typeof val === 'function')) {\n    console.warn(`Dynamically mapping values to individual properties is deprecated. Use a single function that returns the mapped object instead.\\nFound object containing properties whose values are possibly mapping functions: ${Object.entries(mapper).filter(([, value]) => typeof value === 'function').map(([key, value]) => `\\n - ${key}: ${value.toString().replace(/\\n\\s*/g, '')}`).join('')}`);\n  }\n  return mapper;\n}\nfunction isArray(value) {\n  return Array.isArray(value);\n}\nfunction isErrorActorEvent(event) {\n  return event.type.startsWith('xstate.error.actor');\n}\nfunction toTransitionConfigArray(configLike) {\n  return toArrayStrict(configLike).map(transitionLike => {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string') {\n      return {\n        target: transitionLike\n      };\n    }\n    return transitionLike;\n  });\n}\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n  return toArray(target);\n}\nfunction toObserver(nextHandler, errorHandler, completionHandler) {\n  const isObserver = typeof nextHandler === 'object';\n  const self = isObserver ? nextHandler : undefined;\n  return {\n    next: (isObserver ? nextHandler.next : nextHandler)?.bind(self),\n    error: (isObserver ? nextHandler.error : errorHandler)?.bind(self),\n    complete: (isObserver ? nextHandler.complete : completionHandler)?.bind(self)\n  };\n}\nfunction createInvokeId(stateNodeId, index) {\n  return `${index}.${stateNodeId}`;\n}\nfunction resolveReferencedActor(machine, src) {\n  const match = src.match(/^xstate\\.invoke\\.(\\d+)\\.(.*)/);\n  if (!match) {\n    return machine.implementations.actors[src];\n  }\n  const [, indexStr, nodeId] = match;\n  const node = machine.getStateNodeById(nodeId);\n  const invokeConfig = node.config.invoke;\n  return (Array.isArray(invokeConfig) ? invokeConfig[indexStr] : invokeConfig).src;\n}\nfunction getAllOwnEventDescriptors(snapshot) {\n  return [...new Set([...snapshot._nodes.flatMap(sn => sn.ownEvents)])];\n}\n\nfunction createScheduledEventId(actorRef, id) {\n  return `${actorRef.sessionId}.${id}`;\n}\nlet idCounter = 0;\nfunction createSystem(rootActor, options) {\n  const children = new Map();\n  const keyedActors = new Map();\n  const reverseKeyedActors = new WeakMap();\n  const inspectionObservers = new Set();\n  const timerMap = {};\n  const {\n    clock,\n    logger\n  } = options;\n  const scheduler = {\n    schedule: (source, target, event, delay, id = Math.random().toString(36).slice(2)) => {\n      const scheduledEvent = {\n        source,\n        target,\n        event,\n        delay,\n        id,\n        startedAt: Date.now()\n      };\n      const scheduledEventId = createScheduledEventId(source, id);\n      system._snapshot._scheduledEvents[scheduledEventId] = scheduledEvent;\n      const timeout = clock.setTimeout(() => {\n        delete timerMap[scheduledEventId];\n        delete system._snapshot._scheduledEvents[scheduledEventId];\n        system._relay(source, target, event);\n      }, delay);\n      timerMap[scheduledEventId] = timeout;\n    },\n    cancel: (source, id) => {\n      const scheduledEventId = createScheduledEventId(source, id);\n      const timeout = timerMap[scheduledEventId];\n      delete timerMap[scheduledEventId];\n      delete system._snapshot._scheduledEvents[scheduledEventId];\n      if (timeout !== undefined) {\n        clock.clearTimeout(timeout);\n      }\n    },\n    cancelAll: actorRef => {\n      for (const scheduledEventId in system._snapshot._scheduledEvents) {\n        const scheduledEvent = system._snapshot._scheduledEvents[scheduledEventId];\n        if (scheduledEvent.source === actorRef) {\n          scheduler.cancel(actorRef, scheduledEvent.id);\n        }\n      }\n    }\n  };\n  const sendInspectionEvent = event => {\n    if (!inspectionObservers.size) {\n      return;\n    }\n    const resolvedInspectionEvent = {\n      ...event,\n      rootId: rootActor.sessionId\n    };\n    inspectionObservers.forEach(observer => observer.next?.(resolvedInspectionEvent));\n  };\n  const system = {\n    _snapshot: {\n      _scheduledEvents: (options?.snapshot && options.snapshot.scheduler) ?? {}\n    },\n    _bookId: () => `x:${idCounter++}`,\n    _register: (sessionId, actorRef) => {\n      children.set(sessionId, actorRef);\n      return sessionId;\n    },\n    _unregister: actorRef => {\n      children.delete(actorRef.sessionId);\n      const systemId = reverseKeyedActors.get(actorRef);\n      if (systemId !== undefined) {\n        keyedActors.delete(systemId);\n        reverseKeyedActors.delete(actorRef);\n      }\n    },\n    get: systemId => {\n      return keyedActors.get(systemId);\n    },\n    _set: (systemId, actorRef) => {\n      const existing = keyedActors.get(systemId);\n      if (existing && existing !== actorRef) {\n        throw new Error(`Actor with system ID '${systemId}' already exists.`);\n      }\n      keyedActors.set(systemId, actorRef);\n      reverseKeyedActors.set(actorRef, systemId);\n    },\n    inspect: observerOrFn => {\n      const observer = toObserver(observerOrFn);\n      inspectionObservers.add(observer);\n      return {\n        unsubscribe() {\n          inspectionObservers.delete(observer);\n        }\n      };\n    },\n    _sendInspectionEvent: sendInspectionEvent,\n    _relay: (source, target, event) => {\n      system._sendInspectionEvent({\n        type: '@xstate.event',\n        sourceRef: source,\n        actorRef: target,\n        event\n      });\n      target._send(event);\n    },\n    scheduler,\n    getSnapshot: () => {\n      return {\n        _scheduledEvents: {\n          ...system._snapshot._scheduledEvents\n        }\n      };\n    },\n    start: () => {\n      const scheduledEvents = system._snapshot._scheduledEvents;\n      system._snapshot._scheduledEvents = {};\n      for (const scheduledId in scheduledEvents) {\n        const {\n          source,\n          target,\n          event,\n          delay,\n          id\n        } = scheduledEvents[scheduledId];\n        scheduler.schedule(source, target, event, delay, id);\n      }\n    },\n    _clock: clock,\n    _logger: logger\n  };\n  return system;\n}\n\nlet executingCustomAction = false;\nconst $$ACTOR_TYPE = 1;\n\n// those values are currently used by @xstate/react directly so it's important to keep the assigned values in sync\nlet ProcessingStatus = /*#__PURE__*/function (ProcessingStatus) {\n  ProcessingStatus[ProcessingStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  ProcessingStatus[ProcessingStatus[\"Running\"] = 1] = \"Running\";\n  ProcessingStatus[ProcessingStatus[\"Stopped\"] = 2] = \"Stopped\";\n  return ProcessingStatus;\n}({});\nconst defaultOptions = {\n  clock: {\n    setTimeout: (fn, ms) => {\n      return setTimeout(fn, ms);\n    },\n    clearTimeout: id => {\n      return clearTimeout(id);\n    }\n  },\n  logger: console.log.bind(console),\n  devTools: false\n};\n\n/**\n * An Actor is a running process that can receive events, send events and change\n * its behavior based on the events it receives, which can cause effects outside\n * of the actor. When you run a state machine, it becomes an actor.\n */\nclass Actor {\n  /**\n   * Creates a new actor instance for the given logic with the provided options,\n   * if any.\n   *\n   * @param logic The logic to create an actor from\n   * @param options Actor options\n   */\n  constructor(logic, options) {\n    this.logic = logic;\n    /** The current internal state of the actor. */\n    this._snapshot = void 0;\n    /**\n     * The clock that is responsible for setting and clearing timeouts, such as\n     * delayed events and transitions.\n     */\n    this.clock = void 0;\n    this.options = void 0;\n    /** The unique identifier for this actor relative to its parent. */\n    this.id = void 0;\n    this.mailbox = new Mailbox(this._process.bind(this));\n    this.observers = new Set();\n    this.eventListeners = new Map();\n    this.logger = void 0;\n    /** @internal */\n    this._processingStatus = ProcessingStatus.NotStarted;\n    // Actor Ref\n    this._parent = void 0;\n    /** @internal */\n    this._syncSnapshot = void 0;\n    this.ref = void 0;\n    // TODO: add typings for system\n    this._actorScope = void 0;\n    this._systemId = void 0;\n    /** The globally unique process ID for this invocation. */\n    this.sessionId = void 0;\n    /** The system to which this actor belongs. */\n    this.system = void 0;\n    this._doneEvent = void 0;\n    this.src = void 0;\n    // array of functions to defer\n    this._deferred = [];\n    const resolvedOptions = {\n      ...defaultOptions,\n      ...options\n    };\n    const {\n      clock,\n      logger,\n      parent,\n      syncSnapshot,\n      id,\n      systemId,\n      inspect\n    } = resolvedOptions;\n    this.system = parent ? parent.system : createSystem(this, {\n      clock,\n      logger\n    });\n    if (inspect && !parent) {\n      // Always inspect at the system-level\n      this.system.inspect(toObserver(inspect));\n    }\n    this.sessionId = this.system._bookId();\n    this.id = id ?? this.sessionId;\n    this.logger = options?.logger ?? this.system._logger;\n    this.clock = options?.clock ?? this.system._clock;\n    this._parent = parent;\n    this._syncSnapshot = syncSnapshot;\n    this.options = resolvedOptions;\n    this.src = resolvedOptions.src ?? logic;\n    this.ref = this;\n    this._actorScope = {\n      self: this,\n      id: this.id,\n      sessionId: this.sessionId,\n      logger: this.logger,\n      defer: fn => {\n        this._deferred.push(fn);\n      },\n      system: this.system,\n      stopChild: child => {\n        if (child._parent !== this) {\n          throw new Error(`Cannot stop child actor ${child.id} of ${this.id} because it is not a child`);\n        }\n        child._stop();\n      },\n      emit: emittedEvent => {\n        const listeners = this.eventListeners.get(emittedEvent.type);\n        const wildcardListener = this.eventListeners.get('*');\n        if (!listeners && !wildcardListener) {\n          return;\n        }\n        const allListeners = [...(listeners ? listeners.values() : []), ...(wildcardListener ? wildcardListener.values() : [])];\n        for (const handler of allListeners) {\n          handler(emittedEvent);\n        }\n      },\n      actionExecutor: action => {\n        const exec = () => {\n          this._actorScope.system._sendInspectionEvent({\n            type: '@xstate.action',\n            actorRef: this,\n            action: {\n              type: action.type,\n              params: action.params\n            }\n          });\n          if (!action.exec) {\n            return;\n          }\n          const saveExecutingCustomAction = executingCustomAction;\n          try {\n            executingCustomAction = true;\n            action.exec(action.info, action.params);\n          } finally {\n            executingCustomAction = saveExecutingCustomAction;\n          }\n        };\n        if (this._processingStatus === ProcessingStatus.Running) {\n          exec();\n        } else {\n          this._deferred.push(exec);\n        }\n      }\n    };\n\n    // Ensure that the send method is bound to this Actor instance\n    // if destructured\n    this.send = this.send.bind(this);\n    this.system._sendInspectionEvent({\n      type: '@xstate.actor',\n      actorRef: this\n    });\n    if (systemId) {\n      this._systemId = systemId;\n      this.system._set(systemId, this);\n    }\n    this._initState(options?.snapshot ?? options?.state);\n    if (systemId && this._snapshot.status !== 'active') {\n      this.system._unregister(this);\n    }\n  }\n  _initState(persistedState) {\n    try {\n      this._snapshot = persistedState ? this.logic.restoreSnapshot ? this.logic.restoreSnapshot(persistedState, this._actorScope) : persistedState : this.logic.getInitialSnapshot(this._actorScope, this.options?.input);\n    } catch (err) {\n      // if we get here then it means that we assign a value to this._snapshot that is not of the correct type\n      // we can't get the true `TSnapshot & { status: 'error'; }`, it's impossible\n      // so right now this is a lie of sorts\n      this._snapshot = {\n        status: 'error',\n        output: undefined,\n        error: err\n      };\n    }\n  }\n  update(snapshot, event) {\n    // Update state\n    this._snapshot = snapshot;\n\n    // Execute deferred effects\n    let deferredFn;\n    while (deferredFn = this._deferred.shift()) {\n      try {\n        deferredFn();\n      } catch (err) {\n        // this error can only be caught when executing *initial* actions\n        // it's the only time when we call actions provided by the user through those deferreds\n        // when the actor is already running we always execute them synchronously while transitioning\n        // no \"builtin deferred\" should actually throw an error since they are either safe\n        // or the control flow is passed through the mailbox and errors should be caught by the `_process` used by the mailbox\n        this._deferred.length = 0;\n        this._snapshot = {\n          ...snapshot,\n          status: 'error',\n          error: err\n        };\n      }\n    }\n    switch (this._snapshot.status) {\n      case 'active':\n        for (const observer of this.observers) {\n          try {\n            observer.next?.(snapshot);\n          } catch (err) {\n            reportUnhandledError(err);\n          }\n        }\n        break;\n      case 'done':\n        // next observers are meant to be notified about done snapshots\n        // this can be seen as something that is different from how observable work\n        // but with observables `complete` callback is called without any arguments\n        // it's more ergonomic for XState to treat a done snapshot as a \"next\" value\n        // and the completion event as something that is separate,\n        // something that merely follows emitting that done snapshot\n        for (const observer of this.observers) {\n          try {\n            observer.next?.(snapshot);\n          } catch (err) {\n            reportUnhandledError(err);\n          }\n        }\n        this._stopProcedure();\n        this._complete();\n        this._doneEvent = createDoneActorEvent(this.id, this._snapshot.output);\n        if (this._parent) {\n          this.system._relay(this, this._parent, this._doneEvent);\n        }\n        break;\n      case 'error':\n        this._error(this._snapshot.error);\n        break;\n    }\n    this.system._sendInspectionEvent({\n      type: '@xstate.snapshot',\n      actorRef: this,\n      event,\n      snapshot\n    });\n  }\n\n  /**\n   * Subscribe an observer to an actors snapshot values.\n   *\n   * @remarks\n   * The observer will receive the actors snapshot value when it is emitted.\n   * The observer can be:\n   *\n   * - A plain function that receives the latest snapshot, or\n   * - An observer object whose `.next(snapshot)` method receives the latest\n   *   snapshot\n   *\n   * @example\n   *\n   * ```ts\n   * // Observer as a plain function\n   * const subscription = actor.subscribe((snapshot) => {\n   *   console.log(snapshot);\n   * });\n   * ```\n   *\n   * @example\n   *\n   * ```ts\n   * // Observer as an object\n   * const subscription = actor.subscribe({\n   *   next(snapshot) {\n   *     console.log(snapshot);\n   *   },\n   *   error(err) {\n   *     // ...\n   *   },\n   *   complete() {\n   *     // ...\n   *   }\n   * });\n   * ```\n   *\n   * The return value of `actor.subscribe(observer)` is a subscription object\n   * that has an `.unsubscribe()` method. You can call\n   * `subscription.unsubscribe()` to unsubscribe the observer:\n   *\n   * @example\n   *\n   * ```ts\n   * const subscription = actor.subscribe((snapshot) => {\n   *   // ...\n   * });\n   *\n   * // Unsubscribe the observer\n   * subscription.unsubscribe();\n   * ```\n   *\n   * When the actor is stopped, all of its observers will automatically be\n   * unsubscribed.\n   *\n   * @param observer - Either a plain function that receives the latest\n   *   snapshot, or an observer object whose `.next(snapshot)` method receives\n   *   the latest snapshot\n   */\n\n  subscribe(nextListenerOrObserver, errorListener, completeListener) {\n    const observer = toObserver(nextListenerOrObserver, errorListener, completeListener);\n    if (this._processingStatus !== ProcessingStatus.Stopped) {\n      this.observers.add(observer);\n    } else {\n      switch (this._snapshot.status) {\n        case 'done':\n          try {\n            observer.complete?.();\n          } catch (err) {\n            reportUnhandledError(err);\n          }\n          break;\n        case 'error':\n          {\n            const err = this._snapshot.error;\n            if (!observer.error) {\n              reportUnhandledError(err);\n            } else {\n              try {\n                observer.error(err);\n              } catch (err) {\n                reportUnhandledError(err);\n              }\n            }\n            break;\n          }\n      }\n    }\n    return {\n      unsubscribe: () => {\n        this.observers.delete(observer);\n      }\n    };\n  }\n  on(type, handler) {\n    let listeners = this.eventListeners.get(type);\n    if (!listeners) {\n      listeners = new Set();\n      this.eventListeners.set(type, listeners);\n    }\n    const wrappedHandler = handler.bind(undefined);\n    listeners.add(wrappedHandler);\n    return {\n      unsubscribe: () => {\n        listeners.delete(wrappedHandler);\n      }\n    };\n  }\n\n  /** Starts the Actor from the initial state */\n  start() {\n    if (this._processingStatus === ProcessingStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n    if (this._syncSnapshot) {\n      this.subscribe({\n        next: snapshot => {\n          if (snapshot.status === 'active') {\n            this.system._relay(this, this._parent, {\n              type: `xstate.snapshot.${this.id}`,\n              snapshot\n            });\n          }\n        },\n        error: () => {}\n      });\n    }\n    this.system._register(this.sessionId, this);\n    if (this._systemId) {\n      this.system._set(this._systemId, this);\n    }\n    this._processingStatus = ProcessingStatus.Running;\n\n    // TODO: this isn't correct when rehydrating\n    const initEvent = createInitEvent(this.options.input);\n    this.system._sendInspectionEvent({\n      type: '@xstate.event',\n      sourceRef: this._parent,\n      actorRef: this,\n      event: initEvent\n    });\n    const status = this._snapshot.status;\n    switch (status) {\n      case 'done':\n        // a state machine can be \"done\" upon initialization (it could reach a final state using initial microsteps)\n        // we still need to complete observers, flush deferreds etc\n        this.update(this._snapshot, initEvent);\n        // TODO: rethink cleanup of observers, mailbox, etc\n        return this;\n      case 'error':\n        this._error(this._snapshot.error);\n        return this;\n    }\n    if (!this._parent) {\n      this.system.start();\n    }\n    if (this.logic.start) {\n      try {\n        this.logic.start(this._snapshot, this._actorScope);\n      } catch (err) {\n        this._snapshot = {\n          ...this._snapshot,\n          status: 'error',\n          error: err\n        };\n        this._error(err);\n        return this;\n      }\n    }\n\n    // TODO: this notifies all subscribers but usually this is redundant\n    // there is no real change happening here\n    // we need to rethink if this needs to be refactored\n    this.update(this._snapshot, initEvent);\n    if (this.options.devTools) {\n      this.attachDevTools();\n    }\n    this.mailbox.start();\n    return this;\n  }\n  _process(event) {\n    let nextState;\n    let caughtError;\n    try {\n      nextState = this.logic.transition(this._snapshot, event, this._actorScope);\n    } catch (err) {\n      // we wrap it in a box so we can rethrow it later even if falsy value gets caught here\n      caughtError = {\n        err\n      };\n    }\n    if (caughtError) {\n      const {\n        err\n      } = caughtError;\n      this._snapshot = {\n        ...this._snapshot,\n        status: 'error',\n        error: err\n      };\n      this._error(err);\n      return;\n    }\n    this.update(nextState, event);\n    if (event.type === XSTATE_STOP) {\n      this._stopProcedure();\n      this._complete();\n    }\n  }\n  _stop() {\n    if (this._processingStatus === ProcessingStatus.Stopped) {\n      return this;\n    }\n    this.mailbox.clear();\n    if (this._processingStatus === ProcessingStatus.NotStarted) {\n      this._processingStatus = ProcessingStatus.Stopped;\n      return this;\n    }\n    this.mailbox.enqueue({\n      type: XSTATE_STOP\n    });\n    return this;\n  }\n\n  /** Stops the Actor and unsubscribe all listeners. */\n  stop() {\n    if (this._parent) {\n      throw new Error('A non-root actor cannot be stopped directly.');\n    }\n    return this._stop();\n  }\n  _complete() {\n    for (const observer of this.observers) {\n      try {\n        observer.complete?.();\n      } catch (err) {\n        reportUnhandledError(err);\n      }\n    }\n    this.observers.clear();\n  }\n  _reportError(err) {\n    if (!this.observers.size) {\n      if (!this._parent) {\n        reportUnhandledError(err);\n      }\n      return;\n    }\n    let reportError = false;\n    for (const observer of this.observers) {\n      const errorListener = observer.error;\n      reportError ||= !errorListener;\n      try {\n        errorListener?.(err);\n      } catch (err2) {\n        reportUnhandledError(err2);\n      }\n    }\n    this.observers.clear();\n    if (reportError) {\n      reportUnhandledError(err);\n    }\n  }\n  _error(err) {\n    this._stopProcedure();\n    this._reportError(err);\n    if (this._parent) {\n      this.system._relay(this, this._parent, createErrorActorEvent(this.id, err));\n    }\n  }\n  // TODO: atm children don't belong entirely to the actor so\n  // in a way - it's not even super aware of them\n  // so we can't stop them from here but we really should!\n  // right now, they are being stopped within the machine's transition\n  // but that could throw and leave us with \"orphaned\" active actors\n  _stopProcedure() {\n    if (this._processingStatus !== ProcessingStatus.Running) {\n      // Actor already stopped; do nothing\n      return this;\n    }\n\n    // Cancel all delayed events\n    this.system.scheduler.cancelAll(this);\n\n    // TODO: mailbox.reset\n    this.mailbox.clear();\n    // TODO: after `stop` we must prepare ourselves for receiving events again\n    // events sent *after* stop signal must be queued\n    // it seems like this should be the common behavior for all of our consumers\n    // so perhaps this should be unified somehow for all of them\n    this.mailbox = new Mailbox(this._process.bind(this));\n    this._processingStatus = ProcessingStatus.Stopped;\n    this.system._unregister(this);\n    return this;\n  }\n\n  /** @internal */\n  _send(event) {\n    if (this._processingStatus === ProcessingStatus.Stopped) {\n      // do nothing\n      {\n        const eventString = JSON.stringify(event);\n        console.warn(`Event \"${event.type}\" was sent to stopped actor \"${this.id} (${this.sessionId})\". This actor has already reached its final state, and will not transition.\\nEvent: ${eventString}`);\n      }\n      return;\n    }\n    this.mailbox.enqueue(event);\n  }\n\n  /**\n   * Sends an event to the running Actor to trigger a transition.\n   *\n   * @param event The event to send\n   */\n  send(event) {\n    if (typeof event === 'string') {\n      throw new Error(`Only event objects may be sent to actors; use .send({ type: \"${event}\" }) instead`);\n    }\n    this.system._relay(undefined, this, event);\n  }\n  attachDevTools() {\n    const {\n      devTools\n    } = this.options;\n    if (devTools) {\n      const resolvedDevToolsAdapter = typeof devTools === 'function' ? devTools : devToolsAdapter;\n      resolvedDevToolsAdapter(this);\n    }\n  }\n  toJSON() {\n    return {\n      xstate$$type: $$ACTOR_TYPE,\n      id: this.id\n    };\n  }\n\n  /**\n   * Obtain the internal state of the actor, which can be persisted.\n   *\n   * @remarks\n   * The internal state can be persisted from any actor, not only machines.\n   *\n   * Note that the persisted state is not the same as the snapshot from\n   * {@link Actor.getSnapshot}. Persisted state represents the internal state of\n   * the actor, while snapshots represent the actor's last emitted value.\n   *\n   * Can be restored with {@link ActorOptions.state}\n   * @see https://stately.ai/docs/persistence\n   */\n\n  getPersistedSnapshot(options) {\n    return this.logic.getPersistedSnapshot(this._snapshot, options);\n  }\n  [symbolObservable]() {\n    return this;\n  }\n\n  /**\n   * Read an actors snapshot synchronously.\n   *\n   * @remarks\n   * The snapshot represent an actor's last emitted value.\n   *\n   * When an actor receives an event, its internal state may change. An actor\n   * may emit a snapshot when a state transition occurs.\n   *\n   * Note that some actors, such as callback actors generated with\n   * `fromCallback`, will not emit snapshots.\n   * @see {@link Actor.subscribe} to subscribe to an actors snapshot values.\n   * @see {@link Actor.getPersistedSnapshot} to persist the internal state of an actor (which is more than just a snapshot).\n   */\n  getSnapshot() {\n    if (!this._snapshot) {\n      throw new Error(`Snapshot can't be read while the actor initializes itself`);\n    }\n    return this._snapshot;\n  }\n}\n/**\n * Creates a new actor instance for the given actor logic with the provided\n * options, if any.\n *\n * @remarks\n * When you create an actor from actor logic via `createActor(logic)`, you\n * implicitly create an actor system where the created actor is the root actor.\n * Any actors spawned from this root actor and its descendants are part of that\n * actor system.\n * @example\n *\n * ```ts\n * import { createActor } from 'xstate';\n * import { someActorLogic } from './someActorLogic.ts';\n *\n * // Creating the actor, which implicitly creates an actor system with itself as the root actor\n * const actor = createActor(someActorLogic);\n *\n * actor.subscribe((snapshot) => {\n *   console.log(snapshot);\n * });\n *\n * // Actors must be started by calling `actor.start()`, which will also start the actor system.\n * actor.start();\n *\n * // Actors can receive events\n * actor.send({ type: 'someEvent' });\n *\n * // You can stop root actors by calling `actor.stop()`, which will also stop the actor system and all actors in that system.\n * actor.stop();\n * ```\n *\n * @param logic - The actor logic to create an actor from. For a state machine\n *   actor logic creator, see {@link createMachine}. Other actor logic creators\n *   include {@link fromCallback}, {@link fromEventObservable},\n *   {@link fromObservable}, {@link fromPromise}, and {@link fromTransition}.\n * @param options - Actor options\n */\nfunction createActor(logic, ...[options]) {\n  return new Actor(logic, options);\n}\n\n/**\n * Creates a new Interpreter instance for the given machine with the provided\n * options, if any.\n *\n * @deprecated Use `createActor` instead\n * @alias\n */\nconst interpret = createActor;\n\n/**\n * @deprecated Use `Actor` instead.\n * @alias\n */\n\nfunction resolveCancel(_, snapshot, actionArgs, actionParams, {\n  sendId\n}) {\n  const resolvedSendId = typeof sendId === 'function' ? sendId(actionArgs, actionParams) : sendId;\n  return [snapshot, {\n    sendId: resolvedSendId\n  }, undefined];\n}\nfunction executeCancel(actorScope, params) {\n  actorScope.defer(() => {\n    actorScope.system.scheduler.cancel(actorScope.self, params.sendId);\n  });\n}\n/**\n * Cancels a delayed `sendTo(...)` action that is waiting to be executed. The\n * canceled `sendTo(...)` action will not send its event or execute, unless the\n * `delay` has already elapsed before `cancel(...)` is called.\n *\n * @example\n *\n * ```ts\n * import { createMachine, sendTo, cancel } from 'xstate';\n *\n * const machine = createMachine({\n *   // ...\n *   on: {\n *     sendEvent: {\n *       actions: sendTo(\n *         'some-actor',\n *         { type: 'someEvent' },\n *         {\n *           id: 'some-id',\n *           delay: 1000\n *         }\n *       )\n *     },\n *     cancelEvent: {\n *       actions: cancel('some-id')\n *     }\n *   }\n * });\n * ```\n *\n * @param sendId The `id` of the `sendTo(...)` action to cancel.\n */\nfunction cancel(sendId) {\n  function cancel(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  cancel.type = 'xstate.cancel';\n  cancel.sendId = sendId;\n  cancel.resolve = resolveCancel;\n  cancel.execute = executeCancel;\n  return cancel;\n}\n\nfunction resolveSpawn(actorScope, snapshot, actionArgs, _actionParams, {\n  id,\n  systemId,\n  src,\n  input,\n  syncSnapshot\n}) {\n  const logic = typeof src === 'string' ? resolveReferencedActor(snapshot.machine, src) : src;\n  const resolvedId = typeof id === 'function' ? id(actionArgs) : id;\n  let actorRef;\n  let resolvedInput = undefined;\n  if (logic) {\n    resolvedInput = typeof input === 'function' ? input({\n      context: snapshot.context,\n      event: actionArgs.event,\n      self: actorScope.self\n    }) : input;\n    actorRef = createActor(logic, {\n      id: resolvedId,\n      src,\n      parent: actorScope.self,\n      syncSnapshot,\n      systemId,\n      input: resolvedInput\n    });\n  }\n  if (!actorRef) {\n    console.warn(\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions,@typescript-eslint/no-base-to-string\n    `Actor type '${src}' not found in machine '${actorScope.id}'.`);\n  }\n  return [cloneMachineSnapshot(snapshot, {\n    children: {\n      ...snapshot.children,\n      [resolvedId]: actorRef\n    }\n  }), {\n    id,\n    systemId,\n    actorRef,\n    src,\n    input: resolvedInput\n  }, undefined];\n}\nfunction executeSpawn(actorScope, {\n  actorRef\n}) {\n  if (!actorRef) {\n    return;\n  }\n  actorScope.defer(() => {\n    if (actorRef._processingStatus === ProcessingStatus.Stopped) {\n      return;\n    }\n    actorRef.start();\n  });\n}\nfunction spawnChild(...[src, {\n  id,\n  systemId,\n  input,\n  syncSnapshot = false\n} = {}]) {\n  function spawnChild(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  spawnChild.type = 'xstate.spawnChild';\n  spawnChild.id = id;\n  spawnChild.systemId = systemId;\n  spawnChild.src = src;\n  spawnChild.input = input;\n  spawnChild.syncSnapshot = syncSnapshot;\n  spawnChild.resolve = resolveSpawn;\n  spawnChild.execute = executeSpawn;\n  return spawnChild;\n}\n\nfunction resolveStop(_, snapshot, args, actionParams, {\n  actorRef\n}) {\n  const actorRefOrString = typeof actorRef === 'function' ? actorRef(args, actionParams) : actorRef;\n  const resolvedActorRef = typeof actorRefOrString === 'string' ? snapshot.children[actorRefOrString] : actorRefOrString;\n  let children = snapshot.children;\n  if (resolvedActorRef) {\n    children = {\n      ...children\n    };\n    delete children[resolvedActorRef.id];\n  }\n  return [cloneMachineSnapshot(snapshot, {\n    children\n  }), resolvedActorRef, undefined];\n}\nfunction executeStop(actorScope, actorRef) {\n  if (!actorRef) {\n    return;\n  }\n\n  // we need to eagerly unregister it here so a new actor with the same systemId can be registered immediately\n  // since we defer actual stopping of the actor but we don't defer actor creations (and we can't do that)\n  // this could throw on `systemId` collision, for example, when dealing with reentering transitions\n  actorScope.system._unregister(actorRef);\n\n  // this allows us to prevent an actor from being started if it gets stopped within the same macrostep\n  // this can happen, for example, when the invoking state is being exited immediately by an always transition\n  if (actorRef._processingStatus !== ProcessingStatus.Running) {\n    actorScope.stopChild(actorRef);\n    return;\n  }\n  // stopping a child enqueues a stop event in the child actor's mailbox\n  // we need for all of the already enqueued events to be processed before we stop the child\n  // the parent itself might want to send some events to a child (for example from exit actions on the invoking state)\n  // and we don't want to ignore those events\n  actorScope.defer(() => {\n    actorScope.stopChild(actorRef);\n  });\n}\n/**\n * Stops a child actor.\n *\n * @param actorRef The actor to stop.\n */\nfunction stopChild(actorRef) {\n  function stop(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  stop.type = 'xstate.stopChild';\n  stop.actorRef = actorRef;\n  stop.resolve = resolveStop;\n  stop.execute = executeStop;\n  return stop;\n}\n\n/**\n * Stops a child actor.\n *\n * @deprecated Use `stopChild(...)` instead\n * @alias\n */\nconst stop = stopChild;\n\nfunction checkStateIn(snapshot, _, {\n  stateValue\n}) {\n  if (typeof stateValue === 'string' && isStateId(stateValue)) {\n    const target = snapshot.machine.getStateNodeById(stateValue);\n    return snapshot._nodes.some(sn => sn === target);\n  }\n  return snapshot.matches(stateValue);\n}\nfunction stateIn(stateValue) {\n  function stateIn() {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  stateIn.check = checkStateIn;\n  stateIn.stateValue = stateValue;\n  return stateIn;\n}\nfunction checkNot(snapshot, {\n  context,\n  event\n}, {\n  guards\n}) {\n  return !evaluateGuard(guards[0], context, event, snapshot);\n}\n\n/**\n * Higher-order guard that evaluates to `true` if the `guard` passed to it\n * evaluates to `false`.\n *\n * @category Guards\n * @example\n *\n * ```ts\n * import { setup, not } from 'xstate';\n *\n * const machine = setup({\n *   guards: {\n *     someNamedGuard: () => false\n *   }\n * }).createMachine({\n *   on: {\n *     someEvent: {\n *       guard: not('someNamedGuard'),\n *       actions: () => {\n *         // will be executed if guard in `not(...)`\n *         // evaluates to `false`\n *       }\n *     }\n *   }\n * });\n * ```\n *\n * @returns A guard\n */\nfunction not(guard) {\n  function not(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  not.check = checkNot;\n  not.guards = [guard];\n  return not;\n}\nfunction checkAnd(snapshot, {\n  context,\n  event\n}, {\n  guards\n}) {\n  return guards.every(guard => evaluateGuard(guard, context, event, snapshot));\n}\n\n/**\n * Higher-order guard that evaluates to `true` if all `guards` passed to it\n * evaluate to `true`.\n *\n * @category Guards\n * @example\n *\n * ```ts\n * import { setup, and } from 'xstate';\n *\n * const machine = setup({\n *   guards: {\n *     someNamedGuard: () => true\n *   }\n * }).createMachine({\n *   on: {\n *     someEvent: {\n *       guard: and([({ context }) => context.value > 0, 'someNamedGuard']),\n *       actions: () => {\n *         // will be executed if all guards in `and(...)`\n *         // evaluate to true\n *       }\n *     }\n *   }\n * });\n * ```\n *\n * @returns A guard action object\n */\nfunction and(guards) {\n  function and(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  and.check = checkAnd;\n  and.guards = guards;\n  return and;\n}\nfunction checkOr(snapshot, {\n  context,\n  event\n}, {\n  guards\n}) {\n  return guards.some(guard => evaluateGuard(guard, context, event, snapshot));\n}\n\n/**\n * Higher-order guard that evaluates to `true` if any of the `guards` passed to\n * it evaluate to `true`.\n *\n * @category Guards\n * @example\n *\n * ```ts\n * import { setup, or } from 'xstate';\n *\n * const machine = setup({\n *   guards: {\n *     someNamedGuard: () => true\n *   }\n * }).createMachine({\n *   on: {\n *     someEvent: {\n *       guard: or([({ context }) => context.value > 0, 'someNamedGuard']),\n *       actions: () => {\n *         // will be executed if any of the guards in `or(...)`\n *         // evaluate to true\n *       }\n *     }\n *   }\n * });\n * ```\n *\n * @returns A guard action object\n */\nfunction or(guards) {\n  function or(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  or.check = checkOr;\n  or.guards = guards;\n  return or;\n}\n\n// TODO: throw on cycles (depth check should be enough)\nfunction evaluateGuard(guard, context, event, snapshot) {\n  const {\n    machine\n  } = snapshot;\n  const isInline = typeof guard === 'function';\n  const resolved = isInline ? guard : machine.implementations.guards[typeof guard === 'string' ? guard : guard.type];\n  if (!isInline && !resolved) {\n    throw new Error(`Guard '${typeof guard === 'string' ? guard : guard.type}' is not implemented.'.`);\n  }\n  if (typeof resolved !== 'function') {\n    return evaluateGuard(resolved, context, event, snapshot);\n  }\n  const guardArgs = {\n    context,\n    event\n  };\n  const guardParams = isInline || typeof guard === 'string' ? undefined : 'params' in guard ? typeof guard.params === 'function' ? guard.params({\n    context,\n    event\n  }) : guard.params : undefined;\n  if (!('check' in resolved)) {\n    // the existing type of `.guards` assumes non-nullable `TExpressionGuard`\n    // inline guards expect `TExpressionGuard` to be set to `undefined`\n    // it's fine to cast this here, our logic makes sure that we call those 2 \"variants\" correctly\n    return resolved(guardArgs, guardParams);\n  }\n  const builtinGuard = resolved;\n  return builtinGuard.check(snapshot, guardArgs, resolved // this holds all params\n  );\n}\n\nconst isAtomicStateNode = stateNode => stateNode.type === 'atomic' || stateNode.type === 'final';\nfunction getChildren(stateNode) {\n  return Object.values(stateNode.states).filter(sn => sn.type !== 'history');\n}\nfunction getProperAncestors(stateNode, toStateNode) {\n  const ancestors = [];\n  if (toStateNode === stateNode) {\n    return ancestors;\n  }\n\n  // add all ancestors\n  let m = stateNode.parent;\n  while (m && m !== toStateNode) {\n    ancestors.push(m);\n    m = m.parent;\n  }\n  return ancestors;\n}\nfunction getAllStateNodes(stateNodes) {\n  const nodeSet = new Set(stateNodes);\n  const adjList = getAdjList(nodeSet);\n\n  // add descendants\n  for (const s of nodeSet) {\n    // if previously active, add existing child nodes\n    if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n      getInitialStateNodesWithTheirAncestors(s).forEach(sn => nodeSet.add(sn));\n    } else {\n      if (s.type === 'parallel') {\n        for (const child of getChildren(s)) {\n          if (child.type === 'history') {\n            continue;\n          }\n          if (!nodeSet.has(child)) {\n            const initialStates = getInitialStateNodesWithTheirAncestors(child);\n            for (const initialStateNode of initialStates) {\n              nodeSet.add(initialStateNode);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // add all ancestors\n  for (const s of nodeSet) {\n    let m = s.parent;\n    while (m) {\n      nodeSet.add(m);\n      m = m.parent;\n    }\n  }\n  return nodeSet;\n}\nfunction getValueFromAdj(baseNode, adjList) {\n  const childStateNodes = adjList.get(baseNode);\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n  if (baseNode.type === 'compound') {\n    const childStateNode = childStateNodes[0];\n    if (childStateNode) {\n      if (isAtomicStateNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n  const stateValue = {};\n  for (const childStateNode of childStateNodes) {\n    stateValue[childStateNode.key] = getValueFromAdj(childStateNode, adjList);\n  }\n  return stateValue;\n}\nfunction getAdjList(stateNodes) {\n  const adjList = new Map();\n  for (const s of stateNodes) {\n    if (!adjList.has(s)) {\n      adjList.set(s, []);\n    }\n    if (s.parent) {\n      if (!adjList.has(s.parent)) {\n        adjList.set(s.parent, []);\n      }\n      adjList.get(s.parent).push(s);\n    }\n  }\n  return adjList;\n}\nfunction getStateValue(rootNode, stateNodes) {\n  const config = getAllStateNodes(stateNodes);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\nfunction isInFinalState(stateNodeSet, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(s => s.type === 'final' && stateNodeSet.has(s));\n  }\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(sn => isInFinalState(stateNodeSet, sn));\n  }\n  return stateNode.type === 'final';\n}\nconst isStateId = str => str[0] === STATE_IDENTIFIER;\nfunction getCandidates(stateNode, receivedEventType) {\n  const candidates = stateNode.transitions.get(receivedEventType) || [...stateNode.transitions.keys()].filter(eventDescriptor => {\n    // check if transition is a wildcard transition,\n    // which matches any non-transient events\n    if (eventDescriptor === WILDCARD) {\n      return true;\n    }\n    if (!eventDescriptor.endsWith('.*')) {\n      return false;\n    }\n    if (/.*\\*.+/.test(eventDescriptor)) {\n      console.warn(`Wildcards can only be the last token of an event descriptor (e.g., \"event.*\") or the entire event descriptor (\"*\"). Check the \"${eventDescriptor}\" event.`);\n    }\n    const partialEventTokens = eventDescriptor.split('.');\n    const eventTokens = receivedEventType.split('.');\n    for (let tokenIndex = 0; tokenIndex < partialEventTokens.length; tokenIndex++) {\n      const partialEventToken = partialEventTokens[tokenIndex];\n      const eventToken = eventTokens[tokenIndex];\n      if (partialEventToken === '*') {\n        const isLastToken = tokenIndex === partialEventTokens.length - 1;\n        if (!isLastToken) {\n          console.warn(`Infix wildcards in transition events are not allowed. Check the \"${eventDescriptor}\" transition.`);\n        }\n        return isLastToken;\n      }\n      if (partialEventToken !== eventToken) {\n        return false;\n      }\n    }\n    return true;\n  }).sort((a, b) => b.length - a.length).flatMap(key => stateNode.transitions.get(key));\n  return candidates;\n}\n\n/** All delayed transitions from the config. */\nfunction getDelayedTransitions(stateNode) {\n  const afterConfig = stateNode.config.after;\n  if (!afterConfig) {\n    return [];\n  }\n  const mutateEntryExit = delay => {\n    const afterEvent = createAfterEvent(delay, stateNode.id);\n    const eventType = afterEvent.type;\n    stateNode.entry.push(raise(afterEvent, {\n      id: eventType,\n      delay\n    }));\n    stateNode.exit.push(cancel(eventType));\n    return eventType;\n  };\n  const delayedTransitions = Object.keys(afterConfig).flatMap(delay => {\n    const configTransition = afterConfig[delay];\n    const resolvedTransition = typeof configTransition === 'string' ? {\n      target: configTransition\n    } : configTransition;\n    const resolvedDelay = Number.isNaN(+delay) ? delay : +delay;\n    const eventType = mutateEntryExit(resolvedDelay);\n    return toArray(resolvedTransition).map(transition => ({\n      ...transition,\n      event: eventType,\n      delay: resolvedDelay\n    }));\n  });\n  return delayedTransitions.map(delayedTransition => {\n    const {\n      delay\n    } = delayedTransition;\n    return {\n      ...formatTransition(stateNode, delayedTransition.event, delayedTransition),\n      delay\n    };\n  });\n}\nfunction formatTransition(stateNode, descriptor, transitionConfig) {\n  const normalizedTarget = normalizeTarget(transitionConfig.target);\n  const reenter = transitionConfig.reenter ?? false;\n  const target = resolveTarget(stateNode, normalizedTarget);\n\n  // TODO: should this be part of a lint rule instead?\n  if (transitionConfig.cond) {\n    throw new Error(`State \"${stateNode.id}\" has declared \\`cond\\` for one of its transitions. This property has been renamed to \\`guard\\`. Please update your code.`);\n  }\n  const transition = {\n    ...transitionConfig,\n    actions: toArray(transitionConfig.actions),\n    guard: transitionConfig.guard,\n    target,\n    source: stateNode,\n    reenter,\n    eventType: descriptor,\n    toJSON: () => ({\n      ...transition,\n      source: `#${stateNode.id}`,\n      target: target ? target.map(t => `#${t.id}`) : undefined\n    })\n  };\n  return transition;\n}\nfunction formatTransitions(stateNode) {\n  const transitions = new Map();\n  if (stateNode.config.on) {\n    for (const descriptor of Object.keys(stateNode.config.on)) {\n      if (descriptor === NULL_EVENT) {\n        throw new Error('Null events (\"\") cannot be specified as a transition key. Use `always: { ... }` instead.');\n      }\n      const transitionsConfig = stateNode.config.on[descriptor];\n      transitions.set(descriptor, toTransitionConfigArray(transitionsConfig).map(t => formatTransition(stateNode, descriptor, t)));\n    }\n  }\n  if (stateNode.config.onDone) {\n    const descriptor = `xstate.done.state.${stateNode.id}`;\n    transitions.set(descriptor, toTransitionConfigArray(stateNode.config.onDone).map(t => formatTransition(stateNode, descriptor, t)));\n  }\n  for (const invokeDef of stateNode.invoke) {\n    if (invokeDef.onDone) {\n      const descriptor = `xstate.done.actor.${invokeDef.id}`;\n      transitions.set(descriptor, toTransitionConfigArray(invokeDef.onDone).map(t => formatTransition(stateNode, descriptor, t)));\n    }\n    if (invokeDef.onError) {\n      const descriptor = `xstate.error.actor.${invokeDef.id}`;\n      transitions.set(descriptor, toTransitionConfigArray(invokeDef.onError).map(t => formatTransition(stateNode, descriptor, t)));\n    }\n    if (invokeDef.onSnapshot) {\n      const descriptor = `xstate.snapshot.${invokeDef.id}`;\n      transitions.set(descriptor, toTransitionConfigArray(invokeDef.onSnapshot).map(t => formatTransition(stateNode, descriptor, t)));\n    }\n  }\n  for (const delayedTransition of stateNode.after) {\n    let existing = transitions.get(delayedTransition.eventType);\n    if (!existing) {\n      existing = [];\n      transitions.set(delayedTransition.eventType, existing);\n    }\n    existing.push(delayedTransition);\n  }\n  return transitions;\n}\nfunction formatInitialTransition(stateNode, _target) {\n  const resolvedTarget = typeof _target === 'string' ? stateNode.states[_target] : _target ? stateNode.states[_target.target] : undefined;\n  if (!resolvedTarget && _target) {\n    throw new Error(\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions, @typescript-eslint/no-base-to-string\n    `Initial state node \"${_target}\" not found on parent state node #${stateNode.id}`);\n  }\n  const transition = {\n    source: stateNode,\n    actions: !_target || typeof _target === 'string' ? [] : toArray(_target.actions),\n    eventType: null,\n    reenter: false,\n    target: resolvedTarget ? [resolvedTarget] : [],\n    toJSON: () => ({\n      ...transition,\n      source: `#${stateNode.id}`,\n      target: resolvedTarget ? [`#${resolvedTarget.id}`] : []\n    })\n  };\n  return transition;\n}\nfunction resolveTarget(stateNode, targets) {\n  if (targets === undefined) {\n    // an undefined target signals that the state node should not transition from that state when receiving that event\n    return undefined;\n  }\n  return targets.map(target => {\n    if (typeof target !== 'string') {\n      return target;\n    }\n    if (isStateId(target)) {\n      return stateNode.machine.getStateNodeById(target);\n    }\n    const isInternalTarget = target[0] === STATE_DELIMITER;\n    // If internal target is defined on machine,\n    // do not include machine key on target\n    if (isInternalTarget && !stateNode.parent) {\n      return getStateNodeByPath(stateNode, target.slice(1));\n    }\n    const resolvedTarget = isInternalTarget ? stateNode.key + target : target;\n    if (stateNode.parent) {\n      try {\n        const targetStateNode = getStateNodeByPath(stateNode.parent, resolvedTarget);\n        return targetStateNode;\n      } catch (err) {\n        throw new Error(`Invalid transition definition for state node '${stateNode.id}':\\n${err.message}`);\n      }\n    } else {\n      throw new Error(`Invalid target: \"${target}\" is not a valid target from the root node. Did you mean \".${target}\"?`);\n    }\n  });\n}\nfunction resolveHistoryDefaultTransition(stateNode) {\n  const normalizedTarget = normalizeTarget(stateNode.config.target);\n  if (!normalizedTarget) {\n    return stateNode.parent.initial;\n  }\n  return {\n    target: normalizedTarget.map(t => typeof t === 'string' ? getStateNodeByPath(stateNode.parent, t) : t)\n  };\n}\nfunction isHistoryNode(stateNode) {\n  return stateNode.type === 'history';\n}\nfunction getInitialStateNodesWithTheirAncestors(stateNode) {\n  const states = getInitialStateNodes(stateNode);\n  for (const initialState of states) {\n    for (const ancestor of getProperAncestors(initialState, stateNode)) {\n      states.add(ancestor);\n    }\n  }\n  return states;\n}\nfunction getInitialStateNodes(stateNode) {\n  const set = new Set();\n  function iter(descStateNode) {\n    if (set.has(descStateNode)) {\n      return;\n    }\n    set.add(descStateNode);\n    if (descStateNode.type === 'compound') {\n      iter(descStateNode.initial.target[0]);\n    } else if (descStateNode.type === 'parallel') {\n      for (const child of getChildren(descStateNode)) {\n        iter(child);\n      }\n    }\n  }\n  iter(stateNode);\n  return set;\n}\n/** Returns the child state node from its relative `stateKey`, or throws. */\nfunction getStateNode(stateNode, stateKey) {\n  if (isStateId(stateKey)) {\n    return stateNode.machine.getStateNodeById(stateKey);\n  }\n  if (!stateNode.states) {\n    throw new Error(`Unable to retrieve child state '${stateKey}' from '${stateNode.id}'; no child states exist.`);\n  }\n  const result = stateNode.states[stateKey];\n  if (!result) {\n    throw new Error(`Child state '${stateKey}' does not exist on '${stateNode.id}'`);\n  }\n  return result;\n}\n\n/**\n * Returns the relative state node from the given `statePath`, or throws.\n *\n * @param statePath The string or string array relative path to the state node.\n */\nfunction getStateNodeByPath(stateNode, statePath) {\n  if (typeof statePath === 'string' && isStateId(statePath)) {\n    try {\n      return stateNode.machine.getStateNodeById(statePath);\n    } catch {\n      // try individual paths\n      // throw e;\n    }\n  }\n  const arrayStatePath = toStatePath(statePath).slice();\n  let currentStateNode = stateNode;\n  while (arrayStatePath.length) {\n    const key = arrayStatePath.shift();\n    if (!key.length) {\n      break;\n    }\n    currentStateNode = getStateNode(currentStateNode, key);\n  }\n  return currentStateNode;\n}\n\n/**\n * Returns the state nodes represented by the current state value.\n *\n * @param stateValue The state value or State instance\n */\nfunction getStateNodes(stateNode, stateValue) {\n  if (typeof stateValue === 'string') {\n    const childStateNode = stateNode.states[stateValue];\n    if (!childStateNode) {\n      throw new Error(`State '${stateValue}' does not exist on '${stateNode.id}'`);\n    }\n    return [stateNode, childStateNode];\n  }\n  const childStateKeys = Object.keys(stateValue);\n  const childStateNodes = childStateKeys.map(subStateKey => getStateNode(stateNode, subStateKey)).filter(Boolean);\n  return [stateNode.machine.root, stateNode].concat(childStateNodes, childStateKeys.reduce((allSubStateNodes, subStateKey) => {\n    const subStateNode = getStateNode(stateNode, subStateKey);\n    if (!subStateNode) {\n      return allSubStateNodes;\n    }\n    const subStateNodes = getStateNodes(subStateNode, stateValue[subStateKey]);\n    return allSubStateNodes.concat(subStateNodes);\n  }, []));\n}\nfunction transitionAtomicNode(stateNode, stateValue, snapshot, event) {\n  const childStateNode = getStateNode(stateNode, stateValue);\n  const next = childStateNode.next(snapshot, event);\n  if (!next || !next.length) {\n    return stateNode.next(snapshot, event);\n  }\n  return next;\n}\nfunction transitionCompoundNode(stateNode, stateValue, snapshot, event) {\n  const subStateKeys = Object.keys(stateValue);\n  const childStateNode = getStateNode(stateNode, subStateKeys[0]);\n  const next = transitionNode(childStateNode, stateValue[subStateKeys[0]], snapshot, event);\n  if (!next || !next.length) {\n    return stateNode.next(snapshot, event);\n  }\n  return next;\n}\nfunction transitionParallelNode(stateNode, stateValue, snapshot, event) {\n  const allInnerTransitions = [];\n  for (const subStateKey of Object.keys(stateValue)) {\n    const subStateValue = stateValue[subStateKey];\n    if (!subStateValue) {\n      continue;\n    }\n    const subStateNode = getStateNode(stateNode, subStateKey);\n    const innerTransitions = transitionNode(subStateNode, subStateValue, snapshot, event);\n    if (innerTransitions) {\n      allInnerTransitions.push(...innerTransitions);\n    }\n  }\n  if (!allInnerTransitions.length) {\n    return stateNode.next(snapshot, event);\n  }\n  return allInnerTransitions;\n}\nfunction transitionNode(stateNode, stateValue, snapshot, event) {\n  // leaf node\n  if (typeof stateValue === 'string') {\n    return transitionAtomicNode(stateNode, stateValue, snapshot, event);\n  }\n\n  // compound node\n  if (Object.keys(stateValue).length === 1) {\n    return transitionCompoundNode(stateNode, stateValue, snapshot, event);\n  }\n\n  // parallel node\n  return transitionParallelNode(stateNode, stateValue, snapshot, event);\n}\nfunction getHistoryNodes(stateNode) {\n  return Object.keys(stateNode.states).map(key => stateNode.states[key]).filter(sn => sn.type === 'history');\n}\nfunction isDescendant(childStateNode, parentStateNode) {\n  let marker = childStateNode;\n  while (marker.parent && marker.parent !== parentStateNode) {\n    marker = marker.parent;\n  }\n  return marker.parent === parentStateNode;\n}\nfunction hasIntersection(s1, s2) {\n  const set1 = new Set(s1);\n  const set2 = new Set(s2);\n  for (const item of set1) {\n    if (set2.has(item)) {\n      return true;\n    }\n  }\n  for (const item of set2) {\n    if (set1.has(item)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction removeConflictingTransitions(enabledTransitions, stateNodeSet, historyValue) {\n  const filteredTransitions = new Set();\n  for (const t1 of enabledTransitions) {\n    let t1Preempted = false;\n    const transitionsToRemove = new Set();\n    for (const t2 of filteredTransitions) {\n      if (hasIntersection(computeExitSet([t1], stateNodeSet, historyValue), computeExitSet([t2], stateNodeSet, historyValue))) {\n        if (isDescendant(t1.source, t2.source)) {\n          transitionsToRemove.add(t2);\n        } else {\n          t1Preempted = true;\n          break;\n        }\n      }\n    }\n    if (!t1Preempted) {\n      for (const t3 of transitionsToRemove) {\n        filteredTransitions.delete(t3);\n      }\n      filteredTransitions.add(t1);\n    }\n  }\n  return Array.from(filteredTransitions);\n}\nfunction findLeastCommonAncestor(stateNodes) {\n  const [head, ...tail] = stateNodes;\n  for (const ancestor of getProperAncestors(head, undefined)) {\n    if (tail.every(sn => isDescendant(sn, ancestor))) {\n      return ancestor;\n    }\n  }\n}\nfunction getEffectiveTargetStates(transition, historyValue) {\n  if (!transition.target) {\n    return [];\n  }\n  const targets = new Set();\n  for (const targetNode of transition.target) {\n    if (isHistoryNode(targetNode)) {\n      if (historyValue[targetNode.id]) {\n        for (const node of historyValue[targetNode.id]) {\n          targets.add(node);\n        }\n      } else {\n        for (const node of getEffectiveTargetStates(resolveHistoryDefaultTransition(targetNode), historyValue)) {\n          targets.add(node);\n        }\n      }\n    } else {\n      targets.add(targetNode);\n    }\n  }\n  return [...targets];\n}\nfunction getTransitionDomain(transition, historyValue) {\n  const targetStates = getEffectiveTargetStates(transition, historyValue);\n  if (!targetStates) {\n    return;\n  }\n  if (!transition.reenter && targetStates.every(target => target === transition.source || isDescendant(target, transition.source))) {\n    return transition.source;\n  }\n  const lca = findLeastCommonAncestor(targetStates.concat(transition.source));\n  if (lca) {\n    return lca;\n  }\n\n  // at this point we know that it's a root transition since LCA couldn't be found\n  if (transition.reenter) {\n    return;\n  }\n  return transition.source.machine.root;\n}\nfunction computeExitSet(transitions, stateNodeSet, historyValue) {\n  const statesToExit = new Set();\n  for (const t of transitions) {\n    if (t.target?.length) {\n      const domain = getTransitionDomain(t, historyValue);\n      if (t.reenter && t.source === domain) {\n        statesToExit.add(domain);\n      }\n      for (const stateNode of stateNodeSet) {\n        if (isDescendant(stateNode, domain)) {\n          statesToExit.add(stateNode);\n        }\n      }\n    }\n  }\n  return [...statesToExit];\n}\nfunction areStateNodeCollectionsEqual(prevStateNodes, nextStateNodeSet) {\n  if (prevStateNodes.length !== nextStateNodeSet.size) {\n    return false;\n  }\n  for (const node of prevStateNodes) {\n    if (!nextStateNodeSet.has(node)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/** https://www.w3.org/TR/scxml/#microstepProcedure */\nfunction microstep(transitions, currentSnapshot, actorScope, event, isInitial, internalQueue) {\n  if (!transitions.length) {\n    return currentSnapshot;\n  }\n  const mutStateNodeSet = new Set(currentSnapshot._nodes);\n  let historyValue = currentSnapshot.historyValue;\n  const filteredTransitions = removeConflictingTransitions(transitions, mutStateNodeSet, historyValue);\n  let nextState = currentSnapshot;\n\n  // Exit states\n  if (!isInitial) {\n    [nextState, historyValue] = exitStates(nextState, event, actorScope, filteredTransitions, mutStateNodeSet, historyValue, internalQueue, actorScope.actionExecutor);\n  }\n\n  // Execute transition content\n  nextState = resolveActionsAndContext(nextState, event, actorScope, filteredTransitions.flatMap(t => t.actions), internalQueue, undefined);\n\n  // Enter states\n  nextState = enterStates(nextState, event, actorScope, filteredTransitions, mutStateNodeSet, internalQueue, historyValue, isInitial);\n  const nextStateNodes = [...mutStateNodeSet];\n  if (nextState.status === 'done') {\n    nextState = resolveActionsAndContext(nextState, event, actorScope, nextStateNodes.sort((a, b) => b.order - a.order).flatMap(state => state.exit), internalQueue, undefined);\n  }\n\n  // eslint-disable-next-line no-useless-catch\n  try {\n    if (historyValue === currentSnapshot.historyValue && areStateNodeCollectionsEqual(currentSnapshot._nodes, mutStateNodeSet)) {\n      return nextState;\n    }\n    return cloneMachineSnapshot(nextState, {\n      _nodes: nextStateNodes,\n      historyValue\n    });\n  } catch (e) {\n    // TODO: Refactor this once proper error handling is implemented.\n    // See https://github.com/statelyai/rfcs/pull/4\n    throw e;\n  }\n}\nfunction getMachineOutput(snapshot, event, actorScope, rootNode, rootCompletionNode) {\n  if (rootNode.output === undefined) {\n    return;\n  }\n  const doneStateEvent = createDoneStateEvent(rootCompletionNode.id, rootCompletionNode.output !== undefined && rootCompletionNode.parent ? resolveOutput(rootCompletionNode.output, snapshot.context, event, actorScope.self) : undefined);\n  return resolveOutput(rootNode.output, snapshot.context, doneStateEvent, actorScope.self);\n}\nfunction enterStates(currentSnapshot, event, actorScope, filteredTransitions, mutStateNodeSet, internalQueue, historyValue, isInitial) {\n  let nextSnapshot = currentSnapshot;\n  const statesToEnter = new Set();\n  // those are states that were directly targeted or indirectly targeted by the explicit target\n  // in other words, those are states for which initial actions should be executed\n  // when we target `#deep_child` initial actions of its ancestors shouldn't be executed\n  const statesForDefaultEntry = new Set();\n  computeEntrySet(filteredTransitions, historyValue, statesForDefaultEntry, statesToEnter);\n\n  // In the initial state, the root state node is \"entered\".\n  if (isInitial) {\n    statesForDefaultEntry.add(currentSnapshot.machine.root);\n  }\n  const completedNodes = new Set();\n  for (const stateNodeToEnter of [...statesToEnter].sort((a, b) => a.order - b.order)) {\n    mutStateNodeSet.add(stateNodeToEnter);\n    const actions = [];\n\n    // Add entry actions\n    actions.push(...stateNodeToEnter.entry);\n    for (const invokeDef of stateNodeToEnter.invoke) {\n      actions.push(spawnChild(invokeDef.src, {\n        ...invokeDef,\n        syncSnapshot: !!invokeDef.onSnapshot\n      }));\n    }\n    if (statesForDefaultEntry.has(stateNodeToEnter)) {\n      const initialActions = stateNodeToEnter.initial.actions;\n      actions.push(...initialActions);\n    }\n    nextSnapshot = resolveActionsAndContext(nextSnapshot, event, actorScope, actions, internalQueue, stateNodeToEnter.invoke.map(invokeDef => invokeDef.id));\n    if (stateNodeToEnter.type === 'final') {\n      const parent = stateNodeToEnter.parent;\n      let ancestorMarker = parent?.type === 'parallel' ? parent : parent?.parent;\n      let rootCompletionNode = ancestorMarker || stateNodeToEnter;\n      if (parent?.type === 'compound') {\n        internalQueue.push(createDoneStateEvent(parent.id, stateNodeToEnter.output !== undefined ? resolveOutput(stateNodeToEnter.output, nextSnapshot.context, event, actorScope.self) : undefined));\n      }\n      while (ancestorMarker?.type === 'parallel' && !completedNodes.has(ancestorMarker) && isInFinalState(mutStateNodeSet, ancestorMarker)) {\n        completedNodes.add(ancestorMarker);\n        internalQueue.push(createDoneStateEvent(ancestorMarker.id));\n        rootCompletionNode = ancestorMarker;\n        ancestorMarker = ancestorMarker.parent;\n      }\n      if (ancestorMarker) {\n        continue;\n      }\n      nextSnapshot = cloneMachineSnapshot(nextSnapshot, {\n        status: 'done',\n        output: getMachineOutput(nextSnapshot, event, actorScope, nextSnapshot.machine.root, rootCompletionNode)\n      });\n    }\n  }\n  return nextSnapshot;\n}\nfunction computeEntrySet(transitions, historyValue, statesForDefaultEntry, statesToEnter) {\n  for (const t of transitions) {\n    const domain = getTransitionDomain(t, historyValue);\n    for (const s of t.target || []) {\n      if (!isHistoryNode(s) && (\n      // if the target is different than the source then it will *definitely* be entered\n      t.source !== s ||\n      // we know that the domain can't lie within the source\n      // if it's different than the source then it's outside of it and it means that the target has to be entered as well\n      t.source !== domain ||\n      // reentering transitions always enter the target, even if it's the source itself\n      t.reenter)) {\n        statesToEnter.add(s);\n        statesForDefaultEntry.add(s);\n      }\n      addDescendantStatesToEnter(s, historyValue, statesForDefaultEntry, statesToEnter);\n    }\n    const targetStates = getEffectiveTargetStates(t, historyValue);\n    for (const s of targetStates) {\n      const ancestors = getProperAncestors(s, domain);\n      if (domain?.type === 'parallel') {\n        ancestors.push(domain);\n      }\n      addAncestorStatesToEnter(statesToEnter, historyValue, statesForDefaultEntry, ancestors, !t.source.parent && t.reenter ? undefined : domain);\n    }\n  }\n}\nfunction addDescendantStatesToEnter(stateNode, historyValue, statesForDefaultEntry, statesToEnter) {\n  if (isHistoryNode(stateNode)) {\n    if (historyValue[stateNode.id]) {\n      const historyStateNodes = historyValue[stateNode.id];\n      for (const s of historyStateNodes) {\n        statesToEnter.add(s);\n        addDescendantStatesToEnter(s, historyValue, statesForDefaultEntry, statesToEnter);\n      }\n      for (const s of historyStateNodes) {\n        addProperAncestorStatesToEnter(s, stateNode.parent, statesToEnter, historyValue, statesForDefaultEntry);\n      }\n    } else {\n      const historyDefaultTransition = resolveHistoryDefaultTransition(stateNode);\n      for (const s of historyDefaultTransition.target) {\n        statesToEnter.add(s);\n        if (historyDefaultTransition === stateNode.parent?.initial) {\n          statesForDefaultEntry.add(stateNode.parent);\n        }\n        addDescendantStatesToEnter(s, historyValue, statesForDefaultEntry, statesToEnter);\n      }\n      for (const s of historyDefaultTransition.target) {\n        addProperAncestorStatesToEnter(s, stateNode.parent, statesToEnter, historyValue, statesForDefaultEntry);\n      }\n    }\n  } else {\n    if (stateNode.type === 'compound') {\n      const [initialState] = stateNode.initial.target;\n      if (!isHistoryNode(initialState)) {\n        statesToEnter.add(initialState);\n        statesForDefaultEntry.add(initialState);\n      }\n      addDescendantStatesToEnter(initialState, historyValue, statesForDefaultEntry, statesToEnter);\n      addProperAncestorStatesToEnter(initialState, stateNode, statesToEnter, historyValue, statesForDefaultEntry);\n    } else {\n      if (stateNode.type === 'parallel') {\n        for (const child of getChildren(stateNode).filter(sn => !isHistoryNode(sn))) {\n          if (![...statesToEnter].some(s => isDescendant(s, child))) {\n            if (!isHistoryNode(child)) {\n              statesToEnter.add(child);\n              statesForDefaultEntry.add(child);\n            }\n            addDescendantStatesToEnter(child, historyValue, statesForDefaultEntry, statesToEnter);\n          }\n        }\n      }\n    }\n  }\n}\nfunction addAncestorStatesToEnter(statesToEnter, historyValue, statesForDefaultEntry, ancestors, reentrancyDomain) {\n  for (const anc of ancestors) {\n    if (!reentrancyDomain || isDescendant(anc, reentrancyDomain)) {\n      statesToEnter.add(anc);\n    }\n    if (anc.type === 'parallel') {\n      for (const child of getChildren(anc).filter(sn => !isHistoryNode(sn))) {\n        if (![...statesToEnter].some(s => isDescendant(s, child))) {\n          statesToEnter.add(child);\n          addDescendantStatesToEnter(child, historyValue, statesForDefaultEntry, statesToEnter);\n        }\n      }\n    }\n  }\n}\nfunction addProperAncestorStatesToEnter(stateNode, toStateNode, statesToEnter, historyValue, statesForDefaultEntry) {\n  addAncestorStatesToEnter(statesToEnter, historyValue, statesForDefaultEntry, getProperAncestors(stateNode, toStateNode));\n}\nfunction exitStates(currentSnapshot, event, actorScope, transitions, mutStateNodeSet, historyValue, internalQueue, _actionExecutor) {\n  let nextSnapshot = currentSnapshot;\n  const statesToExit = computeExitSet(transitions, mutStateNodeSet, historyValue);\n  statesToExit.sort((a, b) => b.order - a.order);\n  let changedHistory;\n\n  // From SCXML algorithm: https://www.w3.org/TR/scxml/#exitStates\n  for (const exitStateNode of statesToExit) {\n    for (const historyNode of getHistoryNodes(exitStateNode)) {\n      let predicate;\n      if (historyNode.history === 'deep') {\n        predicate = sn => isAtomicStateNode(sn) && isDescendant(sn, exitStateNode);\n      } else {\n        predicate = sn => {\n          return sn.parent === exitStateNode;\n        };\n      }\n      changedHistory ??= {\n        ...historyValue\n      };\n      changedHistory[historyNode.id] = Array.from(mutStateNodeSet).filter(predicate);\n    }\n  }\n  for (const s of statesToExit) {\n    nextSnapshot = resolveActionsAndContext(nextSnapshot, event, actorScope, [...s.exit, ...s.invoke.map(def => stopChild(def.id))], internalQueue, undefined);\n    mutStateNodeSet.delete(s);\n  }\n  return [nextSnapshot, changedHistory || historyValue];\n}\nfunction getAction(machine, actionType) {\n  return machine.implementations.actions[actionType];\n}\nfunction resolveAndExecuteActionsWithContext(currentSnapshot, event, actorScope, actions, extra, retries) {\n  const {\n    machine\n  } = currentSnapshot;\n  let intermediateSnapshot = currentSnapshot;\n  for (const action of actions) {\n    const isInline = typeof action === 'function';\n    const resolvedAction = isInline ? action :\n    // the existing type of `.actions` assumes non-nullable `TExpressionAction`\n    // it's fine to cast this here to get a common type and lack of errors in the rest of the code\n    // our logic below makes sure that we call those 2 \"variants\" correctly\n\n    getAction(machine, typeof action === 'string' ? action : action.type);\n    const actionArgs = {\n      context: intermediateSnapshot.context,\n      event,\n      self: actorScope.self,\n      system: actorScope.system\n    };\n    const actionParams = isInline || typeof action === 'string' ? undefined : 'params' in action ? typeof action.params === 'function' ? action.params({\n      context: intermediateSnapshot.context,\n      event\n    }) : action.params : undefined;\n    if (!resolvedAction || !('resolve' in resolvedAction)) {\n      actorScope.actionExecutor({\n        type: typeof action === 'string' ? action : typeof action === 'object' ? action.type : action.name || '(anonymous)',\n        info: actionArgs,\n        params: actionParams,\n        exec: resolvedAction\n      });\n      continue;\n    }\n    const builtinAction = resolvedAction;\n    const [nextState, params, actions] = builtinAction.resolve(actorScope, intermediateSnapshot, actionArgs, actionParams, resolvedAction,\n    // this holds all params\n    extra);\n    intermediateSnapshot = nextState;\n    if ('retryResolve' in builtinAction) {\n      retries?.push([builtinAction, params]);\n    }\n    if ('execute' in builtinAction) {\n      actorScope.actionExecutor({\n        type: builtinAction.type,\n        info: actionArgs,\n        params,\n        exec: builtinAction.execute.bind(null, actorScope, params)\n      });\n    }\n    if (actions) {\n      intermediateSnapshot = resolveAndExecuteActionsWithContext(intermediateSnapshot, event, actorScope, actions, extra, retries);\n    }\n  }\n  return intermediateSnapshot;\n}\nfunction resolveActionsAndContext(currentSnapshot, event, actorScope, actions, internalQueue, deferredActorIds) {\n  const retries = deferredActorIds ? [] : undefined;\n  const nextState = resolveAndExecuteActionsWithContext(currentSnapshot, event, actorScope, actions, {\n    internalQueue,\n    deferredActorIds\n  }, retries);\n  retries?.forEach(([builtinAction, params]) => {\n    builtinAction.retryResolve(actorScope, nextState, params);\n  });\n  return nextState;\n}\nfunction macrostep(snapshot, event, actorScope, internalQueue) {\n  if (event.type === WILDCARD) {\n    throw new Error(`An event cannot have the wildcard type ('${WILDCARD}')`);\n  }\n  let nextSnapshot = snapshot;\n  const microstates = [];\n  function addMicrostate(microstate, event, transitions) {\n    actorScope.system._sendInspectionEvent({\n      type: '@xstate.microstep',\n      actorRef: actorScope.self,\n      event,\n      snapshot: microstate,\n      _transitions: transitions\n    });\n    microstates.push(microstate);\n  }\n\n  // Handle stop event\n  if (event.type === XSTATE_STOP) {\n    nextSnapshot = cloneMachineSnapshot(stopChildren(nextSnapshot, event, actorScope), {\n      status: 'stopped'\n    });\n    addMicrostate(nextSnapshot, event, []);\n    return {\n      snapshot: nextSnapshot,\n      microstates\n    };\n  }\n  let nextEvent = event;\n\n  // Assume the state is at rest (no raised events)\n  // Determine the next state based on the next microstep\n  if (nextEvent.type !== XSTATE_INIT) {\n    const currentEvent = nextEvent;\n    const isErr = isErrorActorEvent(currentEvent);\n    const transitions = selectTransitions(currentEvent, nextSnapshot);\n    if (isErr && !transitions.length) {\n      // TODO: we should likely only allow transitions selected by very explicit descriptors\n      // `*` shouldn't be matched, likely `xstate.error.*` shouldnt be either\n      // similarly `xstate.error.actor.*` and `xstate.error.actor.todo.*` have to be considered too\n      nextSnapshot = cloneMachineSnapshot(snapshot, {\n        status: 'error',\n        error: currentEvent.error\n      });\n      addMicrostate(nextSnapshot, currentEvent, []);\n      return {\n        snapshot: nextSnapshot,\n        microstates\n      };\n    }\n    nextSnapshot = microstep(transitions, snapshot, actorScope, nextEvent, false,\n    // isInitial\n    internalQueue);\n    addMicrostate(nextSnapshot, currentEvent, transitions);\n  }\n  let shouldSelectEventlessTransitions = true;\n  while (nextSnapshot.status === 'active') {\n    let enabledTransitions = shouldSelectEventlessTransitions ? selectEventlessTransitions(nextSnapshot, nextEvent) : [];\n\n    // eventless transitions should always be selected after selecting *regular* transitions\n    // by assigning `undefined` to `previousState` we ensure that `shouldSelectEventlessTransitions` gets always computed to true in such a case\n    const previousState = enabledTransitions.length ? nextSnapshot : undefined;\n    if (!enabledTransitions.length) {\n      if (!internalQueue.length) {\n        break;\n      }\n      nextEvent = internalQueue.shift();\n      enabledTransitions = selectTransitions(nextEvent, nextSnapshot);\n    }\n    nextSnapshot = microstep(enabledTransitions, nextSnapshot, actorScope, nextEvent, false, internalQueue);\n    shouldSelectEventlessTransitions = nextSnapshot !== previousState;\n    addMicrostate(nextSnapshot, nextEvent, enabledTransitions);\n  }\n  if (nextSnapshot.status !== 'active') {\n    stopChildren(nextSnapshot, nextEvent, actorScope);\n  }\n  return {\n    snapshot: nextSnapshot,\n    microstates\n  };\n}\nfunction stopChildren(nextState, event, actorScope) {\n  return resolveActionsAndContext(nextState, event, actorScope, Object.values(nextState.children).map(child => stopChild(child)), [], undefined);\n}\nfunction selectTransitions(event, nextState) {\n  return nextState.machine.getTransitionData(nextState, event);\n}\nfunction selectEventlessTransitions(nextState, event) {\n  const enabledTransitionSet = new Set();\n  const atomicStates = nextState._nodes.filter(isAtomicStateNode);\n  for (const stateNode of atomicStates) {\n    loop: for (const s of [stateNode].concat(getProperAncestors(stateNode, undefined))) {\n      if (!s.always) {\n        continue;\n      }\n      for (const transition of s.always) {\n        if (transition.guard === undefined || evaluateGuard(transition.guard, nextState.context, event, nextState)) {\n          enabledTransitionSet.add(transition);\n          break loop;\n        }\n      }\n    }\n  }\n  return removeConflictingTransitions(Array.from(enabledTransitionSet), new Set(nextState._nodes), nextState.historyValue);\n}\n\n/**\n * Resolves a partial state value with its full representation in the state\n * node's machine.\n *\n * @param stateValue The partial state value to resolve.\n */\nfunction resolveStateValue(rootNode, stateValue) {\n  const allStateNodes = getAllStateNodes(getStateNodes(rootNode, stateValue));\n  return getStateValue(rootNode, [...allStateNodes]);\n}\n\nfunction isMachineSnapshot(value) {\n  return !!value && typeof value === 'object' && 'machine' in value && 'value' in value;\n}\nconst machineSnapshotMatches = function matches(testValue) {\n  return matchesState(testValue, this.value);\n};\nconst machineSnapshotHasTag = function hasTag(tag) {\n  return this.tags.has(tag);\n};\nconst machineSnapshotCan = function can(event) {\n  if (!this.machine) {\n    console.warn(`state.can(...) used outside of a machine-created State object; this will always return false.`);\n  }\n  const transitionData = this.machine.getTransitionData(this, event);\n  return !!transitionData?.length &&\n  // Check that at least one transition is not forbidden\n  transitionData.some(t => t.target !== undefined || t.actions.length);\n};\nconst machineSnapshotToJSON = function toJSON() {\n  const {\n    _nodes: nodes,\n    tags,\n    machine,\n    getMeta,\n    toJSON,\n    can,\n    hasTag,\n    matches,\n    ...jsonValues\n  } = this;\n  return {\n    ...jsonValues,\n    tags: Array.from(tags)\n  };\n};\nconst machineSnapshotGetMeta = function getMeta() {\n  return this._nodes.reduce((acc, stateNode) => {\n    if (stateNode.meta !== undefined) {\n      acc[stateNode.id] = stateNode.meta;\n    }\n    return acc;\n  }, {});\n};\nfunction createMachineSnapshot(config, machine) {\n  return {\n    status: config.status,\n    output: config.output,\n    error: config.error,\n    machine,\n    context: config.context,\n    _nodes: config._nodes,\n    value: getStateValue(machine.root, config._nodes),\n    tags: new Set(config._nodes.flatMap(sn => sn.tags)),\n    children: config.children,\n    historyValue: config.historyValue || {},\n    matches: machineSnapshotMatches,\n    hasTag: machineSnapshotHasTag,\n    can: machineSnapshotCan,\n    getMeta: machineSnapshotGetMeta,\n    toJSON: machineSnapshotToJSON\n  };\n}\nfunction cloneMachineSnapshot(snapshot, config = {}) {\n  return createMachineSnapshot({\n    ...snapshot,\n    ...config\n  }, snapshot.machine);\n}\nfunction getPersistedSnapshot(snapshot, options) {\n  const {\n    _nodes: nodes,\n    tags,\n    machine,\n    children,\n    context,\n    can,\n    hasTag,\n    matches,\n    getMeta,\n    toJSON,\n    ...jsonValues\n  } = snapshot;\n  const childrenJson = {};\n  for (const id in children) {\n    const child = children[id];\n    if (typeof child.src !== 'string' && (!options || !('__unsafeAllowInlineActors' in options))) {\n      throw new Error('An inline child actor cannot be persisted.');\n    }\n    childrenJson[id] = {\n      snapshot: child.getPersistedSnapshot(options),\n      src: child.src,\n      systemId: child._systemId,\n      syncSnapshot: child._syncSnapshot\n    };\n  }\n  const persisted = {\n    ...jsonValues,\n    context: persistContext(context),\n    children: childrenJson\n  };\n  return persisted;\n}\nfunction persistContext(contextPart) {\n  let copy;\n  for (const key in contextPart) {\n    const value = contextPart[key];\n    if (value && typeof value === 'object') {\n      if ('sessionId' in value && 'send' in value && 'ref' in value) {\n        copy ??= Array.isArray(contextPart) ? contextPart.slice() : {\n          ...contextPart\n        };\n        copy[key] = {\n          xstate$$type: $$ACTOR_TYPE,\n          id: value.id\n        };\n      } else {\n        const result = persistContext(value);\n        if (result !== value) {\n          copy ??= Array.isArray(contextPart) ? contextPart.slice() : {\n            ...contextPart\n          };\n          copy[key] = result;\n        }\n      }\n    }\n  }\n  return copy ?? contextPart;\n}\n\nfunction resolveRaise(_, snapshot, args, actionParams, {\n  event: eventOrExpr,\n  id,\n  delay\n}, {\n  internalQueue\n}) {\n  const delaysMap = snapshot.machine.implementations.delays;\n  if (typeof eventOrExpr === 'string') {\n    throw new Error(\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n    `Only event objects may be used with raise; use raise({ type: \"${eventOrExpr}\" }) instead`);\n  }\n  const resolvedEvent = typeof eventOrExpr === 'function' ? eventOrExpr(args, actionParams) : eventOrExpr;\n  let resolvedDelay;\n  if (typeof delay === 'string') {\n    const configDelay = delaysMap && delaysMap[delay];\n    resolvedDelay = typeof configDelay === 'function' ? configDelay(args, actionParams) : configDelay;\n  } else {\n    resolvedDelay = typeof delay === 'function' ? delay(args, actionParams) : delay;\n  }\n  if (typeof resolvedDelay !== 'number') {\n    internalQueue.push(resolvedEvent);\n  }\n  return [snapshot, {\n    event: resolvedEvent,\n    id,\n    delay: resolvedDelay\n  }, undefined];\n}\nfunction executeRaise(actorScope, params) {\n  const {\n    event,\n    delay,\n    id\n  } = params;\n  if (typeof delay === 'number') {\n    actorScope.defer(() => {\n      const self = actorScope.self;\n      actorScope.system.scheduler.schedule(self, self, event, delay, id);\n    });\n    return;\n  }\n}\n/**\n * Raises an event. This places the event in the internal event queue, so that\n * the event is immediately consumed by the machine in the current step.\n *\n * @param eventType The event to raise.\n */\nfunction raise(eventOrExpr, options) {\n  if (executingCustomAction) {\n    console.warn('Custom actions should not call `raise()` directly, as it is not imperative. See https://stately.ai/docs/actions#built-in-actions for more details.');\n  }\n  function raise(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  raise.type = 'xstate.raise';\n  raise.event = eventOrExpr;\n  raise.id = options?.id;\n  raise.delay = options?.delay;\n  raise.resolve = resolveRaise;\n  raise.execute = executeRaise;\n  return raise;\n}\n\nexport { $$ACTOR_TYPE as $, createActor as A, Actor as B, interpret as C, and as D, not as E, or as F, stateIn as G, isMachineSnapshot as H, getAllOwnEventDescriptors as I, matchesState as J, pathToStateValue as K, toObserver as L, cancel as M, NULL_EVENT as N, raise as O, spawnChild as P, stop as Q, stopChild as R, STATE_DELIMITER as S, ProcessingStatus as T, cloneMachineSnapshot as U, executingCustomAction as V, XSTATE_ERROR as W, XSTATE_STOP as X, createErrorActorEvent as Y, toTransitionConfigArray as a, formatTransition as b, createInvokeId as c, formatInitialTransition as d, evaluateGuard as e, formatTransitions as f, getDelayedTransitions as g, getCandidates as h, getAllStateNodes as i, getStateNodes as j, createMachineSnapshot as k, isInFinalState as l, mapValues as m, macrostep as n, transitionNode as o, resolveActionsAndContext as p, createInitEvent as q, resolveStateValue as r, microstep as s, toArray as t, getInitialStateNodes as u, toStatePath as v, isStateId as w, getStateNodeByPath as x, getPersistedSnapshot as y, resolveReferencedActor as z };\n", "import { X as XSTATE_STOP, A as createActor } from '../../dist/raise-1db27a82.development.esm.js';\nimport '../../dev/dist/xstate-dev.development.esm.js';\n\n/**\n * Represents an actor created by `fromTransition`.\n *\n * The type of `self` within the actor's logic.\n *\n * @example\n *\n * ```ts\n * import {\n *   fromTransition,\n *   createActor,\n *   type AnyActorSystem\n * } from 'xstate';\n *\n * //* The actor's stored context.\n * type Context = {\n *   // The current count.\n *   count: number;\n *   // The amount to increase `count` by.\n *   step: number;\n * };\n * // The events the actor receives.\n * type Event = { type: 'increment' };\n * // The actor's input.\n * type Input = { step?: number };\n *\n * // Actor logic that increments `count` by `step` when it receives an event of\n * // type `increment`.\n * const logic = fromTransition<Context, Event, AnyActorSystem, Input>(\n *   (state, event, actorScope) => {\n *     actorScope.self;\n *     //         ^? TransitionActorRef<Context, Event>\n *\n *     if (event.type === 'increment') {\n *       return {\n *         ...state,\n *         count: state.count + state.step\n *       };\n *     }\n *     return state;\n *   },\n *   ({ input, self }) => {\n *     self;\n *     // ^? TransitionActorRef<Context, Event>\n *\n *     return {\n *       count: 0,\n *       step: input.step ?? 1\n *     };\n *   }\n * );\n *\n * const actor = createActor(logic, { input: { step: 10 } });\n * //    ^? TransitionActorRef<Context, Event>\n * ```\n *\n * @see {@link fromTransition}\n */\n\n/**\n * Returns actor logic given a transition function and its initial state.\n *\n * A transition function is a function that takes the current `state` and\n * received `event` object as arguments, and returns the next state, similar to\n * a reducer.\n *\n * Actors created from transition logic (transition actors) can:\n *\n * - Receive events\n * - Emit snapshots of its state\n *\n * The transition functions `state` is used as its transition actors\n * `context`.\n *\n * Note that the \"state\" for a transition function is provided by the initial\n * state argument, and is not the same as the State object of an actor or a\n * state within a machine configuration.\n *\n * @example\n *\n * ```ts\n * const transitionLogic = fromTransition(\n *   (state, event) => {\n *     if (event.type === 'increment') {\n *       return {\n *         ...state,\n *         count: state.count + 1\n *       };\n *     }\n *     return state;\n *   },\n *   { count: 0 }\n * );\n *\n * const transitionActor = createActor(transitionLogic);\n * transitionActor.subscribe((snapshot) => {\n *   console.log(snapshot);\n * });\n * transitionActor.start();\n * // => {\n * //   status: 'active',\n * //   context: { count: 0 },\n * //   ...\n * // }\n *\n * transitionActor.send({ type: 'increment' });\n * // => {\n * //   status: 'active',\n * //   context: { count: 1 },\n * //   ...\n * // }\n * ```\n *\n * @param transition The transition function used to describe the transition\n *   logic. It should return the next state given the current state and event.\n *   It receives the following arguments:\n *\n *   - `state` - the current state.\n *   - `event` - the received event.\n *   - `actorScope` - the actor scope object, with properties like `self` and\n *       `system`.\n *\n * @param initialContext The initial state of the transition function, either an\n *   object representing the state, or a function which returns a state object.\n *   If a function, it will receive as its only argument an object with the\n *   following properties:\n *\n *   - `input` - the `input` provided to its parent transition actor.\n *   - `self` - a reference to its parent transition actor.\n *\n * @returns Actor logic\n * @see {@link https://stately.ai/docs/input | Input docs} for more information about how input is passed\n */\nfunction fromTransition(transition, initialContext) {\n  return {\n    config: transition,\n    transition: (snapshot, event, actorScope) => {\n      return {\n        ...snapshot,\n        context: transition(snapshot.context, event, actorScope)\n      };\n    },\n    getInitialSnapshot: (_, input) => {\n      return {\n        status: 'active',\n        output: undefined,\n        error: undefined,\n        context: typeof initialContext === 'function' ? initialContext({\n          input\n        }) : initialContext\n      };\n    },\n    getPersistedSnapshot: snapshot => snapshot,\n    restoreSnapshot: snapshot => snapshot\n  };\n}\n\nconst instanceStates = /* #__PURE__ */new WeakMap();\n\n/**\n * Represents an actor created by `fromCallback`.\n *\n * The type of `self` within the actor's logic.\n *\n * @example\n *\n * ```ts\n * import { fromCallback, createActor } from 'xstate';\n *\n * // The events the actor receives.\n * type Event = { type: 'someEvent' };\n * // The actor's input.\n * type Input = { name: string };\n *\n * // Actor logic that logs whenever it receives an event of type `someEvent`.\n * const logic = fromCallback<Event, Input>(({ self, input, receive }) => {\n *   self;\n *   // ^? CallbackActorRef<Event, Input>\n *\n *   receive((event) => {\n *     if (event.type === 'someEvent') {\n *       console.log(`${input.name}: received \"someEvent\" event`);\n *       // logs 'myActor: received \"someEvent\" event'\n *     }\n *   });\n * });\n *\n * const actor = createActor(logic, { input: { name: 'myActor' } });\n * //    ^? CallbackActorRef<Event, Input>\n * ```\n *\n * @see {@link fromCallback}\n */\n\n/**\n * An actor logic creator which returns callback logic as defined by a callback\n * function.\n *\n * @remarks\n * Useful for subscription-based or other free-form logic that can send events\n * back to the parent actor.\n *\n * Actors created from callback logic (callback actors) can:\n *\n * - Receive events via the `receive` function\n * - Send events to the parent actor via the `sendBack` function\n *\n * Callback actors are a bit different from other actors in that they:\n *\n * - Do not work with `onDone`\n * - Do not produce a snapshot using `.getSnapshot()`\n * - Do not emit values when used with `.subscribe()`\n * - Can not be stopped with `.stop()`\n *\n * @example\n *\n * ```typescript\n * const callbackLogic = fromCallback(({ sendBack, receive }) => {\n *   let lockStatus = 'unlocked';\n *\n *   const handler = (event) => {\n *     if (lockStatus === 'locked') {\n *       return;\n *     }\n *     sendBack(event);\n *   };\n *\n *   receive((event) => {\n *     if (event.type === 'lock') {\n *       lockStatus = 'locked';\n *     } else if (event.type === 'unlock') {\n *       lockStatus = 'unlocked';\n *     }\n *   });\n *\n *   document.body.addEventListener('click', handler);\n *\n *   return () => {\n *     document.body.removeEventListener('click', handler);\n *   };\n * });\n * ```\n *\n * @param callback - The callback function used to describe the callback logic\n *   The callback function is passed an object with the following properties:\n *\n *   - `receive` - A function that can send events back to the parent actor; the\n *       listener is then called whenever events are received by the callback\n *       actor\n *   - `sendBack` - A function that can send events back to the parent actor\n *   - `input` - Data that was provided to the callback actor\n *   - `self` - The parent actor of the callback actor\n *   - `system` - The actor system to which the callback actor belongs The callback\n *       function can (optionally) return a cleanup function, which is called\n *       when the actor is stopped.\n *\n * @returns Callback logic\n * @see {@link CallbackLogicFunction} for more information about the callback function and its object argument\n * @see {@link https://stately.ai/docs/input | Input docs} for more information about how input is passed\n */\nfunction fromCallback(callback) {\n  const logic = {\n    config: callback,\n    start: (state, actorScope) => {\n      const {\n        self,\n        system,\n        emit\n      } = actorScope;\n      const callbackState = {\n        receivers: undefined,\n        dispose: undefined\n      };\n      instanceStates.set(self, callbackState);\n      callbackState.dispose = callback({\n        input: state.input,\n        system,\n        self,\n        sendBack: event => {\n          if (self.getSnapshot().status === 'stopped') {\n            return;\n          }\n          if (self._parent) {\n            system._relay(self, self._parent, event);\n          }\n        },\n        receive: listener => {\n          callbackState.receivers ??= new Set();\n          callbackState.receivers.add(listener);\n        },\n        emit\n      });\n    },\n    transition: (state, event, actorScope) => {\n      const callbackState = instanceStates.get(actorScope.self);\n      if (event.type === XSTATE_STOP) {\n        state = {\n          ...state,\n          status: 'stopped',\n          error: undefined\n        };\n        callbackState.dispose?.();\n        return state;\n      }\n      callbackState.receivers?.forEach(receiver => receiver(event));\n      return state;\n    },\n    getInitialSnapshot: (_, input) => {\n      return {\n        status: 'active',\n        output: undefined,\n        error: undefined,\n        input\n      };\n    },\n    getPersistedSnapshot: snapshot => snapshot,\n    restoreSnapshot: snapshot => snapshot\n  };\n  return logic;\n}\n\nconst XSTATE_OBSERVABLE_NEXT = 'xstate.observable.next';\nconst XSTATE_OBSERVABLE_ERROR = 'xstate.observable.error';\nconst XSTATE_OBSERVABLE_COMPLETE = 'xstate.observable.complete';\n\n/**\n * Represents an actor created by `fromObservable` or `fromEventObservable`.\n *\n * The type of `self` within the actor's logic.\n *\n * @example\n *\n * ```ts\n * import { fromObservable, createActor } from 'xstate';\n * import { interval } from 'rxjs';\n *\n * // The type of the value observed by the actor's logic.\n * type Context = number;\n * // The actor's input.\n * type Input = { period?: number };\n *\n * // Actor logic that observes a number incremented every `input.period`\n * // milliseconds (default: 1_000).\n * const logic = fromObservable<Context, Input>(({ input, self }) => {\n *   self;\n *   // ^? ObservableActorRef<Event, Input>\n *\n *   return interval(input.period ?? 1_000);\n * });\n *\n * const actor = createActor(logic, { input: { period: 2_000 } });\n * //    ^? ObservableActorRef<Event, Input>\n * ```\n *\n * @see {@link fromObservable}\n * @see {@link fromEventObservable}\n */\n\n/**\n * Observable actor logic is described by an observable stream of values. Actors\n * created from observable logic (observable actors) can:\n *\n * - Emit snapshots of the observables emitted value\n *\n * The observables emitted value is used as its observable actors `context`.\n *\n * Sending events to observable actors will have no effect.\n *\n * @example\n *\n * ```ts\n * import { fromObservable, createActor } from 'xstate';\n * import { interval } from 'rxjs';\n *\n * const logic = fromObservable((obj) => interval(1000));\n *\n * const actor = createActor(logic);\n *\n * actor.subscribe((snapshot) => {\n *   console.log(snapshot.context);\n * });\n *\n * actor.start();\n * // At every second:\n * // Logs 0\n * // Logs 1\n * // Logs 2\n * // ...\n * ```\n *\n * @param observableCreator A function that creates an observable. It receives\n *   one argument, an object with the following properties:\n *\n *   - `input` - Data that was provided to the observable actor\n *   - `self` - The parent actor\n *   - `system` - The actor system to which the observable actor belongs\n *\n *   It should return a {@link Subscribable}, which is compatible with an RxJS\n *   Observable, although RxJS is not required to create them.\n * @see {@link https://rxjs.dev} for documentation on RxJS Observable and observable creators.\n * @see {@link Subscribable} interface in XState, which is based on and compatible with RxJS Observable.\n */\nfunction fromObservable(observableCreator) {\n  // TODO: add event types\n  const logic = {\n    config: observableCreator,\n    transition: (snapshot, event) => {\n      if (snapshot.status !== 'active') {\n        return snapshot;\n      }\n      switch (event.type) {\n        case XSTATE_OBSERVABLE_NEXT:\n          {\n            const newSnapshot = {\n              ...snapshot,\n              context: event.data\n            };\n            return newSnapshot;\n          }\n        case XSTATE_OBSERVABLE_ERROR:\n          return {\n            ...snapshot,\n            status: 'error',\n            error: event.data,\n            input: undefined,\n            _subscription: undefined\n          };\n        case XSTATE_OBSERVABLE_COMPLETE:\n          return {\n            ...snapshot,\n            status: 'done',\n            input: undefined,\n            _subscription: undefined\n          };\n        case XSTATE_STOP:\n          snapshot._subscription.unsubscribe();\n          return {\n            ...snapshot,\n            status: 'stopped',\n            input: undefined,\n            _subscription: undefined\n          };\n        default:\n          return snapshot;\n      }\n    },\n    getInitialSnapshot: (_, input) => {\n      return {\n        status: 'active',\n        output: undefined,\n        error: undefined,\n        context: undefined,\n        input,\n        _subscription: undefined\n      };\n    },\n    start: (state, {\n      self,\n      system,\n      emit\n    }) => {\n      if (state.status === 'done') {\n        // Do not restart a completed observable\n        return;\n      }\n      state._subscription = observableCreator({\n        input: state.input,\n        system,\n        self,\n        emit\n      }).subscribe({\n        next: value => {\n          system._relay(self, self, {\n            type: XSTATE_OBSERVABLE_NEXT,\n            data: value\n          });\n        },\n        error: err => {\n          system._relay(self, self, {\n            type: XSTATE_OBSERVABLE_ERROR,\n            data: err\n          });\n        },\n        complete: () => {\n          system._relay(self, self, {\n            type: XSTATE_OBSERVABLE_COMPLETE\n          });\n        }\n      });\n    },\n    getPersistedSnapshot: ({\n      _subscription,\n      ...state\n    }) => state,\n    restoreSnapshot: state => ({\n      ...state,\n      _subscription: undefined\n    })\n  };\n  return logic;\n}\n\n/**\n * Creates event observable logic that listens to an observable that delivers\n * event objects.\n *\n * Event observable actor logic is described by an observable stream of\n * {@link https://stately.ai/docs/transitions#event-objects | event objects}.\n * Actors created from event observable logic (event observable actors) can:\n *\n * - Implicitly send events to its parent actor\n * - Emit snapshots of its emitted event objects\n *\n * Sending events to event observable actors will have no effect.\n *\n * @example\n *\n * ```ts\n * import {\n *   fromEventObservable,\n *   Subscribable,\n *   EventObject,\n *   createMachine,\n *   createActor\n * } from 'xstate';\n * import { fromEvent } from 'rxjs';\n *\n * const mouseClickLogic = fromEventObservable(\n *   () => fromEvent(document.body, 'click') as Subscribable<EventObject>\n * );\n *\n * const canvasMachine = createMachine({\n *   invoke: {\n *     // Will send mouse `click` events to the canvas actor\n *     src: mouseClickLogic\n *   }\n * });\n *\n * const canvasActor = createActor(canvasMachine);\n * canvasActor.start();\n * ```\n *\n * @param lazyObservable A function that creates an observable that delivers\n *   event objects. It receives one argument, an object with the following\n *   properties:\n *\n *   - `input` - Data that was provided to the event observable actor\n *   - `self` - The parent actor\n *   - `system` - The actor system to which the event observable actor belongs.\n *\n *   It should return a {@link Subscribable}, which is compatible with an RxJS\n *   Observable, although RxJS is not required to create them.\n */\nfunction fromEventObservable(lazyObservable) {\n  // TODO: event types\n  const logic = {\n    config: lazyObservable,\n    transition: (state, event) => {\n      if (state.status !== 'active') {\n        return state;\n      }\n      switch (event.type) {\n        case XSTATE_OBSERVABLE_ERROR:\n          return {\n            ...state,\n            status: 'error',\n            error: event.data,\n            input: undefined,\n            _subscription: undefined\n          };\n        case XSTATE_OBSERVABLE_COMPLETE:\n          return {\n            ...state,\n            status: 'done',\n            input: undefined,\n            _subscription: undefined\n          };\n        case XSTATE_STOP:\n          state._subscription.unsubscribe();\n          return {\n            ...state,\n            status: 'stopped',\n            input: undefined,\n            _subscription: undefined\n          };\n        default:\n          return state;\n      }\n    },\n    getInitialSnapshot: (_, input) => {\n      return {\n        status: 'active',\n        output: undefined,\n        error: undefined,\n        context: undefined,\n        input,\n        _subscription: undefined\n      };\n    },\n    start: (state, {\n      self,\n      system,\n      emit\n    }) => {\n      if (state.status === 'done') {\n        // Do not restart a completed observable\n        return;\n      }\n      state._subscription = lazyObservable({\n        input: state.input,\n        system,\n        self,\n        emit\n      }).subscribe({\n        next: value => {\n          if (self._parent) {\n            system._relay(self, self._parent, value);\n          }\n        },\n        error: err => {\n          system._relay(self, self, {\n            type: XSTATE_OBSERVABLE_ERROR,\n            data: err\n          });\n        },\n        complete: () => {\n          system._relay(self, self, {\n            type: XSTATE_OBSERVABLE_COMPLETE\n          });\n        }\n      });\n    },\n    getPersistedSnapshot: ({\n      _subscription,\n      ...snapshot\n    }) => snapshot,\n    restoreSnapshot: snapshot => ({\n      ...snapshot,\n      _subscription: undefined\n    })\n  };\n  return logic;\n}\n\nconst XSTATE_PROMISE_RESOLVE = 'xstate.promise.resolve';\nconst XSTATE_PROMISE_REJECT = 'xstate.promise.reject';\n\n/**\n * Represents an actor created by `fromPromise`.\n *\n * The type of `self` within the actor's logic.\n *\n * @example\n *\n * ```ts\n * import { fromPromise, createActor } from 'xstate';\n *\n * // The actor's resolved output\n * type Output = string;\n * // The actor's input.\n * type Input = { message: string };\n *\n * // Actor logic that fetches the url of an image of a cat saying `input.message`.\n * const logic = fromPromise<Output, Input>(async ({ input, self }) => {\n *   self;\n *   // ^? PromiseActorRef<Output, Input>\n *\n *   const data = await fetch(\n *     `https://cataas.com/cat/says/${input.message}`\n *   );\n *   const url = await data.json();\n *   return url;\n * });\n *\n * const actor = createActor(logic, { input: { message: 'hello world' } });\n * //    ^? PromiseActorRef<Output, Input>\n * ```\n *\n * @see {@link fromPromise}\n */\n\nconst controllerMap = new WeakMap();\n\n/**\n * An actor logic creator which returns promise logic as defined by an async\n * process that resolves or rejects after some time.\n *\n * Actors created from promise actor logic (promise actors) can:\n *\n * - Emit the resolved value of the promise\n * - Output the resolved value of the promise\n *\n * Sending events to promise actors will have no effect.\n *\n * @example\n *\n * ```ts\n * const promiseLogic = fromPromise(async () => {\n *   const result = await fetch('https://example.com/...').then((data) =>\n *     data.json()\n *   );\n *\n *   return result;\n * });\n *\n * const promiseActor = createActor(promiseLogic);\n * promiseActor.subscribe((snapshot) => {\n *   console.log(snapshot);\n * });\n * promiseActor.start();\n * // => {\n * //   output: undefined,\n * //   status: 'active'\n * //   ...\n * // }\n *\n * // After promise resolves\n * // => {\n * //   output: { ... },\n * //   status: 'done',\n * //   ...\n * // }\n * ```\n *\n * @param promiseCreator A function which returns a Promise, and accepts an\n *   object with the following properties:\n *\n *   - `input` - Data that was provided to the promise actor\n *   - `self` - The parent actor of the promise actor\n *   - `system` - The actor system to which the promise actor belongs\n *\n * @see {@link https://stately.ai/docs/input | Input docs} for more information about how input is passed\n */\nfunction fromPromise(promiseCreator) {\n  const logic = {\n    config: promiseCreator,\n    transition: (state, event, scope) => {\n      if (state.status !== 'active') {\n        return state;\n      }\n      switch (event.type) {\n        case XSTATE_PROMISE_RESOLVE:\n          {\n            const resolvedValue = event.data;\n            return {\n              ...state,\n              status: 'done',\n              output: resolvedValue,\n              input: undefined\n            };\n          }\n        case XSTATE_PROMISE_REJECT:\n          return {\n            ...state,\n            status: 'error',\n            error: event.data,\n            input: undefined\n          };\n        case XSTATE_STOP:\n          {\n            controllerMap.get(scope.self)?.abort();\n            return {\n              ...state,\n              status: 'stopped',\n              input: undefined\n            };\n          }\n        default:\n          return state;\n      }\n    },\n    start: (state, {\n      self,\n      system,\n      emit\n    }) => {\n      // TODO: determine how to allow customizing this so that promises\n      // can be restarted if necessary\n      if (state.status !== 'active') {\n        return;\n      }\n      const controller = new AbortController();\n      controllerMap.set(self, controller);\n      const resolvedPromise = Promise.resolve(promiseCreator({\n        input: state.input,\n        system,\n        self,\n        signal: controller.signal,\n        emit\n      }));\n      resolvedPromise.then(response => {\n        if (self.getSnapshot().status !== 'active') {\n          return;\n        }\n        controllerMap.delete(self);\n        system._relay(self, self, {\n          type: XSTATE_PROMISE_RESOLVE,\n          data: response\n        });\n      }, errorData => {\n        if (self.getSnapshot().status !== 'active') {\n          return;\n        }\n        controllerMap.delete(self);\n        system._relay(self, self, {\n          type: XSTATE_PROMISE_REJECT,\n          data: errorData\n        });\n      });\n    },\n    getInitialSnapshot: (_, input) => {\n      return {\n        status: 'active',\n        output: undefined,\n        error: undefined,\n        input\n      };\n    },\n    getPersistedSnapshot: snapshot => snapshot,\n    restoreSnapshot: snapshot => snapshot\n  };\n  return logic;\n}\n\nconst emptyLogic = fromTransition(_ => undefined, undefined);\nfunction createEmptyActor() {\n  return createActor(emptyLogic);\n}\n\nexport { createEmptyActor, fromCallback, fromEventObservable, fromObservable, fromPromise, fromTransition };\n", "import { T as ProcessingStatus, z as resolveReferencedActor, A as createActor, U as cloneMachineSnapshot, V as executingCustomAction, W as XSTATE_ERROR, Y as createErrorActorEvent, e as evaluateGuard, M as cancel, O as raise, P as spawnChild, R as stopChild } from './raise-1db27a82.development.esm.js';\n\nfunction createSpawner(actorScope, {\n  machine,\n  context\n}, event, spawnedChildren) {\n  const spawn = (src, options) => {\n    if (typeof src === 'string') {\n      const logic = resolveReferencedActor(machine, src);\n      if (!logic) {\n        throw new Error(`Actor logic '${src}' not implemented in machine '${machine.id}'`);\n      }\n      const actorRef = createActor(logic, {\n        id: options?.id,\n        parent: actorScope.self,\n        syncSnapshot: options?.syncSnapshot,\n        input: typeof options?.input === 'function' ? options.input({\n          context,\n          event,\n          self: actorScope.self\n        }) : options?.input,\n        src,\n        systemId: options?.systemId\n      });\n      spawnedChildren[actorRef.id] = actorRef;\n      return actorRef;\n    } else {\n      const actorRef = createActor(src, {\n        id: options?.id,\n        parent: actorScope.self,\n        syncSnapshot: options?.syncSnapshot,\n        input: options?.input,\n        src,\n        systemId: options?.systemId\n      });\n      return actorRef;\n    }\n  };\n  return (src, options) => {\n    const actorRef = spawn(src, options); // TODO: fix types\n    spawnedChildren[actorRef.id] = actorRef;\n    actorScope.defer(() => {\n      if (actorRef._processingStatus === ProcessingStatus.Stopped) {\n        return;\n      }\n      actorRef.start();\n    });\n    return actorRef;\n  };\n}\n\nfunction resolveAssign(actorScope, snapshot, actionArgs, actionParams, {\n  assignment\n}) {\n  if (!snapshot.context) {\n    throw new Error('Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.');\n  }\n  const spawnedChildren = {};\n  const assignArgs = {\n    context: snapshot.context,\n    event: actionArgs.event,\n    spawn: createSpawner(actorScope, snapshot, actionArgs.event, spawnedChildren),\n    self: actorScope.self,\n    system: actorScope.system\n  };\n  let partialUpdate = {};\n  if (typeof assignment === 'function') {\n    partialUpdate = assignment(assignArgs, actionParams);\n  } else {\n    for (const key of Object.keys(assignment)) {\n      const propAssignment = assignment[key];\n      partialUpdate[key] = typeof propAssignment === 'function' ? propAssignment(assignArgs, actionParams) : propAssignment;\n    }\n  }\n  const updatedContext = Object.assign({}, snapshot.context, partialUpdate);\n  return [cloneMachineSnapshot(snapshot, {\n    context: updatedContext,\n    children: Object.keys(spawnedChildren).length ? {\n      ...snapshot.children,\n      ...spawnedChildren\n    } : snapshot.children\n  }), undefined, undefined];\n}\n/**\n * Updates the current context of the machine.\n *\n * @example\n *\n * ```ts\n * import { createMachine, assign } from 'xstate';\n *\n * const countMachine = createMachine({\n *   context: {\n *     count: 0,\n *     message: ''\n *   },\n *   on: {\n *     inc: {\n *       actions: assign({\n *         count: ({ context }) => context.count + 1\n *       })\n *     },\n *     updateMessage: {\n *       actions: assign(({ context, event }) => {\n *         return {\n *           message: event.message.trim()\n *         };\n *       })\n *     }\n *   }\n * });\n * ```\n *\n * @param assignment An object that represents the partial context to update, or\n *   a function that returns an object that represents the partial context to\n *   update.\n */\nfunction assign(assignment) {\n  if (executingCustomAction) {\n    console.warn('Custom actions should not call `assign()` directly, as it is not imperative. See https://stately.ai/docs/actions#built-in-actions for more details.');\n  }\n  function assign(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  assign.type = 'xstate.assign';\n  assign.assignment = assignment;\n  assign.resolve = resolveAssign;\n  return assign;\n}\n\nfunction resolveEmit(_, snapshot, args, actionParams, {\n  event: eventOrExpr\n}) {\n  const resolvedEvent = typeof eventOrExpr === 'function' ? eventOrExpr(args, actionParams) : eventOrExpr;\n  return [snapshot, {\n    event: resolvedEvent\n  }, undefined];\n}\nfunction executeEmit(actorScope, {\n  event\n}) {\n  actorScope.defer(() => actorScope.emit(event));\n}\n/**\n * Emits an event to event handlers registered on the actor via `actor.on(event,\n * handler)`.\n *\n * @example\n *\n * ```ts\n * import { emit } from 'xstate';\n *\n * const machine = createMachine({\n *   // ...\n *   on: {\n *     something: {\n *       actions: emit({\n *         type: 'emitted',\n *         some: 'data'\n *       })\n *     }\n *   }\n *   // ...\n * });\n *\n * const actor = createActor(machine).start();\n *\n * actor.on('emitted', (event) => {\n *   console.log(event);\n * });\n *\n * actor.send({ type: 'something' });\n * // logs:\n * // {\n * //   type: 'emitted',\n * //   some: 'data'\n * // }\n * ```\n */\nfunction emit(/** The event to emit, or an expression that returns an event to emit. */\neventOrExpr) {\n  if (executingCustomAction) {\n    console.warn('Custom actions should not call `emit()` directly, as it is not imperative. See https://stately.ai/docs/actions#built-in-actions for more details.');\n  }\n  function emit(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  emit.type = 'xstate.emit';\n  emit.event = eventOrExpr;\n  emit.resolve = resolveEmit;\n  emit.execute = executeEmit;\n  return emit;\n}\n\n/**\n * @remarks\n * `T | unknown` reduces to `unknown` and that can be problematic when it comes\n * to contextual typing. It especially is a problem when the union has a\n * function member, like here:\n *\n * ```ts\n * declare function test(\n *   cbOrVal: ((arg: number) => unknown) | unknown\n * ): void;\n * test((arg) => {}); // oops, implicit any\n * ```\n *\n * This type can be used to avoid this problem. This union represents the same\n * value space as `unknown`.\n */\n\n// https://github.com/microsoft/TypeScript/issues/23182#issuecomment-379091887\n\n// @TODO: Replace with native `NoInfer` when TS issue gets fixed:\n// https://github.com/microsoft/TypeScript/pull/57673\n\n/** @deprecated Use the built-in `NoInfer` type instead */\n\n/** The full definition of an event, with a string `type`. */\n\n/**\n * The string or object representing the state value relative to the parent\n * state node.\n *\n * @remarks\n * - For a child atomic state node, this is a string, e.g., `\"pending\"`.\n * - For complex state nodes, this is an object, e.g., `{ success:\n *   \"someChildState\" }`.\n */\n\n/** @deprecated Use `AnyMachineSnapshot` instead */\n\n// TODO: possibly refactor this somehow, use even a simpler type, and maybe even make `machine.options` private or something\n/** @ignore */\n\nlet SpecialTargets = /*#__PURE__*/function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n  return SpecialTargets;\n}({});\n\n/** @deprecated Use `AnyActor` instead. */\n\n// Based on RxJS types\n\n// TODO: in v6, this should only accept AnyActorLogic, like ActorRefFromLogic\n\n/** @deprecated Use `Actor<T>` instead. */\n\n/**\n * Represents logic which can be used by an actor.\n *\n * @template TSnapshot - The type of the snapshot.\n * @template TEvent - The type of the event object.\n * @template TInput - The type of the input.\n * @template TSystem - The type of the actor system.\n */\n\n/** @deprecated */\n\n// TODO: cover all that can be actually returned\n\nfunction resolveSendTo(actorScope, snapshot, args, actionParams, {\n  to,\n  event: eventOrExpr,\n  id,\n  delay\n}, extra) {\n  const delaysMap = snapshot.machine.implementations.delays;\n  if (typeof eventOrExpr === 'string') {\n    throw new Error(\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n    `Only event objects may be used with sendTo; use sendTo({ type: \"${eventOrExpr}\" }) instead`);\n  }\n  const resolvedEvent = typeof eventOrExpr === 'function' ? eventOrExpr(args, actionParams) : eventOrExpr;\n  let resolvedDelay;\n  if (typeof delay === 'string') {\n    const configDelay = delaysMap && delaysMap[delay];\n    resolvedDelay = typeof configDelay === 'function' ? configDelay(args, actionParams) : configDelay;\n  } else {\n    resolvedDelay = typeof delay === 'function' ? delay(args, actionParams) : delay;\n  }\n  const resolvedTarget = typeof to === 'function' ? to(args, actionParams) : to;\n  let targetActorRef;\n  if (typeof resolvedTarget === 'string') {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-enum-comparison\n    if (resolvedTarget === SpecialTargets.Parent) {\n      targetActorRef = actorScope.self._parent;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-enum-comparison\n    else if (resolvedTarget === SpecialTargets.Internal) {\n      targetActorRef = actorScope.self;\n    } else if (resolvedTarget.startsWith('#_')) {\n      // SCXML compatibility: https://www.w3.org/TR/scxml/#SCXMLEventProcessor\n      // #_invokeid. If the target is the special term '#_invokeid', where invokeid is the invokeid of an SCXML session that the sending session has created by <invoke>, the Processor must add the event to the external queue of that session.\n      targetActorRef = snapshot.children[resolvedTarget.slice(2)];\n    } else {\n      targetActorRef = extra.deferredActorIds?.includes(resolvedTarget) ? resolvedTarget : snapshot.children[resolvedTarget];\n    }\n    if (!targetActorRef) {\n      throw new Error(`Unable to send event to actor '${resolvedTarget}' from machine '${snapshot.machine.id}'.`);\n    }\n  } else {\n    targetActorRef = resolvedTarget || actorScope.self;\n  }\n  return [snapshot, {\n    to: targetActorRef,\n    targetId: typeof resolvedTarget === 'string' ? resolvedTarget : undefined,\n    event: resolvedEvent,\n    id,\n    delay: resolvedDelay\n  }, undefined];\n}\nfunction retryResolveSendTo(_, snapshot, params) {\n  if (typeof params.to === 'string') {\n    params.to = snapshot.children[params.to];\n  }\n}\nfunction executeSendTo(actorScope, params) {\n  // this forms an outgoing events queue\n  // thanks to that the recipient actors are able to read the *updated* snapshot value of the sender\n  actorScope.defer(() => {\n    const {\n      to,\n      event,\n      delay,\n      id\n    } = params;\n    if (typeof delay === 'number') {\n      actorScope.system.scheduler.schedule(actorScope.self, to, event, delay, id);\n      return;\n    }\n    actorScope.system._relay(actorScope.self,\n    // at this point, in a deferred task, it should already be mutated by retryResolveSendTo\n    // if it initially started as a string\n    to, event.type === XSTATE_ERROR ? createErrorActorEvent(actorScope.self.id, event.data) : event);\n  });\n}\n/**\n * Sends an event to an actor.\n *\n * @param actor The `ActorRef` to send the event to.\n * @param event The event to send, or an expression that evaluates to the event\n *   to send\n * @param options Send action options\n *\n *   - `id` - The unique send event identifier (used with `cancel()`).\n *   - `delay` - The number of milliseconds to delay the sending of the event.\n */\nfunction sendTo(to, eventOrExpr, options) {\n  if (executingCustomAction) {\n    console.warn('Custom actions should not call `sendTo()` directly, as it is not imperative. See https://stately.ai/docs/actions#built-in-actions for more details.');\n  }\n  function sendTo(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  sendTo.type = 'xstate.sendTo';\n  sendTo.to = to;\n  sendTo.event = eventOrExpr;\n  sendTo.id = options?.id;\n  sendTo.delay = options?.delay;\n  sendTo.resolve = resolveSendTo;\n  sendTo.retryResolve = retryResolveSendTo;\n  sendTo.execute = executeSendTo;\n  return sendTo;\n}\n\n/**\n * Sends an event to this machine's parent.\n *\n * @param event The event to send to the parent machine.\n * @param options Options to pass into the send event.\n */\nfunction sendParent(event, options) {\n  return sendTo(SpecialTargets.Parent, event, options);\n}\n/**\n * Forwards (sends) an event to the `target` actor.\n *\n * @param target The target actor to forward the event to.\n * @param options Options to pass into the send action creator.\n */\nfunction forwardTo(target, options) {\n  if ((!target || typeof target === 'function')) {\n    const originalTarget = target;\n    target = (...args) => {\n      const resolvedTarget = typeof originalTarget === 'function' ? originalTarget(...args) : originalTarget;\n      if (!resolvedTarget) {\n        throw new Error(`Attempted to forward event to undefined actor. This risks an infinite loop in the sender.`);\n      }\n      return resolvedTarget;\n    };\n  }\n  return sendTo(target, ({\n    event\n  }) => event, options);\n}\n\nfunction resolveEnqueueActions(actorScope, snapshot, args, actionParams, {\n  collect\n}) {\n  const actions = [];\n  const enqueue = function enqueue(action) {\n    actions.push(action);\n  };\n  enqueue.assign = (...args) => {\n    actions.push(assign(...args));\n  };\n  enqueue.cancel = (...args) => {\n    actions.push(cancel(...args));\n  };\n  enqueue.raise = (...args) => {\n    // for some reason it fails to infer `TDelay` from `...args` here and picks its default (`never`)\n    // then it fails to typecheck that because `...args` use `string` in place of `TDelay`\n    actions.push(raise(...args));\n  };\n  enqueue.sendTo = (...args) => {\n    // for some reason it fails to infer `TDelay` from `...args` here and picks its default (`never`)\n    // then it fails to typecheck that because `...args` use `string` in place of `TDelay\n    actions.push(sendTo(...args));\n  };\n  enqueue.sendParent = (...args) => {\n    actions.push(sendParent(...args));\n  };\n  enqueue.spawnChild = (...args) => {\n    actions.push(spawnChild(...args));\n  };\n  enqueue.stopChild = (...args) => {\n    actions.push(stopChild(...args));\n  };\n  enqueue.emit = (...args) => {\n    actions.push(emit(...args));\n  };\n  collect({\n    context: args.context,\n    event: args.event,\n    enqueue,\n    check: guard => evaluateGuard(guard, snapshot.context, args.event, snapshot),\n    self: actorScope.self,\n    system: actorScope.system\n  }, actionParams);\n  return [snapshot, undefined, actions];\n}\n/**\n * Creates an action object that will execute actions that are queued by the\n * `enqueue(action)` function.\n *\n * @example\n *\n * ```ts\n * import { createMachine, enqueueActions } from 'xstate';\n *\n * const machine = createMachine({\n *   entry: enqueueActions(({ enqueue, check }) => {\n *     enqueue.assign({ count: 0 });\n *\n *     if (check('someGuard')) {\n *       enqueue.assign({ count: 1 });\n *     }\n *\n *     enqueue('someAction');\n *   })\n * });\n * ```\n */\nfunction enqueueActions(collect) {\n  function enqueueActions(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  enqueueActions.type = 'xstate.enqueueActions';\n  enqueueActions.collect = collect;\n  enqueueActions.resolve = resolveEnqueueActions;\n  return enqueueActions;\n}\n\nfunction resolveLog(_, snapshot, actionArgs, actionParams, {\n  value,\n  label\n}) {\n  return [snapshot, {\n    value: typeof value === 'function' ? value(actionArgs, actionParams) : value,\n    label\n  }, undefined];\n}\nfunction executeLog({\n  logger\n}, {\n  value,\n  label\n}) {\n  if (label) {\n    logger(label, value);\n  } else {\n    logger(value);\n  }\n}\n/**\n * @param expr The expression function to evaluate which will be logged. Takes\n *   in 2 arguments:\n *\n *   - `ctx` - the current state context\n *   - `event` - the event that caused this action to be executed.\n *\n * @param label The label to give to the logged expression.\n */\nfunction log(value = ({\n  context,\n  event\n}) => ({\n  context,\n  event\n}), label) {\n  function log(_args, _params) {\n    {\n      throw new Error(`This isn't supposed to be called`);\n    }\n  }\n  log.type = 'xstate.log';\n  log.value = value;\n  log.label = label;\n  log.resolve = resolveLog;\n  log.execute = executeLog;\n  return log;\n}\n\nexport { SpecialTargets as S, assign as a, enqueueActions as b, sendTo as c, emit as e, forwardTo as f, log as l, sendParent as s };\n", "export { createEmptyActor, fromCallback, fromEventObservable, fromObservable, fromPromise, fromTransition } from '../actors/dist/xstate-actors.development.esm.js';\nimport { t as toArray, S as STATE_DELIMITER, m as mapValues, f as formatTransitions, a as toTransitionConfigArray, b as formatTransition, N as NULL_EVENT, e as evaluateGuard, c as createInvokeId, g as getDelayedTransitions, d as formatInitialTransition, h as getCandidates, r as resolveStateValue, i as getAllStateNodes, j as getStateNodes, k as createMachineSnapshot, l as isInFinalState, n as macrostep, o as transitionNode, p as resolveActionsAndContext, q as createInitEvent, s as microstep, u as getInitialStateNodes, v as toStatePath, w as isStateId, x as getStateNodeByPath, y as getPersistedSnapshot, z as resolveReferencedActor, A as createActor, $ as $$ACTOR_TYPE } from './raise-1db27a82.development.esm.js';\nexport { B as Actor, I as __unsafe_getAllOwnEventDescriptors, D as and, M as cancel, A as createActor, j as getStateNodes, C as interpret, H as isMachineSnapshot, J as matchesState, E as not, F as or, K as pathToStateValue, O as raise, P as spawnChild, G as stateIn, Q as stop, R as stopChild, L as toObserver } from './raise-1db27a82.development.esm.js';\nimport { a as assign } from './log-0acd9069.development.esm.js';\nexport { S as SpecialTargets, a as assign, e as emit, b as enqueueActions, f as forwardTo, l as log, s as sendParent, c as sendTo } from './log-0acd9069.development.esm.js';\nimport '../dev/dist/xstate-dev.development.esm.js';\n\n/**\n * Asserts that the given event object is of the specified type or types. Throws\n * an error if the event object is not of the specified types.\n *\n * @example\n *\n * ```ts\n * // ...\n * entry: ({ event }) => {\n *   assertEvent(event, 'doNothing');\n *   // event is { type: 'doNothing' }\n * },\n * // ...\n * exit: ({ event }) => {\n *   assertEvent(event, 'greet');\n *   // event is { type: 'greet'; message: string }\n *\n *   assertEvent(event, ['greet', 'notify']);\n *   // event is { type: 'greet'; message: string }\n *   // or { type: 'notify'; message: string; level: 'info' | 'error' }\n * },\n * ```\n */\nfunction assertEvent(event, type) {\n  const types = toArray(type);\n  if (!types.includes(event.type)) {\n    const typesText = types.length === 1 ? `type \"${types[0]}\"` : `one of types \"${types.join('\", \"')}\"`;\n    throw new Error(`Expected event ${JSON.stringify(event)} to have ${typesText}`);\n  }\n}\n\nconst cache = new WeakMap();\nfunction memo(object, key, fn) {\n  let memoizedData = cache.get(object);\n  if (!memoizedData) {\n    memoizedData = {\n      [key]: fn()\n    };\n    cache.set(object, memoizedData);\n  } else if (!(key in memoizedData)) {\n    memoizedData[key] = fn();\n  }\n  return memoizedData[key];\n}\n\nconst EMPTY_OBJECT = {};\nconst toSerializableAction = action => {\n  if (typeof action === 'string') {\n    return {\n      type: action\n    };\n  }\n  if (typeof action === 'function') {\n    if ('resolve' in action) {\n      return {\n        type: action.type\n      };\n    }\n    return {\n      type: action.name\n    };\n  }\n  return action;\n};\nclass StateNode {\n  constructor(/** The raw config used to create the machine. */\n  config, options) {\n    this.config = config;\n    /**\n     * The relative key of the state node, which represents its location in the\n     * overall state value.\n     */\n    this.key = void 0;\n    /** The unique ID of the state node. */\n    this.id = void 0;\n    /**\n     * The type of this state node:\n     *\n     * - `'atomic'` - no child state nodes\n     * - `'compound'` - nested child state nodes (XOR)\n     * - `'parallel'` - orthogonal nested child state nodes (AND)\n     * - `'history'` - history state node\n     * - `'final'` - final state node\n     */\n    this.type = void 0;\n    /** The string path from the root machine node to this node. */\n    this.path = void 0;\n    /** The child state nodes. */\n    this.states = void 0;\n    /**\n     * The type of history on this state node. Can be:\n     *\n     * - `'shallow'` - recalls only top-level historical state value\n     * - `'deep'` - recalls historical state value at all levels\n     */\n    this.history = void 0;\n    /** The action(s) to be executed upon entering the state node. */\n    this.entry = void 0;\n    /** The action(s) to be executed upon exiting the state node. */\n    this.exit = void 0;\n    /** The parent state node. */\n    this.parent = void 0;\n    /** The root machine node. */\n    this.machine = void 0;\n    /**\n     * The meta data associated with this state node, which will be returned in\n     * State instances.\n     */\n    this.meta = void 0;\n    /**\n     * The output data sent with the \"xstate.done.state._id_\" event if this is a\n     * final state node.\n     */\n    this.output = void 0;\n    /**\n     * The order this state node appears. Corresponds to the implicit document\n     * order.\n     */\n    this.order = -1;\n    this.description = void 0;\n    this.tags = [];\n    this.transitions = void 0;\n    this.always = void 0;\n    this.parent = options._parent;\n    this.key = options._key;\n    this.machine = options._machine;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.id = this.config.id || [this.machine.id, ...this.path].join(STATE_DELIMITER);\n    this.type = this.config.type || (this.config.states && Object.keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n    this.description = this.config.description;\n    this.order = this.machine.idMap.size;\n    this.machine.idMap.set(this.id, this);\n    this.states = this.config.states ? mapValues(this.config.states, (stateConfig, key) => {\n      const stateNode = new StateNode(stateConfig, {\n        _parent: this,\n        _key: key,\n        _machine: this.machine\n      });\n      return stateNode;\n    }) : EMPTY_OBJECT;\n    if (this.type === 'compound' && !this.config.initial) {\n      throw new Error(`No initial state specified for compound state node \"#${this.id}\". Try adding { initial: \"${Object.keys(this.states)[0]}\" } to the state config.`);\n    }\n\n    // History config\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this.entry = toArray(this.config.entry).slice();\n    this.exit = toArray(this.config.exit).slice();\n    this.meta = this.config.meta;\n    this.output = this.type === 'final' || !this.parent ? this.config.output : undefined;\n    this.tags = toArray(config.tags).slice();\n  }\n\n  /** @internal */\n  _initialize() {\n    this.transitions = formatTransitions(this);\n    if (this.config.always) {\n      this.always = toTransitionConfigArray(this.config.always).map(t => formatTransition(this, NULL_EVENT, t));\n    }\n    Object.keys(this.states).forEach(key => {\n      this.states[key]._initialize();\n    });\n  }\n\n  /** The well-structured state node definition. */\n  get definition() {\n    return {\n      id: this.id,\n      key: this.key,\n      version: this.machine.version,\n      type: this.type,\n      initial: this.initial ? {\n        target: this.initial.target,\n        source: this,\n        actions: this.initial.actions.map(toSerializableAction),\n        eventType: null,\n        reenter: false,\n        toJSON: () => ({\n          target: this.initial.target.map(t => `#${t.id}`),\n          source: `#${this.id}`,\n          actions: this.initial.actions.map(toSerializableAction),\n          eventType: null\n        })\n      } : undefined,\n      history: this.history,\n      states: mapValues(this.states, state => {\n        return state.definition;\n      }),\n      on: this.on,\n      transitions: [...this.transitions.values()].flat().map(t => ({\n        ...t,\n        actions: t.actions.map(toSerializableAction)\n      })),\n      entry: this.entry.map(toSerializableAction),\n      exit: this.exit.map(toSerializableAction),\n      meta: this.meta,\n      order: this.order || -1,\n      output: this.output,\n      invoke: this.invoke,\n      description: this.description,\n      tags: this.tags\n    };\n  }\n\n  /** @internal */\n  toJSON() {\n    return this.definition;\n  }\n\n  /** The logic invoked as actors by this state node. */\n  get invoke() {\n    return memo(this, 'invoke', () => toArray(this.config.invoke).map((invokeConfig, i) => {\n      const {\n        src,\n        systemId\n      } = invokeConfig;\n      const resolvedId = invokeConfig.id ?? createInvokeId(this.id, i);\n      const sourceName = typeof src === 'string' ? src : `xstate.invoke.${createInvokeId(this.id, i)}`;\n      return {\n        ...invokeConfig,\n        src: sourceName,\n        id: resolvedId,\n        systemId: systemId,\n        toJSON() {\n          const {\n            onDone,\n            onError,\n            ...invokeDefValues\n          } = invokeConfig;\n          return {\n            ...invokeDefValues,\n            type: 'xstate.invoke',\n            src: sourceName,\n            id: resolvedId\n          };\n        }\n      };\n    }));\n  }\n\n  /** The mapping of events to transitions. */\n  get on() {\n    return memo(this, 'on', () => {\n      const transitions = this.transitions;\n      return [...transitions].flatMap(([descriptor, t]) => t.map(t => [descriptor, t])).reduce((map, [descriptor, transition]) => {\n        map[descriptor] = map[descriptor] || [];\n        map[descriptor].push(transition);\n        return map;\n      }, {});\n    });\n  }\n  get after() {\n    return memo(this, 'delayedTransitions', () => getDelayedTransitions(this));\n  }\n  get initial() {\n    return memo(this, 'initial', () => formatInitialTransition(this, this.config.initial));\n  }\n\n  /** @internal */\n  next(snapshot, event) {\n    const eventType = event.type;\n    const actions = [];\n    let selectedTransition;\n    const candidates = memo(this, `candidates-${eventType}`, () => getCandidates(this, eventType));\n    for (const candidate of candidates) {\n      const {\n        guard\n      } = candidate;\n      const resolvedContext = snapshot.context;\n      let guardPassed = false;\n      try {\n        guardPassed = !guard || evaluateGuard(guard, resolvedContext, event, snapshot);\n      } catch (err) {\n        const guardType = typeof guard === 'string' ? guard : typeof guard === 'object' ? guard.type : undefined;\n        throw new Error(`Unable to evaluate guard ${guardType ? `'${guardType}' ` : ''}in transition for event '${eventType}' in state node '${this.id}':\\n${err.message}`);\n      }\n      if (guardPassed) {\n        actions.push(...candidate.actions);\n        selectedTransition = candidate;\n        break;\n      }\n    }\n    return selectedTransition ? [selectedTransition] : undefined;\n  }\n\n  /** All the event types accepted by this state node and its descendants. */\n  get events() {\n    return memo(this, 'events', () => {\n      const {\n        states\n      } = this;\n      const events = new Set(this.ownEvents);\n      if (states) {\n        for (const stateId of Object.keys(states)) {\n          const state = states[stateId];\n          if (state.states) {\n            for (const event of state.events) {\n              events.add(`${event}`);\n            }\n          }\n        }\n      }\n      return Array.from(events);\n    });\n  }\n\n  /**\n   * All the events that have transitions directly from this state node.\n   *\n   * Excludes any inert events.\n   */\n  get ownEvents() {\n    const events = new Set([...this.transitions.keys()].filter(descriptor => {\n      return this.transitions.get(descriptor).some(transition => !(!transition.target && !transition.actions.length && !transition.reenter));\n    }));\n    return Array.from(events);\n  }\n}\n\nconst STATE_IDENTIFIER = '#';\nclass StateMachine {\n  constructor(/** The raw config used to create the machine. */\n  config, implementations) {\n    this.config = config;\n    /** The machine's own version. */\n    this.version = void 0;\n    this.schemas = void 0;\n    this.implementations = void 0;\n    /** @internal */\n    this.__xstatenode = true;\n    /** @internal */\n    this.idMap = new Map();\n    this.root = void 0;\n    this.id = void 0;\n    this.states = void 0;\n    this.events = void 0;\n    this.id = config.id || '(machine)';\n    this.implementations = {\n      actors: implementations?.actors ?? {},\n      actions: implementations?.actions ?? {},\n      delays: implementations?.delays ?? {},\n      guards: implementations?.guards ?? {}\n    };\n    this.version = this.config.version;\n    this.schemas = this.config.schemas;\n    this.transition = this.transition.bind(this);\n    this.getInitialSnapshot = this.getInitialSnapshot.bind(this);\n    this.getPersistedSnapshot = this.getPersistedSnapshot.bind(this);\n    this.restoreSnapshot = this.restoreSnapshot.bind(this);\n    this.start = this.start.bind(this);\n    this.root = new StateNode(config, {\n      _key: this.id,\n      _machine: this\n    });\n    this.root._initialize();\n    this.states = this.root.states; // TODO: remove!\n    this.events = this.root.events;\n    if (!('output' in this.root) && Object.values(this.states).some(state => state.type === 'final' && 'output' in state)) {\n      console.warn('Missing `machine.output` declaration (top-level final state with output detected)');\n    }\n  }\n\n  /**\n   * Clones this state machine with the provided implementations and merges the\n   * `context` (if provided).\n   *\n   * @param implementations Options (`actions`, `guards`, `actors`, `delays`,\n   *   `context`) to recursively merge with the existing options.\n   * @returns A new `StateMachine` instance with the provided implementations.\n   */\n  provide(implementations) {\n    const {\n      actions,\n      guards,\n      actors,\n      delays\n    } = this.implementations;\n    return new StateMachine(this.config, {\n      actions: {\n        ...actions,\n        ...implementations.actions\n      },\n      guards: {\n        ...guards,\n        ...implementations.guards\n      },\n      actors: {\n        ...actors,\n        ...implementations.actors\n      },\n      delays: {\n        ...delays,\n        ...implementations.delays\n      }\n    });\n  }\n  resolveState(config) {\n    const resolvedStateValue = resolveStateValue(this.root, config.value);\n    const nodeSet = getAllStateNodes(getStateNodes(this.root, resolvedStateValue));\n    return createMachineSnapshot({\n      _nodes: [...nodeSet],\n      context: config.context || {},\n      children: {},\n      status: isInFinalState(nodeSet, this.root) ? 'done' : config.status || 'active',\n      output: config.output,\n      error: config.error,\n      historyValue: config.historyValue\n    }, this);\n  }\n\n  /**\n   * Determines the next snapshot given the current `snapshot` and received\n   * `event`. Calculates a full macrostep from all microsteps.\n   *\n   * @param snapshot The current snapshot\n   * @param event The received event\n   */\n  transition(snapshot, event, actorScope) {\n    return macrostep(snapshot, event, actorScope, []).snapshot;\n  }\n\n  /**\n   * Determines the next state given the current `state` and `event`. Calculates\n   * a microstep.\n   *\n   * @param state The current state\n   * @param event The received event\n   */\n  microstep(snapshot, event, actorScope) {\n    return macrostep(snapshot, event, actorScope, []).microstates;\n  }\n  getTransitionData(snapshot, event) {\n    return transitionNode(this.root, snapshot.value, snapshot, event) || [];\n  }\n\n  /**\n   * The initial state _before_ evaluating any microsteps. This \"pre-initial\"\n   * state is provided to initial actions executed in the initial state.\n   */\n  getPreInitialState(actorScope, initEvent, internalQueue) {\n    const {\n      context\n    } = this.config;\n    const preInitial = createMachineSnapshot({\n      context: typeof context !== 'function' && context ? context : {},\n      _nodes: [this.root],\n      children: {},\n      status: 'active'\n    }, this);\n    if (typeof context === 'function') {\n      const assignment = ({\n        spawn,\n        event,\n        self\n      }) => context({\n        spawn,\n        input: event.input,\n        self\n      });\n      return resolveActionsAndContext(preInitial, initEvent, actorScope, [assign(assignment)], internalQueue, undefined);\n    }\n    return preInitial;\n  }\n\n  /**\n   * Returns the initial `State` instance, with reference to `self` as an\n   * `ActorRef`.\n   */\n  getInitialSnapshot(actorScope, input) {\n    const initEvent = createInitEvent(input); // TODO: fix;\n    const internalQueue = [];\n    const preInitialState = this.getPreInitialState(actorScope, initEvent, internalQueue);\n    const nextState = microstep([{\n      target: [...getInitialStateNodes(this.root)],\n      source: this.root,\n      reenter: true,\n      actions: [],\n      eventType: null,\n      toJSON: null // TODO: fix\n    }], preInitialState, actorScope, initEvent, true, internalQueue);\n    const {\n      snapshot: macroState\n    } = macrostep(nextState, initEvent, actorScope, internalQueue);\n    return macroState;\n  }\n  start(snapshot) {\n    Object.values(snapshot.children).forEach(child => {\n      if (child.getSnapshot().status === 'active') {\n        child.start();\n      }\n    });\n  }\n  getStateNodeById(stateId) {\n    const fullPath = toStatePath(stateId);\n    const relativePath = fullPath.slice(1);\n    const resolvedStateId = isStateId(fullPath[0]) ? fullPath[0].slice(STATE_IDENTIFIER.length) : fullPath[0];\n    const stateNode = this.idMap.get(resolvedStateId);\n    if (!stateNode) {\n      throw new Error(`Child state node '#${resolvedStateId}' does not exist on machine '${this.id}'`);\n    }\n    return getStateNodeByPath(stateNode, relativePath);\n  }\n  get definition() {\n    return this.root.definition;\n  }\n  toJSON() {\n    return this.definition;\n  }\n  getPersistedSnapshot(snapshot, options) {\n    return getPersistedSnapshot(snapshot, options);\n  }\n  restoreSnapshot(snapshot, _actorScope) {\n    const children = {};\n    const snapshotChildren = snapshot.children;\n    Object.keys(snapshotChildren).forEach(actorId => {\n      const actorData = snapshotChildren[actorId];\n      const childState = actorData.snapshot;\n      const src = actorData.src;\n      const logic = typeof src === 'string' ? resolveReferencedActor(this, src) : src;\n      if (!logic) {\n        return;\n      }\n      const actorRef = createActor(logic, {\n        id: actorId,\n        parent: _actorScope.self,\n        syncSnapshot: actorData.syncSnapshot,\n        snapshot: childState,\n        src,\n        systemId: actorData.systemId\n      });\n      children[actorId] = actorRef;\n    });\n    const restoredSnapshot = createMachineSnapshot({\n      ...snapshot,\n      children,\n      _nodes: Array.from(getAllStateNodes(getStateNodes(this.root, snapshot.value)))\n    }, this);\n    const seen = new Set();\n    function reviveContext(contextPart, children) {\n      if (seen.has(contextPart)) {\n        return;\n      }\n      seen.add(contextPart);\n      for (const key in contextPart) {\n        const value = contextPart[key];\n        if (value && typeof value === 'object') {\n          if ('xstate$$type' in value && value.xstate$$type === $$ACTOR_TYPE) {\n            contextPart[key] = children[value.id];\n            continue;\n          }\n          reviveContext(value, children);\n        }\n      }\n    }\n    reviveContext(restoredSnapshot.context, children);\n    return restoredSnapshot;\n  }\n}\n\n/**\n * Creates a state machine (statechart) with the given configuration.\n *\n * The state machine represents the pure logic of a state machine actor.\n *\n * @example\n *\n * ```ts\n * import { createMachine } from 'xstate';\n *\n * const lightMachine = createMachine({\n *   id: 'light',\n *   initial: 'green',\n *   states: {\n *     green: {\n *       on: {\n *         TIMER: { target: 'yellow' }\n *       }\n *     },\n *     yellow: {\n *       on: {\n *         TIMER: { target: 'red' }\n *       }\n *     },\n *     red: {\n *       on: {\n *         TIMER: { target: 'green' }\n *       }\n *     }\n *   }\n * });\n *\n * const lightActor = createActor(lightMachine);\n * lightActor.start();\n *\n * lightActor.send({ type: 'TIMER' });\n * ```\n *\n * @param config The state machine configuration.\n * @param options DEPRECATED: use `setup({ ... })` or `machine.provide({ ... })`\n *   to provide machine implementations instead.\n */\nfunction createMachine(config, implementations) {\n  return new StateMachine(config, implementations);\n}\n\n/** @internal */\nfunction createInertActorScope(actorLogic) {\n  const self = createActor(actorLogic);\n  const inertActorScope = {\n    self,\n    defer: () => {},\n    id: '',\n    logger: () => {},\n    sessionId: '',\n    stopChild: () => {},\n    system: self.system,\n    emit: () => {},\n    actionExecutor: () => {}\n  };\n  return inertActorScope;\n}\n\n/** @deprecated Use `initialTransition()` instead. */\nfunction getInitialSnapshot(actorLogic, ...[input]) {\n  const actorScope = createInertActorScope(actorLogic);\n  return actorLogic.getInitialSnapshot(actorScope, input);\n}\n\n/**\n * Determines the next snapshot for the given `actorLogic` based on the given\n * `snapshot` and `event`.\n *\n * If the `snapshot` is `undefined`, the initial snapshot of the `actorLogic` is\n * used.\n *\n * @deprecated Use `transition()` instead.\n * @example\n *\n * ```ts\n * import { getNextSnapshot } from 'xstate';\n * import { trafficLightMachine } from './trafficLightMachine.ts';\n *\n * const nextSnapshot = getNextSnapshot(\n *   trafficLightMachine, // actor logic\n *   undefined, // snapshot (or initial state if undefined)\n *   { type: 'TIMER' }\n * ); // event object\n *\n * console.log(nextSnapshot.value);\n * // => 'yellow'\n *\n * const nextSnapshot2 = getNextSnapshot(\n *   trafficLightMachine, // actor logic\n *   nextSnapshot, // snapshot\n *   { type: 'TIMER' }\n * ); // event object\n *\n * console.log(nextSnapshot2.value);\n * // =>'red'\n * ```\n */\nfunction getNextSnapshot(actorLogic, snapshot, event) {\n  const inertActorScope = createInertActorScope(actorLogic);\n  inertActorScope.self._snapshot = snapshot;\n  return actorLogic.transition(snapshot, event, inertActorScope);\n}\n\n// at the moment we allow extra actors - ones that are not specified by `children`\n// this could be reconsidered in the future\n\nfunction setup({\n  schemas,\n  actors,\n  actions,\n  guards,\n  delays\n}) {\n  return {\n    createMachine: config => createMachine({\n      ...config,\n      schemas\n    }, {\n      actors,\n      actions,\n      guards,\n      delays\n    })\n  };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-declaration-merging\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-declaration-merging\nclass SimulatedClock {\n  constructor() {\n    this.timeouts = new Map();\n    this._now = 0;\n    this._id = 0;\n    this._flushing = false;\n    this._flushingInvalidated = false;\n  }\n  now() {\n    return this._now;\n  }\n  getId() {\n    return this._id++;\n  }\n  setTimeout(fn, timeout) {\n    this._flushingInvalidated = this._flushing;\n    const id = this.getId();\n    this.timeouts.set(id, {\n      start: this.now(),\n      timeout,\n      fn\n    });\n    return id;\n  }\n  clearTimeout(id) {\n    this._flushingInvalidated = this._flushing;\n    this.timeouts.delete(id);\n  }\n  set(time) {\n    if (this._now > time) {\n      throw new Error('Unable to travel back in time');\n    }\n    this._now = time;\n    this.flushTimeouts();\n  }\n  flushTimeouts() {\n    if (this._flushing) {\n      this._flushingInvalidated = true;\n      return;\n    }\n    this._flushing = true;\n    const sorted = [...this.timeouts].sort(([_idA, timeoutA], [_idB, timeoutB]) => {\n      const endA = timeoutA.start + timeoutA.timeout;\n      const endB = timeoutB.start + timeoutB.timeout;\n      return endB > endA ? -1 : 1;\n    });\n    for (const [id, timeout] of sorted) {\n      if (this._flushingInvalidated) {\n        this._flushingInvalidated = false;\n        this._flushing = false;\n        this.flushTimeouts();\n        return;\n      }\n      if (this.now() - timeout.start >= timeout.timeout) {\n        this.timeouts.delete(id);\n        timeout.fn.call(null);\n      }\n    }\n    this._flushing = false;\n  }\n  increment(ms) {\n    this._now += ms;\n    this.flushTimeouts();\n  }\n}\n\n/**\n * Returns a promise that resolves to the `output` of the actor when it is done.\n *\n * @example\n *\n * ```ts\n * const machine = createMachine({\n *   // ...\n *   output: {\n *     count: 42\n *   }\n * });\n *\n * const actor = createActor(machine);\n *\n * actor.start();\n *\n * const output = await toPromise(actor);\n *\n * console.log(output);\n * // logs { count: 42 }\n * ```\n */\nfunction toPromise(actor) {\n  return new Promise((resolve, reject) => {\n    actor.subscribe({\n      complete: () => {\n        resolve(actor.getSnapshot().output);\n      },\n      error: reject\n    });\n  });\n}\n\n/**\n * Given actor `logic`, a `snapshot`, and an `event`, returns a tuple of the\n * `nextSnapshot` and `actions` to execute.\n *\n * This is a pure function that does not execute `actions`.\n */\nfunction transition(logic, snapshot, event) {\n  const executableActions = [];\n  const actorScope = createInertActorScope(logic);\n  actorScope.actionExecutor = action => {\n    executableActions.push(action);\n  };\n  const nextSnapshot = logic.transition(snapshot, event, actorScope);\n  return [nextSnapshot, executableActions];\n}\n\n/**\n * Given actor `logic` and optional `input`, returns a tuple of the\n * `nextSnapshot` and `actions` to execute from the initial transition (no\n * previous state).\n *\n * This is a pure function that does not execute `actions`.\n */\nfunction initialTransition(logic, ...[input]) {\n  const executableActions = [];\n  const actorScope = createInertActorScope(logic);\n  actorScope.actionExecutor = action => {\n    executableActions.push(action);\n  };\n  const nextSnapshot = logic.getInitialSnapshot(actorScope, input);\n  return [nextSnapshot, executableActions];\n}\n\nconst defaultWaitForOptions = {\n  timeout: Infinity // much more than 10 seconds\n};\n\n/**\n * Subscribes to an actor ref and waits for its emitted value to satisfy a\n * predicate, and then resolves with that value. Will throw if the desired state\n * is not reached after an optional timeout. (defaults to Infinity).\n *\n * @example\n *\n * ```js\n * const state = await waitFor(someService, (state) => {\n *   return state.hasTag('loaded');\n * });\n *\n * state.hasTag('loaded'); // true\n * ```\n *\n * @param actorRef The actor ref to subscribe to\n * @param predicate Determines if a value matches the condition to wait for\n * @param options\n * @returns A promise that eventually resolves to the emitted value that matches\n *   the condition\n */\nfunction waitFor(actorRef, predicate, options) {\n  const resolvedOptions = {\n    ...defaultWaitForOptions,\n    ...options\n  };\n  return new Promise((res, rej) => {\n    const {\n      signal\n    } = resolvedOptions;\n    if (signal?.aborted) {\n      // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\n      rej(signal.reason);\n      return;\n    }\n    let done = false;\n    if (resolvedOptions.timeout < 0) {\n      console.error('`timeout` passed to `waitFor` is negative and it will reject its internal promise immediately.');\n    }\n    const handle = resolvedOptions.timeout === Infinity ? undefined : setTimeout(() => {\n      dispose();\n      rej(new Error(`Timeout of ${resolvedOptions.timeout} ms exceeded`));\n    }, resolvedOptions.timeout);\n    const dispose = () => {\n      clearTimeout(handle);\n      done = true;\n      sub?.unsubscribe();\n      if (abortListener) {\n        signal.removeEventListener('abort', abortListener);\n      }\n    };\n    function checkEmitted(emitted) {\n      if (predicate(emitted)) {\n        dispose();\n        res(emitted);\n      }\n    }\n\n    /**\n     * If the `signal` option is provided, this will be the listener for its\n     * `abort` event\n     */\n    let abortListener;\n    // eslint-disable-next-line prefer-const\n    let sub; // avoid TDZ when disposing synchronously\n\n    // See if the current snapshot already matches the predicate\n    checkEmitted(actorRef.getSnapshot());\n    if (done) {\n      return;\n    }\n\n    // only define the `abortListener` if the `signal` option is provided\n    if (signal) {\n      abortListener = () => {\n        dispose();\n        // XState does not \"own\" the signal, so we should reject with its reason (if any)\n        // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\n        rej(signal.reason);\n      };\n      signal.addEventListener('abort', abortListener);\n    }\n    sub = actorRef.subscribe({\n      next: checkEmitted,\n      error: err => {\n        dispose();\n        // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\n        rej(err);\n      },\n      complete: () => {\n        dispose();\n        rej(new Error(`Actor terminated without satisfying predicate`));\n      }\n    });\n    if (done) {\n      sub.unsubscribe();\n    }\n  });\n}\n\nexport { SimulatedClock, StateMachine, StateNode, assertEvent, createMachine, getInitialSnapshot, getNextSnapshot, initialTransition, setup, toPromise, transition, waitFor };\n", "import { type DmkError } from \"@api/Error\";\n\nexport class DeviceNotOnboardedError implements DmkError {\n  readonly _tag = \"DeviceNotOnboardedError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Device not onboarded.\");\n  }\n}\n\nexport class DeviceLockedError implements DmkError {\n  readonly _tag = \"DeviceLockedError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Device locked.\");\n  }\n}\n\nexport class UnsupportedFirmwareDAError implements DmkError {\n  readonly _tag = \"UnsupportedFirmwareDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unknown error.\");\n  }\n}\n\nexport class RefusedByUserDAError implements DmkError {\n  readonly _tag = \"RefusedByUserDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unknown error.\");\n  }\n}\n\nexport class AppAlreadyInstalledDAError implements DmkError {\n  readonly _tag = \"AppAlreadyInstalledDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unknown error.\");\n  }\n}\n\nexport class OutOfMemoryDAError implements DmkError {\n  readonly _tag = \"OutOfMemoryDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unknown error.\");\n  }\n}\n\nexport class UnknownDAError implements DmkError {\n  readonly _tag = \"UnknownDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unknown error.\");\n  }\n}\n\nexport class UnsupportedApplicationDAError implements DmkError {\n  readonly _tag = \"UnsupportedApplicationDAError\";\n  readonly originalError?: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(\n      message ?? \"Application currently not supported.\",\n    );\n  }\n}\n", "export const DEFAULT_UNLOCK_TIMEOUT_MS = 60 * 1000;\n", "/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n", "/**\n * Returns true if the object is a function.\n * @param value The value to check\n */\nexport function isFunction(value: any): value is (...args: any[]) => any {\n  return typeof value === 'function';\n}\n", "/**\n * Used to create Error subclasses until the community moves away from ES5.\n *\n * This is because compiling from TypeScript down to ES5 has issues with subclassing Errors\n * as well as other built-in types: https://github.com/Microsoft/TypeScript/issues/12123\n *\n * @param createImpl A factory function to create the actual constructor implementation. The returned\n * function should be a named function that calls `_super` internally.\n */\nexport function createErrorClass<T>(createImpl: (_super: any) => any): T {\n  const _super = (instance: any) => {\n    Error.call(instance);\n    instance.stack = new Error().stack;\n  };\n\n  const ctorFunc = createImpl(_super);\n  ctorFunc.prototype = Object.create(Error.prototype);\n  ctorFunc.prototype.constructor = ctorFunc;\n  return ctorFunc;\n}\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface UnsubscriptionError extends Error {\n  readonly errors: any[];\n}\n\nexport interface UnsubscriptionErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (errors: any[]): UnsubscriptionError;\n}\n\n/**\n * An error thrown when one or more errors have occurred during the\n * `unsubscribe` of a {@link Subscription}.\n */\nexport const UnsubscriptionError: UnsubscriptionErrorCtor = createErrorClass(\n  (_super) =>\n    function UnsubscriptionErrorImpl(this: any, errors: (Error | string)[]) {\n      _super(this);\n      this.message = errors\n        ? `${errors.length} errors occurred during unsubscription:\n${errors.map((err, i) => `${i + 1}) ${err.toString()}`).join('\\n  ')}`\n        : '';\n      this.name = 'UnsubscriptionError';\n      this.errors = errors;\n    }\n);\n", "/**\n * Removes an item from an array, mutating it.\n * @param arr The array to remove the item from\n * @param item The item to remove\n */\nexport function arrRemove<T>(arr: T[] | undefined | null, item: T) {\n  if (arr) {\n    const index = arr.indexOf(item);\n    0 <= index && arr.splice(index, 1);\n  }\n}\n", "import { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { SubscriptionLike, TeardownLogic, Unsubscribable } from './types';\nimport { arrRemove } from './util/arrRemove';\n\n/**\n * Represents a disposable resource, such as the execution of an Observable. A\n * Subscription has one important method, `unsubscribe`, that takes no argument\n * and just disposes the resource held by the subscription.\n *\n * Additionally, subscriptions may be grouped together through the `add()`\n * method, which will attach a child Subscription to the current Subscription.\n * When a Subscription is unsubscribed, all its children (and its grandchildren)\n * will be unsubscribed as well.\n */\nexport class Subscription implements SubscriptionLike {\n  public static EMPTY = (() => {\n    const empty = new Subscription();\n    empty.closed = true;\n    return empty;\n  })();\n\n  /**\n   * A flag to indicate whether this Subscription has already been unsubscribed.\n   */\n  public closed = false;\n\n  private _parentage: Subscription[] | Subscription | null = null;\n\n  /**\n   * The list of registered finalizers to execute upon unsubscription. Adding and removing from this\n   * list occurs in the {@link #add} and {@link #remove} methods.\n   */\n  private _finalizers: Exclude<TeardownLogic, void>[] | null = null;\n\n  /**\n   * @param initialTeardown A function executed first as part of the finalization\n   * process that is kicked off when {@link #unsubscribe} is called.\n   */\n  constructor(private initialTeardown?: () => void) {}\n\n  /**\n   * Disposes the resources held by the subscription. May, for instance, cancel\n   * an ongoing Observable execution or cancel any other type of work that\n   * started when the Subscription was created.\n   */\n  unsubscribe(): void {\n    let errors: any[] | undefined;\n\n    if (!this.closed) {\n      this.closed = true;\n\n      // Remove this from it's parents.\n      const { _parentage } = this;\n      if (_parentage) {\n        this._parentage = null;\n        if (Array.isArray(_parentage)) {\n          for (const parent of _parentage) {\n            parent.remove(this);\n          }\n        } else {\n          _parentage.remove(this);\n        }\n      }\n\n      const { initialTeardown: initialFinalizer } = this;\n      if (isFunction(initialFinalizer)) {\n        try {\n          initialFinalizer();\n        } catch (e) {\n          errors = e instanceof UnsubscriptionError ? e.errors : [e];\n        }\n      }\n\n      const { _finalizers } = this;\n      if (_finalizers) {\n        this._finalizers = null;\n        for (const finalizer of _finalizers) {\n          try {\n            execFinalizer(finalizer);\n          } catch (err) {\n            errors = errors ?? [];\n            if (err instanceof UnsubscriptionError) {\n              errors = [...errors, ...err.errors];\n            } else {\n              errors.push(err);\n            }\n          }\n        }\n      }\n\n      if (errors) {\n        throw new UnsubscriptionError(errors);\n      }\n    }\n  }\n\n  /**\n   * Adds a finalizer to this subscription, so that finalization will be unsubscribed/called\n   * when this subscription is unsubscribed. If this subscription is already {@link #closed},\n   * because it has already been unsubscribed, then whatever finalizer is passed to it\n   * will automatically be executed (unless the finalizer itself is also a closed subscription).\n   *\n   * Closed Subscriptions cannot be added as finalizers to any subscription. Adding a closed\n   * subscription to a any subscription will result in no operation. (A noop).\n   *\n   * Adding a subscription to itself, or adding `null` or `undefined` will not perform any\n   * operation at all. (A noop).\n   *\n   * `Subscription` instances that are added to this instance will automatically remove themselves\n   * if they are unsubscribed. Functions and {@link Unsubscribable} objects that you wish to remove\n   * will need to be removed manually with {@link #remove}\n   *\n   * @param teardown The finalization logic to add to this subscription.\n   */\n  add(teardown: TeardownLogic): void {\n    // Only add the finalizer if it's not undefined\n    // and don't add a subscription to itself.\n    if (teardown && teardown !== this) {\n      if (this.closed) {\n        // If this subscription is already closed,\n        // execute whatever finalizer is handed to it automatically.\n        execFinalizer(teardown);\n      } else {\n        if (teardown instanceof Subscription) {\n          // We don't add closed subscriptions, and we don't add the same subscription\n          // twice. Subscription unsubscribe is idempotent.\n          if (teardown.closed || teardown._hasParent(this)) {\n            return;\n          }\n          teardown._addParent(this);\n        }\n        (this._finalizers = this._finalizers ?? []).push(teardown);\n      }\n    }\n  }\n\n  /**\n   * Checks to see if a this subscription already has a particular parent.\n   * This will signal that this subscription has already been added to the parent in question.\n   * @param parent the parent to check for\n   */\n  private _hasParent(parent: Subscription) {\n    const { _parentage } = this;\n    return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n  }\n\n  /**\n   * Adds a parent to this subscription so it can be removed from the parent if it\n   * unsubscribes on it's own.\n   *\n   * NOTE: THIS ASSUMES THAT {@link _hasParent} HAS ALREADY BEEN CHECKED.\n   * @param parent The parent subscription to add\n   */\n  private _addParent(parent: Subscription) {\n    const { _parentage } = this;\n    this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n  }\n\n  /**\n   * Called on a child when it is removed via {@link #remove}.\n   * @param parent The parent to remove\n   */\n  private _removeParent(parent: Subscription) {\n    const { _parentage } = this;\n    if (_parentage === parent) {\n      this._parentage = null;\n    } else if (Array.isArray(_parentage)) {\n      arrRemove(_parentage, parent);\n    }\n  }\n\n  /**\n   * Removes a finalizer from this subscription that was previously added with the {@link #add} method.\n   *\n   * Note that `Subscription` instances, when unsubscribed, will automatically remove themselves\n   * from every other `Subscription` they have been added to. This means that using the `remove` method\n   * is not a common thing and should be used thoughtfully.\n   *\n   * If you add the same finalizer instance of a function or an unsubscribable object to a `Subscription` instance\n   * more than once, you will need to call `remove` the same number of times to remove all instances.\n   *\n   * All finalizer instances are removed to free up memory upon unsubscription.\n   *\n   * @param teardown The finalizer to remove from this subscription\n   */\n  remove(teardown: Exclude<TeardownLogic, void>): void {\n    const { _finalizers } = this;\n    _finalizers && arrRemove(_finalizers, teardown);\n\n    if (teardown instanceof Subscription) {\n      teardown._removeParent(this);\n    }\n  }\n}\n\nexport const EMPTY_SUBSCRIPTION = Subscription.EMPTY;\n\nexport function isSubscription(value: any): value is Subscription {\n  return (\n    value instanceof Subscription ||\n    (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe))\n  );\n}\n\nfunction execFinalizer(finalizer: Unsubscribable | (() => void)) {\n  if (isFunction(finalizer)) {\n    finalizer();\n  } else {\n    finalizer.unsubscribe();\n  }\n}\n", "import { Subscriber } from './Subscriber';\nimport { ObservableNotification } from './types';\n\n/**\n * The {@link GlobalConfig} object for RxJS. It is used to configure things\n * like how to react on unhandled errors.\n */\nexport const config: GlobalConfig = {\n  onUnhandledError: null,\n  onStoppedNotification: null,\n  Promise: undefined,\n  useDeprecatedSynchronousErrorHandling: false,\n  useDeprecatedNextContext: false,\n};\n\n/**\n * The global configuration object for RxJS, used to configure things\n * like how to react on unhandled errors. Accessible via {@link config}\n * object.\n */\nexport interface GlobalConfig {\n  /**\n   * A registration point for unhandled errors from RxJS. These are errors that\n   * cannot were not handled by consuming code in the usual subscription path. For\n   * example, if you have this configured, and you subscribe to an observable without\n   * providing an error handler, errors from that subscription will end up here. This\n   * will _always_ be called asynchronously on another job in the runtime. This is because\n   * we do not want errors thrown in this user-configured handler to interfere with the\n   * behavior of the library.\n   */\n  onUnhandledError: ((err: any) => void) | null;\n\n  /**\n   * A registration point for notifications that cannot be sent to subscribers because they\n   * have completed, errored or have been explicitly unsubscribed. By default, next, complete\n   * and error notifications sent to stopped subscribers are noops. However, sometimes callers\n   * might want a different behavior. For example, with sources that attempt to report errors\n   * to stopped subscribers, a caller can configure RxJS to throw an unhandled error instead.\n   * This will _always_ be called asynchronously on another job in the runtime. This is because\n   * we do not want errors thrown in this user-configured handler to interfere with the\n   * behavior of the library.\n   */\n  onStoppedNotification: ((notification: ObservableNotification<any>, subscriber: Subscriber<any>) => void) | null;\n\n  /**\n   * The promise constructor used by default for {@link Observable#toPromise toPromise} and {@link Observable#forEach forEach}\n   * methods.\n   *\n   * @deprecated As of version 8, RxJS will no longer support this sort of injection of a\n   * Promise constructor. If you need a Promise implementation other than native promises,\n   * please polyfill/patch Promise as you see appropriate. Will be removed in v8.\n   */\n  Promise?: PromiseConstructorLike;\n\n  /**\n   * If true, turns on synchronous error rethrowing, which is a deprecated behavior\n   * in v6 and higher. This behavior enables bad patterns like wrapping a subscribe\n   * call in a try/catch block. It also enables producer interference, a nasty bug\n   * where a multicast can be broken for all observers by a downstream consumer with\n   * an unhandled error. DO NOT USE THIS FLAG UNLESS IT'S NEEDED TO BUY TIME\n   * FOR MIGRATION REASONS.\n   *\n   * @deprecated As of version 8, RxJS will no longer support synchronous throwing\n   * of unhandled errors. All errors will be thrown on a separate call stack to prevent bad\n   * behaviors described above. Will be removed in v8.\n   */\n  useDeprecatedSynchronousErrorHandling: boolean;\n\n  /**\n   * If true, enables an as-of-yet undocumented feature from v5: The ability to access\n   * `unsubscribe()` via `this` context in `next` functions created in observers passed\n   * to `subscribe`.\n   *\n   * This is being removed because the performance was severely problematic, and it could also cause\n   * issues when types other than POJOs are passed to subscribe as subscribers, as they will likely have\n   * their `this` context overwritten.\n   *\n   * @deprecated As of version 8, RxJS will no longer support altering the\n   * context of next functions provided as part of an observer to Subscribe. Instead,\n   * you will have access to a subscription or a signal or token that will allow you to do things like\n   * unsubscribe and test closed status. Will be removed in v8.\n   */\n  useDeprecatedNextContext: boolean;\n}\n", "import type { TimerHandle } from './timerHandle';\ntype SetTimeoutFunction = (handler: () => void, timeout?: number, ...args: any[]) => TimerHandle;\ntype ClearTimeoutFunction = (handle: TimerHandle) => void;\n\ninterface TimeoutProvider {\n  setTimeout: SetTimeoutFunction;\n  clearTimeout: ClearTimeoutFunction;\n  delegate:\n    | {\n        setTimeout: SetTimeoutFunction;\n        clearTimeout: ClearTimeoutFunction;\n      }\n    | undefined;\n}\n\nexport const timeoutProvider: TimeoutProvider = {\n  // When accessing the delegate, use the variable rather than `this` so that\n  // the functions can be called without being bound to the provider.\n  setTimeout(handler: () => void, timeout?: number, ...args) {\n    const { delegate } = timeoutProvider;\n    if (delegate?.setTimeout) {\n      return delegate.setTimeout(handler, timeout, ...args);\n    }\n    return setTimeout(handler, timeout, ...args);\n  },\n  clearTimeout(handle) {\n    const { delegate } = timeoutProvider;\n    return (delegate?.clearTimeout || clearTimeout)(handle as any);\n  },\n  delegate: undefined,\n};\n", "import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\n\n/**\n * Handles an error on another job either with the user-configured {@link onUnhandledError},\n * or by throwing it on that new job so it can be picked up by `window.onerror`, `process.on('error')`, etc.\n *\n * This should be called whenever there is an error that is out-of-band with the subscription\n * or when an error hits a terminal boundary of the subscription and no error handler was provided.\n *\n * @param err the error to report\n */\nexport function reportUnhandledError(err: any) {\n  timeoutProvider.setTimeout(() => {\n    const { onUnhandledError } = config;\n    if (onUnhandledError) {\n      // Execute the user-configured error handler.\n      onUnhandledError(err);\n    } else {\n      // Throw so it is picked up by the runtime's uncaught error mechanism.\n      throw err;\n    }\n  });\n}\n", "/* tslint:disable:no-empty */\nexport function noop() { }\n", "import { CompleteNotification, NextNotification, ErrorNotification } from './types';\n\n/**\n * A completion object optimized for memory use and created to be the\n * same \"shape\" as other notifications in v8.\n * @internal\n */\nexport const COMPLETE_NOTIFICATION = (() => createNotification('C', undefined, undefined) as CompleteNotification)();\n\n/**\n * Internal use only. Creates an optimized error notification that is the same \"shape\"\n * as other notifications.\n * @internal\n */\nexport function errorNotification(error: any): ErrorNotification {\n  return createNotification('E', undefined, error) as any;\n}\n\n/**\n * Internal use only. Creates an optimized next notification that is the same \"shape\"\n * as other notifications.\n * @internal\n */\nexport function nextNotification<T>(value: T) {\n  return createNotification('N', value, undefined) as NextNotification<T>;\n}\n\n/**\n * Ensures that all notifications created internally have the same \"shape\" in v8.\n *\n * TODO: This is only exported to support a crazy legacy test in `groupBy`.\n * @internal\n */\nexport function createNotification(kind: 'N' | 'E' | 'C', value: any, error: any) {\n  return {\n    kind,\n    value,\n    error,\n  };\n}\n", "import { config } from '../config';\n\nlet context: { errorThrown: boolean; error: any } | null = null;\n\n/**\n * Handles dealing with errors for super-gross mode. Creates a context, in which\n * any synchronously thrown errors will be passed to {@link captureError}. Which\n * will record the error such that it will be rethrown after the call back is complete.\n * TODO: Remove in v8\n * @param cb An immediately executed function.\n */\nexport function errorContext(cb: () => void) {\n  if (config.useDeprecatedSynchronousErrorHandling) {\n    const isRoot = !context;\n    if (isRoot) {\n      context = { errorThrown: false, error: null };\n    }\n    cb();\n    if (isRoot) {\n      const { errorThrown, error } = context!;\n      context = null;\n      if (errorThrown) {\n        throw error;\n      }\n    }\n  } else {\n    // This is the general non-deprecated path for everyone that\n    // isn't crazy enough to use super-gross mode (useDeprecatedSynchronousErrorHandling)\n    cb();\n  }\n}\n\n/**\n * Captures errors only in super-gross mode.\n * @param err the error to capture\n */\nexport function captureError(err: any) {\n  if (config.useDeprecatedSynchronousErrorHandling && context) {\n    context.errorThrown = true;\n    context.error = err;\n  }\n}\n", "import { isFunction } from './util/isFunction';\nimport { Observer, ObservableNotification } from './types';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\n\n/**\n * Implements the {@link Observer} interface and extends the\n * {@link Subscription} class. While the {@link Observer} is the public API for\n * consuming the values of an {@link Observable}, all Observers get converted to\n * a Subscriber, in order to provide Subscription-like capabilities such as\n * `unsubscribe`. Subscriber is a common type in RxJS, and crucial for\n * implementing operators, but it is rarely used as a public API.\n */\nexport class Subscriber<T> extends Subscription implements Observer<T> {\n  /**\n   * A static factory for a Subscriber, given a (potentially partial) definition\n   * of an Observer.\n   * @param next The `next` callback of an Observer.\n   * @param error The `error` callback of an\n   * Observer.\n   * @param complete The `complete` callback of an\n   * Observer.\n   * @return A Subscriber wrapping the (partially defined)\n   * Observer represented by the given arguments.\n   * @deprecated Do not use. Will be removed in v8. There is no replacement for this\n   * method, and there is no reason to be creating instances of `Subscriber` directly.\n   * If you have a specific use case, please file an issue.\n   */\n  static create<T>(next?: (x?: T) => void, error?: (e?: any) => void, complete?: () => void): Subscriber<T> {\n    return new SafeSubscriber(next, error, complete);\n  }\n\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  protected isStopped: boolean = false;\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  protected destination: Subscriber<any> | Observer<any>; // this `any` is the escape hatch to erase extra type param (e.g. R)\n\n  /**\n   * @deprecated Internal implementation detail, do not use directly. Will be made internal in v8.\n   * There is no reason to directly create an instance of Subscriber. This type is exported for typings reasons.\n   */\n  constructor(destination?: Subscriber<any> | Observer<any>) {\n    super();\n    if (destination) {\n      this.destination = destination;\n      // Automatically chain subscriptions together here.\n      // if destination is a Subscription, then it is a Subscriber.\n      if (isSubscription(destination)) {\n        destination.add(this);\n      }\n    } else {\n      this.destination = EMPTY_OBSERVER;\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive notifications of type `next` from\n   * the Observable, with a value. The Observable may call this method 0 or more\n   * times.\n   * @param value The `next` value.\n   */\n  next(value: T): void {\n    if (this.isStopped) {\n      handleStoppedNotification(nextNotification(value), this);\n    } else {\n      this._next(value!);\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive notifications of type `error` from\n   * the Observable, with an attached `Error`. Notifies the Observer that\n   * the Observable has experienced an error condition.\n   * @param err The `error` exception.\n   */\n  error(err?: any): void {\n    if (this.isStopped) {\n      handleStoppedNotification(errorNotification(err), this);\n    } else {\n      this.isStopped = true;\n      this._error(err);\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive a valueless notification of type\n   * `complete` from the Observable. Notifies the Observer that the Observable\n   * has finished sending push-based notifications.\n   */\n  complete(): void {\n    if (this.isStopped) {\n      handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n    } else {\n      this.isStopped = true;\n      this._complete();\n    }\n  }\n\n  unsubscribe(): void {\n    if (!this.closed) {\n      this.isStopped = true;\n      super.unsubscribe();\n      this.destination = null!;\n    }\n  }\n\n  protected _next(value: T): void {\n    this.destination.next(value);\n  }\n\n  protected _error(err: any): void {\n    try {\n      this.destination.error(err);\n    } finally {\n      this.unsubscribe();\n    }\n  }\n\n  protected _complete(): void {\n    try {\n      this.destination.complete();\n    } finally {\n      this.unsubscribe();\n    }\n  }\n}\n\n/**\n * This bind is captured here because we want to be able to have\n * compatibility with monoid libraries that tend to use a method named\n * `bind`. In particular, a library called Monio requires this.\n */\nconst _bind = Function.prototype.bind;\n\nfunction bind<Fn extends (...args: any[]) => any>(fn: Fn, thisArg: any): Fn {\n  return _bind.call(fn, thisArg);\n}\n\n/**\n * Internal optimization only, DO NOT EXPOSE.\n * @internal\n */\nclass ConsumerObserver<T> implements Observer<T> {\n  constructor(private partialObserver: Partial<Observer<T>>) {}\n\n  next(value: T): void {\n    const { partialObserver } = this;\n    if (partialObserver.next) {\n      try {\n        partialObserver.next(value);\n      } catch (error) {\n        handleUnhandledError(error);\n      }\n    }\n  }\n\n  error(err: any): void {\n    const { partialObserver } = this;\n    if (partialObserver.error) {\n      try {\n        partialObserver.error(err);\n      } catch (error) {\n        handleUnhandledError(error);\n      }\n    } else {\n      handleUnhandledError(err);\n    }\n  }\n\n  complete(): void {\n    const { partialObserver } = this;\n    if (partialObserver.complete) {\n      try {\n        partialObserver.complete();\n      } catch (error) {\n        handleUnhandledError(error);\n      }\n    }\n  }\n}\n\nexport class SafeSubscriber<T> extends Subscriber<T> {\n  constructor(\n    observerOrNext?: Partial<Observer<T>> | ((value: T) => void) | null,\n    error?: ((e?: any) => void) | null,\n    complete?: (() => void) | null\n  ) {\n    super();\n\n    let partialObserver: Partial<Observer<T>>;\n    if (isFunction(observerOrNext) || !observerOrNext) {\n      // The first argument is a function, not an observer. The next\n      // two arguments *could* be observers, or they could be empty.\n      partialObserver = {\n        next: (observerOrNext ?? undefined) as ((value: T) => void) | undefined,\n        error: error ?? undefined,\n        complete: complete ?? undefined,\n      };\n    } else {\n      // The first argument is a partial observer.\n      let context: any;\n      if (this && config.useDeprecatedNextContext) {\n        // This is a deprecated path that made `this.unsubscribe()` available in\n        // next handler functions passed to subscribe. This only exists behind a flag\n        // now, as it is *very* slow.\n        context = Object.create(observerOrNext);\n        context.unsubscribe = () => this.unsubscribe();\n        partialObserver = {\n          next: observerOrNext.next && bind(observerOrNext.next, context),\n          error: observerOrNext.error && bind(observerOrNext.error, context),\n          complete: observerOrNext.complete && bind(observerOrNext.complete, context),\n        };\n      } else {\n        // The \"normal\" path. Just use the partial observer directly.\n        partialObserver = observerOrNext;\n      }\n    }\n\n    // Wrap the partial observer to ensure it's a full observer, and\n    // make sure proper error handling is accounted for.\n    this.destination = new ConsumerObserver(partialObserver);\n  }\n}\n\nfunction handleUnhandledError(error: any) {\n  if (config.useDeprecatedSynchronousErrorHandling) {\n    captureError(error);\n  } else {\n    // Ideal path, we report this as an unhandled error,\n    // which is thrown on a new call stack.\n    reportUnhandledError(error);\n  }\n}\n\n/**\n * An error handler used when no error handler was supplied\n * to the SafeSubscriber -- meaning no error handler was supplied\n * do the `subscribe` call on our observable.\n * @param err The error to handle\n */\nfunction defaultErrorHandler(err: any) {\n  throw err;\n}\n\n/**\n * A handler for notifications that cannot be sent to a stopped subscriber.\n * @param notification The notification being sent.\n * @param subscriber The stopped subscriber.\n */\nfunction handleStoppedNotification(notification: ObservableNotification<any>, subscriber: Subscriber<any>) {\n  const { onStoppedNotification } = config;\n  onStoppedNotification && timeoutProvider.setTimeout(() => onStoppedNotification(notification, subscriber));\n}\n\n/**\n * The observer used as a stub for subscriptions where the user did not\n * pass any arguments to `subscribe`. Comes with the default error handling\n * behavior.\n */\nexport const EMPTY_OBSERVER: Readonly<Observer<any>> & { closed: true } = {\n  closed: true,\n  next: noop,\n  error: defaultErrorHandler,\n  complete: noop,\n};\n", "/**\n * Symbol.observable or a string \"@@observable\". Used for interop\n *\n * @deprecated We will no longer be exporting this symbol in upcoming versions of RxJS.\n * Instead polyfill and use Symbol.observable directly *or* use https://www.npmjs.com/package/symbol-observable\n */\nexport const observable: string | symbol = (() => (typeof Symbol === 'function' && Symbol.observable) || '@@observable')();\n", "/**\n * This function takes one parameter and just returns it. Simply put,\n * this is like `<T>(x: T): T => x`.\n *\n * ## Examples\n *\n * This is useful in some cases when using things like `mergeMap`\n *\n * ```ts\n * import { interval, take, map, range, mergeMap, identity } from 'rxjs';\n *\n * const source$ = interval(1000).pipe(take(5));\n *\n * const result$ = source$.pipe(\n *   map(i => range(i)),\n *   mergeMap(identity) // same as mergeMap(x => x)\n * );\n *\n * result$.subscribe({\n *   next: console.log\n * });\n * ```\n *\n * Or when you want to selectively apply an operator\n *\n * ```ts\n * import { interval, take, identity } from 'rxjs';\n *\n * const shouldLimit = () => Math.random() < 0.5;\n *\n * const source$ = interval(1000);\n *\n * const result$ = source$.pipe(shouldLimit() ? take(5) : identity);\n *\n * result$.subscribe({\n *   next: console.log\n * });\n * ```\n *\n * @param x Any value that is returned by this function\n * @returns The value passed as the first parameter to this function\n */\nexport function identity<T>(x: T): T {\n  return x;\n}\n", "import { identity } from './identity';\nimport { UnaryFunction } from '../types';\n\nexport function pipe(): typeof identity;\nexport function pipe<T, A>(fn1: UnaryFunction<T, A>): UnaryFunction<T, A>;\nexport function pipe<T, A, B>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>): UnaryFunction<T, B>;\nexport function pipe<T, A, B, C>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>): UnaryFunction<T, C>;\nexport function pipe<T, A, B, C, D>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>\n): UnaryFunction<T, D>;\nexport function pipe<T, A, B, C, D, E>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>\n): UnaryFunction<T, E>;\nexport function pipe<T, A, B, C, D, E, F>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>,\n  fn6: UnaryFunction<E, F>\n): UnaryFunction<T, F>;\nexport function pipe<T, A, B, C, D, E, F, G>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>,\n  fn6: UnaryFunction<E, F>,\n  fn7: UnaryFunction<F, G>\n): UnaryFunction<T, G>;\nexport function pipe<T, A, B, C, D, E, F, G, H>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>,\n  fn6: UnaryFunction<E, F>,\n  fn7: UnaryFunction<F, G>,\n  fn8: UnaryFunction<G, H>\n): UnaryFunction<T, H>;\nexport function pipe<T, A, B, C, D, E, F, G, H, I>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>,\n  fn6: UnaryFunction<E, F>,\n  fn7: UnaryFunction<F, G>,\n  fn8: UnaryFunction<G, H>,\n  fn9: UnaryFunction<H, I>\n): UnaryFunction<T, I>;\nexport function pipe<T, A, B, C, D, E, F, G, H, I>(\n  fn1: UnaryFunction<T, A>,\n  fn2: UnaryFunction<A, B>,\n  fn3: UnaryFunction<B, C>,\n  fn4: UnaryFunction<C, D>,\n  fn5: UnaryFunction<D, E>,\n  fn6: UnaryFunction<E, F>,\n  fn7: UnaryFunction<F, G>,\n  fn8: UnaryFunction<G, H>,\n  fn9: UnaryFunction<H, I>,\n  ...fns: UnaryFunction<any, any>[]\n): UnaryFunction<T, unknown>;\n\n/**\n * pipe() can be called on one or more functions, each of which can take one argument (\"UnaryFunction\")\n * and uses it to return a value.\n * It returns a function that takes one argument, passes it to the first UnaryFunction, and then\n * passes the result to the next one, passes that result to the next one, and so on.  \n */\nexport function pipe(...fns: Array<UnaryFunction<any, any>>): UnaryFunction<any, any> {\n  return pipeFromArray(fns);\n}\n\n/** @internal */\nexport function pipeFromArray<T, R>(fns: Array<UnaryFunction<T, R>>): UnaryFunction<T, R> {\n  if (fns.length === 0) {\n    return identity as UnaryFunction<any, any>;\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return function piped(input: T): R {\n    return fns.reduce((prev: any, fn: UnaryFunction<T, R>) => fn(prev), input as any);\n  };\n}\n", "import { Operator } from './Operator';\nimport { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription, Subscription } from './Subscription';\nimport { TeardownLogic, OperatorFunction, Subscribable, Observer } from './types';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nimport { errorContext } from './util/errorContext';\n\n/**\n * A representation of any set of values over any amount of time. This is the most basic building block\n * of RxJS.\n */\nexport class Observable<T> implements Subscribable<T> {\n  /**\n   * @deprecated Internal implementation detail, do not use directly. Will be made internal in v8.\n   */\n  source: Observable<any> | undefined;\n\n  /**\n   * @deprecated Internal implementation detail, do not use directly. Will be made internal in v8.\n   */\n  operator: Operator<any, T> | undefined;\n\n  /**\n   * @param subscribe The function that is called when the Observable is\n   * initially subscribed to. This function is given a Subscriber, to which new values\n   * can be `next`ed, or an `error` method can be called to raise an error, or\n   * `complete` can be called to notify of a successful completion.\n   */\n  constructor(subscribe?: (this: Observable<T>, subscriber: Subscriber<T>) => TeardownLogic) {\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  // HACK: Since TypeScript inherits static properties too, we have to\n  // fight against TypeScript here so Subject can have a different static create signature\n  /**\n   * Creates a new Observable by calling the Observable constructor\n   * @param subscribe the subscriber function to be passed to the Observable constructor\n   * @return A new observable.\n   * @deprecated Use `new Observable()` instead. Will be removed in v8.\n   */\n  static create: (...args: any[]) => any = <T>(subscribe?: (subscriber: Subscriber<T>) => TeardownLogic) => {\n    return new Observable<T>(subscribe);\n  };\n\n  /**\n   * Creates a new Observable, with this Observable instance as the source, and the passed\n   * operator defined as the new observable's operator.\n   * @param operator the operator defining the operation to take on the observable\n   * @return A new observable with the Operator applied.\n   * @deprecated Internal implementation detail, do not use directly. Will be made internal in v8.\n   * If you have implemented an operator using `lift`, it is recommended that you create an\n   * operator by simply returning `new Observable()` directly. See \"Creating new operators from\n   * scratch\" section here: https://rxjs.dev/guide/operators\n   */\n  lift<R>(operator?: Operator<T, R>): Observable<R> {\n    const observable = new Observable<R>();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  }\n\n  subscribe(observerOrNext?: Partial<Observer<T>> | ((value: T) => void)): Subscription;\n  /** @deprecated Instead of passing separate callback arguments, use an observer argument. Signatures taking separate callback arguments will be removed in v8. Details: https://rxjs.dev/deprecations/subscribe-arguments */\n  subscribe(next?: ((value: T) => void) | null, error?: ((error: any) => void) | null, complete?: (() => void) | null): Subscription;\n  /**\n   * Invokes an execution of an Observable and registers Observer handlers for notifications it will emit.\n   *\n   * <span class=\"informal\">Use it when you have all these Observables, but still nothing is happening.</span>\n   *\n   * `subscribe` is not a regular operator, but a method that calls Observable's internal `subscribe` function. It\n   * might be for example a function that you passed to Observable's constructor, but most of the time it is\n   * a library implementation, which defines what will be emitted by an Observable, and when it be will emitted. This means\n   * that calling `subscribe` is actually the moment when Observable starts its work, not when it is created, as it is often\n   * the thought.\n   *\n   * Apart from starting the execution of an Observable, this method allows you to listen for values\n   * that an Observable emits, as well as for when it completes or errors. You can achieve this in two\n   * of the following ways.\n   *\n   * The first way is creating an object that implements {@link Observer} interface. It should have methods\n   * defined by that interface, but note that it should be just a regular JavaScript object, which you can create\n   * yourself in any way you want (ES6 class, classic function constructor, object literal etc.). In particular, do\n   * not attempt to use any RxJS implementation details to create Observers - you don't need them. Remember also\n   * that your object does not have to implement all methods. If you find yourself creating a method that doesn't\n   * do anything, you can simply omit it. Note however, if the `error` method is not provided and an error happens,\n   * it will be thrown asynchronously. Errors thrown asynchronously cannot be caught using `try`/`catch`. Instead,\n   * use the {@link onUnhandledError} configuration option or use a runtime handler (like `window.onerror` or\n   * `process.on('error)`) to be notified of unhandled errors. Because of this, it's recommended that you provide\n   * an `error` method to avoid missing thrown errors.\n   *\n   * The second way is to give up on Observer object altogether and simply provide callback functions in place of its methods.\n   * This means you can provide three functions as arguments to `subscribe`, where the first function is equivalent\n   * of a `next` method, the second of an `error` method and the third of a `complete` method. Just as in case of an Observer,\n   * if you do not need to listen for something, you can omit a function by passing `undefined` or `null`,\n   * since `subscribe` recognizes these functions by where they were placed in function call. When it comes\n   * to the `error` function, as with an Observer, if not provided, errors emitted by an Observable will be thrown asynchronously.\n   *\n   * You can, however, subscribe with no parameters at all. This may be the case where you're not interested in terminal events\n   * and you also handled emissions internally by using operators (e.g. using `tap`).\n   *\n   * Whichever style of calling `subscribe` you use, in both cases it returns a Subscription object.\n   * This object allows you to call `unsubscribe` on it, which in turn will stop the work that an Observable does and will clean\n   * up all resources that an Observable used. Note that cancelling a subscription will not call `complete` callback\n   * provided to `subscribe` function, which is reserved for a regular completion signal that comes from an Observable.\n   *\n   * Remember that callbacks provided to `subscribe` are not guaranteed to be called asynchronously.\n   * It is an Observable itself that decides when these functions will be called. For example {@link of}\n   * by default emits all its values synchronously. Always check documentation for how given Observable\n   * will behave when subscribed and if its default behavior can be modified with a `scheduler`.\n   *\n   * #### Examples\n   *\n   * Subscribe with an {@link guide/observer Observer}\n   *\n   * ```ts\n   * import { of } from 'rxjs';\n   *\n   * const sumObserver = {\n   *   sum: 0,\n   *   next(value) {\n   *     console.log('Adding: ' + value);\n   *     this.sum = this.sum + value;\n   *   },\n   *   error() {\n   *     // We actually could just remove this method,\n   *     // since we do not really care about errors right now.\n   *   },\n   *   complete() {\n   *     console.log('Sum equals: ' + this.sum);\n   *   }\n   * };\n   *\n   * of(1, 2, 3) // Synchronously emits 1, 2, 3 and then completes.\n   *   .subscribe(sumObserver);\n   *\n   * // Logs:\n   * // 'Adding: 1'\n   * // 'Adding: 2'\n   * // 'Adding: 3'\n   * // 'Sum equals: 6'\n   * ```\n   *\n   * Subscribe with functions ({@link deprecations/subscribe-arguments deprecated})\n   *\n   * ```ts\n   * import { of } from 'rxjs'\n   *\n   * let sum = 0;\n   *\n   * of(1, 2, 3).subscribe(\n   *   value => {\n   *     console.log('Adding: ' + value);\n   *     sum = sum + value;\n   *   },\n   *   undefined,\n   *   () => console.log('Sum equals: ' + sum)\n   * );\n   *\n   * // Logs:\n   * // 'Adding: 1'\n   * // 'Adding: 2'\n   * // 'Adding: 3'\n   * // 'Sum equals: 6'\n   * ```\n   *\n   * Cancel a subscription\n   *\n   * ```ts\n   * import { interval } from 'rxjs';\n   *\n   * const subscription = interval(1000).subscribe({\n   *   next(num) {\n   *     console.log(num)\n   *   },\n   *   complete() {\n   *     // Will not be called, even when cancelling subscription.\n   *     console.log('completed!');\n   *   }\n   * });\n   *\n   * setTimeout(() => {\n   *   subscription.unsubscribe();\n   *   console.log('unsubscribed!');\n   * }, 2500);\n   *\n   * // Logs:\n   * // 0 after 1s\n   * // 1 after 2s\n   * // 'unsubscribed!' after 2.5s\n   * ```\n   *\n   * @param observerOrNext Either an {@link Observer} with some or all callback methods,\n   * or the `next` handler that is called for each value emitted from the subscribed Observable.\n   * @param error A handler for a terminal event resulting from an error. If no error handler is provided,\n   * the error will be thrown asynchronously as unhandled.\n   * @param complete A handler for a terminal event resulting from successful completion.\n   * @return A subscription reference to the registered handlers.\n   */\n  subscribe(\n    observerOrNext?: Partial<Observer<T>> | ((value: T) => void) | null,\n    error?: ((error: any) => void) | null,\n    complete?: (() => void) | null\n  ): Subscription {\n    const subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n\n    errorContext(() => {\n      const { operator, source } = this;\n      subscriber.add(\n        operator\n          ? // We're dealing with a subscription in the\n            // operator chain to one of our lifted operators.\n            operator.call(subscriber, source)\n          : source\n          ? // If `source` has a value, but `operator` does not, something that\n            // had intimate knowledge of our API, like our `Subject`, must have\n            // set it. We're going to just call `_subscribe` directly.\n            this._subscribe(subscriber)\n          : // In all other cases, we're likely wrapping a user-provided initializer\n            // function, so we need to catch errors and handle them appropriately.\n            this._trySubscribe(subscriber)\n      );\n    });\n\n    return subscriber;\n  }\n\n  /** @internal */\n  protected _trySubscribe(sink: Subscriber<T>): TeardownLogic {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      // We don't need to return anything in this case,\n      // because it's just going to try to `add()` to a subscription\n      // above.\n      sink.error(err);\n    }\n  }\n\n  /**\n   * Used as a NON-CANCELLABLE means of subscribing to an observable, for use with\n   * APIs that expect promises, like `async/await`. You cannot unsubscribe from this.\n   *\n   * **WARNING**: Only use this with observables you *know* will complete. If the source\n   * observable does not complete, you will end up with a promise that is hung up, and\n   * potentially all of the state of an async function hanging out in memory. To avoid\n   * this situation, look into adding something like {@link timeout}, {@link take},\n   * {@link takeWhile}, or {@link takeUntil} amongst others.\n   *\n   * #### Example\n   *\n   * ```ts\n   * import { interval, take } from 'rxjs';\n   *\n   * const source$ = interval(1000).pipe(take(4));\n   *\n   * async function getTotal() {\n   *   let total = 0;\n   *\n   *   await source$.forEach(value => {\n   *     total += value;\n   *     console.log('observable -> ' + value);\n   *   });\n   *\n   *   return total;\n   * }\n   *\n   * getTotal().then(\n   *   total => console.log('Total: ' + total)\n   * );\n   *\n   * // Expected:\n   * // 'observable -> 0'\n   * // 'observable -> 1'\n   * // 'observable -> 2'\n   * // 'observable -> 3'\n   * // 'Total: 6'\n   * ```\n   *\n   * @param next A handler for each value emitted by the observable.\n   * @return A promise that either resolves on observable completion or\n   * rejects with the handled error.\n   */\n  forEach(next: (value: T) => void): Promise<void>;\n\n  /**\n   * @param next a handler for each value emitted by the observable\n   * @param promiseCtor a constructor function used to instantiate the Promise\n   * @return a promise that either resolves on observable completion or\n   *  rejects with the handled error\n   * @deprecated Passing a Promise constructor will no longer be available\n   * in upcoming versions of RxJS. This is because it adds weight to the library, for very\n   * little benefit. If you need this functionality, it is recommended that you either\n   * polyfill Promise, or you create an adapter to convert the returned native promise\n   * to whatever promise implementation you wanted. Will be removed in v8.\n   */\n  forEach(next: (value: T) => void, promiseCtor: PromiseConstructorLike): Promise<void>;\n\n  forEach(next: (value: T) => void, promiseCtor?: PromiseConstructorLike): Promise<void> {\n    promiseCtor = getPromiseCtor(promiseCtor);\n\n    return new promiseCtor<void>((resolve, reject) => {\n      const subscriber = new SafeSubscriber<T>({\n        next: (value) => {\n          try {\n            next(value);\n          } catch (err) {\n            reject(err);\n            subscriber.unsubscribe();\n          }\n        },\n        error: reject,\n        complete: resolve,\n      });\n      this.subscribe(subscriber);\n    }) as Promise<void>;\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<any>): TeardownLogic {\n    return this.source?.subscribe(subscriber);\n  }\n\n  /**\n   * An interop point defined by the es7-observable spec https://github.com/zenparsing/es-observable\n   * @return This instance of the observable.\n   */\n  [Symbol_observable]() {\n    return this;\n  }\n\n  /* tslint:disable:max-line-length */\n  pipe(): Observable<T>;\n  pipe<A>(op1: OperatorFunction<T, A>): Observable<A>;\n  pipe<A, B>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>): Observable<B>;\n  pipe<A, B, C>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>): Observable<C>;\n  pipe<A, B, C, D>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>\n  ): Observable<D>;\n  pipe<A, B, C, D, E>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>\n  ): Observable<E>;\n  pipe<A, B, C, D, E, F>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>,\n    op6: OperatorFunction<E, F>\n  ): Observable<F>;\n  pipe<A, B, C, D, E, F, G>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>,\n    op6: OperatorFunction<E, F>,\n    op7: OperatorFunction<F, G>\n  ): Observable<G>;\n  pipe<A, B, C, D, E, F, G, H>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>,\n    op6: OperatorFunction<E, F>,\n    op7: OperatorFunction<F, G>,\n    op8: OperatorFunction<G, H>\n  ): Observable<H>;\n  pipe<A, B, C, D, E, F, G, H, I>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>,\n    op6: OperatorFunction<E, F>,\n    op7: OperatorFunction<F, G>,\n    op8: OperatorFunction<G, H>,\n    op9: OperatorFunction<H, I>\n  ): Observable<I>;\n  pipe<A, B, C, D, E, F, G, H, I>(\n    op1: OperatorFunction<T, A>,\n    op2: OperatorFunction<A, B>,\n    op3: OperatorFunction<B, C>,\n    op4: OperatorFunction<C, D>,\n    op5: OperatorFunction<D, E>,\n    op6: OperatorFunction<E, F>,\n    op7: OperatorFunction<F, G>,\n    op8: OperatorFunction<G, H>,\n    op9: OperatorFunction<H, I>,\n    ...operations: OperatorFunction<any, any>[]\n  ): Observable<unknown>;\n  /* tslint:enable:max-line-length */\n\n  /**\n   * Used to stitch together functional operators into a chain.\n   *\n   * ## Example\n   *\n   * ```ts\n   * import { interval, filter, map, scan } from 'rxjs';\n   *\n   * interval(1000)\n   *   .pipe(\n   *     filter(x => x % 2 === 0),\n   *     map(x => x + x),\n   *     scan((acc, x) => acc + x)\n   *   )\n   *   .subscribe(x => console.log(x));\n   * ```\n   *\n   * @return The Observable result of all the operators having been called\n   * in the order they were passed in.\n   */\n  pipe(...operations: OperatorFunction<any, any>[]): Observable<any> {\n    return pipeFromArray(operations)(this);\n  }\n\n  /* tslint:disable:max-line-length */\n  /** @deprecated Replaced with {@link firstValueFrom} and {@link lastValueFrom}. Will be removed in v8. Details: https://rxjs.dev/deprecations/to-promise */\n  toPromise(): Promise<T | undefined>;\n  /** @deprecated Replaced with {@link firstValueFrom} and {@link lastValueFrom}. Will be removed in v8. Details: https://rxjs.dev/deprecations/to-promise */\n  toPromise(PromiseCtor: typeof Promise): Promise<T | undefined>;\n  /** @deprecated Replaced with {@link firstValueFrom} and {@link lastValueFrom}. Will be removed in v8. Details: https://rxjs.dev/deprecations/to-promise */\n  toPromise(PromiseCtor: PromiseConstructorLike): Promise<T | undefined>;\n  /* tslint:enable:max-line-length */\n\n  /**\n   * Subscribe to this Observable and get a Promise resolving on\n   * `complete` with the last emission (if any).\n   *\n   * **WARNING**: Only use this with observables you *know* will complete. If the source\n   * observable does not complete, you will end up with a promise that is hung up, and\n   * potentially all of the state of an async function hanging out in memory. To avoid\n   * this situation, look into adding something like {@link timeout}, {@link take},\n   * {@link takeWhile}, or {@link takeUntil} amongst others.\n   *\n   * @param [promiseCtor] a constructor function used to instantiate\n   * the Promise\n   * @return A Promise that resolves with the last value emit, or\n   * rejects on an error. If there were no emissions, Promise\n   * resolves with undefined.\n   * @deprecated Replaced with {@link firstValueFrom} and {@link lastValueFrom}. Will be removed in v8. Details: https://rxjs.dev/deprecations/to-promise\n   */\n  toPromise(promiseCtor?: PromiseConstructorLike): Promise<T | undefined> {\n    promiseCtor = getPromiseCtor(promiseCtor);\n\n    return new promiseCtor((resolve, reject) => {\n      let value: T | undefined;\n      this.subscribe(\n        (x: T) => (value = x),\n        (err: any) => reject(err),\n        () => resolve(value)\n      );\n    }) as Promise<T | undefined>;\n  }\n}\n\n/**\n * Decides between a passed promise constructor from consuming code,\n * A default configured promise constructor, and the native promise\n * constructor and returns it. If nothing can be found, it will throw\n * an error.\n * @param promiseCtor The optional promise constructor to passed by consuming code\n */\nfunction getPromiseCtor(promiseCtor: PromiseConstructorLike | undefined) {\n  return promiseCtor ?? config.Promise ?? Promise;\n}\n\nfunction isObserver<T>(value: any): value is Observer<T> {\n  return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\n\nfunction isSubscriber<T>(value: any): value is Subscriber<T> {\n  return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n", "import { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction } from '../types';\nimport { isFunction } from './isFunction';\n\n/**\n * Used to determine if an object is an Observable with a lift function.\n */\nexport function hasLift(source: any): source is { lift: InstanceType<typeof Observable>['lift'] } {\n  return isFunction(source?.lift);\n}\n\n/**\n * Creates an `OperatorFunction`. Used to define operators throughout the library in a concise way.\n * @param init The logic to connect the liftedSource to the subscriber at the moment of subscription.\n */\nexport function operate<T, R>(\n  init: (liftedSource: Observable<T>, subscriber: Subscriber<R>) => (() => void) | void\n): OperatorFunction<T, R> {\n  return (source: Observable<T>) => {\n    if (hasLift(source)) {\n      return source.lift(function (this: Subscriber<R>, liftedSource: Observable<T>) {\n        try {\n          return init(liftedSource, this);\n        } catch (err) {\n          this.error(err);\n        }\n      });\n    }\n    throw new TypeError('Unable to lift unknown Observable type');\n  };\n}\n", "import { Subscriber } from '../Subscriber';\n\n/**\n * Creates an instance of an `OperatorSubscriber`.\n * @param destination The downstream subscriber.\n * @param onNext Handles next values, only called if this subscriber is not stopped or closed. Any\n * error that occurs in this function is caught and sent to the `error` method of this subscriber.\n * @param onError Handles errors from the subscription, any errors that occur in this handler are caught\n * and send to the `destination` error handler.\n * @param onComplete Handles completion notification from the subscription. Any errors that occur in\n * this handler are sent to the `destination` error handler.\n * @param onFinalize Additional teardown logic here. This will only be called on teardown if the\n * subscriber itself is not already closed. This is called after all other teardown logic is executed.\n */\nexport function createOperatorSubscriber<T>(\n  destination: Subscriber<any>,\n  onNext?: (value: T) => void,\n  onComplete?: () => void,\n  onError?: (err: any) => void,\n  onFinalize?: () => void\n): Subscriber<T> {\n  return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\n\n/**\n * A generic helper for allowing operators to be created with a Subscriber and\n * use closures to capture necessary state from the operator function itself.\n */\nexport class OperatorSubscriber<T> extends Subscriber<T> {\n  /**\n   * Creates an instance of an `OperatorSubscriber`.\n   * @param destination The downstream subscriber.\n   * @param onNext Handles next values, only called if this subscriber is not stopped or closed. Any\n   * error that occurs in this function is caught and sent to the `error` method of this subscriber.\n   * @param onError Handles errors from the subscription, any errors that occur in this handler are caught\n   * and send to the `destination` error handler.\n   * @param onComplete Handles completion notification from the subscription. Any errors that occur in\n   * this handler are sent to the `destination` error handler.\n   * @param onFinalize Additional finalization logic here. This will only be called on finalization if the\n   * subscriber itself is not already closed. This is called after all other finalization logic is executed.\n   * @param shouldUnsubscribe An optional check to see if an unsubscribe call should truly unsubscribe.\n   * NOTE: This currently **ONLY** exists to support the strange behavior of {@link groupBy}, where unsubscription\n   * to the resulting observable does not actually disconnect from the source if there are active subscriptions\n   * to any grouped observable. (DO NOT EXPOSE OR USE EXTERNALLY!!!)\n   */\n  constructor(\n    destination: Subscriber<any>,\n    onNext?: (value: T) => void,\n    onComplete?: () => void,\n    onError?: (err: any) => void,\n    private onFinalize?: () => void,\n    private shouldUnsubscribe?: () => boolean\n  ) {\n    // It's important - for performance reasons - that all of this class's\n    // members are initialized and that they are always initialized in the same\n    // order. This will ensure that all OperatorSubscriber instances have the\n    // same hidden class in V8. This, in turn, will help keep the number of\n    // hidden classes involved in property accesses within the base class as\n    // low as possible. If the number of hidden classes involved exceeds four,\n    // the property accesses will become megamorphic and performance penalties\n    // will be incurred - i.e. inline caches won't be used.\n    //\n    // The reasons for ensuring all instances have the same hidden class are\n    // further discussed in this blog post from Benedikt Meurer:\n    // https://benediktmeurer.de/2018/03/23/impact-of-polymorphism-on-component-based-frameworks-like-react/\n    super(destination);\n    this._next = onNext\n      ? function (this: OperatorSubscriber<T>, value: T) {\n          try {\n            onNext(value);\n          } catch (err) {\n            destination.error(err);\n          }\n        }\n      : super._next;\n    this._error = onError\n      ? function (this: OperatorSubscriber<T>, err: any) {\n          try {\n            onError(err);\n          } catch (err) {\n            // Send any errors that occur down stream.\n            destination.error(err);\n          } finally {\n            // Ensure finalization.\n            this.unsubscribe();\n          }\n        }\n      : super._error;\n    this._complete = onComplete\n      ? function (this: OperatorSubscriber<T>) {\n          try {\n            onComplete();\n          } catch (err) {\n            // Send any errors that occur down stream.\n            destination.error(err);\n          } finally {\n            // Ensure finalization.\n            this.unsubscribe();\n          }\n        }\n      : super._complete;\n  }\n\n  unsubscribe() {\n    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n      const { closed } = this;\n      super.unsubscribe();\n      // Execute additional teardown if we have any and we didn't already do so.\n      !closed && this.onFinalize?.();\n    }\n  }\n}\n", "import { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction } from '../types';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/**\n * Make a {@link ConnectableObservable} behave like a ordinary observable and automates the way\n * you can connect to it.\n *\n * Internally it counts the subscriptions to the observable and subscribes (only once) to the source if\n * the number of subscriptions is larger than 0. If the number of subscriptions is smaller than 1, it\n * unsubscribes from the source. This way you can make sure that everything before the *published*\n * refCount has only a single subscription independently of the number of subscribers to the target\n * observable.\n *\n * Note that using the {@link share} operator is exactly the same as using the `multicast(() => new Subject())` operator\n * (making the observable hot) and the *refCount* operator in a sequence.\n *\n * ![](refCount.png)\n *\n * ## Example\n *\n * In the following example there are two intervals turned into connectable observables\n * by using the *publish* operator. The first one uses the *refCount* operator, the\n * second one does not use it. You will notice that a connectable observable does nothing\n * until you call its connect function.\n *\n * ```ts\n * import { interval, tap, publish, refCount } from 'rxjs';\n *\n * // Turn the interval observable into a ConnectableObservable (hot)\n * const refCountInterval = interval(400).pipe(\n *   tap(num => console.log(`refCount ${ num }`)),\n *   publish(),\n *   refCount()\n * );\n *\n * const publishedInterval = interval(400).pipe(\n *   tap(num => console.log(`publish ${ num }`)),\n *   publish()\n * );\n *\n * refCountInterval.subscribe();\n * refCountInterval.subscribe();\n * // 'refCount 0' -----> 'refCount 1' -----> etc\n * // All subscriptions will receive the same value and the tap (and\n * // every other operator) before the `publish` operator will be executed\n * // only once per event independently of the number of subscriptions.\n *\n * publishedInterval.subscribe();\n * // Nothing happens until you call .connect() on the observable.\n * ```\n *\n * @return A function that returns an Observable that automates the connection\n * to ConnectableObservable.\n * @see {@link ConnectableObservable}\n * @see {@link share}\n * @see {@link publish}\n * @deprecated Replaced with the {@link share} operator. How `share` is used\n * will depend on the connectable observable you created just prior to the\n * `refCount` operator.\n * Details: https://rxjs.dev/deprecations/multicasting\n */\nexport function refCount<T>(): MonoTypeOperatorFunction<T> {\n  return operate((source, subscriber) => {\n    let connection: Subscription | null = null;\n\n    (source as any)._refCount++;\n\n    const refCounter = createOperatorSubscriber(subscriber, undefined, undefined, undefined, () => {\n      if (!source || (source as any)._refCount <= 0 || 0 < --(source as any)._refCount) {\n        connection = null;\n        return;\n      }\n\n      ///\n      // Compare the local RefCountSubscriber's connection Subscription to the\n      // connection Subscription on the shared ConnectableObservable. In cases\n      // where the ConnectableObservable source synchronously emits values, and\n      // the RefCountSubscriber's downstream Observers synchronously unsubscribe,\n      // execution continues to here before the RefCountOperator has a chance to\n      // supply the RefCountSubscriber with the shared connection Subscription.\n      // For example:\n      // ```\n      // range(0, 10).pipe(\n      //   publish(),\n      //   refCount(),\n      //   take(5),\n      // )\n      // .subscribe();\n      // ```\n      // In order to account for this case, RefCountSubscriber should only dispose\n      // the ConnectableObservable's shared connection Subscription if the\n      // connection Subscription exists, *and* either:\n      //   a. RefCountSubscriber doesn't have a reference to the shared connection\n      //      Subscription yet, or,\n      //   b. RefCountSubscriber's connection Subscription reference is identical\n      //      to the shared connection Subscription\n      ///\n\n      const sharedConnection = (source as any)._connection;\n      const conn = connection;\n      connection = null;\n\n      if (sharedConnection && (!conn || sharedConnection === conn)) {\n        sharedConnection.unsubscribe();\n      }\n\n      subscriber.unsubscribe();\n    });\n\n    source.subscribe(refCounter);\n\n    if (!refCounter.closed) {\n      connection = (source as ConnectableObservable<T>).connect();\n    }\n  });\n}\n", "import { Subject } from '../Subject';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { hasLift } from '../util/lift';\n\n/**\n * @class ConnectableObservable<T>\n * @deprecated Will be removed in v8. Use {@link connectable} to create a connectable observable.\n * If you are using the `refCount` method of `ConnectableObservable`, use the {@link share} operator\n * instead.\n * Details: https://rxjs.dev/deprecations/multicasting\n */\nexport class ConnectableObservable<T> extends Observable<T> {\n  protected _subject: Subject<T> | null = null;\n  protected _refCount: number = 0;\n  protected _connection: Subscription | null = null;\n\n  /**\n   * @param source The source observable\n   * @param subjectFactory The factory that creates the subject used internally.\n   * @deprecated Will be removed in v8. Use {@link connectable} to create a connectable observable.\n   * `new ConnectableObservable(source, factory)` is equivalent to\n   * `connectable(source, { connector: factory })`.\n   * When the `refCount()` method is needed, the {@link share} operator should be used instead:\n   * `new ConnectableObservable(source, factory).refCount()` is equivalent to\n   * `source.pipe(share({ connector: factory }))`.\n   * Details: https://rxjs.dev/deprecations/multicasting\n   */\n  constructor(public source: Observable<T>, protected subjectFactory: () => Subject<T>) {\n    super();\n    // If we have lift, monkey patch that here. This is done so custom observable\n    // types will compose through multicast. Otherwise the resulting observable would\n    // simply be an instance of `ConnectableObservable`.\n    if (hasLift(source)) {\n      this.lift = source.lift;\n    }\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<T>) {\n    return this.getSubject().subscribe(subscriber);\n  }\n\n  protected getSubject(): Subject<T> {\n    const subject = this._subject;\n    if (!subject || subject.isStopped) {\n      this._subject = this.subjectFactory();\n    }\n    return this._subject!;\n  }\n\n  protected _teardown() {\n    this._refCount = 0;\n    const { _connection } = this;\n    this._subject = this._connection = null;\n    _connection?.unsubscribe();\n  }\n\n  /**\n   * @deprecated {@link ConnectableObservable} will be removed in v8. Use {@link connectable} instead.\n   * Details: https://rxjs.dev/deprecations/multicasting\n   */\n  connect(): Subscription {\n    let connection = this._connection;\n    if (!connection) {\n      connection = this._connection = new Subscription();\n      const subject = this.getSubject();\n      connection.add(\n        this.source.subscribe(\n          createOperatorSubscriber(\n            subject as any,\n            undefined,\n            () => {\n              this._teardown();\n              subject.complete();\n            },\n            (err) => {\n              this._teardown();\n              subject.error(err);\n            },\n            () => this._teardown()\n          )\n        )\n      );\n\n      if (connection.closed) {\n        this._connection = null;\n        connection = Subscription.EMPTY;\n      }\n    }\n    return connection;\n  }\n\n  /**\n   * @deprecated {@link ConnectableObservable} will be removed in v8. Use the {@link share} operator instead.\n   * Details: https://rxjs.dev/deprecations/multicasting\n   */\n  refCount(): Observable<T> {\n    return higherOrderRefCount()(this) as Observable<T>;\n  }\n}\n", "import { TimestampProvider } from '../types';\n\ninterface PerformanceTimestampProvider extends TimestampProvider {\n  delegate: TimestampProvider | undefined;\n}\n\nexport const performanceTimestampProvider: PerformanceTimestampProvider = {\n  now() {\n    // Use the variable rather than `this` so that the function can be called\n    // without being bound to the provider.\n    return (performanceTimestampProvider.delegate || performance).now();\n  },\n  delegate: undefined,\n};\n", "import { Subscription } from '../Subscription';\n\ninterface AnimationFrameProvider {\n  schedule(callback: FrameRequestCallback): Subscription;\n  requestAnimationFrame: typeof requestAnimationFrame;\n  cancelAnimationFrame: typeof cancelAnimationFrame;\n  delegate:\n    | {\n        requestAnimationFrame: typeof requestAnimationFrame;\n        cancelAnimationFrame: typeof cancelAnimationFrame;\n      }\n    | undefined;\n}\n\nexport const animationFrameProvider: AnimationFrameProvider = {\n  // When accessing the delegate, use the variable rather than `this` so that\n  // the functions can be called without being bound to the provider.\n  schedule(callback) {\n    let request = requestAnimationFrame;\n    let cancel: typeof cancelAnimationFrame | undefined = cancelAnimationFrame;\n    const { delegate } = animationFrameProvider;\n    if (delegate) {\n      request = delegate.requestAnimationFrame;\n      cancel = delegate.cancelAnimationFrame;\n    }\n    const handle = request((timestamp) => {\n      // Clear the cancel function. The request has been fulfilled, so\n      // attempting to cancel the request upon unsubscription would be\n      // pointless.\n      cancel = undefined;\n      callback(timestamp);\n    });\n    return new Subscription(() => cancel?.(handle));\n  },\n  requestAnimationFrame(...args) {\n    const { delegate } = animationFrameProvider;\n    return (delegate?.requestAnimationFrame || requestAnimationFrame)(...args);\n  },\n  cancelAnimationFrame(...args) {\n    const { delegate } = animationFrameProvider;\n    return (delegate?.cancelAnimationFrame || cancelAnimationFrame)(...args);\n  },\n  delegate: undefined,\n};\n", "import { Observable } from '../../Observable';\nimport { TimestampProvider } from '../../types';\nimport { performanceTimestampProvider } from '../../scheduler/performanceTimestampProvider';\nimport { animationFrameProvider } from '../../scheduler/animationFrameProvider';\n\n/**\n * An observable of animation frames\n *\n * Emits the amount of time elapsed since subscription and the timestamp on each animation frame.\n * Defaults to milliseconds provided to the requestAnimationFrame's callback. Does not end on its own.\n *\n * Every subscription will start a separate animation loop. Since animation frames are always scheduled\n * by the browser to occur directly before a repaint, scheduling more than one animation frame synchronously\n * should not be much different or have more overhead than looping over an array of events during\n * a single animation frame. However, if for some reason the developer would like to ensure the\n * execution of animation-related handlers are all executed during the same task by the engine,\n * the `share` operator can be used.\n *\n * This is useful for setting up animations with RxJS.\n *\n * ## Examples\n *\n * Tweening a div to move it on the screen\n *\n * ```ts\n * import { animationFrames, map, takeWhile, endWith } from 'rxjs';\n *\n * function tween(start: number, end: number, duration: number) {\n *   const diff = end - start;\n *   return animationFrames().pipe(\n *     // Figure out what percentage of time has passed\n *     map(({ elapsed }) => elapsed / duration),\n *     // Take the vector while less than 100%\n *     takeWhile(v => v < 1),\n *     // Finish with 100%\n *     endWith(1),\n *     // Calculate the distance traveled between start and end\n *     map(v => v * diff + start)\n *   );\n * }\n *\n * // Setup a div for us to move around\n * const div = document.createElement('div');\n * document.body.appendChild(div);\n * div.style.position = 'absolute';\n * div.style.width = '40px';\n * div.style.height = '40px';\n * div.style.backgroundColor = 'lime';\n * div.style.transform = 'translate3d(10px, 0, 0)';\n *\n * tween(10, 200, 4000).subscribe(x => {\n *   div.style.transform = `translate3d(${ x }px, 0, 0)`;\n * });\n * ```\n *\n * Providing a custom timestamp provider\n *\n * ```ts\n * import { animationFrames, TimestampProvider } from 'rxjs';\n *\n * // A custom timestamp provider\n * let now = 0;\n * const customTSProvider: TimestampProvider = {\n *   now() { return now++; }\n * };\n *\n * const source$ = animationFrames(customTSProvider);\n *\n * // Log increasing numbers 0...1...2... on every animation frame.\n * source$.subscribe(({ elapsed }) => console.log(elapsed));\n * ```\n *\n * @param timestampProvider An object with a `now` method that provides a numeric timestamp\n */\nexport function animationFrames(timestampProvider?: TimestampProvider) {\n  return timestampProvider ? animationFramesFactory(timestampProvider) : DEFAULT_ANIMATION_FRAMES;\n}\n\n/**\n * Does the work of creating the observable for `animationFrames`.\n * @param timestampProvider The timestamp provider to use to create the observable\n */\nfunction animationFramesFactory(timestampProvider?: TimestampProvider) {\n  return new Observable<{ timestamp: number; elapsed: number }>((subscriber) => {\n    // If no timestamp provider is specified, use performance.now() - as it\n    // will return timestamps 'compatible' with those passed to the run\n    // callback and won't be affected by NTP adjustments, etc.\n    const provider = timestampProvider || performanceTimestampProvider;\n\n    // Capture the start time upon subscription, as the run callback can remain\n    // queued for a considerable period of time and the elapsed time should\n    // represent the time elapsed since subscription - not the time since the\n    // first rendered animation frame.\n    const start = provider.now();\n\n    let id = 0;\n    const run = () => {\n      if (!subscriber.closed) {\n        id = animationFrameProvider.requestAnimationFrame((timestamp: DOMHighResTimeStamp | number) => {\n          id = 0;\n          // Use the provider's timestamp to calculate the elapsed time. Note that\n          // this means - if the caller hasn't passed a provider - that\n          // performance.now() will be used instead of the timestamp that was\n          // passed to the run callback. The reason for this is that the timestamp\n          // passed to the callback can be earlier than the start time, as it\n          // represents the time at which the browser decided it would render any\n          // queued frames - and that time can be earlier the captured start time.\n          const now = provider.now();\n          subscriber.next({\n            timestamp: timestampProvider ? now : timestamp,\n            elapsed: now - start,\n          });\n          run();\n        });\n      }\n    };\n\n    run();\n\n    return () => {\n      if (id) {\n        animationFrameProvider.cancelAnimationFrame(id);\n      }\n    };\n  });\n}\n\n/**\n * In the common case, where the timestamp provided by the rAF API is used,\n * we use this shared observable to reduce overhead.\n */\nconst DEFAULT_ANIMATION_FRAMES = animationFramesFactory();\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface ObjectUnsubscribedError extends Error {}\n\nexport interface ObjectUnsubscribedErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (): ObjectUnsubscribedError;\n}\n\n/**\n * An error thrown when an action is invalid because the object has been\n * unsubscribed.\n *\n * @see {@link Subject}\n * @see {@link BehaviorSubject}\n *\n * @class ObjectUnsubscribedError\n */\nexport const ObjectUnsubscribedError: ObjectUnsubscribedErrorCtor = createErrorClass(\n  (_super) =>\n    function ObjectUnsubscribedErrorImpl(this: any) {\n      _super(this);\n      this.name = 'ObjectUnsubscribedError';\n      this.message = 'object unsubscribed';\n    }\n);\n", "import { Operator } from './Operator';\nimport { Observable } from './Observable';\nimport { Subscriber } from './Subscriber';\nimport { Subscription, EMPTY_SUBSCRIPTION } from './Subscription';\nimport { Observer, SubscriptionLike, TeardownLogic } from './types';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { arrRemove } from './util/arrRemove';\nimport { errorContext } from './util/errorContext';\n\n/**\n * A Subject is a special type of Observable that allows values to be\n * multicasted to many Observers. Subjects are like EventEmitters.\n *\n * Every Subject is an Observable and an Observer. You can subscribe to a\n * Subject, and you can call next to feed values as well as error and complete.\n */\nexport class Subject<T> extends Observable<T> implements SubscriptionLike {\n  closed = false;\n\n  private currentObservers: Observer<T>[] | null = null;\n\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  observers: Observer<T>[] = [];\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  isStopped = false;\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  hasError = false;\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  thrownError: any = null;\n\n  /**\n   * Creates a \"subject\" by basically gluing an observer to an observable.\n   *\n   * @deprecated Recommended you do not use. Will be removed at some point in the future. Plans for replacement still under discussion.\n   */\n  static create: (...args: any[]) => any = <T>(destination: Observer<T>, source: Observable<T>): AnonymousSubject<T> => {\n    return new AnonymousSubject<T>(destination, source);\n  };\n\n  constructor() {\n    // NOTE: This must be here to obscure Observable's constructor.\n    super();\n  }\n\n  /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n  lift<R>(operator: Operator<T, R>): Observable<R> {\n    const subject = new AnonymousSubject(this, this);\n    subject.operator = operator as any;\n    return subject as any;\n  }\n\n  /** @internal */\n  protected _throwIfClosed() {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n  }\n\n  next(value: T) {\n    errorContext(() => {\n      this._throwIfClosed();\n      if (!this.isStopped) {\n        if (!this.currentObservers) {\n          this.currentObservers = Array.from(this.observers);\n        }\n        for (const observer of this.currentObservers) {\n          observer.next(value);\n        }\n      }\n    });\n  }\n\n  error(err: any) {\n    errorContext(() => {\n      this._throwIfClosed();\n      if (!this.isStopped) {\n        this.hasError = this.isStopped = true;\n        this.thrownError = err;\n        const { observers } = this;\n        while (observers.length) {\n          observers.shift()!.error(err);\n        }\n      }\n    });\n  }\n\n  complete() {\n    errorContext(() => {\n      this._throwIfClosed();\n      if (!this.isStopped) {\n        this.isStopped = true;\n        const { observers } = this;\n        while (observers.length) {\n          observers.shift()!.complete();\n        }\n      }\n    });\n  }\n\n  unsubscribe() {\n    this.isStopped = this.closed = true;\n    this.observers = this.currentObservers = null!;\n  }\n\n  get observed() {\n    return this.observers?.length > 0;\n  }\n\n  /** @internal */\n  protected _trySubscribe(subscriber: Subscriber<T>): TeardownLogic {\n    this._throwIfClosed();\n    return super._trySubscribe(subscriber);\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<T>): Subscription {\n    this._throwIfClosed();\n    this._checkFinalizedStatuses(subscriber);\n    return this._innerSubscribe(subscriber);\n  }\n\n  /** @internal */\n  protected _innerSubscribe(subscriber: Subscriber<any>) {\n    const { hasError, isStopped, observers } = this;\n    if (hasError || isStopped) {\n      return EMPTY_SUBSCRIPTION;\n    }\n    this.currentObservers = null;\n    observers.push(subscriber);\n    return new Subscription(() => {\n      this.currentObservers = null;\n      arrRemove(observers, subscriber);\n    });\n  }\n\n  /** @internal */\n  protected _checkFinalizedStatuses(subscriber: Subscriber<any>) {\n    const { hasError, thrownError, isStopped } = this;\n    if (hasError) {\n      subscriber.error(thrownError);\n    } else if (isStopped) {\n      subscriber.complete();\n    }\n  }\n\n  /**\n   * Creates a new Observable with this Subject as the source. You can do this\n   * to create custom Observer-side logic of the Subject and conceal it from\n   * code that uses the Observable.\n   * @return Observable that this Subject casts to.\n   */\n  asObservable(): Observable<T> {\n    const observable: any = new Observable<T>();\n    observable.source = this;\n    return observable;\n  }\n}\n\nexport class AnonymousSubject<T> extends Subject<T> {\n  constructor(\n    /** @deprecated Internal implementation detail, do not use directly. Will be made internal in v8. */\n    public destination?: Observer<T>,\n    source?: Observable<T>\n  ) {\n    super();\n    this.source = source;\n  }\n\n  next(value: T) {\n    this.destination?.next?.(value);\n  }\n\n  error(err: any) {\n    this.destination?.error?.(err);\n  }\n\n  complete() {\n    this.destination?.complete?.();\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<T>): Subscription {\n    return this.source?.subscribe(subscriber) ?? EMPTY_SUBSCRIPTION;\n  }\n}\n", "import { Subject } from './Subject';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\n\n/**\n * A variant of Subject that requires an initial value and emits its current\n * value whenever it is subscribed to.\n */\nexport class BehaviorSubject<T> extends Subject<T> {\n  constructor(private _value: T) {\n    super();\n  }\n\n  get value(): T {\n    return this.getValue();\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<T>): Subscription {\n    const subscription = super._subscribe(subscriber);\n    !subscription.closed && subscriber.next(this._value);\n    return subscription;\n  }\n\n  getValue(): T {\n    const { hasError, thrownError, _value } = this;\n    if (hasError) {\n      throw thrownError;\n    }\n    this._throwIfClosed();\n    return _value;\n  }\n\n  next(value: T): void {\n    super.next((this._value = value));\n  }\n}\n", "import { TimestampProvider } from '../types';\n\ninterface DateTimestampProvider extends TimestampProvider {\n  delegate: TimestampProvider | undefined;\n}\n\nexport const dateTimestampProvider: DateTimestampProvider = {\n  now() {\n    // Use the variable rather than `this` so that the function can be called\n    // without being bound to the provider.\n    return (dateTimestampProvider.delegate || Date).now();\n  },\n  delegate: undefined,\n};\n", "import { Subject } from './Subject';\nimport { TimestampProvider } from './types';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\n\n/**\n * A variant of {@link Subject} that \"replays\" old values to new subscribers by emitting them when they first subscribe.\n *\n * `ReplaySubject` has an internal buffer that will store a specified number of values that it has observed. Like `Subject`,\n * `ReplaySubject` \"observes\" values by having them passed to its `next` method. When it observes a value, it will store that\n * value for a time determined by the configuration of the `ReplaySubject`, as passed to its constructor.\n *\n * When a new subscriber subscribes to the `ReplaySubject` instance, it will synchronously emit all values in its buffer in\n * a First-In-First-Out (FIFO) manner. The `ReplaySubject` will also complete, if it has observed completion; and it will\n * error if it has observed an error.\n *\n * There are two main configuration items to be concerned with:\n *\n * 1. `bufferSize` - This will determine how many items are stored in the buffer, defaults to infinite.\n * 2. `windowTime` - The amount of time to hold a value in the buffer before removing it from the buffer.\n *\n * Both configurations may exist simultaneously. So if you would like to buffer a maximum of 3 values, as long as the values\n * are less than 2 seconds old, you could do so with a `new ReplaySubject(3, 2000)`.\n *\n * ### Differences with BehaviorSubject\n *\n * `BehaviorSubject` is similar to `new ReplaySubject(1)`, with a couple of exceptions:\n *\n * 1. `BehaviorSubject` comes \"primed\" with a single value upon construction.\n * 2. `ReplaySubject` will replay values, even after observing an error, where `BehaviorSubject` will not.\n *\n * @see {@link Subject}\n * @see {@link BehaviorSubject}\n * @see {@link shareReplay}\n */\nexport class ReplaySubject<T> extends Subject<T> {\n  private _buffer: (T | number)[] = [];\n  private _infiniteTimeWindow = true;\n\n  /**\n   * @param _bufferSize The size of the buffer to replay on subscription\n   * @param _windowTime The amount of time the buffered items will stay buffered\n   * @param _timestampProvider An object with a `now()` method that provides the current timestamp. This is used to\n   * calculate the amount of time something has been buffered.\n   */\n  constructor(\n    private _bufferSize = Infinity,\n    private _windowTime = Infinity,\n    private _timestampProvider: TimestampProvider = dateTimestampProvider\n  ) {\n    super();\n    this._infiniteTimeWindow = _windowTime === Infinity;\n    this._bufferSize = Math.max(1, _bufferSize);\n    this._windowTime = Math.max(1, _windowTime);\n  }\n\n  next(value: T): void {\n    const { isStopped, _buffer, _infiniteTimeWindow, _timestampProvider, _windowTime } = this;\n    if (!isStopped) {\n      _buffer.push(value);\n      !_infiniteTimeWindow && _buffer.push(_timestampProvider.now() + _windowTime);\n    }\n    this._trimBuffer();\n    super.next(value);\n  }\n\n  /** @internal */\n  protected _subscribe(subscriber: Subscriber<T>): Subscription {\n    this._throwIfClosed();\n    this._trimBuffer();\n\n    const subscription = this._innerSubscribe(subscriber);\n\n    const { _infiniteTimeWindow, _buffer } = this;\n    // We use a copy here, so reentrant code does not mutate our array while we're\n    // emitting it to a new subscriber.\n    const copy = _buffer.slice();\n    for (let i = 0; i < copy.length && !subscriber.closed; i += _infiniteTimeWindow ? 1 : 2) {\n      subscriber.next(copy[i] as T);\n    }\n\n    this._checkFinalizedStatuses(subscriber);\n\n    return subscription;\n  }\n\n  private _trimBuffer() {\n    const { _bufferSize, _timestampProvider, _buffer, _infiniteTimeWindow } = this;\n    // If we don't have an infinite buffer size, and we're over the length,\n    // use splice to truncate the old buffer values off. Note that we have to\n    // double the size for instances where we're not using an infinite time window\n    // because we're storing the values and the timestamps in the same array.\n    const adjustedBufferSize = (_infiniteTimeWindow ? 1 : 2) * _bufferSize;\n    _bufferSize < Infinity && adjustedBufferSize < _buffer.length && _buffer.splice(0, _buffer.length - adjustedBufferSize);\n\n    // Now, if we're not in an infinite time window, remove all values where the time is\n    // older than what is allowed.\n    if (!_infiniteTimeWindow) {\n      const now = _timestampProvider.now();\n      let last = 0;\n      // Search the array for the first timestamp that isn't expired and\n      // truncate the buffer up to that point.\n      for (let i = 1; i < _buffer.length && (_buffer[i] as number) <= now; i += 2) {\n        last = i;\n      }\n      last && _buffer.splice(0, last + 1);\n    }\n  }\n}\n", "import { Subject } from './Subject';\nimport { Subscriber } from './Subscriber';\n\n/**\n * A variant of Subject that only emits a value when it completes. It will emit\n * its latest value to all its observers on completion.\n */\nexport class AsyncSubject<T> extends Subject<T> {\n  private _value: T | null = null;\n  private _hasValue = false;\n  private _isComplete = false;\n\n  /** @internal */\n  protected _checkFinalizedStatuses(subscriber: Subscriber<T>) {\n    const { hasError, _hasValue, _value, thrownError, isStopped, _isComplete } = this;\n    if (hasError) {\n      subscriber.error(thrownError);\n    } else if (isStopped || _isComplete) {\n      _hasValue && subscriber.next(_value!);\n      subscriber.complete();\n    }\n  }\n\n  next(value: T): void {\n    if (!this.isStopped) {\n      this._value = value;\n      this._hasValue = true;\n    }\n  }\n\n  complete(): void {\n    const { _hasValue, _value, _isComplete } = this;\n    if (!_isComplete) {\n      this._isComplete = true;\n      _hasValue && super.next(_value!);\n      super.complete();\n    }\n  }\n}\n", "import { Scheduler } from '../Scheduler';\nimport { Subscription } from '../Subscription';\nimport { SchedulerAction } from '../types';\n\n/**\n * A unit of work to be executed in a `scheduler`. An action is typically\n * created from within a {@link SchedulerLike} and an RxJS user does not need to concern\n * themselves about creating and manipulating an Action.\n *\n * ```ts\n * class Action<T> extends Subscription {\n *   new (scheduler: Scheduler, work: (state?: T) => void);\n *   schedule(state?: T, delay: number = 0): Subscription;\n * }\n * ```\n */\nexport class Action<T> extends Subscription {\n  constructor(scheduler: Scheduler, work: (this: SchedulerAction<T>, state?: T) => void) {\n    super();\n  }\n  /**\n   * Schedules this action on its parent {@link SchedulerLike} for execution. May be passed\n   * some context object, `state`. May happen at some point in the future,\n   * according to the `delay` parameter, if specified.\n   * @param state Some contextual data that the `work` function uses when called by the\n   * Scheduler.\n   * @param delay Time to wait before executing the work, where the time unit is implicit\n   * and defined by the Scheduler.\n   * @return A subscription in order to be able to unsubscribe the scheduled work.\n   */\n  public schedule(state?: T, delay: number = 0): Subscription {\n    return this;\n  }\n}\n", "import type { TimerHandle } from './timerHandle';\ntype SetIntervalFunction = (handler: () => void, timeout?: number, ...args: any[]) => TimerHandle;\ntype ClearIntervalFunction = (handle: TimerHandle) => void;\n\ninterface IntervalProvider {\n  setInterval: SetIntervalFunction;\n  clearInterval: ClearIntervalFunction;\n  delegate:\n    | {\n        setInterval: SetIntervalFunction;\n        clearInterval: ClearIntervalFunction;\n      }\n    | undefined;\n}\n\nexport const intervalProvider: IntervalProvider = {\n  // When accessing the delegate, use the variable rather than `this` so that\n  // the functions can be called without being bound to the provider.\n  setInterval(handler: () => void, timeout?: number, ...args) {\n    const { delegate } = intervalProvider;\n    if (delegate?.setInterval) {\n      return delegate.setInterval(handler, timeout, ...args);\n    }\n    return setInterval(handler, timeout, ...args);\n  },\n  clearInterval(handle) {\n    const { delegate } = intervalProvider;\n    return (delegate?.clearInterval || clearInterval)(handle as any);\n  },\n  delegate: undefined,\n};\n", "import { Action } from './Action';\nimport { SchedulerAction } from '../types';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nimport { TimerHandle } from './timerHandle';\n\nexport class AsyncAction<T> extends Action<T> {\n  public id: TimerHandle | undefined;\n  public state?: T;\n  // @ts-ignore: Property has no initializer and is not definitely assigned\n  public delay: number;\n  protected pending: boolean = false;\n\n  constructor(protected scheduler: AsyncScheduler, protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n    if (this.closed) {\n      return this;\n    }\n\n    // Always replace the current state with the new state.\n    this.state = state;\n\n    const id = this.id;\n    const scheduler = this.scheduler;\n\n    //\n    // Important implementation note:\n    //\n    // Actions only execute once by default, unless rescheduled from within the\n    // scheduled callback. This allows us to implement single and repeat\n    // actions via the same code path, without adding API surface area, as well\n    // as mimic traditional recursion but across asynchronous boundaries.\n    //\n    // However, JS runtimes and timers distinguish between intervals achieved by\n    // serial `setTimeout` calls vs. a single `setInterval` call. An interval of\n    // serial `setTimeout` calls can be individually delayed, which delays\n    // scheduling the next `setTimeout`, and so on. `setInterval` attempts to\n    // guarantee the interval callback will be invoked more precisely to the\n    // interval period, regardless of load.\n    //\n    // Therefore, we use `setInterval` to schedule single and repeat actions.\n    // If the action reschedules itself with the same delay, the interval is not\n    // canceled. If the action doesn't reschedule, or reschedules with a\n    // different delay, the interval will be canceled after scheduled callback\n    // execution.\n    //\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    // Set the pending flag indicating that this action has been scheduled, or\n    // has recursively rescheduled itself.\n    this.pending = true;\n\n    this.delay = delay;\n    // If this action has already an async Id, don't request a new one.\n    this.id = this.id ?? this.requestAsyncId(scheduler, this.id, delay);\n\n    return this;\n  }\n\n  protected requestAsyncId(scheduler: AsyncScheduler, _id?: TimerHandle, delay: number = 0): TimerHandle {\n    return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n  }\n\n  protected recycleAsyncId(_scheduler: AsyncScheduler, id?: TimerHandle, delay: number | null = 0): TimerHandle | undefined {\n    // If this action is rescheduled with the same delay time, don't clear the interval id.\n    if (delay != null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n    // Otherwise, if the action's delay time is different from the current delay,\n    // or the action has been rescheduled before it's executed, clear the interval id\n    if (id != null) {\n      intervalProvider.clearInterval(id);\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Immediately executes this action and the `work` it contains.\n   */\n  public execute(state: T, delay: number): any {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n    const error = this._execute(state, delay);\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      // Dequeue if the action didn't reschedule itself. Don't call\n      // unsubscribe(), because the action could reschedule later.\n      // For example:\n      // ```\n      // scheduler.schedule(function doWork(counter) {\n      //   /* ... I'm a busy worker bee ... */\n      //   var originalAction = this;\n      //   /* wait 100ms before rescheduling the action */\n      //   setTimeout(function () {\n      //     originalAction.schedule(counter + 1);\n      //   }, 100);\n      // }, 1000);\n      // ```\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  }\n\n  protected _execute(state: T, _delay: number): any {\n    let errored: boolean = false;\n    let errorValue: any;\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      // HACK: Since code elsewhere is relying on the \"truthiness\" of the\n      // return here, we can't have it return \"\" or 0 or false.\n      // TODO: Clean this up when we refactor schedulers mid-version-8 or so.\n      errorValue = e ? e : new Error('Scheduled action threw falsy error');\n    }\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  }\n\n  unsubscribe() {\n    if (!this.closed) {\n      const { id, scheduler } = this;\n      const { actions } = scheduler;\n\n      this.work = this.state = this.scheduler = null!;\n      this.pending = false;\n\n      arrRemove(actions, this);\n      if (id != null) {\n        this.id = this.recycleAsyncId(scheduler, id, null);\n      }\n\n      this.delay = null!;\n      super.unsubscribe();\n    }\n  }\n}\n", "let nextHandle = 1;\n// The promise needs to be created lazily otherwise it won't be patched by Zones\nlet resolved: Promise<any>;\nconst activeHandles: { [key: number]: any } = {};\n\n/**\n * Finds the handle in the list of active handles, and removes it.\n * Returns `true` if found, `false` otherwise. Used both to clear\n * Immediate scheduled tasks, and to identify if a task should be scheduled.\n */\nfunction findAndClearHandle(handle: number): boolean {\n  if (handle in activeHandles) {\n    delete activeHandles[handle];\n    return true;\n  }\n  return false;\n}\n\n/**\n * Helper functions to schedule and unschedule microtasks.\n */\nexport const Immediate = {\n  setImmediate(cb: () => void): number {\n    const handle = nextHandle++;\n    activeHandles[handle] = true;\n    if (!resolved) {\n      resolved = Promise.resolve();\n    }\n    resolved.then(() => findAndClearHandle(handle) && cb());\n    return handle;\n  },\n\n  clearImmediate(handle: number): void {\n    findAndClearHandle(handle);\n  },\n};\n\n/**\n * Used for internal testing purposes only. Do not export from library.\n */\nexport const TestTools = {\n  pending() {\n    return Object.keys(activeHandles).length;\n  }\n};\n", "import { Immediate } from '../util/Immediate';\nimport type { TimerHandle } from './timerHandle';\nconst { setImmediate, clearImmediate } = Immediate;\n\ntype SetImmediateFunction = (handler: () => void, ...args: any[]) => TimerHandle;\ntype ClearImmediateFunction = (handle: TimerHandle) => void;\n\ninterface ImmediateProvider {\n  setImmediate: SetImmediateFunction;\n  clearImmediate: ClearImmediateFunction;\n  delegate:\n    | {\n        setImmediate: SetImmediateFunction;\n        clearImmediate: ClearImmediateFunction;\n      }\n    | undefined;\n}\n\nexport const immediateProvider: ImmediateProvider = {\n  // When accessing the delegate, use the variable rather than `this` so that\n  // the functions can be called without being bound to the provider.\n  setImmediate(...args) {\n    const { delegate } = immediateProvider;\n    return (delegate?.setImmediate || setImmediate)(...args);\n  },\n  clearImmediate(handle) {\n    const { delegate } = immediateProvider;\n    return (delegate?.clearImmediate || clearImmediate)(handle as any);\n  },\n  delegate: undefined,\n};\n", "import { AsyncAction } from './AsyncAction';\nimport { AsapScheduler } from './AsapScheduler';\nimport { SchedulerAction } from '../types';\nimport { immediateProvider } from './immediateProvider';\nimport { TimerHandle } from './timerHandle';\n\nexport class AsapAction<T> extends AsyncAction<T> {\n  constructor(protected scheduler: AsapScheduler, protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  protected requestAsyncId(scheduler: AsapScheduler, id?: TimerHandle, delay: number = 0): TimerHandle {\n    // If delay is greater than 0, request as an async action.\n    if (delay !== null && delay > 0) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n    // Push the action to the end of the scheduler queue.\n    scheduler.actions.push(this);\n    // If a microtask has already been scheduled, don't schedule another\n    // one. If a microtask hasn't been scheduled yet, schedule one now. Return\n    // the current scheduled microtask id.\n    return scheduler._scheduled || (scheduler._scheduled = immediateProvider.setImmediate(scheduler.flush.bind(scheduler, undefined)));\n  }\n\n  protected recycleAsyncId(scheduler: AsapScheduler, id?: TimerHandle, delay: number = 0): TimerHandle | undefined {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n    if (delay != null ? delay > 0 : this.delay > 0) {\n      return super.recycleAsyncId(scheduler, id, delay);\n    }\n    // If the scheduler queue has no remaining actions with the same async id,\n    // cancel the requested microtask and set the scheduled flag to undefined\n    // so the next AsapAction will request its own.\n    const { actions } = scheduler;\n    if (id != null && actions[actions.length - 1]?.id !== id) {\n      immediateProvider.clearImmediate(id);\n      if (scheduler._scheduled === id) {\n        scheduler._scheduled = undefined;\n      }\n    }\n    // Return undefined so the action knows to request a new async id if it's rescheduled.\n    return undefined;\n  }\n}\n", "import { Action } from './scheduler/Action';\nimport { Subscription } from './Subscription';\nimport { SchedulerLike, SchedulerAction } from './types';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\n\n/**\n * An execution context and a data structure to order tasks and schedule their\n * execution. Provides a notion of (potentially virtual) time, through the\n * `now()` getter method.\n *\n * Each unit of work in a Scheduler is called an `Action`.\n *\n * ```ts\n * class Scheduler {\n *   now(): number;\n *   schedule(work, delay?, state?): Subscription;\n * }\n * ```\n *\n * @deprecated Scheduler is an internal implementation detail of RxJS, and\n * should not be used directly. Rather, create your own class and implement\n * {@link SchedulerLike}. Will be made internal in v8.\n */\nexport class Scheduler implements SchedulerLike {\n  public static now: () => number = dateTimestampProvider.now;\n\n  constructor(private schedulerActionCtor: typeof Action, now: () => number = Scheduler.now) {\n    this.now = now;\n  }\n\n  /**\n   * A getter method that returns a number representing the current time\n   * (at the time this function was called) according to the scheduler's own\n   * internal clock.\n   * @return A number that represents the current time. May or may not\n   * have a relation to wall-clock time. May or may not refer to a time unit\n   * (e.g. milliseconds).\n   */\n  public now: () => number;\n\n  /**\n   * Schedules a function, `work`, for execution. May happen at some point in\n   * the future, according to the `delay` parameter, if specified. May be passed\n   * some context object, `state`, which will be passed to the `work` function.\n   *\n   * The given arguments will be processed an stored as an Action object in a\n   * queue of actions.\n   *\n   * @param work A function representing a task, or some unit of work to be\n   * executed by the Scheduler.\n   * @param delay Time to wait before executing the work, where the time unit is\n   * implicit and defined by the Scheduler itself.\n   * @param state Some contextual data that the `work` function uses when called\n   * by the Scheduler.\n   * @return A subscription in order to be able to unsubscribe the scheduled work.\n   */\n  public schedule<T>(work: (this: SchedulerAction<T>, state?: T) => void, delay: number = 0, state?: T): Subscription {\n    return new this.schedulerActionCtor<T>(this, work).schedule(state, delay);\n  }\n}\n", "import { Scheduler } from '../Scheduler';\nimport { Action } from './Action';\nimport { AsyncAction } from './AsyncAction';\nimport { TimerHandle } from './timerHandle';\n\nexport class AsyncScheduler extends Scheduler {\n  public actions: Array<AsyncAction<any>> = [];\n  /**\n   * A flag to indicate whether the Scheduler is currently executing a batch of\n   * queued actions.\n   * @internal\n   */\n  public _active: boolean = false;\n  /**\n   * An internal ID used to track the latest asynchronous task such as those\n   * coming from `setTimeout`, `setInterval`, `requestAnimationFrame`, and\n   * others.\n   * @internal\n   */\n  public _scheduled: TimerHandle | undefined;\n\n  constructor(SchedulerAction: typeof Action, now: () => number = Scheduler.now) {\n    super(SchedulerAction, now);\n  }\n\n  public flush(action: AsyncAction<any>): void {\n    const { actions } = this;\n\n    if (this._active) {\n      actions.push(action);\n      return;\n    }\n\n    let error: any;\n    this._active = true;\n\n    do {\n      if ((error = action.execute(action.state, action.delay))) {\n        break;\n      }\n    } while ((action = actions.shift()!)); // exhaust the scheduler queue\n\n    this._active = false;\n\n    if (error) {\n      while ((action = actions.shift()!)) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n", "import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\nexport class AsapScheduler extends AsyncScheduler {\n  public flush(action?: AsyncAction<any>): void {\n    this._active = true;\n    // The async id that effects a call to flush is stored in _scheduled.\n    // Before executing an action, it's necessary to check the action's async\n    // id to determine whether it's supposed to be executed in the current\n    // flush.\n    // Previous implementations of this method used a count to determine this,\n    // but that was unsound, as actions that are unsubscribed - i.e. cancelled -\n    // are removed from the actions array and that can shift actions that are\n    // scheduled to be executed in a subsequent flush into positions at which\n    // they are executed within the current flush.\n    const flushId = this._scheduled;\n    this._scheduled = undefined;\n\n    const { actions } = this;\n    let error: any;\n    action = action || actions.shift()!;\n\n    do {\n      if ((error = action.execute(action.state, action.delay))) {\n        break;\n      }\n    } while ((action = actions[0]) && action.id === flushId && actions.shift());\n\n    this._active = false;\n\n    if (error) {\n      while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n", "import { AsapAction } from './AsapAction';\nimport { AsapScheduler } from './AsapScheduler';\n\n/**\n *\n * Asap Scheduler\n *\n * <span class=\"informal\">Perform task as fast as it can be performed asynchronously</span>\n *\n * `asap` scheduler behaves the same as {@link asyncScheduler} scheduler when you use it to delay task\n * in time. If however you set delay to `0`, `asap` will wait for current synchronously executing\n * code to end and then it will try to execute given task as fast as possible.\n *\n * `asap` scheduler will do its best to minimize time between end of currently executing code\n * and start of scheduled task. This makes it best candidate for performing so called \"deferring\".\n * Traditionally this was achieved by calling `setTimeout(deferredTask, 0)`, but that technique involves\n * some (although minimal) unwanted delay.\n *\n * Note that using `asap` scheduler does not necessarily mean that your task will be first to process\n * after currently executing code. In particular, if some task was also scheduled with `asap` before,\n * that task will execute first. That being said, if you need to schedule task asynchronously, but\n * as soon as possible, `asap` scheduler is your best bet.\n *\n * ## Example\n * Compare async and asap scheduler<\n * ```ts\n * import { asapScheduler, asyncScheduler } from 'rxjs';\n *\n * asyncScheduler.schedule(() => console.log('async')); // scheduling 'async' first...\n * asapScheduler.schedule(() => console.log('asap'));\n *\n * // Logs:\n * // \"asap\"\n * // \"async\"\n * // ... but 'asap' goes first!\n * ```\n */\n\nexport const asapScheduler = new AsapScheduler(AsapAction);\n\n/**\n * @deprecated Renamed to {@link asapScheduler}. Will be removed in v8.\n */\nexport const asap = asapScheduler;\n", "import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\n/**\n *\n * Async Scheduler\n *\n * <span class=\"informal\">Schedule task as if you used setTimeout(task, duration)</span>\n *\n * `async` scheduler schedules tasks asynchronously, by putting them on the JavaScript\n * event loop queue. It is best used to delay tasks in time or to schedule tasks repeating\n * in intervals.\n *\n * If you just want to \"defer\" task, that is to perform it right after currently\n * executing synchronous code ends (commonly achieved by `setTimeout(deferredTask, 0)`),\n * better choice will be the {@link asapScheduler} scheduler.\n *\n * ## Examples\n * Use async scheduler to delay task\n * ```ts\n * import { asyncScheduler } from 'rxjs';\n *\n * const task = () => console.log('it works!');\n *\n * asyncScheduler.schedule(task, 2000);\n *\n * // After 2 seconds logs:\n * // \"it works!\"\n * ```\n *\n * Use async scheduler to repeat task in intervals\n * ```ts\n * import { asyncScheduler } from 'rxjs';\n *\n * function task(state) {\n *   console.log(state);\n *   this.schedule(state + 1, 1000); // `this` references currently executing Action,\n *                                   // which we reschedule with new state and delay\n * }\n *\n * asyncScheduler.schedule(task, 3000, 0);\n *\n * // Logs:\n * // 0 after 3s\n * // 1 after 4s\n * // 2 after 5s\n * // 3 after 6s\n * ```\n */\n\nexport const asyncScheduler = new AsyncScheduler(AsyncAction);\n\n/**\n * @deprecated Renamed to {@link asyncScheduler}. Will be removed in v8.\n */\nexport const async = asyncScheduler;\n", "import { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { QueueScheduler } from './QueueScheduler';\nimport { SchedulerAction } from '../types';\nimport { TimerHandle } from './timerHandle';\n\nexport class QueueAction<T> extends AsyncAction<T> {\n  constructor(protected scheduler: QueueScheduler, protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n    if (delay > 0) {\n      return super.schedule(state, delay);\n    }\n    this.delay = delay;\n    this.state = state;\n    this.scheduler.flush(this);\n    return this;\n  }\n\n  public execute(state: T, delay: number): any {\n    return delay > 0 || this.closed ? super.execute(state, delay) : this._execute(state, delay);\n  }\n\n  protected requestAsyncId(scheduler: QueueScheduler, id?: TimerHandle, delay: number = 0): TimerHandle {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n\n    if ((delay != null && delay > 0) || (delay == null && this.delay > 0)) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n\n    // Otherwise flush the scheduler starting with this action.\n    scheduler.flush(this);\n\n    // HACK: In the past, this was returning `void`. However, `void` isn't a valid\n    // `TimerHandle`, and generally the return value here isn't really used. So the\n    // compromise is to return `0` which is both \"falsy\" and a valid `TimerHandle`,\n    // as opposed to refactoring every other instanceo of `requestAsyncId`.\n    return 0;\n  }\n}\n", "import { AsyncScheduler } from './AsyncScheduler';\n\nexport class QueueScheduler extends AsyncScheduler {\n}\n", "import { QueueAction } from './QueueAction';\nimport { QueueScheduler } from './QueueScheduler';\n\n/**\n *\n * Queue Scheduler\n *\n * <span class=\"informal\">Put every next task on a queue, instead of executing it immediately</span>\n *\n * `queue` scheduler, when used with delay, behaves the same as {@link asyncScheduler} scheduler.\n *\n * When used without delay, it schedules given task synchronously - executes it right when\n * it is scheduled. However when called recursively, that is when inside the scheduled task,\n * another task is scheduled with queue scheduler, instead of executing immediately as well,\n * that task will be put on a queue and wait for current one to finish.\n *\n * This means that when you execute task with `queue` scheduler, you are sure it will end\n * before any other task scheduled with that scheduler will start.\n *\n * ## Examples\n * Schedule recursively first, then do something\n * ```ts\n * import { queueScheduler } from 'rxjs';\n *\n * queueScheduler.schedule(() => {\n *   queueScheduler.schedule(() => console.log('second')); // will not happen now, but will be put on a queue\n *\n *   console.log('first');\n * });\n *\n * // Logs:\n * // \"first\"\n * // \"second\"\n * ```\n *\n * Reschedule itself recursively\n * ```ts\n * import { queueScheduler } from 'rxjs';\n *\n * queueScheduler.schedule(function(state) {\n *   if (state !== 0) {\n *     console.log('before', state);\n *     this.schedule(state - 1); // `this` references currently executing Action,\n *                               // which we reschedule with new state\n *     console.log('after', state);\n *   }\n * }, 0, 3);\n *\n * // In scheduler that runs recursively, you would expect:\n * // \"before\", 3\n * // \"before\", 2\n * // \"before\", 1\n * // \"after\", 1\n * // \"after\", 2\n * // \"after\", 3\n *\n * // But with queue it logs:\n * // \"before\", 3\n * // \"after\", 3\n * // \"before\", 2\n * // \"after\", 2\n * // \"before\", 1\n * // \"after\", 1\n * ```\n */\n\nexport const queueScheduler = new QueueScheduler(QueueAction);\n\n/**\n * @deprecated Renamed to {@link queueScheduler}. Will be removed in v8.\n */\nexport const queue = queueScheduler;\n", "import { AsyncAction } from './AsyncAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\nimport { SchedulerAction } from '../types';\nimport { animationFrameProvider } from './animationFrameProvider';\nimport { TimerHandle } from './timerHandle';\n\nexport class AnimationFrameAction<T> extends AsyncAction<T> {\n  constructor(protected scheduler: AnimationFrameScheduler, protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  protected requestAsyncId(scheduler: AnimationFrameScheduler, id?: TimerHandle, delay: number = 0): TimerHandle {\n    // If delay is greater than 0, request as an async action.\n    if (delay !== null && delay > 0) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n    // Push the action to the end of the scheduler queue.\n    scheduler.actions.push(this);\n    // If an animation frame has already been requested, don't request another\n    // one. If an animation frame hasn't been requested yet, request one. Return\n    // the current animation frame request id.\n    return scheduler._scheduled || (scheduler._scheduled = animationFrameProvider.requestAnimationFrame(() => scheduler.flush(undefined)));\n  }\n\n  protected recycleAsyncId(scheduler: AnimationFrameScheduler, id?: TimerHandle, delay: number = 0): TimerHandle | undefined {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n    if (delay != null ? delay > 0 : this.delay > 0) {\n      return super.recycleAsyncId(scheduler, id, delay);\n    }\n    // If the scheduler queue has no remaining actions with the same async id,\n    // cancel the requested animation frame and set the scheduled flag to\n    // undefined so the next AnimationFrameAction will request its own.\n    const { actions } = scheduler;\n    if (id != null && id === scheduler._scheduled && actions[actions.length - 1]?.id !== id) {\n      animationFrameProvider.cancelAnimationFrame(id as number);\n      scheduler._scheduled = undefined;\n    }\n    // Return undefined so the action knows to request a new async id if it's rescheduled.\n    return undefined;\n  }\n}\n", "import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\nexport class AnimationFrameScheduler extends AsyncScheduler {\n  public flush(action?: AsyncAction<any>): void {\n    this._active = true;\n    // The async id that effects a call to flush is stored in _scheduled.\n    // Before executing an action, it's necessary to check the action's async\n    // id to determine whether it's supposed to be executed in the current\n    // flush.\n    // Previous implementations of this method used a count to determine this,\n    // but that was unsound, as actions that are unsubscribed - i.e. cancelled -\n    // are removed from the actions array and that can shift actions that are\n    // scheduled to be executed in a subsequent flush into positions at which\n    // they are executed within the current flush.\n    let flushId;\n    if (action) {\n      flushId = action.id;\n    } else {\n      flushId = this._scheduled;\n      this._scheduled = undefined;\n    }\n\n    const { actions } = this;\n    let error: any;\n    action = action || actions.shift()!;\n\n    do {\n      if ((error = action.execute(action.state, action.delay))) {\n        break;\n      }\n    } while ((action = actions[0]) && action.id === flushId && actions.shift());\n\n    this._active = false;\n\n    if (error) {\n      while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n", "import { AnimationFrameAction } from './AnimationFrameAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\n\n/**\n *\n * Animation Frame Scheduler\n *\n * <span class=\"informal\">Perform task when `window.requestAnimationFrame` would fire</span>\n *\n * When `animationFrame` scheduler is used with delay, it will fall back to {@link asyncScheduler} scheduler\n * behaviour.\n *\n * Without delay, `animationFrame` scheduler can be used to create smooth browser animations.\n * It makes sure scheduled task will happen just before next browser content repaint,\n * thus performing animations as efficiently as possible.\n *\n * ## Example\n * Schedule div height animation\n * ```ts\n * // html: <div style=\"background: #0ff;\"></div>\n * import { animationFrameScheduler } from 'rxjs';\n *\n * const div = document.querySelector('div');\n *\n * animationFrameScheduler.schedule(function(height) {\n *   div.style.height = height + \"px\";\n *\n *   this.schedule(height + 1);  // `this` references currently executing Action,\n *                               // which we reschedule with new state\n * }, 0, 0);\n *\n * // You will see a div element growing in height\n * ```\n */\n\nexport const animationFrameScheduler = new AnimationFrameScheduler(AnimationFrameAction);\n\n/**\n * @deprecated Renamed to {@link animationFrameScheduler}. Will be removed in v8.\n */\nexport const animationFrame = animationFrameScheduler;\n", "import { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\nimport { SchedulerAction } from '../types';\nimport { TimerHandle } from './timerHandle';\n\nexport class VirtualTimeScheduler extends AsyncScheduler {\n  /** @deprecated Not used in VirtualTimeScheduler directly. Will be removed in v8. */\n  static frameTimeFactor = 10;\n\n  /**\n   * The current frame for the state of the virtual scheduler instance. The difference\n   * between two \"frames\" is synonymous with the passage of \"virtual time units\". So if\n   * you record `scheduler.frame` to be `1`, then later, observe `scheduler.frame` to be at `11`,\n   * that means `10` virtual time units have passed.\n   */\n  public frame: number = 0;\n\n  /**\n   * Used internally to examine the current virtual action index being processed.\n   * @deprecated Internal implementation detail, do not use directly. Will be made internal in v8.\n   */\n  public index: number = -1;\n\n  /**\n   * This creates an instance of a `VirtualTimeScheduler`. Experts only. The signature of\n   * this constructor is likely to change in the long run.\n   *\n   * @param schedulerActionCtor The type of Action to initialize when initializing actions during scheduling.\n   * @param maxFrames The maximum number of frames to process before stopping. Used to prevent endless flush cycles.\n   */\n  constructor(schedulerActionCtor: typeof AsyncAction = VirtualAction as any, public maxFrames: number = Infinity) {\n    super(schedulerActionCtor, () => this.frame);\n  }\n\n  /**\n   * Prompt the Scheduler to execute all of its queued actions, therefore\n   * clearing its queue.\n   */\n  public flush(): void {\n    const { actions, maxFrames } = this;\n    let error: any;\n    let action: AsyncAction<any> | undefined;\n\n    while ((action = actions[0]) && action.delay <= maxFrames) {\n      actions.shift();\n      this.frame = action.delay;\n\n      if ((error = action.execute(action.state, action.delay))) {\n        break;\n      }\n    }\n\n    if (error) {\n      while ((action = actions.shift())) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n\nexport class VirtualAction<T> extends AsyncAction<T> {\n  protected active: boolean = true;\n\n  constructor(\n    protected scheduler: VirtualTimeScheduler,\n    protected work: (this: SchedulerAction<T>, state?: T) => void,\n    protected index: number = (scheduler.index += 1)\n  ) {\n    super(scheduler, work);\n    this.index = scheduler.index = index;\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n    if (Number.isFinite(delay)) {\n      if (!this.id) {\n        return super.schedule(state, delay);\n      }\n      this.active = false;\n      // If an action is rescheduled, we save allocations by mutating its state,\n      // pushing it to the end of the scheduler queue, and recycling the action.\n      // But since the VirtualTimeScheduler is used for testing, VirtualActions\n      // must be immutable so they can be inspected later.\n      const action = new VirtualAction(this.scheduler, this.work);\n      this.add(action);\n      return action.schedule(state, delay);\n    } else {\n      // If someone schedules something with Infinity, it'll never happen. So we\n      // don't even schedule it.\n      return Subscription.EMPTY;\n    }\n  }\n\n  protected requestAsyncId(scheduler: VirtualTimeScheduler, id?: any, delay: number = 0): TimerHandle {\n    this.delay = scheduler.frame + delay;\n    const { actions } = scheduler;\n    actions.push(this);\n    (actions as Array<VirtualAction<T>>).sort(VirtualAction.sortActions);\n    return 1;\n  }\n\n  protected recycleAsyncId(scheduler: VirtualTimeScheduler, id?: any, delay: number = 0): TimerHandle | undefined {\n    return undefined;\n  }\n\n  protected _execute(state: T, delay: number): any {\n    if (this.active === true) {\n      return super._execute(state, delay);\n    }\n  }\n\n  private static sortActions<T>(a: VirtualAction<T>, b: VirtualAction<T>) {\n    if (a.delay === b.delay) {\n      if (a.index === b.index) {\n        return 0;\n      } else if (a.index > b.index) {\n        return 1;\n      } else {\n        return -1;\n      }\n    } else if (a.delay > b.delay) {\n      return 1;\n    } else {\n      return -1;\n    }\n  }\n}\n", "import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\n\n/**\n * A simple Observable that emits no items to the Observer and immediately\n * emits a complete notification.\n *\n * <span class=\"informal\">Just emits 'complete', and nothing else.</span>\n *\n * ![](empty.png)\n *\n * A simple Observable that only emits the complete notification. It can be used\n * for composing with other Observables, such as in a {@link mergeMap}.\n *\n * ## Examples\n *\n * Log complete notification\n *\n * ```ts\n * import { EMPTY } from 'rxjs';\n *\n * EMPTY.subscribe({\n *   next: () => console.log('Next'),\n *   complete: () => console.log('Complete!')\n * });\n *\n * // Outputs\n * // Complete!\n * ```\n *\n * Emit the number 7, then complete\n *\n * ```ts\n * import { EMPTY, startWith } from 'rxjs';\n *\n * const result = EMPTY.pipe(startWith(7));\n * result.subscribe(x => console.log(x));\n *\n * // Outputs\n * // 7\n * ```\n *\n * Map and flatten only odd numbers to the sequence `'a'`, `'b'`, `'c'`\n *\n * ```ts\n * import { interval, mergeMap, of, EMPTY } from 'rxjs';\n *\n * const interval$ = interval(1000);\n * const result = interval$.pipe(\n *   mergeMap(x => x % 2 === 1 ? of('a', 'b', 'c') : EMPTY),\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following to the console:\n * // x is equal to the count on the interval, e.g. (0, 1, 2, 3, ...)\n * // x will occur every 1000ms\n * // if x % 2 is equal to 1, print a, b, c (each on its own)\n * // if x % 2 is not equal to 1, nothing will be output\n * ```\n *\n * @see {@link Observable}\n * @see {@link NEVER}\n * @see {@link of}\n * @see {@link throwError}\n */\nexport const EMPTY = new Observable<never>((subscriber) => subscriber.complete());\n\n/**\n * @param scheduler A {@link SchedulerLike} to use for scheduling\n * the emission of the complete notification.\n * @deprecated Replaced with the {@link EMPTY} constant or {@link scheduled} (e.g. `scheduled([], scheduler)`). Will be removed in v8.\n */\nexport function empty(scheduler?: SchedulerLike) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\n\nfunction emptyScheduled(scheduler: SchedulerLike) {\n  return new Observable<never>((subscriber) => scheduler.schedule(() => subscriber.complete()));\n}\n", "import { SchedulerLike } from '../types';\nimport { isFunction } from './isFunction';\n\nexport function isScheduler(value: any): value is SchedulerLike {\n  return value && isFunction(value.schedule);\n}\n", "import { SchedulerLike } from '../types';\nimport { isFunction } from './isFunction';\nimport { isScheduler } from './isScheduler';\n\nfunction last<T>(arr: T[]): T | undefined {\n  return arr[arr.length - 1];\n}\n\nexport function popResultSelector(args: any[]): ((...args: unknown[]) => unknown) | undefined {\n  return isFunction(last(args)) ? args.pop() : undefined;\n}\n\nexport function popScheduler(args: any[]): SchedulerLike | undefined {\n  return isScheduler(last(args)) ? args.pop() : undefined;\n}\n\nexport function popNumber(args: any[], defaultValue: number): number {\n  return typeof last(args) === 'number' ? args.pop()! : defaultValue;\n}\n", "export const isArrayLike = (<T>(x: any): x is ArrayLike<T> => x && typeof x.length === 'number' && typeof x !== 'function');", "import { isFunction } from \"./isFunction\";\n\n/**\n * Tests to see if the object is \"thennable\".\n * @param value the object to test\n */\nexport function isPromise(value: any): value is PromiseLike<any> {\n  return isFunction(value?.then);\n}\n", "import { InteropObservable } from '../types';\nimport { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\n\n/** Identifies an input as being Observable (but not necessary an Rx Observable) */\nexport function isInteropObservable(input: any): input is InteropObservable<any> {\n  return isFunction(input[Symbol_observable]);\n}\n", "import { isFunction } from './isFunction';\n\nexport function isAsyncIterable<T>(obj: any): obj is AsyncIterable<T> {\n  return Symbol.asyncIterator && isFunction(obj?.[Symbol.asyncIterator]);\n}\n", "/**\n * Creates the TypeError to throw if an invalid object is passed to `from` or `scheduled`.\n * @param input The object that was passed.\n */\nexport function createInvalidObservableTypeError(input: any) {\n  // TODO: We should create error codes that can be looked up, so this can be less verbose.\n  return new TypeError(\n    `You provided ${\n      input !== null && typeof input === 'object' ? 'an invalid object' : `'${input}'`\n    } where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`\n  );\n}\n", "export function getSymbolIterator(): symbol {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator' as any;\n  }\n\n  return Symbol.iterator;\n}\n\nexport const iterator = getSymbolIterator();\n", "import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\n\n/** Identifies an input as being an Iterable */\nexport function isIterable(input: any): input is Iterable<any> {\n  return isFunction(input?.[Symbol_iterator]);\n}\n", "import { ReadableStreamLike } from '../types';\nimport { isFunction } from './isFunction';\n\nexport async function* readableStreamLikeToAsyncGenerator<T>(readableStream: ReadableStreamLike<T>): AsyncGenerator<T> {\n  const reader = readableStream.getReader();\n  try {\n    while (true) {\n      const { value, done } = await reader.read();\n      if (done) {\n        return;\n      }\n      yield value!;\n    }\n  } finally {\n    reader.releaseLock();\n  }\n}\n\nexport function isReadableStreamLike<T>(obj: any): obj is ReadableStreamLike<T> {\n  // We don't want to use instanceof checks because they would return\n  // false for instances from another Realm, like an <iframe>.\n  return isFunction(obj?.getReader);\n}\n", "import { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { Observable } from '../Observable';\nimport { ObservableInput, ObservedValueOf, ReadableStreamLike } from '../types';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nimport { Subscriber } from '../Subscriber';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { observable as Symbol_observable } from '../symbol/observable';\n\nexport function innerFrom<O extends ObservableInput<any>>(input: O): Observable<ObservedValueOf<O>>;\nexport function innerFrom<T>(input: ObservableInput<T>): Observable<T> {\n  if (input instanceof Observable) {\n    return input;\n  }\n  if (input != null) {\n    if (isInteropObservable(input)) {\n      return fromInteropObservable(input);\n    }\n    if (isArrayLike(input)) {\n      return fromArrayLike(input);\n    }\n    if (isPromise(input)) {\n      return fromPromise(input);\n    }\n    if (isAsyncIterable(input)) {\n      return fromAsyncIterable(input);\n    }\n    if (isIterable(input)) {\n      return fromIterable(input);\n    }\n    if (isReadableStreamLike(input)) {\n      return fromReadableStreamLike(input);\n    }\n  }\n\n  throw createInvalidObservableTypeError(input);\n}\n\n/**\n * Creates an RxJS Observable from an object that implements `Symbol.observable`.\n * @param obj An object that properly implements `Symbol.observable`.\n */\nexport function fromInteropObservable<T>(obj: any) {\n  return new Observable((subscriber: Subscriber<T>) => {\n    const obs = obj[Symbol_observable]();\n    if (isFunction(obs.subscribe)) {\n      return obs.subscribe(subscriber);\n    }\n    // Should be caught by observable subscribe function error handling.\n    throw new TypeError('Provided object does not correctly implement Symbol.observable');\n  });\n}\n\n/**\n * Synchronously emits the values of an array like and completes.\n * This is exported because there are creation functions and operators that need to\n * make direct use of the same logic, and there's no reason to make them run through\n * `from` conditionals because we *know* they're dealing with an array.\n * @param array The array to emit values from\n */\nexport function fromArrayLike<T>(array: ArrayLike<T>) {\n  return new Observable((subscriber: Subscriber<T>) => {\n    // Loop over the array and emit each value. Note two things here:\n    // 1. We're making sure that the subscriber is not closed on each loop.\n    //    This is so we don't continue looping over a very large array after\n    //    something like a `take`, `takeWhile`, or other synchronous unsubscription\n    //    has already unsubscribed.\n    // 2. In this form, reentrant code can alter that array we're looping over.\n    //    This is a known issue, but considered an edge case. The alternative would\n    //    be to copy the array before executing the loop, but this has\n    //    performance implications.\n    for (let i = 0; i < array.length && !subscriber.closed; i++) {\n      subscriber.next(array[i]);\n    }\n    subscriber.complete();\n  });\n}\n\nexport function fromPromise<T>(promise: PromiseLike<T>) {\n  return new Observable((subscriber: Subscriber<T>) => {\n    promise\n      .then(\n        (value) => {\n          if (!subscriber.closed) {\n            subscriber.next(value);\n            subscriber.complete();\n          }\n        },\n        (err: any) => subscriber.error(err)\n      )\n      .then(null, reportUnhandledError);\n  });\n}\n\nexport function fromIterable<T>(iterable: Iterable<T>) {\n  return new Observable((subscriber: Subscriber<T>) => {\n    for (const value of iterable) {\n      subscriber.next(value);\n      if (subscriber.closed) {\n        return;\n      }\n    }\n    subscriber.complete();\n  });\n}\n\nexport function fromAsyncIterable<T>(asyncIterable: AsyncIterable<T>) {\n  return new Observable((subscriber: Subscriber<T>) => {\n    process(asyncIterable, subscriber).catch((err) => subscriber.error(err));\n  });\n}\n\nexport function fromReadableStreamLike<T>(readableStream: ReadableStreamLike<T>) {\n  return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\n\nasync function process<T>(asyncIterable: AsyncIterable<T>, subscriber: Subscriber<T>) {\n  for await (const value of asyncIterable) {\n    subscriber.next(value);\n    // A side-effect may have closed our subscriber,\n    // check before the next iteration.\n    if (subscriber.closed) {\n      return;\n    }\n  }\n  subscriber.complete();\n}\n", "import { Subscription } from '../Subscription';\nimport { SchedulerAction, SchedulerLike } from '../types';\n\nexport function executeSchedule(\n  parentSubscription: Subscription,\n  scheduler: SchedulerLike,\n  work: () => void,\n  delay: number,\n  repeat: true\n): void;\nexport function executeSchedule(\n  parentSubscription: Subscription,\n  scheduler: SchedulerLike,\n  work: () => void,\n  delay?: number,\n  repeat?: false\n): Subscription;\n\nexport function executeSchedule(\n  parentSubscription: Subscription,\n  scheduler: SchedulerLike,\n  work: () => void,\n  delay = 0,\n  repeat = false\n): Subscription | void {\n  const scheduleSubscription = scheduler.schedule(function (this: SchedulerAction<any>) {\n    work();\n    if (repeat) {\n      parentSubscription.add(this.schedule(null, delay));\n    } else {\n      this.unsubscribe();\n    }\n  }, delay);\n\n  parentSubscription.add(scheduleSubscription);\n\n  if (!repeat) {\n    // Because user-land scheduler implementations are unlikely to properly reuse\n    // Actions for repeat scheduling, we can't trust that the returned subscription\n    // will control repeat subscription scenarios. So we're trying to avoid using them\n    // incorrectly within this library.\n    return scheduleSubscription;\n  }\n}\n", "/** @prettier */\nimport { MonoTypeOperatorFunction, SchedulerLike } from '../types';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/**\n * Re-emits all notifications from source Observable with specified scheduler.\n *\n * <span class=\"informal\">Ensure a specific scheduler is used, from outside of an Observable.</span>\n *\n * `observeOn` is an operator that accepts a scheduler as a first parameter, which will be used to reschedule\n * notifications emitted by the source Observable. It might be useful, if you do not have control over\n * internal scheduler of a given Observable, but want to control when its values are emitted nevertheless.\n *\n * Returned Observable emits the same notifications (nexted values, complete and error events) as the source Observable,\n * but rescheduled with provided scheduler. Note that this doesn't mean that source Observables internal\n * scheduler will be replaced in any way. Original scheduler still will be used, but when the source Observable emits\n * notification, it will be immediately scheduled again - this time with scheduler passed to `observeOn`.\n * An anti-pattern would be calling `observeOn` on Observable that emits lots of values synchronously, to split\n * that emissions into asynchronous chunks. For this to happen, scheduler would have to be passed into the source\n * Observable directly (usually into the operator that creates it). `observeOn` simply delays notifications a\n * little bit more, to ensure that they are emitted at expected moments.\n *\n * As a matter of fact, `observeOn` accepts second parameter, which specifies in milliseconds with what delay notifications\n * will be emitted. The main difference between {@link delay} operator and `observeOn` is that `observeOn`\n * will delay all notifications - including error notifications - while `delay` will pass through error\n * from source Observable immediately when it is emitted. In general it is highly recommended to use `delay` operator\n * for any kind of delaying of values in the stream, while using `observeOn` to specify which scheduler should be used\n * for notification emissions in general.\n *\n * ## Example\n *\n * Ensure values in subscribe are called just before browser repaint\n *\n * ```ts\n * import { interval, observeOn, animationFrameScheduler } from 'rxjs';\n *\n * const someDiv = document.createElement('div');\n * someDiv.style.cssText = 'width: 200px;background: #09c';\n * document.body.appendChild(someDiv);\n * const intervals = interval(10);      // Intervals are scheduled\n *                                      // with async scheduler by default...\n * intervals.pipe(\n *   observeOn(animationFrameScheduler) // ...but we will observe on animationFrame\n * )                                    // scheduler to ensure smooth animation.\n * .subscribe(val => {\n *   someDiv.style.height = val + 'px';\n * });\n * ```\n *\n * @see {@link delay}\n *\n * @param scheduler Scheduler that will be used to reschedule notifications from source Observable.\n * @param delay Number of milliseconds that states with what delay every notification should be rescheduled.\n * @return A function that returns an Observable that emits the same\n * notifications as the source Observable, but with provided scheduler.\n */\nexport function observeOn<T>(scheduler: SchedulerLike, delay = 0): MonoTypeOperatorFunction<T> {\n  return operate((source, subscriber) => {\n    source.subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (value) => executeSchedule(subscriber, scheduler, () => subscriber.next(value), delay),\n        () => executeSchedule(subscriber, scheduler, () => subscriber.complete(), delay),\n        (err) => executeSchedule(subscriber, scheduler, () => subscriber.error(err), delay)\n      )\n    );\n  });\n}\n", "import { MonoTypeOperatorFunction, SchedulerLike } from '../types';\nimport { operate } from '../util/lift';\n\n/**\n * Asynchronously subscribes Observers to this Observable on the specified {@link SchedulerLike}.\n *\n * With `subscribeOn` you can decide what type of scheduler a specific Observable will be using when it is subscribed to.\n *\n * Schedulers control the speed and order of emissions to observers from an Observable stream.\n *\n * ![](subscribeOn.png)\n *\n * ## Example\n *\n * Given the following code:\n *\n * ```ts\n * import { of, merge } from 'rxjs';\n *\n * const a = of(1, 2, 3);\n * const b = of(4, 5, 6);\n *\n * merge(a, b).subscribe(console.log);\n *\n * // Outputs\n * // 1\n * // 2\n * // 3\n * // 4\n * // 5\n * // 6\n * ```\n *\n * Both Observable `a` and `b` will emit their values directly and synchronously once they are subscribed to.\n *\n * If we instead use the `subscribeOn` operator declaring that we want to use the {@link asyncScheduler} for values emitted by Observable `a`:\n *\n * ```ts\n * import { of, subscribeOn, asyncScheduler, merge } from 'rxjs';\n *\n * const a = of(1, 2, 3).pipe(subscribeOn(asyncScheduler));\n * const b = of(4, 5, 6);\n *\n * merge(a, b).subscribe(console.log);\n *\n * // Outputs\n * // 4\n * // 5\n * // 6\n * // 1\n * // 2\n * // 3\n * ```\n *\n * The reason for this is that Observable `b` emits its values directly and synchronously like before\n * but the emissions from `a` are scheduled on the event loop because we are now using the {@link asyncScheduler} for that specific Observable.\n *\n * @param scheduler The {@link SchedulerLike} to perform subscription actions on.\n * @param delay A delay to pass to the scheduler to delay subscriptions\n * @return A function that returns an Observable modified so that its\n * subscriptions happen on the specified {@link SchedulerLike}.\n */\nexport function subscribeOn<T>(scheduler: SchedulerLike, delay: number = 0): MonoTypeOperatorFunction<T> {\n  return operate((source, subscriber) => {\n    subscriber.add(scheduler.schedule(() => source.subscribe(subscriber), delay));\n  });\n}\n", "import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nimport { InteropObservable, SchedulerLike } from '../types';\n\nexport function scheduleObservable<T>(input: InteropObservable<T>, scheduler: SchedulerLike) {\n  return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n", "import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nimport { SchedulerLike } from '../types';\n\nexport function schedulePromise<T>(input: PromiseLike<T>, scheduler: SchedulerLike) {\n  return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n", "import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\n\nexport function scheduleArray<T>(input: ArrayLike<T>, scheduler: SchedulerLike) {\n  return new Observable<T>((subscriber) => {\n    // The current array index.\n    let i = 0;\n    // Start iterating over the array like on a schedule.\n    return scheduler.schedule(function () {\n      if (i === input.length) {\n        // If we have hit the end of the array like in the\n        // previous job, we can complete.\n        subscriber.complete();\n      } else {\n        // Otherwise let's next the value at the current index,\n        // then increment our index.\n        subscriber.next(input[i++]);\n        // If the last emission didn't cause us to close the subscriber\n        // (via take or some side effect), reschedule the job and we'll\n        // make another pass.\n        if (!subscriber.closed) {\n          this.schedule();\n        }\n      }\n    });\n  });\n}\n", "import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from '../util/isFunction';\nimport { executeSchedule } from '../util/executeSchedule';\n\n/**\n * Used in {@link scheduled} to create an observable from an Iterable.\n * @param input The iterable to create an observable from\n * @param scheduler The scheduler to use\n */\nexport function scheduleIterable<T>(input: Iterable<T>, scheduler: SchedulerLike) {\n  return new Observable<T>((subscriber) => {\n    let iterator: Iterator<T, T>;\n\n    // Schedule the initial creation of the iterator from\n    // the iterable. This is so the code in the iterable is\n    // not called until the scheduled job fires.\n    executeSchedule(subscriber, scheduler, () => {\n      // Create the iterator.\n      iterator = (input as any)[Symbol_iterator]();\n\n      executeSchedule(\n        subscriber,\n        scheduler,\n        () => {\n          let value: T;\n          let done: boolean | undefined;\n          try {\n            // Pull the value out of the iterator\n            ({ value, done } = iterator.next());\n          } catch (err) {\n            // We got an error while pulling from the iterator\n            subscriber.error(err);\n            return;\n          }\n\n          if (done) {\n            // If it is \"done\" we just complete. This mimics the\n            // behavior of JavaScript's `for..of` consumption of\n            // iterables, which will not emit the value from an iterator\n            // result of `{ done: true: value: 'here' }`.\n            subscriber.complete();\n          } else {\n            // The iterable is not done, emit the value.\n            subscriber.next(value);\n          }\n        },\n        0,\n        true\n      );\n    });\n\n    // During finalization, if we see this iterator has a `return` method,\n    // then we know it is a Generator, and not just an Iterator. So we call\n    // the `return()` function. This will ensure that any `finally { }` blocks\n    // inside of the generator we can hit will be hit properly.\n    return () => isFunction(iterator?.return) && iterator.return();\n  });\n}\n", "import { SchedulerLike } from '../types';\nimport { Observable } from '../Observable';\nimport { executeSchedule } from '../util/executeSchedule';\n\nexport function scheduleAsyncIterable<T>(input: AsyncIterable<T>, scheduler: SchedulerLike) {\n  if (!input) {\n    throw new Error('Iterable cannot be null');\n  }\n  return new Observable<T>((subscriber) => {\n    executeSchedule(subscriber, scheduler, () => {\n      const iterator = input[Symbol.asyncIterator]();\n      executeSchedule(\n        subscriber,\n        scheduler,\n        () => {\n          iterator.next().then((result) => {\n            if (result.done) {\n              // This will remove the subscriptions from\n              // the parent subscription.\n              subscriber.complete();\n            } else {\n              subscriber.next(result.value);\n            }\n          });\n        },\n        0,\n        true\n      );\n    });\n  });\n}\n", "import { SchedulerLike, ReadableStreamLike } from '../types';\nimport { Observable } from '../Observable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\n\nexport function scheduleReadableStreamLike<T>(input: ReadableStreamLike<T>, scheduler: SchedulerLike): Observable<T> {\n  return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input), scheduler);\n}\n", "import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\nimport { ObservableInput, SchedulerLike } from '../types';\nimport { Observable } from '../Observable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isReadableStreamLike } from '../util/isReadableStreamLike';\nimport { scheduleReadableStreamLike } from './scheduleReadableStreamLike';\n\n/**\n * Converts from a common {@link ObservableInput} type to an observable where subscription and emissions\n * are scheduled on the provided scheduler.\n *\n * @see {@link from}\n * @see {@link of}\n *\n * @param input The observable, array, promise, iterable, etc you would like to schedule\n * @param scheduler The scheduler to use to schedule the subscription and emissions from\n * the returned observable.\n */\nexport function scheduled<T>(input: ObservableInput<T>, scheduler: SchedulerLike): Observable<T> {\n  if (input != null) {\n    if (isInteropObservable(input)) {\n      return scheduleObservable(input, scheduler);\n    }\n    if (isArrayLike(input)) {\n      return scheduleArray(input, scheduler);\n    }\n    if (isPromise(input)) {\n      return schedulePromise(input, scheduler);\n    }\n    if (isAsyncIterable(input)) {\n      return scheduleAsyncIterable(input, scheduler);\n    }\n    if (isIterable(input)) {\n      return scheduleIterable(input, scheduler);\n    }\n    if (isReadableStreamLike(input)) {\n      return scheduleReadableStreamLike(input, scheduler);\n    }\n  }\n  throw createInvalidObservableTypeError(input);\n}\n", "import { Observable } from '../Observable';\nimport { ObservableInput, SchedulerLike, ObservedValueOf } from '../types';\nimport { scheduled } from '../scheduled/scheduled';\nimport { innerFrom } from './innerFrom';\n\nexport function from<O extends ObservableInput<any>>(input: O): Observable<ObservedValueOf<O>>;\n/** @deprecated The `scheduler` parameter will be removed in v8. Use `scheduled`. Details: https://rxjs.dev/deprecations/scheduler-argument */\nexport function from<O extends ObservableInput<any>>(input: O, scheduler: SchedulerLike | undefined): Observable<ObservedValueOf<O>>;\n\n/**\n * Creates an Observable from an Array, an array-like object, a Promise, an iterable object, or an Observable-like object.\n *\n * <span class=\"informal\">Converts almost anything to an Observable.</span>\n *\n * ![](from.png)\n *\n * `from` converts various other objects and data types into Observables. It also converts a Promise, an array-like, or an\n * <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#iterable\" target=\"_blank\">iterable</a>\n * object into an Observable that emits the items in that promise, array, or iterable. A String, in this context, is treated\n * as an array of characters. Observable-like objects (contains a function named with the ES2015 Symbol for Observable) can also be\n * converted through this operator.\n *\n * ## Examples\n *\n * Converts an array to an Observable\n *\n * ```ts\n * import { from } from 'rxjs';\n *\n * const array = [10, 20, 30];\n * const result = from(array);\n *\n * result.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 10\n * // 20\n * // 30\n * ```\n *\n * Convert an infinite iterable (from a generator) to an Observable\n *\n * ```ts\n * import { from, take } from 'rxjs';\n *\n * function* generateDoubles(seed) {\n *    let i = seed;\n *    while (true) {\n *      yield i;\n *      i = 2 * i; // double it\n *    }\n * }\n *\n * const iterator = generateDoubles(3);\n * const result = from(iterator).pipe(take(10));\n *\n * result.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 3\n * // 6\n * // 12\n * // 24\n * // 48\n * // 96\n * // 192\n * // 384\n * // 768\n * // 1536\n * ```\n *\n * With `asyncScheduler`\n *\n * ```ts\n * import { from, asyncScheduler } from 'rxjs';\n *\n * console.log('start');\n *\n * const array = [10, 20, 30];\n * const result = from(array, asyncScheduler);\n *\n * result.subscribe(x => console.log(x));\n *\n * console.log('end');\n *\n * // Logs:\n * // 'start'\n * // 'end'\n * // 10\n * // 20\n * // 30\n * ```\n *\n * @see {@link fromEvent}\n * @see {@link fromEventPattern}\n *\n * @param input A subscription object, a Promise, an Observable-like,\n * an Array, an iterable, or an array-like object to be converted.\n * @param scheduler An optional {@link SchedulerLike} on which to schedule the emission of values.\n * @return An Observable converted from {@link ObservableInput}.\n */\nexport function from<T>(input: ObservableInput<T>, scheduler?: SchedulerLike): Observable<T> {\n  return scheduler ? scheduled(input, scheduler) : innerFrom(input);\n}\n", "import { SchedulerLike, ValueFromArray } from '../types';\nimport { Observable } from '../Observable';\nimport { popScheduler } from '../util/args';\nimport { from } from './from';\n\n// Devs are more likely to pass null or undefined than they are a scheduler\n// without accompanying values. To make things easier for (naughty) devs who\n// use the `strictNullChecks: false` TypeScript compiler option, these\n// overloads with explicit null and undefined values are included.\n\nexport function of(value: null): Observable<null>;\nexport function of(value: undefined): Observable<undefined>;\n\n/** @deprecated The `scheduler` parameter will be removed in v8. Use `scheduled`. Details: https://rxjs.dev/deprecations/scheduler-argument */\nexport function of(scheduler: SchedulerLike): Observable<never>;\n/** @deprecated The `scheduler` parameter will be removed in v8. Use `scheduled`. Details: https://rxjs.dev/deprecations/scheduler-argument */\nexport function of<A extends readonly unknown[]>(...valuesAndScheduler: [...A, SchedulerLike]): Observable<ValueFromArray<A>>;\n\nexport function of(): Observable<never>;\n/** @deprecated Do not specify explicit type parameters. Signatures with type parameters that cannot be inferred will be removed in v8. */\nexport function of<T>(): Observable<T>;\nexport function of<T>(value: T): Observable<T>;\nexport function of<A extends readonly unknown[]>(...values: A): Observable<ValueFromArray<A>>;\n\n/**\n * Converts the arguments to an observable sequence.\n *\n * <span class=\"informal\">Each argument becomes a `next` notification.</span>\n *\n * ![](of.png)\n *\n * Unlike {@link from}, it does not do any flattening and emits each argument in whole\n * as a separate `next` notification.\n *\n * ## Examples\n *\n * Emit the values `10, 20, 30`\n *\n * ```ts\n * import { of } from 'rxjs';\n *\n * of(10, 20, 30)\n *   .subscribe({\n *     next: value => console.log('next:', value),\n *     error: err => console.log('error:', err),\n *     complete: () => console.log('the end'),\n *   });\n *\n * // Outputs\n * // next: 10\n * // next: 20\n * // next: 30\n * // the end\n * ```\n *\n * Emit the array `[1, 2, 3]`\n *\n * ```ts\n * import { of } from 'rxjs';\n *\n * of([1, 2, 3])\n *   .subscribe({\n *     next: value => console.log('next:', value),\n *     error: err => console.log('error:', err),\n *     complete: () => console.log('the end'),\n *   });\n *\n * // Outputs\n * // next: [1, 2, 3]\n * // the end\n * ```\n *\n * @see {@link from}\n * @see {@link range}\n *\n * @param args A comma separated list of arguments you want to be emitted.\n * @return An Observable that synchronously emits the arguments described\n * above and then immediately completes.\n */\nexport function of<T>(...args: Array<T | SchedulerLike>): Observable<T> {\n  const scheduler = popScheduler(args);\n  return from(args as T[], scheduler);\n}\n", "import { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { SchedulerLike } from '../types';\nimport { isFunction } from '../util/isFunction';\n\n/**\n * Creates an observable that will create an error instance and push it to the consumer as an error\n * immediately upon subscription.\n *\n * <span class=\"informal\">Just errors and does nothing else</span>\n *\n * ![](throw.png)\n *\n * This creation function is useful for creating an observable that will create an error and error every\n * time it is subscribed to. Generally, inside of most operators when you might want to return an errored\n * observable, this is unnecessary. In most cases, such as in the inner return of {@link concatMap},\n * {@link mergeMap}, {@link defer}, and many others, you can simply throw the error, and RxJS will pick\n * that up and notify the consumer of the error.\n *\n * ## Example\n *\n * Create a simple observable that will create a new error with a timestamp and log it\n * and the message every time you subscribe to it\n *\n * ```ts\n * import { throwError } from 'rxjs';\n *\n * let errorCount = 0;\n *\n * const errorWithTimestamp$ = throwError(() => {\n *   const error: any = new Error(`This is error number ${ ++errorCount }`);\n *   error.timestamp = Date.now();\n *   return error;\n * });\n *\n * errorWithTimestamp$.subscribe({\n *   error: err => console.log(err.timestamp, err.message)\n * });\n *\n * errorWithTimestamp$.subscribe({\n *   error: err => console.log(err.timestamp, err.message)\n * });\n *\n * // Logs the timestamp and a new error message for each subscription\n * ```\n *\n * ### Unnecessary usage\n *\n * Using `throwError` inside of an operator or creation function\n * with a callback, is usually not necessary\n *\n * ```ts\n * import { of, concatMap, timer, throwError } from 'rxjs';\n *\n * const delays$ = of(1000, 2000, Infinity, 3000);\n *\n * delays$.pipe(\n *   concatMap(ms => {\n *     if (ms < 10000) {\n *       return timer(ms);\n *     } else {\n *       // This is probably overkill.\n *       return throwError(() => new Error(`Invalid time ${ ms }`));\n *     }\n *   })\n * )\n * .subscribe({\n *   next: console.log,\n *   error: console.error\n * });\n * ```\n *\n * You can just throw the error instead\n *\n * ```ts\n * import { of, concatMap, timer } from 'rxjs';\n *\n * const delays$ = of(1000, 2000, Infinity, 3000);\n *\n * delays$.pipe(\n *   concatMap(ms => {\n *     if (ms < 10000) {\n *       return timer(ms);\n *     } else {\n *       // Cleaner and easier to read for most folks.\n *       throw new Error(`Invalid time ${ ms }`);\n *     }\n *   })\n * )\n * .subscribe({\n *   next: console.log,\n *   error: console.error\n * });\n * ```\n *\n * @param errorFactory A factory function that will create the error instance that is pushed.\n */\nexport function throwError(errorFactory: () => any): Observable<never>;\n\n/**\n * Returns an observable that will error with the specified error immediately upon subscription.\n *\n * @param error The error instance to emit\n * @deprecated Support for passing an error value will be removed in v8. Instead, pass a factory function to `throwError(() => new Error('test'))`. This is\n * because it will create the error at the moment it should be created and capture a more appropriate stack trace. If\n * for some reason you need to create the error ahead of time, you can still do that: `const err = new Error('test'); throwError(() => err);`.\n */\nexport function throwError(error: any): Observable<never>;\n\n/**\n * Notifies the consumer of an error using a given scheduler by scheduling it at delay `0` upon subscription.\n *\n * @param errorOrErrorFactory An error instance or error factory\n * @param scheduler A scheduler to use to schedule the error notification\n * @deprecated The `scheduler` parameter will be removed in v8.\n * Use `throwError` in combination with {@link observeOn}: `throwError(() => new Error('test')).pipe(observeOn(scheduler));`.\n * Details: https://rxjs.dev/deprecations/scheduler-argument\n */\nexport function throwError(errorOrErrorFactory: any, scheduler: SchedulerLike): Observable<never>;\n\nexport function throwError(errorOrErrorFactory: any, scheduler?: SchedulerLike): Observable<never> {\n  const errorFactory = isFunction(errorOrErrorFactory) ? errorOrErrorFactory : () => errorOrErrorFactory;\n  const init = (subscriber: Subscriber<never>) => subscriber.error(errorFactory());\n  return new Observable(scheduler ? (subscriber) => scheduler.schedule(init as any, 0, subscriber) : init);\n}\n", "import { PartialObserver, ObservableNotification, CompleteNotification, NextNotification, ErrorNotification } from './types';\nimport { Observable } from './Observable';\nimport { EMPTY } from './observable/empty';\nimport { of } from './observable/of';\nimport { throwError } from './observable/throwError';\nimport { isFunction } from './util/isFunction';\n\n// TODO: When this enum is removed, replace it with a type alias. See #4556.\n/**\n * @deprecated Use a string literal instead. `NotificationKind` will be replaced with a type alias in v8.\n * It will not be replaced with a const enum as those are not compatible with isolated modules.\n */\nexport enum NotificationKind {\n  NEXT = 'N',\n  ERROR = 'E',\n  COMPLETE = 'C',\n}\n\n/**\n * Represents a push-based event or value that an {@link Observable} can emit.\n * This class is particularly useful for operators that manage notifications,\n * like {@link materialize}, {@link dematerialize}, {@link observeOn}, and\n * others. Besides wrapping the actual delivered value, it also annotates it\n * with metadata of, for instance, what type of push message it is (`next`,\n * `error`, or `complete`).\n *\n * @see {@link materialize}\n * @see {@link dematerialize}\n * @see {@link observeOn}\n * @deprecated It is NOT recommended to create instances of `Notification` directly.\n * Rather, try to create POJOs matching the signature outlined in {@link ObservableNotification}.\n * For example: `{ kind: 'N', value: 1 }`, `{ kind: 'E', error: new Error('bad') }`, or `{ kind: 'C' }`.\n * Will be removed in v8.\n */\nexport class Notification<T> {\n  /**\n   * A value signifying that the notification will \"next\" if observed. In truth,\n   * This is really synonymous with just checking `kind === \"N\"`.\n   * @deprecated Will be removed in v8. Instead, just check to see if the value of `kind` is `\"N\"`.\n   */\n  readonly hasValue: boolean;\n\n  /**\n   * Creates a \"Next\" notification object.\n   * @param kind Always `'N'`\n   * @param value The value to notify with if observed.\n   * @deprecated Internal implementation detail. Use {@link Notification#createNext createNext} instead.\n   */\n  constructor(kind: 'N', value?: T);\n  /**\n   * Creates an \"Error\" notification object.\n   * @param kind Always `'E'`\n   * @param value Always `undefined`\n   * @param error The error to notify with if observed.\n   * @deprecated Internal implementation detail. Use {@link Notification#createError createError} instead.\n   */\n  constructor(kind: 'E', value: undefined, error: any);\n  /**\n   * Creates a \"completion\" notification object.\n   * @param kind Always `'C'`\n   * @deprecated Internal implementation detail. Use {@link Notification#createComplete createComplete} instead.\n   */\n  constructor(kind: 'C');\n  constructor(public readonly kind: 'N' | 'E' | 'C', public readonly value?: T, public readonly error?: any) {\n    this.hasValue = kind === 'N';\n  }\n\n  /**\n   * Executes the appropriate handler on a passed `observer` given the `kind` of notification.\n   * If the handler is missing it will do nothing. Even if the notification is an error, if\n   * there is no error handler on the observer, an error will not be thrown, it will noop.\n   * @param observer The observer to notify.\n   */\n  observe(observer: PartialObserver<T>): void {\n    return observeNotification(this as ObservableNotification<T>, observer);\n  }\n\n  /**\n   * Executes a notification on the appropriate handler from a list provided.\n   * If a handler is missing for the kind of notification, nothing is called\n   * and no error is thrown, it will be a noop.\n   * @param next A next handler\n   * @param error An error handler\n   * @param complete A complete handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  do(next: (value: T) => void, error: (err: any) => void, complete: () => void): void;\n  /**\n   * Executes a notification on the appropriate handler from a list provided.\n   * If a handler is missing for the kind of notification, nothing is called\n   * and no error is thrown, it will be a noop.\n   * @param next A next handler\n   * @param error An error handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  do(next: (value: T) => void, error: (err: any) => void): void;\n  /**\n   * Executes the next handler if the Notification is of `kind` `\"N\"`. Otherwise\n   * this will not error, and it will be a noop.\n   * @param next The next handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  do(next: (value: T) => void): void;\n  do(nextHandler: (value: T) => void, errorHandler?: (err: any) => void, completeHandler?: () => void): void {\n    const { kind, value, error } = this;\n    return kind === 'N' ? nextHandler?.(value!) : kind === 'E' ? errorHandler?.(error) : completeHandler?.();\n  }\n\n  /**\n   * Executes a notification on the appropriate handler from a list provided.\n   * If a handler is missing for the kind of notification, nothing is called\n   * and no error is thrown, it will be a noop.\n   * @param next A next handler\n   * @param error An error handler\n   * @param complete A complete handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  accept(next: (value: T) => void, error: (err: any) => void, complete: () => void): void;\n  /**\n   * Executes a notification on the appropriate handler from a list provided.\n   * If a handler is missing for the kind of notification, nothing is called\n   * and no error is thrown, it will be a noop.\n   * @param next A next handler\n   * @param error An error handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  accept(next: (value: T) => void, error: (err: any) => void): void;\n  /**\n   * Executes the next handler if the Notification is of `kind` `\"N\"`. Otherwise\n   * this will not error, and it will be a noop.\n   * @param next The next handler\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  accept(next: (value: T) => void): void;\n\n  /**\n   * Executes the appropriate handler on a passed `observer` given the `kind` of notification.\n   * If the handler is missing it will do nothing. Even if the notification is an error, if\n   * there is no error handler on the observer, an error will not be thrown, it will noop.\n   * @param observer The observer to notify.\n   * @deprecated Replaced with {@link Notification#observe observe}. Will be removed in v8.\n   */\n  accept(observer: PartialObserver<T>): void;\n  accept(nextOrObserver: PartialObserver<T> | ((value: T) => void), error?: (err: any) => void, complete?: () => void) {\n    return isFunction((nextOrObserver as any)?.next)\n      ? this.observe(nextOrObserver as PartialObserver<T>)\n      : this.do(nextOrObserver as (value: T) => void, error as any, complete as any);\n  }\n\n  /**\n   * Returns a simple Observable that just delivers the notification represented\n   * by this Notification instance.\n   *\n   * @deprecated Will be removed in v8. To convert a `Notification` to an {@link Observable},\n   * use {@link of} and {@link dematerialize}: `of(notification).pipe(dematerialize())`.\n   */\n  toObservable(): Observable<T> {\n    const { kind, value, error } = this;\n    // Select the observable to return by `kind`\n    const result =\n      kind === 'N'\n        ? // Next kind. Return an observable of that value.\n          of(value!)\n        : //\n        kind === 'E'\n        ? // Error kind. Return an observable that emits the error.\n          throwError(() => error)\n        : //\n        kind === 'C'\n        ? // Completion kind. Kind is \"C\", return an observable that just completes.\n          EMPTY\n        : // Unknown kind, return falsy, so we error below.\n          0;\n    if (!result) {\n      // TODO: consider removing this check. The only way to cause this would be to\n      // use the Notification constructor directly in a way that is not type-safe.\n      // and direct use of the Notification constructor is deprecated.\n      throw new TypeError(`Unexpected notification kind ${kind}`);\n    }\n    return result;\n  }\n\n  private static completeNotification = new Notification('C') as Notification<never> & CompleteNotification;\n  /**\n   * A shortcut to create a Notification instance of the type `next` from a\n   * given value.\n   * @param value The `next` value.\n   * @return The \"next\" Notification representing the argument.\n   * @deprecated It is NOT recommended to create instances of `Notification` directly.\n   * Rather, try to create POJOs matching the signature outlined in {@link ObservableNotification}.\n   * For example: `{ kind: 'N', value: 1 }`, `{ kind: 'E', error: new Error('bad') }`, or `{ kind: 'C' }`.\n   * Will be removed in v8.\n   */\n  static createNext<T>(value: T) {\n    return new Notification('N', value) as Notification<T> & NextNotification<T>;\n  }\n\n  /**\n   * A shortcut to create a Notification instance of the type `error` from a\n   * given error.\n   * @param err The `error` error.\n   * @return The \"error\" Notification representing the argument.\n   * @deprecated It is NOT recommended to create instances of `Notification` directly.\n   * Rather, try to create POJOs matching the signature outlined in {@link ObservableNotification}.\n   * For example: `{ kind: 'N', value: 1 }`, `{ kind: 'E', error: new Error('bad') }`, or `{ kind: 'C' }`.\n   * Will be removed in v8.\n   */\n  static createError(err?: any) {\n    return new Notification('E', undefined, err) as Notification<never> & ErrorNotification;\n  }\n\n  /**\n   * A shortcut to create a Notification instance of the type `complete`.\n   * @return The valueless \"complete\" Notification.\n   * @deprecated It is NOT recommended to create instances of `Notification` directly.\n   * Rather, try to create POJOs matching the signature outlined in {@link ObservableNotification}.\n   * For example: `{ kind: 'N', value: 1 }`, `{ kind: 'E', error: new Error('bad') }`, or `{ kind: 'C' }`.\n   * Will be removed in v8.\n   */\n  static createComplete(): Notification<never> & CompleteNotification {\n    return Notification.completeNotification;\n  }\n}\n\n/**\n * Executes the appropriate handler on a passed `observer` given the `kind` of notification.\n * If the handler is missing it will do nothing. Even if the notification is an error, if\n * there is no error handler on the observer, an error will not be thrown, it will noop.\n * @param notification The notification object to observe.\n * @param observer The observer to notify.\n */\nexport function observeNotification<T>(notification: ObservableNotification<T>, observer: PartialObserver<T>) {\n  const { kind, value, error } = notification as any;\n  if (typeof kind !== 'string') {\n    throw new TypeError('Invalid notification, missing \"kind\"');\n  }\n  kind === 'N' ? observer.next?.(value!) : kind === 'E' ? observer.error?.(error) : observer.complete?.();\n}\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface EmptyError extends Error {}\n\nexport interface EmptyErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (): EmptyError;\n}\n\n/**\n * An error thrown when an Observable or a sequence was queried but has no\n * elements.\n *\n * @see {@link first}\n * @see {@link last}\n * @see {@link single}\n * @see {@link firstValueFrom}\n * @see {@link lastValueFrom}\n */\nexport const EmptyError: EmptyErrorCtor = createErrorClass(\n  (_super) =>\n    function EmptyErrorImpl(this: any) {\n      _super(this);\n      this.name = 'EmptyError';\n      this.message = 'no elements in sequence';\n    }\n);\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface ArgumentOutOfRangeError extends Error {}\n\nexport interface ArgumentOutOfRangeErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (): ArgumentOutOfRangeError;\n}\n\n/**\n * An error thrown when an element was queried at a certain index of an\n * Observable, but no such index or position exists in that sequence.\n *\n * @see {@link elementAt}\n * @see {@link take}\n * @see {@link takeLast}\n */\nexport const ArgumentOutOfRangeError: ArgumentOutOfRangeErrorCtor = createErrorClass(\n  (_super) =>\n    function ArgumentOutOfRangeErrorImpl(this: any) {\n      _super(this);\n      this.name = 'ArgumentOutOfRangeError';\n      this.message = 'argument out of range';\n    }\n);\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface NotFoundError extends Error {}\n\nexport interface NotFoundErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (message: string): NotFoundError;\n}\n\n/**\n * An error thrown when a value or values are missing from an\n * observable sequence.\n *\n * @see {@link operators/single}\n */\nexport const NotFoundError: NotFoundErrorCtor = createErrorClass(\n  (_super) =>\n    function NotFoundErrorImpl(this: any, message: string) {\n      _super(this);\n      this.name = 'NotFoundError';\n      this.message = message;\n    }\n);\n", "import { createErrorClass } from './createErrorClass';\n\nexport interface SequenceError extends Error {}\n\nexport interface SequenceErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new (message: string): SequenceError;\n}\n\n/**\n * An error thrown when something is wrong with the sequence of\n * values arriving on the observable.\n *\n * @see {@link operators/single}\n */\nexport const SequenceError: SequenceErrorCtor = createErrorClass(\n  (_super) =>\n    function SequenceErrorImpl(this: any, message: string) {\n      _super(this);\n      this.name = 'SequenceError';\n      this.message = message;\n    }\n);\n", "/**\n * Checks to see if a value is not only a `Date` object,\n * but a *valid* `Date` object that can be converted to a\n * number. For example, `new Date('blah')` is indeed an\n * `instanceof Date`, however it cannot be converted to a\n * number.\n */\nexport function isValidDate(value: any): value is Date {\n  return value instanceof Date && !isNaN(value as any);\n}\n", "import { asyncScheduler } from '../scheduler/async';\nimport { MonoTypeOperatorFunction, SchedulerLike, OperatorFunction, ObservableInput, ObservedValueOf } from '../types';\nimport { isValidDate } from '../util/isDate';\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { Observable } from '../Observable';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\n\nexport interface TimeoutConfig<T, O extends ObservableInput<unknown> = ObservableInput<T>, M = unknown> {\n  /**\n   * The time allowed between values from the source before timeout is triggered.\n   */\n  each?: number;\n\n  /**\n   * The relative time as a `number` in milliseconds, or a specific time as a `Date` object,\n   * by which the first value must arrive from the source before timeout is triggered.\n   */\n  first?: number | Date;\n\n  /**\n   * The scheduler to use with time-related operations within this operator. Defaults to {@link asyncScheduler}\n   */\n  scheduler?: SchedulerLike;\n\n  /**\n   * A factory used to create observable to switch to when timeout occurs. Provides\n   * a {@link TimeoutInfo} about the source observable's emissions and what delay or\n   * exact time triggered the timeout.\n   */\n  with?: (info: TimeoutInfo<T, M>) => O;\n\n  /**\n   * Optional additional metadata you can provide to code that handles\n   * the timeout, will be provided through the {@link TimeoutError}.\n   * This can be used to help identify the source of a timeout or pass along\n   * other information related to the timeout.\n   */\n  meta?: M;\n}\n\nexport interface TimeoutInfo<T, M = unknown> {\n  /** Optional metadata that was provided to the timeout configuration. */\n  readonly meta: M;\n  /** The number of messages seen before the timeout */\n  readonly seen: number;\n  /** The last message seen */\n  readonly lastValue: T | null;\n}\n\n/**\n * An error emitted when a timeout occurs.\n */\nexport interface TimeoutError<T = unknown, M = unknown> extends Error {\n  /**\n   * The information provided to the error by the timeout\n   * operation that created the error. Will be `null` if\n   * used directly in non-RxJS code with an empty constructor.\n   * (Note that using this constructor directly is not recommended,\n   * you should create your own errors)\n   */\n  info: TimeoutInfo<T, M> | null;\n}\n\nexport interface TimeoutErrorCtor {\n  /**\n   * @deprecated Internal implementation detail. Do not construct error instances.\n   * Cannot be tagged as internal: https://github.com/ReactiveX/rxjs/issues/6269\n   */\n  new <T = unknown, M = unknown>(info?: TimeoutInfo<T, M>): TimeoutError<T, M>;\n}\n\n/**\n * An error thrown by the {@link timeout} operator.\n *\n * Provided so users can use as a type and do quality comparisons.\n * We recommend you do not subclass this or create instances of this class directly.\n * If you have need of a error representing a timeout, you should\n * create your own error class and use that.\n *\n * @see {@link timeout}\n */\nexport const TimeoutError: TimeoutErrorCtor = createErrorClass(\n  (_super) =>\n    function TimeoutErrorImpl(this: any, info: TimeoutInfo<any> | null = null) {\n      _super(this);\n      this.message = 'Timeout has occurred';\n      this.name = 'TimeoutError';\n      this.info = info;\n    }\n);\n\n/**\n * If `with` is provided, this will return an observable that will switch to a different observable if the source\n * does not push values within the specified time parameters.\n *\n * <span class=\"informal\">The most flexible option for creating a timeout behavior.</span>\n *\n * The first thing to know about the configuration is if you do not provide a `with` property to the configuration,\n * when timeout conditions are met, this operator will emit a {@link TimeoutError}. Otherwise, it will use the factory\n * function provided by `with`, and switch your subscription to the result of that. Timeout conditions are provided by\n * the settings in `first` and `each`.\n *\n * The `first` property can be either a `Date` for a specific time, a `number` for a time period relative to the\n * point of subscription, or it can be skipped. This property is to check timeout conditions for the arrival of\n * the first value from the source _only_. The timings of all subsequent values  from the source will be checked\n * against the time period provided by `each`, if it was provided.\n *\n * The `each` property can be either a `number` or skipped. If a value for `each` is provided, it represents the amount of\n * time the resulting observable will wait between the arrival of values from the source before timing out. Note that if\n * `first` is _not_ provided, the value from `each` will be used to check timeout conditions for the arrival of the first\n * value and all subsequent values. If `first` _is_ provided, `each` will only be use to check all values after the first.\n *\n * ## Examples\n *\n * Emit a custom error if there is too much time between values\n *\n * ```ts\n * import { interval, timeout, throwError } from 'rxjs';\n *\n * class CustomTimeoutError extends Error {\n *   constructor() {\n *     super('It was too slow');\n *     this.name = 'CustomTimeoutError';\n *   }\n * }\n *\n * const slow$ = interval(900);\n *\n * slow$.pipe(\n *   timeout({\n *     each: 1000,\n *     with: () => throwError(() => new CustomTimeoutError())\n *   })\n * )\n * .subscribe({\n *   error: console.error\n * });\n * ```\n *\n * Switch to a faster observable if your source is slow.\n *\n * ```ts\n * import { interval, timeout } from 'rxjs';\n *\n * const slow$ = interval(900);\n * const fast$ = interval(500);\n *\n * slow$.pipe(\n *   timeout({\n *     each: 1000,\n *     with: () => fast$,\n *   })\n * )\n * .subscribe(console.log);\n * ```\n * @param config The configuration for the timeout.\n */\nexport function timeout<T, O extends ObservableInput<unknown>, M = unknown>(\n  config: TimeoutConfig<T, O, M> & { with: (info: TimeoutInfo<T, M>) => O }\n): OperatorFunction<T, T | ObservedValueOf<O>>;\n\n/**\n * Returns an observable that will error or switch to a different observable if the source does not push values\n * within the specified time parameters.\n *\n * <span class=\"informal\">The most flexible option for creating a timeout behavior.</span>\n *\n * The first thing to know about the configuration is if you do not provide a `with` property to the configuration,\n * when timeout conditions are met, this operator will emit a {@link TimeoutError}. Otherwise, it will use the factory\n * function provided by `with`, and switch your subscription to the result of that. Timeout conditions are provided by\n * the settings in `first` and `each`.\n *\n * The `first` property can be either a `Date` for a specific time, a `number` for a time period relative to the\n * point of subscription, or it can be skipped. This property is to check timeout conditions for the arrival of\n * the first value from the source _only_. The timings of all subsequent values  from the source will be checked\n * against the time period provided by `each`, if it was provided.\n *\n * The `each` property can be either a `number` or skipped. If a value for `each` is provided, it represents the amount of\n * time the resulting observable will wait between the arrival of values from the source before timing out. Note that if\n * `first` is _not_ provided, the value from `each` will be used to check timeout conditions for the arrival of the first\n * value and all subsequent values. If `first` _is_ provided, `each` will only be use to check all values after the first.\n *\n * ### Handling TimeoutErrors\n *\n * If no `with` property was provided, subscriptions to the resulting observable may emit an error of {@link TimeoutError}.\n * The timeout error provides useful information you can examine when you're handling the error. The most common way to handle\n * the error would be with {@link catchError}, although you could use {@link tap} or just the error handler in your `subscribe` call\n * directly, if your error handling is only a side effect (such as notifying the user, or logging).\n *\n * In this case, you would check the error for `instanceof TimeoutError` to validate that the error was indeed from `timeout`, and\n * not from some other source. If it's not from `timeout`, you should probably rethrow it if you're in a `catchError`.\n *\n * ## Examples\n *\n * Emit a {@link TimeoutError} if the first value, and _only_ the first value, does not arrive within 5 seconds\n *\n * ```ts\n * import { interval, timeout } from 'rxjs';\n *\n * // A random interval that lasts between 0 and 10 seconds per tick\n * const source$ = interval(Math.round(Math.random() * 10_000));\n *\n * source$.pipe(\n *   timeout({ first: 5_000 })\n * )\n * .subscribe({\n *   next: console.log,\n *   error: console.error\n * });\n * ```\n *\n * Emit a {@link TimeoutError} if the source waits longer than 5 seconds between any two values or the first value\n * and subscription.\n *\n * ```ts\n * import { timer, timeout, expand } from 'rxjs';\n *\n * const getRandomTime = () => Math.round(Math.random() * 10_000);\n *\n * // An observable that waits a random amount of time between each delivered value\n * const source$ = timer(getRandomTime())\n *   .pipe(expand(() => timer(getRandomTime())));\n *\n * source$\n *   .pipe(timeout({ each: 5_000 }))\n *   .subscribe({\n *     next: console.log,\n *     error: console.error\n *   });\n * ```\n *\n * Emit a {@link TimeoutError} if the source does not emit before 7 seconds, _or_ if the source waits longer than\n * 5 seconds between any two values after the first.\n *\n * ```ts\n * import { timer, timeout, expand } from 'rxjs';\n *\n * const getRandomTime = () => Math.round(Math.random() * 10_000);\n *\n * // An observable that waits a random amount of time between each delivered value\n * const source$ = timer(getRandomTime())\n *   .pipe(expand(() => timer(getRandomTime())));\n *\n * source$\n *   .pipe(timeout({ first: 7_000, each: 5_000 }))\n *   .subscribe({\n *     next: console.log,\n *     error: console.error\n *   });\n * ```\n */\nexport function timeout<T, M = unknown>(config: Omit<TimeoutConfig<T, any, M>, 'with'>): OperatorFunction<T, T>;\n\n/**\n * Returns an observable that will error if the source does not push its first value before the specified time passed as a `Date`.\n * This is functionally the same as `timeout({ first: someDate })`.\n *\n * <span class=\"informal\">Errors if the first value doesn't show up before the given date and time</span>\n *\n * ![](timeout.png)\n *\n * @param first The date to at which the resulting observable will timeout if the source observable\n * does not emit at least one value.\n * @param scheduler The scheduler to use. Defaults to {@link asyncScheduler}.\n */\nexport function timeout<T>(first: Date, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n\n/**\n * Returns an observable that will error if the source does not push a value within the specified time in milliseconds.\n * This is functionally the same as `timeout({ each: milliseconds })`.\n *\n * <span class=\"informal\">Errors if it waits too long between any value</span>\n *\n * ![](timeout.png)\n *\n * @param each The time allowed between each pushed value from the source before the resulting observable\n * will timeout.\n * @param scheduler The scheduler to use. Defaults to {@link asyncScheduler}.\n */\nexport function timeout<T>(each: number, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n\n/**\n *\n * Errors if Observable does not emit a value in given time span.\n *\n * <span class=\"informal\">Timeouts on Observable that doesn't emit values fast enough.</span>\n *\n * ![](timeout.png)\n *\n * @see {@link timeoutWith}\n *\n * @return A function that returns an Observable that mirrors behaviour of the\n * source Observable, unless timeout happens when it throws an error.\n */\nexport function timeout<T, O extends ObservableInput<any>, M>(\n  config: number | Date | TimeoutConfig<T, O, M>,\n  schedulerArg?: SchedulerLike\n): OperatorFunction<T, T | ObservedValueOf<O>> {\n  // Intentionally terse code.\n  // If the first argument is a valid `Date`, then we use it as the `first` config.\n  // Otherwise, if the first argument is a `number`, then we use it as the `each` config.\n  // Otherwise, it can be assumed the first argument is the configuration object itself, and\n  // we destructure that into what we're going to use, setting important defaults as we do.\n  // NOTE: The default for `scheduler` will be the `scheduler` argument if it exists, or\n  // it will default to the `asyncScheduler`.\n  const {\n    first,\n    each,\n    with: _with = timeoutErrorFactory,\n    scheduler = schedulerArg ?? asyncScheduler,\n    meta = null!,\n  } = (isValidDate(config) ? { first: config } : typeof config === 'number' ? { each: config } : config) as TimeoutConfig<T, O, M>;\n\n  if (first == null && each == null) {\n    // Ensure timeout was provided at runtime.\n    throw new TypeError('No timeout provided.');\n  }\n\n  return operate((source, subscriber) => {\n    // This subscription encapsulates our subscription to the\n    // source for this operator. We're capturing it separately,\n    // because if there is a `with` observable to fail over to,\n    // we want to unsubscribe from our original subscription, and\n    // hand of the subscription to that one.\n    let originalSourceSubscription: Subscription;\n    // The subscription for our timeout timer. This changes\n    // every time we get a new value.\n    let timerSubscription: Subscription;\n    // A bit of state we pass to our with and error factories to\n    // tell what the last value we saw was.\n    let lastValue: T | null = null;\n    // A bit of state we pass to the with and error factories to\n    // tell how many values we have seen so far.\n    let seen = 0;\n    const startTimer = (delay: number) => {\n      timerSubscription = executeSchedule(\n        subscriber,\n        scheduler,\n        () => {\n          try {\n            originalSourceSubscription.unsubscribe();\n            innerFrom(\n              _with!({\n                meta,\n                lastValue,\n                seen,\n              })\n            ).subscribe(subscriber);\n          } catch (err) {\n            subscriber.error(err);\n          }\n        },\n        delay\n      );\n    };\n\n    originalSourceSubscription = source.subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (value: T) => {\n          // clear the timer so we can emit and start another one.\n          timerSubscription?.unsubscribe();\n          seen++;\n          // Emit\n          subscriber.next((lastValue = value));\n          // null | undefined are both < 0. Thanks, JavaScript.\n          each! > 0 && startTimer(each!);\n        },\n        undefined,\n        undefined,\n        () => {\n          if (!timerSubscription?.closed) {\n            timerSubscription?.unsubscribe();\n          }\n          // Be sure not to hold the last value in memory after unsubscription\n          // it could be quite large.\n          lastValue = null;\n        }\n      )\n    );\n\n    // Intentionally terse code.\n    // If we've `seen` a value, that means the \"first\" clause was met already, if it existed.\n    //   it also means that a timer was already started for \"each\" (in the next handler above).\n    // If `first` was provided, and it's a number, then use it.\n    // If `first` was provided and it's not a number, it's a Date, and we get the difference between it and \"now\".\n    // If `first` was not provided at all, then our first timer will be the value from `each`.\n    !seen && startTimer(first != null ? (typeof first === 'number' ? first : +first - scheduler!.now()) : each!);\n  });\n}\n\n/**\n * The default function to use to emit an error when timeout occurs and a `with` function\n * is not specified.\n * @param info The information about the timeout to pass along to the error\n */\nfunction timeoutErrorFactory(info: TimeoutInfo<any>): Observable<never> {\n  throw new TimeoutError(info);\n}\n", "import { OperatorFunction } from '../types';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\nexport function map<T, R>(project: (value: T, index: number) => R): OperatorFunction<T, R>;\n/** @deprecated Use a closure instead of a `thisArg`. Signatures accepting a `thisArg` will be removed in v8. */\nexport function map<T, R, A>(project: (this: A, value: T, index: number) => R, thisArg: A): OperatorFunction<T, R>;\n\n/**\n * Applies a given `project` function to each value emitted by the source\n * Observable, and emits the resulting values as an Observable.\n *\n * <span class=\"informal\">Like [Array.prototype.map()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map),\n * it passes each source value through a transformation function to get\n * corresponding output values.</span>\n *\n * ![](map.png)\n *\n * Similar to the well known `Array.prototype.map` function, this operator\n * applies a projection to each value and emits that projection in the output\n * Observable.\n *\n * ## Example\n *\n * Map every click to the `clientX` position of that click\n *\n * ```ts\n * import { fromEvent, map } from 'rxjs';\n *\n * const clicks = fromEvent<PointerEvent>(document, 'click');\n * const positions = clicks.pipe(map(ev => ev.clientX));\n *\n * positions.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link mapTo}\n * @see {@link pluck}\n *\n * @param project The function to apply to each `value` emitted by the source\n * Observable. The `index` parameter is the number `i` for the i-th emission\n * that has happened since the subscription, starting from the number `0`.\n * @param thisArg An optional argument to define what `this` is in the\n * `project` function.\n * @return A function that returns an Observable that emits the values from the\n * source Observable transformed by the given `project` function.\n */\nexport function map<T, R>(project: (value: T, index: number) => R, thisArg?: any): OperatorFunction<T, R> {\n  return operate((source, subscriber) => {\n    // The index of the value from the source. Used with projection.\n    let index = 0;\n    // Subscribe to the source, all errors and completions are sent along\n    // to the consumer.\n    source.subscribe(\n      createOperatorSubscriber(subscriber, (value: T) => {\n        // Call the projection function with the appropriate this context,\n        // and send the resulting value to the consumer.\n        subscriber.next(project.call(thisArg, value, index++));\n      })\n    );\n  });\n}\n", "import { OperatorFunction } from \"../types\";\nimport { map } from \"../operators/map\";\n\nconst { isArray } = Array;\n\nfunction callOrApply<T, R>(fn: ((...values: T[]) => R), args: T|T[]): R {\n    return isArray(args) ? fn(...args) : fn(args);\n}\n\n/**\n * Used in several -- mostly deprecated -- situations where we need to \n * apply a list of arguments or a single argument to a result selector.\n */\nexport function mapOneOrManyArgs<T, R>(fn: ((...values: T[]) => R)): OperatorFunction<T|T[], R> {\n    return map(args => callOrApply(fn, args))\n}", "const { isArray } = Array;\nconst { getPrototypeOf, prototype: objectProto, keys: getKeys } = Object;\n\n/**\n * Used in functions where either a list of arguments, a single array of arguments, or a\n * dictionary of arguments can be returned. Returns an object with an `args` property with\n * the arguments in an array, if it is a dictionary, it will also return the `keys` in another\n * property.\n */\nexport function argsArgArrayOrObject<T, O extends Record<string, T>>(args: T[] | [O] | [T[]]): { args: T[]; keys: string[] | null } {\n  if (args.length === 1) {\n    const first = args[0];\n    if (isArray(first)) {\n      return { args: first, keys: null };\n    }\n    if (isPOJO(first)) {\n      const keys = getKeys(first);\n      return {\n        args: keys.map((key) => first[key]),\n        keys,\n      };\n    }\n  }\n\n  return { args: args as T[], keys: null };\n}\n\nfunction isPOJO(obj: any): obj is object {\n  return obj && typeof obj === 'object' && getPrototypeOf(obj) === objectProto;\n}\n", "import { Observable } from '../Observable';\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subscriber } from '../Subscriber';\nimport { ObservableInput, SchedulerLike } from '../types';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/**\n * A process embodying the general \"merge\" strategy. This is used in\n * `mergeMap` and `mergeScan` because the logic is otherwise nearly identical.\n * @param source The original source observable\n * @param subscriber The consumer subscriber\n * @param project The projection function to get our inner sources\n * @param concurrent The number of concurrent inner subscriptions\n * @param onBeforeNext Additional logic to apply before nexting to our consumer\n * @param expand If `true` this will perform an \"expand\" strategy, which differs only\n * in that it recurses, and the inner subscription must be schedule-able.\n * @param innerSubScheduler A scheduler to use to schedule inner subscriptions,\n * this is to support the expand strategy, mostly, and should be deprecated\n */\nexport function mergeInternals<T, R>(\n  source: Observable<T>,\n  subscriber: Subscriber<R>,\n  project: (value: T, index: number) => ObservableInput<R>,\n  concurrent: number,\n  onBeforeNext?: (innerValue: R) => void,\n  expand?: boolean,\n  innerSubScheduler?: SchedulerLike,\n  additionalFinalizer?: () => void\n) {\n  // Buffered values, in the event of going over our concurrency limit\n  const buffer: T[] = [];\n  // The number of active inner subscriptions.\n  let active = 0;\n  // An index to pass to our accumulator function\n  let index = 0;\n  // Whether or not the outer source has completed.\n  let isComplete = false;\n\n  /**\n   * Checks to see if we can complete our result or not.\n   */\n  const checkComplete = () => {\n    // If the outer has completed, and nothing is left in the buffer,\n    // and we don't have any active inner subscriptions, then we can\n    // Emit the state and complete.\n    if (isComplete && !buffer.length && !active) {\n      subscriber.complete();\n    }\n  };\n\n  // If we're under our concurrency limit, just start the inner subscription, otherwise buffer and wait.\n  const outerNext = (value: T) => (active < concurrent ? doInnerSub(value) : buffer.push(value));\n\n  const doInnerSub = (value: T) => {\n    // If we're expanding, we need to emit the outer values and the inner values\n    // as the inners will \"become outers\" in a way as they are recursively fed\n    // back to the projection mechanism.\n    expand && subscriber.next(value as any);\n\n    // Increment the number of active subscriptions so we can track it\n    // against our concurrency limit later.\n    active++;\n\n    // A flag used to show that the inner observable completed.\n    // This is checked during finalization to see if we should\n    // move to the next item in the buffer, if there is on.\n    let innerComplete = false;\n\n    // Start our inner subscription.\n    innerFrom(project(value, index++)).subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (innerValue) => {\n          // `mergeScan` has additional handling here. For example\n          // taking the inner value and updating state.\n          onBeforeNext?.(innerValue);\n\n          if (expand) {\n            // If we're expanding, then just recurse back to our outer\n            // handler. It will emit the value first thing.\n            outerNext(innerValue as any);\n          } else {\n            // Otherwise, emit the inner value.\n            subscriber.next(innerValue);\n          }\n        },\n        () => {\n          // Flag that we have completed, so we know to check the buffer\n          // during finalization.\n          innerComplete = true;\n        },\n        // Errors are passed to the destination.\n        undefined,\n        () => {\n          // During finalization, if the inner completed (it wasn't errored or\n          // cancelled), then we want to try the next item in the buffer if\n          // there is one.\n          if (innerComplete) {\n            // We have to wrap this in a try/catch because it happens during\n            // finalization, possibly asynchronously, and we want to pass\n            // any errors that happen (like in a projection function) to\n            // the outer Subscriber.\n            try {\n              // INNER SOURCE COMPLETE\n              // Decrement the active count to ensure that the next time\n              // we try to call `doInnerSub`, the number is accurate.\n              active--;\n              // If we have more values in the buffer, try to process those\n              // Note that this call will increment `active` ahead of the\n              // next conditional, if there were any more inner subscriptions\n              // to start.\n              while (buffer.length && active < concurrent) {\n                const bufferedValue = buffer.shift()!;\n                // Particularly for `expand`, we need to check to see if a scheduler was provided\n                // for when we want to start our inner subscription. Otherwise, we just start\n                // are next inner subscription.\n                if (innerSubScheduler) {\n                  executeSchedule(subscriber, innerSubScheduler, () => doInnerSub(bufferedValue));\n                } else {\n                  doInnerSub(bufferedValue);\n                }\n              }\n              // Check to see if we can complete, and complete if so.\n              checkComplete();\n            } catch (err) {\n              subscriber.error(err);\n            }\n          }\n        }\n      )\n    );\n  };\n\n  // Subscribe to our source observable.\n  source.subscribe(\n    createOperatorSubscriber(subscriber, outerNext, () => {\n      // Outer completed, make a note of it, and check to see if we can complete everything.\n      isComplete = true;\n      checkComplete();\n    })\n  );\n\n  // Additional finalization (for when the destination is torn down).\n  // Other finalization is added implicitly via subscription above.\n  return () => {\n    additionalFinalizer?.();\n  };\n}\n", "import { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\nimport { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\n\n/* tslint:disable:max-line-length */\nexport function mergeMap<T, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  concurrent?: number\n): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated The `resultSelector` parameter will be removed in v8. Use an inner `map` instead. Details: https://rxjs.dev/deprecations/resultSelector */\nexport function mergeMap<T, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector: undefined,\n  concurrent?: number\n): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated The `resultSelector` parameter will be removed in v8. Use an inner `map` instead. Details: https://rxjs.dev/deprecations/resultSelector */\nexport function mergeMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R,\n  concurrent?: number\n): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link mergeAll}.</span>\n *\n * ![](mergeMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an Observable, and then merging those resulting Observables and\n * emitting the results of this merger.\n *\n * ## Example\n *\n * Map and flatten each letter to an Observable ticking every 1 second\n *\n * ```ts\n * import { of, mergeMap, interval, map } from 'rxjs';\n *\n * const letters = of('a', 'b', 'c');\n * const result = letters.pipe(\n *   mergeMap(x => interval(1000).pipe(map(i => x + i)))\n * );\n *\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // a0\n * // b0\n * // c0\n * // a1\n * // b1\n * // c1\n * // continues to list a, b, c every second with respective ascending integers\n * ```\n *\n * @see {@link concatMap}\n * @see {@link exhaustMap}\n * @see {@link merge}\n * @see {@link mergeAll}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n * @see {@link switchMap}\n *\n * @param project A function that, when applied to an item emitted by the source\n * Observable, returns an Observable.\n * @param concurrent Maximum number of `ObservableInput`s being subscribed to concurrently.\n * @return A function that returns an Observable that emits the result of\n * applying the projection function (and the optional deprecated\n * `resultSelector`) to each item emitted by the source Observable and merging\n * the results of the Observables obtained from this transformation.\n */\nexport function mergeMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: ((outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R) | number,\n  concurrent: number = Infinity\n): OperatorFunction<T, ObservedValueOf<O> | R> {\n  if (isFunction(resultSelector)) {\n    // DEPRECATED PATH\n    return mergeMap((a, i) => map((b: any, ii: number) => resultSelector(a, b, i, ii))(innerFrom(project(a, i))), concurrent);\n  } else if (typeof resultSelector === 'number') {\n    concurrent = resultSelector;\n  }\n\n  return operate((source, subscriber) => mergeInternals(source, subscriber, project, concurrent));\n}\n", "import { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nimport { OperatorFunction, ObservableInput, ObservedValueOf } from '../types';\n\n/**\n * Converts a higher-order Observable into a first-order Observable which\n * concurrently delivers all values that are emitted on the inner Observables.\n *\n * <span class=\"informal\">Flattens an Observable-of-Observables.</span>\n *\n * ![](mergeAll.png)\n *\n * `mergeAll` subscribes to an Observable that emits Observables, also known as\n * a higher-order Observable. Each time it observes one of these emitted inner\n * Observables, it subscribes to that and delivers all the values from the\n * inner Observable on the output Observable. The output Observable only\n * completes once all inner Observables have completed. Any error delivered by\n * a inner Observable will be immediately emitted on the output Observable.\n *\n * ## Examples\n *\n * Spawn a new interval Observable for each click event, and blend their outputs as one Observable\n *\n * ```ts\n * import { fromEvent, map, interval, mergeAll } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(map(() => interval(1000)));\n * const firstOrder = higherOrder.pipe(mergeAll());\n *\n * firstOrder.subscribe(x => console.log(x));\n * ```\n *\n * Count from 0 to 9 every second for each click, but only allow 2 concurrent timers\n *\n * ```ts\n * import { fromEvent, map, interval, take, mergeAll } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(\n *   map(() => interval(1000).pipe(take(10)))\n * );\n * const firstOrder = higherOrder.pipe(mergeAll(2));\n *\n * firstOrder.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link combineLatestAll}\n * @see {@link concatAll}\n * @see {@link exhaustAll}\n * @see {@link merge}\n * @see {@link mergeMap}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n * @see {@link switchAll}\n * @see {@link switchMap}\n * @see {@link zipAll}\n *\n * @param concurrent Maximum number of inner Observables being subscribed to\n * concurrently.\n * @return A function that returns an Observable that emits values coming from\n * all the inner Observables emitted by the source Observable.\n */\nexport function mergeAll<O extends ObservableInput<any>>(concurrent: number = Infinity): OperatorFunction<O, ObservedValueOf<O>> {\n  return mergeMap(identity, concurrent);\n}\n", "import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\n\n/**\n * Creates an observable that will wait for a specified time period, or exact date, before\n * emitting the number 0.\n *\n * <span class=\"informal\">Used to emit a notification after a delay.</span>\n *\n * This observable is useful for creating delays in code, or racing against other values\n * for ad-hoc timeouts.\n *\n * The `delay` is specified by default in milliseconds, however providing a custom scheduler could\n * create a different behavior.\n *\n * ## Examples\n *\n * Wait 3 seconds and start another observable\n *\n * You might want to use `timer` to delay subscription to an\n * observable by a set amount of time. Here we use a timer with\n * {@link concatMapTo} or {@link concatMap} in order to wait\n * a few seconds and start a subscription to a source.\n *\n * ```ts\n * import { of, timer, concatMap } from 'rxjs';\n *\n * // This could be any observable\n * const source = of(1, 2, 3);\n *\n * timer(3000)\n *   .pipe(concatMap(() => source))\n *   .subscribe(console.log);\n * ```\n *\n * Take all values until the start of the next minute\n *\n * Using a `Date` as the trigger for the first emission, you can\n * do things like wait until midnight to fire an event, or in this case,\n * wait until a new minute starts (chosen so the example wouldn't take\n * too long to run) in order to stop watching a stream. Leveraging\n * {@link takeUntil}.\n *\n * ```ts\n * import { interval, takeUntil, timer } from 'rxjs';\n *\n * // Build a Date object that marks the\n * // next minute.\n * const currentDate = new Date();\n * const startOfNextMinute = new Date(\n *   currentDate.getFullYear(),\n *   currentDate.getMonth(),\n *   currentDate.getDate(),\n *   currentDate.getHours(),\n *   currentDate.getMinutes() + 1\n * );\n *\n * // This could be any observable stream\n * const source = interval(1000);\n *\n * const result = source.pipe(\n *   takeUntil(timer(startOfNextMinute))\n * );\n *\n * result.subscribe(console.log);\n * ```\n *\n * ### Known Limitations\n *\n * - The {@link asyncScheduler} uses `setTimeout` which has limitations for how far in the future it can be scheduled.\n *\n * - If a `scheduler` is provided that returns a timestamp other than an epoch from `now()`, and\n * a `Date` object is passed to the `dueTime` argument, the calculation for when the first emission\n * should occur will be incorrect. In this case, it would be best to do your own calculations\n * ahead of time, and pass a `number` in as the `dueTime`.\n *\n * @param due If a `number`, the amount of time in milliseconds to wait before emitting.\n * If a `Date`, the exact time at which to emit.\n * @param scheduler The scheduler to use to schedule the delay. Defaults to {@link asyncScheduler}.\n */\nexport function timer(due: number | Date, scheduler?: SchedulerLike): Observable<0>;\n\n/**\n * Creates an observable that starts an interval after a specified delay, emitting incrementing numbers -- starting at `0` --\n * on each interval after words.\n *\n * The `delay` and `intervalDuration` are specified by default in milliseconds, however providing a custom scheduler could\n * create a different behavior.\n *\n * ## Example\n *\n * ### Start an interval that starts right away\n *\n * Since {@link interval} waits for the passed delay before starting,\n * sometimes that's not ideal. You may want to start an interval immediately.\n * `timer` works well for this. Here we have both side-by-side so you can\n * see them in comparison.\n *\n * Note that this observable will never complete.\n *\n * ```ts\n * import { timer, interval } from 'rxjs';\n *\n * timer(0, 1000).subscribe(n => console.log('timer', n));\n * interval(1000).subscribe(n => console.log('interval', n));\n * ```\n *\n * ### Known Limitations\n *\n * - The {@link asyncScheduler} uses `setTimeout` which has limitations for how far in the future it can be scheduled.\n *\n * - If a `scheduler` is provided that returns a timestamp other than an epoch from `now()`, and\n * a `Date` object is passed to the `dueTime` argument, the calculation for when the first emission\n * should occur will be incorrect. In this case, it would be best to do your own calculations\n * ahead of time, and pass a `number` in as the `startDue`.\n * @param startDue If a `number`, is the time to wait before starting the interval.\n * If a `Date`, is the exact time at which to start the interval.\n * @param intervalDuration The delay between each value emitted in the interval. Passing a\n * negative number here will result in immediate completion after the first value is emitted, as though\n * no `intervalDuration` was passed at all.\n * @param scheduler The scheduler to use to schedule the delay. Defaults to {@link asyncScheduler}.\n */\nexport function timer(startDue: number | Date, intervalDuration: number, scheduler?: SchedulerLike): Observable<number>;\n\n/**\n * @deprecated The signature allowing `undefined` to be passed for `intervalDuration` will be removed in v8. Use the `timer(dueTime, scheduler?)` signature instead.\n */\nexport function timer(dueTime: number | Date, unused: undefined, scheduler?: SchedulerLike): Observable<0>;\n\nexport function timer(\n  dueTime: number | Date = 0,\n  intervalOrScheduler?: number | SchedulerLike,\n  scheduler: SchedulerLike = asyncScheduler\n): Observable<number> {\n  // Since negative intervalDuration is treated as though no\n  // interval was specified at all, we start with a negative number.\n  let intervalDuration = -1;\n\n  if (intervalOrScheduler != null) {\n    // If we have a second argument, and it's a scheduler,\n    // override the scheduler we had defaulted. Otherwise,\n    // it must be an interval.\n    if (isScheduler(intervalOrScheduler)) {\n      scheduler = intervalOrScheduler;\n    } else {\n      // Note that this *could* be negative, in which case\n      // it's like not passing an intervalDuration at all.\n      intervalDuration = intervalOrScheduler;\n    }\n  }\n\n  return new Observable((subscriber) => {\n    // If a valid date is passed, calculate how long to wait before\n    // executing the first value... otherwise, if it's a number just schedule\n    // that many milliseconds (or scheduler-specified unit size) in the future.\n    let due = isValidDate(dueTime) ? +dueTime - scheduler!.now() : dueTime;\n\n    if (due < 0) {\n      // Ensure we don't schedule in the future.\n      due = 0;\n    }\n\n    // The incrementing value we emit.\n    let n = 0;\n\n    // Start the timer.\n    return scheduler.schedule(function () {\n      if (!subscriber.closed) {\n        // Emit the next value and increment.\n        subscriber.next(n++);\n\n        if (0 <= intervalDuration) {\n          // If we have a interval after the initial timer,\n          // reschedule with the period.\n          this.schedule(undefined, intervalDuration);\n        } else {\n          // We didn't have an interval. So just complete.\n          subscriber.complete();\n        }\n      }\n    }, due);\n  });\n}\n", "import { Observable } from '../Observable';\nimport { asyncScheduler } from '../scheduler/async';\nimport { SchedulerLike } from '../types';\nimport { timer } from './timer';\n\n/**\n * Creates an Observable that emits sequential numbers every specified\n * interval of time, on a specified {@link SchedulerLike}.\n *\n * <span class=\"informal\">Emits incremental numbers periodically in time.</span>\n *\n * ![](interval.png)\n *\n * `interval` returns an Observable that emits an infinite sequence of\n * ascending integers, with a constant interval of time of your choosing\n * between those emissions. The first emission is not sent immediately, but\n * only after the first period has passed. By default, this operator uses the\n * `async` {@link SchedulerLike} to provide a notion of time, but you may pass any\n * {@link SchedulerLike} to it.\n *\n * ## Example\n *\n * Emits ascending numbers, one every second (1000ms) up to the number 3\n *\n * ```ts\n * import { interval, take } from 'rxjs';\n *\n * const numbers = interval(1000);\n *\n * const takeFourNumbers = numbers.pipe(take(4));\n *\n * takeFourNumbers.subscribe(x => console.log('Next: ', x));\n *\n * // Logs:\n * // Next: 0\n * // Next: 1\n * // Next: 2\n * // Next: 3\n * ```\n *\n * @see {@link timer}\n * @see {@link delay}\n *\n * @param period The interval size in milliseconds (by default) or the time unit determined\n * by the scheduler's clock.\n * @param scheduler The {@link SchedulerLike} to use for scheduling the emission of values,\n * and providing a notion of \"time\".\n * @return An Observable that emits a sequential number each time interval.\n */\nexport function interval(period = 0, scheduler: SchedulerLike = asyncScheduler): Observable<number> {\n  if (period < 0) {\n    // We cannot schedule an interval in the past.\n    period = 0;\n  }\n\n  return timer(period, period, scheduler);\n}\n", "import { Observable } from '../Observable';\nimport { ObservableInput, ObservableInputTuple, SchedulerLike } from '../types';\nimport { mergeAll } from '../operators/mergeAll';\nimport { innerFrom } from './innerFrom';\nimport { EMPTY } from './empty';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from './from';\n\nexport function merge<A extends readonly unknown[]>(...sources: [...ObservableInputTuple<A>]): Observable<A[number]>;\nexport function merge<A extends readonly unknown[]>(...sourcesAndConcurrency: [...ObservableInputTuple<A>, number?]): Observable<A[number]>;\n/** @deprecated The `scheduler` parameter will be removed in v8. Use `scheduled` and `mergeAll`. Details: https://rxjs.dev/deprecations/scheduler-argument */\nexport function merge<A extends readonly unknown[]>(\n  ...sourcesAndScheduler: [...ObservableInputTuple<A>, SchedulerLike?]\n): Observable<A[number]>;\n/** @deprecated The `scheduler` parameter will be removed in v8. Use `scheduled` and `mergeAll`. Details: https://rxjs.dev/deprecations/scheduler-argument */\nexport function merge<A extends readonly unknown[]>(\n  ...sourcesAndConcurrencyAndScheduler: [...ObservableInputTuple<A>, number?, SchedulerLike?]\n): Observable<A[number]>;\n\n/**\n * Creates an output Observable which concurrently emits all values from every\n * given input Observable.\n *\n * <span class=\"informal\">Flattens multiple Observables together by blending\n * their values into one Observable.</span>\n *\n * ![](merge.png)\n *\n * `merge` subscribes to each given input Observable (as arguments), and simply\n * forwards (without doing any transformation) all the values from all the input\n * Observables to the output Observable. The output Observable only completes\n * once all input Observables have completed. Any error delivered by an input\n * Observable will be immediately emitted on the output Observable.\n *\n * ## Examples\n *\n * Merge together two Observables: 1s interval and clicks\n *\n * ```ts\n * import { merge, fromEvent, interval } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const timer = interval(1000);\n * const clicksOrTimer = merge(clicks, timer);\n * clicksOrTimer.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // timer will emit ascending values, one every second(1000ms) to console\n * // clicks logs MouseEvents to console every time the \"document\" is clicked\n * // Since the two streams are merged you see these happening\n * // as they occur.\n * ```\n *\n * Merge together 3 Observables, but run only 2 concurrently\n *\n * ```ts\n * import { interval, take, merge } from 'rxjs';\n *\n * const timer1 = interval(1000).pipe(take(10));\n * const timer2 = interval(2000).pipe(take(6));\n * const timer3 = interval(500).pipe(take(10));\n *\n * const concurrent = 2; // the argument\n * const merged = merge(timer1, timer2, timer3, concurrent);\n * merged.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // - First timer1 and timer2 will run concurrently\n * // - timer1 will emit a value every 1000ms for 10 iterations\n * // - timer2 will emit a value every 2000ms for 6 iterations\n * // - after timer1 hits its max iteration, timer2 will\n * //   continue, and timer3 will start to run concurrently with timer2\n * // - when timer2 hits its max iteration it terminates, and\n * //   timer3 will continue to emit a value every 500ms until it is complete\n * ```\n *\n * @see {@link mergeAll}\n * @see {@link mergeMap}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n *\n * @param args `ObservableInput`s to merge together. If the last parameter\n * is of type number, `merge` will use it to limit number of concurrently\n * subscribed `ObservableInput`s. If the last parameter is {@link SchedulerLike},\n * it will be used for scheduling the emission of values.\n * @return An Observable that emits items that are the result of every input Observable.\n */\nexport function merge(...args: (ObservableInput<unknown> | number | SchedulerLike)[]): Observable<unknown> {\n  const scheduler = popScheduler(args);\n  const concurrent = popNumber(args, Infinity);\n  const sources = args as ObservableInput<unknown>[];\n  return !sources.length\n    ? // No source provided\n      EMPTY\n    : sources.length === 1\n    ? // One source? Just return it.\n      innerFrom(sources[0])\n    : // Merge all sources\n      mergeAll(concurrent)(from(sources, scheduler));\n}\n", "import { Observable } from '../Observable';\nimport { noop } from '../util/noop';\n\n/**\n * An Observable that emits no items to the Observer and never completes.\n *\n * ![](never.png)\n *\n * A simple Observable that emits neither values nor errors nor the completion\n * notification. It can be used for testing purposes or for composing with other\n * Observables. Please note that by never emitting a complete notification, this\n * Observable keeps the subscription from being disposed automatically.\n * Subscriptions need to be manually disposed.\n *\n * ##  Example\n *\n * Emit the number 7, then never emit anything else (not even complete)\n *\n * ```ts\n * import { NEVER, startWith } from 'rxjs';\n *\n * const info = () => console.log('Will not be called');\n *\n * const result = NEVER.pipe(startWith(7));\n * result.subscribe({\n *   next: x => console.log(x),\n *   error: info,\n *   complete: info\n * });\n * ```\n *\n * @see {@link Observable}\n * @see {@link EMPTY}\n * @see {@link of}\n * @see {@link throwError}\n */\nexport const NEVER = new Observable<never>(noop);\n\n/**\n * @deprecated Replaced with the {@link NEVER} constant. Will be removed in v8.\n */\nexport function never() {\n  return NEVER;\n}\n", "const { isArray } = Array;\n\n/**\n * Used in operators and functions that accept either a list of arguments, or an array of arguments\n * as a single argument.\n */\nexport function argsOrArgArray<T>(args: (T | T[])[]): T[] {\n  return args.length === 1 && isArray(args[0]) ? args[0] : (args as T[]);\n}\n", "import { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/**\n * A basic scan operation. This is used for `scan` and `reduce`.\n * @param accumulator The accumulator to use\n * @param seed The seed value for the state to accumulate\n * @param hasSeed Whether or not a seed was provided\n * @param emitOnNext Whether or not to emit the state on next\n * @param emitBeforeComplete Whether or not to emit the before completion\n */\n\nexport function scanInternals<V, A, S>(\n  accumulator: (acc: V | A | S, value: V, index: number) => A,\n  seed: S,\n  hasSeed: boolean,\n  emitOnNext: boolean,\n  emitBeforeComplete?: undefined | true\n) {\n  return (source: Observable<V>, subscriber: Subscriber<any>) => {\n    // Whether or not we have state yet. This will only be\n    // false before the first value arrives if we didn't get\n    // a seed value.\n    let hasState = hasSeed;\n    // The state that we're tracking, starting with the seed,\n    // if there is one, and then updated by the return value\n    // from the accumulator on each emission.\n    let state: any = seed;\n    // An index to pass to the accumulator function.\n    let index = 0;\n\n    // Subscribe to our source. All errors and completions are passed through.\n    source.subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (value) => {\n          // Always increment the index.\n          const i = index++;\n          // Set the state\n          state = hasState\n            ? // We already have state, so we can get the new state from the accumulator\n              accumulator(state, value, i)\n            : // We didn't have state yet, a seed value was not provided, so\n\n              // we set the state to the first value, and mark that we have state now\n              ((hasState = true), value);\n\n          // Maybe send it to the consumer.\n          emitOnNext && subscriber.next(state);\n        },\n        // If an onComplete was given, call it, otherwise\n        // just pass through the complete notification to the consumer.\n        emitBeforeComplete &&\n          (() => {\n            hasState && subscriber.next(state);\n            subscriber.complete();\n          })\n      )\n    );\n  };\n}\n", "import { MonoTypeOperatorFunction } from '../types';\nimport { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/**\n * Emits only the first `count` values emitted by the source Observable.\n *\n * <span class=\"informal\">Takes the first `count` values from the source, then\n * completes.</span>\n *\n * ![](take.png)\n *\n * `take` returns an Observable that emits only the first `count` values emitted\n * by the source Observable. If the source emits fewer than `count` values then\n * all of its values are emitted. After that, it completes, regardless if the\n * source completes.\n *\n * ## Example\n *\n * Take the first 5 seconds of an infinite 1-second interval Observable\n *\n * ```ts\n * import { interval, take } from 'rxjs';\n *\n * const intervalCount = interval(1000);\n * const takeFive = intervalCount.pipe(take(5));\n * takeFive.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 0\n * // 1\n * // 2\n * // 3\n * // 4\n * ```\n *\n * @see {@link takeLast}\n * @see {@link takeUntil}\n * @see {@link takeWhile}\n * @see {@link skip}\n *\n * @param count The maximum number of `next` values to emit.\n * @return A function that returns an Observable that emits only the first\n * `count` values emitted by the source Observable, or all of the values from\n * the source if the source emits fewer than `count` values.\n */\nexport function take<T>(count: number): MonoTypeOperatorFunction<T> {\n  return count <= 0\n    ? // If we are taking no values, that's empty.\n      () => EMPTY\n    : operate((source, subscriber) => {\n        let seen = 0;\n        source.subscribe(\n          createOperatorSubscriber(subscriber, (value) => {\n            // Increment the number of values we have seen,\n            // then check it against the allowed count to see\n            // if we are still letting values through.\n            if (++seen <= count) {\n              subscriber.next(value);\n              // If we have met or passed our allowed count,\n              // we need to complete. We have to do <= here,\n              // because re-entrant code will increment `seen` twice.\n              if (count <= seen) {\n                subscriber.complete();\n              }\n            }\n          })\n        );\n      });\n}\n", "import { OperatorFunction } from '../types';\nimport { operate } from '../util/lift';\nimport { scanInternals } from './scanInternals';\n\nexport function scan<V, A = V>(accumulator: (acc: A | V, value: V, index: number) => A): OperatorFunction<V, V | A>;\nexport function scan<V, A>(accumulator: (acc: A, value: V, index: number) => A, seed: A): OperatorFunction<V, A>;\nexport function scan<V, A, S>(accumulator: (acc: A | S, value: V, index: number) => A, seed: S): OperatorFunction<V, A>;\n\n// TODO: link to a \"redux pattern\" section in the guide (location TBD)\n\n/**\n * Useful for encapsulating and managing state. Applies an accumulator (or \"reducer function\")\n * to each value from the source after an initial state is established -- either via\n * a `seed` value (second argument), or from the first value from the source.\n *\n * <span class=\"informal\">It's like {@link reduce}, but emits the current\n * accumulation state after each update</span>\n *\n * ![](scan.png)\n *\n * This operator maintains an internal state and emits it after processing each value as follows:\n *\n * 1. First value arrives\n *   - If a `seed` value was supplied (as the second argument to `scan`), let `state = seed` and `value = firstValue`.\n *   - If NO `seed` value was supplied (no second argument), let `state = firstValue` and go to 3.\n * 2. Let `state = accumulator(state, value)`.\n *   - If an error is thrown by `accumulator`, notify the consumer of an error. The process ends.\n * 3. Emit `state`.\n * 4. Next value arrives, let `value = nextValue`, go to 2.\n *\n * ## Examples\n *\n * An average of previous numbers. This example shows how\n * not providing a `seed` can prime the stream with the\n * first value from the source.\n *\n * ```ts\n * import { of, scan, map } from 'rxjs';\n *\n * const numbers$ = of(1, 2, 3);\n *\n * numbers$\n *   .pipe(\n *     // Get the sum of the numbers coming in.\n *     scan((total, n) => total + n),\n *     // Get the average by dividing the sum by the total number\n *     // received so far (which is 1 more than the zero-based index).\n *     map((sum, index) => sum / (index + 1))\n *   )\n *   .subscribe(console.log);\n * ```\n *\n * The Fibonacci sequence. This example shows how you can use\n * a seed to prime accumulation process. Also... you know... Fibonacci.\n * So important to like, computers and stuff that its whiteboarded\n * in job interviews. Now you can show them the Rx version! (Please don't, haha)\n *\n * ```ts\n * import { interval, scan, map, startWith } from 'rxjs';\n *\n * const firstTwoFibs = [0, 1];\n * // An endless stream of Fibonacci numbers.\n * const fibonacci$ = interval(1000).pipe(\n *   // Scan to get the fibonacci numbers (after 0, 1)\n *   scan(([a, b]) => [b, a + b], firstTwoFibs),\n *   // Get the second number in the tuple, it's the one you calculated\n *   map(([, n]) => n),\n *   // Start with our first two digits :)\n *   startWith(...firstTwoFibs)\n * );\n *\n * fibonacci$.subscribe(console.log);\n * ```\n *\n * @see {@link expand}\n * @see {@link mergeScan}\n * @see {@link reduce}\n * @see {@link switchScan}\n *\n * @param accumulator A \"reducer function\". This will be called for each value after an initial state is\n * acquired.\n * @param seed The initial state. If this is not provided, the first value from the source will\n * be used as the initial state, and emitted without going through the accumulator. All subsequent values\n * will be processed by the accumulator function. If this is provided, all values will go through\n * the accumulator function.\n * @return A function that returns an Observable of the accumulated values.\n */\nexport function scan<V, A, S>(accumulator: (acc: V | A | S, value: V, index: number) => A, seed?: S): OperatorFunction<V, V | A> {\n  // providing a seed of `undefined` *should* be valid and trigger\n  // hasSeed! so don't use `seed !== undefined` checks!\n  // For this reason, we have to check it here at the original call site\n  // otherwise inside Operator/Subscriber we won't know if `undefined`\n  // means they didn't provide anything or if they literally provided `undefined`\n  return operate(scanInternals(accumulator, seed as S, arguments.length >= 2, true));\n}\n", "import { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction, SubjectLike, ObservableInput } from '../types';\nimport { operate } from '../util/lift';\n\nexport interface ShareConfig<T> {\n  /**\n   * The factory used to create the subject that will connect the source observable to\n   * multicast consumers.\n   */\n  connector?: () => SubjectLike<T>;\n  /**\n   * If `true`, the resulting observable will reset internal state on error from source and return to a \"cold\" state. This\n   * allows the resulting observable to be \"retried\" in the event of an error.\n   * If `false`, when an error comes from the source it will push the error into the connecting subject, and the subject\n   * will remain the connecting subject, meaning the resulting observable will not go \"cold\" again, and subsequent retries\n   * or resubscriptions will resubscribe to that same subject. In all cases, RxJS subjects will emit the same error again, however\n   * {@link ReplaySubject} will also push its buffered values before pushing the error.\n   * It is also possible to pass a notifier factory returning an `ObservableInput` instead which grants more fine-grained\n   * control over how and when the reset should happen. This allows behaviors like conditional or delayed resets.\n   */\n  resetOnError?: boolean | ((error: any) => ObservableInput<any>);\n  /**\n   * If `true`, the resulting observable will reset internal state on completion from source and return to a \"cold\" state. This\n   * allows the resulting observable to be \"repeated\" after it is done.\n   * If `false`, when the source completes, it will push the completion through the connecting subject, and the subject\n   * will remain the connecting subject, meaning the resulting observable will not go \"cold\" again, and subsequent repeats\n   * or resubscriptions will resubscribe to that same subject.\n   * It is also possible to pass a notifier factory returning an `ObservableInput` instead which grants more fine-grained\n   * control over how and when the reset should happen. This allows behaviors like conditional or delayed resets.\n   */\n  resetOnComplete?: boolean | (() => ObservableInput<any>);\n  /**\n   * If `true`, when the number of subscribers to the resulting observable reaches zero due to those subscribers unsubscribing, the\n   * internal state will be reset and the resulting observable will return to a \"cold\" state. This means that the next\n   * time the resulting observable is subscribed to, a new subject will be created and the source will be subscribed to\n   * again.\n   * If `false`, when the number of subscribers to the resulting observable reaches zero due to unsubscription, the subject\n   * will remain connected to the source, and new subscriptions to the result will be connected through that same subject.\n   * It is also possible to pass a notifier factory returning an `ObservableInput` instead which grants more fine-grained\n   * control over how and when the reset should happen. This allows behaviors like conditional or delayed resets.\n   */\n  resetOnRefCountZero?: boolean | (() => ObservableInput<any>);\n}\n\nexport function share<T>(): MonoTypeOperatorFunction<T>;\n\nexport function share<T>(options: ShareConfig<T>): MonoTypeOperatorFunction<T>;\n\n/**\n * Returns a new Observable that multicasts (shares) the original Observable. As long as there is at least one\n * Subscriber this Observable will be subscribed and emitting data. When all subscribers have unsubscribed it will\n * unsubscribe from the source Observable. Because the Observable is multicasting it makes the stream `hot`.\n * This is an alias for `multicast(() => new Subject()), refCount()`.\n *\n * The subscription to the underlying source Observable can be reset (unsubscribe and resubscribe for new subscribers),\n * if the subscriber count to the shared observable drops to 0, or if the source Observable errors or completes. It is\n * possible to use notifier factories for the resets to allow for behaviors like conditional or delayed resets. Please\n * note that resetting on error or complete of the source Observable does not behave like a transparent retry or restart\n * of the source because the error or complete will be forwarded to all subscribers and their subscription will be\n * closed. Only new subscribers after a reset on error or complete happened will cause a fresh subscription to the\n * source. To achieve transparent retries or restarts pipe the source through appropriate operators before sharing.\n *\n * ![](share.png)\n *\n * ## Example\n *\n * Generate new multicast Observable from the `source` Observable value\n *\n * ```ts\n * import { interval, tap, map, take, share } from 'rxjs';\n *\n * const source = interval(1000).pipe(\n *   tap(x => console.log('Processing: ', x)),\n *   map(x => x * x),\n *   take(6),\n *   share()\n * );\n *\n * source.subscribe(x => console.log('subscription 1: ', x));\n * source.subscribe(x => console.log('subscription 2: ', x));\n *\n * // Logs:\n * // Processing: 0\n * // subscription 1: 0\n * // subscription 2: 0\n * // Processing: 1\n * // subscription 1: 1\n * // subscription 2: 1\n * // Processing: 2\n * // subscription 1: 4\n * // subscription 2: 4\n * // Processing: 3\n * // subscription 1: 9\n * // subscription 2: 9\n * // Processing: 4\n * // subscription 1: 16\n * // subscription 2: 16\n * // Processing: 5\n * // subscription 1: 25\n * // subscription 2: 25\n * ```\n *\n * ## Example with notifier factory: Delayed reset\n *\n * ```ts\n * import { interval, take, share, timer } from 'rxjs';\n *\n * const source = interval(1000).pipe(\n *   take(3),\n *   share({\n *     resetOnRefCountZero: () => timer(1000)\n *   })\n * );\n *\n * const subscriptionOne = source.subscribe(x => console.log('subscription 1: ', x));\n * setTimeout(() => subscriptionOne.unsubscribe(), 1300);\n *\n * setTimeout(() => source.subscribe(x => console.log('subscription 2: ', x)), 1700);\n *\n * setTimeout(() => source.subscribe(x => console.log('subscription 3: ', x)), 5000);\n *\n * // Logs:\n * // subscription 1:  0\n * // (subscription 1 unsubscribes here)\n * // (subscription 2 subscribes here ~400ms later, source was not reset)\n * // subscription 2:  1\n * // subscription 2:  2\n * // (subscription 2 unsubscribes here)\n * // (subscription 3 subscribes here ~2000ms later, source did reset before)\n * // subscription 3:  0\n * // subscription 3:  1\n * // subscription 3:  2\n * ```\n *\n * @see {@link shareReplay}\n *\n * @return A function that returns an Observable that mirrors the source.\n */\nexport function share<T>(options: ShareConfig<T> = {}): MonoTypeOperatorFunction<T> {\n  const { connector = () => new Subject<T>(), resetOnError = true, resetOnComplete = true, resetOnRefCountZero = true } = options;\n  // It's necessary to use a wrapper here, as the _operator_ must be\n  // referentially transparent. Otherwise, it cannot be used in calls to the\n  // static `pipe` function - to create a partial pipeline.\n  //\n  // The _operator function_ - the function returned by the _operator_ - will\n  // not be referentially transparent - as it shares its source - but the\n  // _operator function_ is called when the complete pipeline is composed via a\n  // call to a source observable's `pipe` method - not when the static `pipe`\n  // function is called.\n  return (wrapperSource) => {\n    let connection: SafeSubscriber<T> | undefined;\n    let resetConnection: Subscription | undefined;\n    let subject: SubjectLike<T> | undefined;\n    let refCount = 0;\n    let hasCompleted = false;\n    let hasErrored = false;\n\n    const cancelReset = () => {\n      resetConnection?.unsubscribe();\n      resetConnection = undefined;\n    };\n    // Used to reset the internal state to a \"cold\"\n    // state, as though it had never been subscribed to.\n    const reset = () => {\n      cancelReset();\n      connection = subject = undefined;\n      hasCompleted = hasErrored = false;\n    };\n    const resetAndUnsubscribe = () => {\n      // We need to capture the connection before\n      // we reset (if we need to reset).\n      const conn = connection;\n      reset();\n      conn?.unsubscribe();\n    };\n\n    return operate<T, T>((source, subscriber) => {\n      refCount++;\n      if (!hasErrored && !hasCompleted) {\n        cancelReset();\n      }\n\n      // Create the subject if we don't have one yet. Grab a local reference to\n      // it as well, which avoids non-null assertions when using it and, if we\n      // connect to it now, then error/complete need a reference after it was\n      // reset.\n      const dest = (subject = subject ?? connector());\n\n      // Add the finalization directly to the subscriber - instead of returning it -\n      // so that the handling of the subscriber's unsubscription will be wired\n      // up _before_ the subscription to the source occurs. This is done so that\n      // the assignment to the source connection's `closed` property will be seen\n      // by synchronous firehose sources.\n      subscriber.add(() => {\n        refCount--;\n\n        // If we're resetting on refCount === 0, and it's 0, we only want to do\n        // that on \"unsubscribe\", really. Resetting on error or completion is a different\n        // configuration.\n        if (refCount === 0 && !hasErrored && !hasCompleted) {\n          resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n        }\n      });\n\n      // The following line adds the subscription to the subscriber passed.\n      // Basically, `subscriber === dest.subscribe(subscriber)` is `true`.\n      dest.subscribe(subscriber);\n\n      if (\n        !connection &&\n        // Check this shareReplay is still activate - it can be reset to 0\n        // and be \"unsubscribed\" _before_ it actually subscribes.\n        // If we were to subscribe then, it'd leak and get stuck.\n        refCount > 0\n      ) {\n        // We need to create a subscriber here - rather than pass an observer and\n        // assign the returned subscription to connection - because it's possible\n        // for reentrant subscriptions to the shared observable to occur and in\n        // those situations we want connection to be already-assigned so that we\n        // don't create another connection to the source.\n        connection = new SafeSubscriber({\n          next: (value) => dest.next(value),\n          error: (err) => {\n            hasErrored = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnError, err);\n            dest.error(err);\n          },\n          complete: () => {\n            hasCompleted = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnComplete);\n            dest.complete();\n          },\n        });\n        innerFrom(source).subscribe(connection);\n      }\n    })(wrapperSource);\n  };\n}\n\nfunction handleReset<T extends unknown[] = never[]>(\n  reset: () => void,\n  on: boolean | ((...args: T) => ObservableInput<any>),\n  ...args: T\n): Subscription | undefined {\n  if (on === true) {\n    reset();\n    return;\n  }\n\n  if (on === false) {\n    return;\n  }\n\n  const onSubscriber = new SafeSubscriber({\n    next: () => {\n      onSubscriber.unsubscribe();\n      reset();\n    },\n  });\n\n  return innerFrom(on(...args)).subscribe(onSubscriber);\n}\n", "import { Subscriber } from '../Subscriber';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\n\n/* tslint:disable:max-line-length */\nexport function switchMap<T, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O\n): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated The `resultSelector` parameter will be removed in v8. Use an inner `map` instead. Details: https://rxjs.dev/deprecations/resultSelector */\nexport function switchMap<T, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector: undefined\n): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated The `resultSelector` parameter will be removed in v8. Use an inner `map` instead. Details: https://rxjs.dev/deprecations/resultSelector */\nexport function switchMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R\n): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable, emitting values only from the most recently projected Observable.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link switchAll}.</span>\n *\n * ![](switchMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an (so-called \"inner\") Observable. Each time it observes one of these\n * inner Observables, the output Observable begins emitting the items emitted by\n * that inner Observable. When a new inner Observable is emitted, `switchMap`\n * stops emitting items from the earlier-emitted inner Observable and begins\n * emitting items from the new one. It continues to behave like this for\n * subsequent inner Observables.\n *\n * ## Example\n *\n * Generate new Observable according to source Observable values\n *\n * ```ts\n * import { of, switchMap } from 'rxjs';\n *\n * const switched = of(1, 2, 3).pipe(switchMap(x => of(x, x ** 2, x ** 3)));\n * switched.subscribe(x => console.log(x));\n * // outputs\n * // 1\n * // 1\n * // 1\n * // 2\n * // 4\n * // 8\n * // 3\n * // 9\n * // 27\n * ```\n *\n * Restart an interval Observable on every click event\n *\n * ```ts\n * import { fromEvent, switchMap, interval } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(switchMap(() => interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link concatMap}\n * @see {@link exhaustMap}\n * @see {@link mergeMap}\n * @see {@link switchAll}\n * @see {@link switchMapTo}\n *\n * @param project A function that, when applied to an item emitted by the source\n * Observable, returns an Observable.\n * @return A function that returns an Observable that emits the result of\n * applying the projection function (and the optional deprecated\n * `resultSelector`) to each item emitted by the source Observable and taking\n * only the values from the most recently projected inner Observable.\n */\nexport function switchMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R\n): OperatorFunction<T, ObservedValueOf<O> | R> {\n  return operate((source, subscriber) => {\n    let innerSubscriber: Subscriber<ObservedValueOf<O>> | null = null;\n    let index = 0;\n    // Whether or not the source subscription has completed\n    let isComplete = false;\n\n    // We only complete the result if the source is complete AND we don't have an active inner subscription.\n    // This is called both when the source completes and when the inners complete.\n    const checkComplete = () => isComplete && !innerSubscriber && subscriber.complete();\n\n    source.subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (value) => {\n          // Cancel the previous inner subscription if there was one\n          innerSubscriber?.unsubscribe();\n          let innerIndex = 0;\n          const outerIndex = index++;\n          // Start the next inner subscription\n          innerFrom(project(value, outerIndex)).subscribe(\n            (innerSubscriber = createOperatorSubscriber(\n              subscriber,\n              // When we get a new inner value, next it through. Note that this is\n              // handling the deprecate result selector here. This is because with this architecture\n              // it ends up being smaller than using the map operator.\n              (innerValue) => subscriber.next(resultSelector ? resultSelector(value, innerValue, outerIndex, innerIndex++) : innerValue),\n              () => {\n                // The inner has completed. Null out the inner subscriber to\n                // free up memory and to signal that we have no inner subscription\n                // currently.\n                innerSubscriber = null!;\n                checkComplete();\n              }\n            ))\n          );\n        },\n        () => {\n          isComplete = true;\n          checkComplete();\n        }\n      )\n    );\n  });\n}\n", "// import { createBrowserInspector } from \"@statelyai/inspect\";\nimport { Observable, ReplaySubject, share } from \"rxjs\";\nimport {\n  createActor,\n  type SnapshotFrom,\n  type StateMachine,\n  type StateSchema,\n} from \"xstate\";\n\nimport {\n  type DeviceAction,\n  type DeviceActionIntermediateValue,\n  type ExecuteDeviceActionReturnType,\n  type InternalApi,\n} from \"@api/device-action/DeviceAction\";\nimport {\n  type DeviceActionState,\n  DeviceActionStatus,\n} from \"@api/device-action/model/DeviceActionState\";\nimport { type DmkError } from \"@api/Error\";\n\nimport { type StateMachineTypes } from \"./StateMachineTypes\";\n\nexport type DeviceActionStateMachine<\n  Output,\n  Input,\n  Error extends DmkError,\n  IntermediateValue extends DeviceActionIntermediateValue,\n  InternalState,\n> = StateMachine<\n  StateMachineTypes<\n    Output,\n    Input,\n    Error,\n    IntermediateValue,\n    InternalState\n  >[\"context\"], // context\n  /**\n   * The following usages `any` are OK because this is just a wrapper around the\n   * state machine and we are not directly going to use these types.\n   */\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  any, // event\n  any, // children\n  any, // actor\n  any, // action\n  any, // guard\n  any, // delay\n  any, // state value\n  any, // tag\n  /* eslint-enable @typescript-eslint/no-explicit-any */\n  StateMachineTypes<\n    Output,\n    Input,\n    Error,\n    IntermediateValue,\n    InternalState\n  >[\"input\"],\n  StateMachineTypes<\n    Output,\n    Input,\n    Error,\n    IntermediateValue,\n    InternalState\n  >[\"output\"],\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  any,\n  any,\n  /* eslint-enable @typescript-eslint/no-explicit-any */\n  StateSchema\n>;\n\n/**\n * A DeviceAction that uses an XState state machine to execute.\n * It maps the state machine snapshots to the DeviceActionState.\n * This class is abstract and should be extended to implement the state machine.\n */\nexport abstract class XStateDeviceAction<\n  Output,\n  Input,\n  Error extends DmkError,\n  IntermediateValue extends DeviceActionIntermediateValue,\n  InternalState,\n> implements DeviceAction<Output, Input, Error, IntermediateValue>\n{\n  readonly input: Input;\n  readonly inspect: boolean = false;\n\n  /**\n   *\n   * @param input The input for the DeviceAction\n   * @param inspect If true, the state machine will be inspected in the browser\n   */\n  constructor(args: { input: Input; inspect?: boolean }) {\n    this.input = args.input;\n    this.inspect = Boolean(args.inspect);\n  }\n\n  protected abstract makeStateMachine(\n    internalAPI: InternalApi,\n  ): DeviceActionStateMachine<\n    Output,\n    Input,\n    Error,\n    IntermediateValue,\n    InternalState\n  >;\n\n  _execute(\n    internalApi: InternalApi,\n  ): ExecuteDeviceActionReturnType<Output, Error, IntermediateValue> {\n    const stateMachine = this.makeStateMachine(internalApi);\n    return this._subscribeToStateMachine(stateMachine);\n  }\n\n  protected _subscribeToStateMachine(\n    stateMachine: DeviceActionStateMachine<\n      Output,\n      Input,\n      Error,\n      IntermediateValue,\n      InternalState\n    >,\n  ): ExecuteDeviceActionReturnType<Output, Error, IntermediateValue> {\n    const actor = createActor(stateMachine, {\n      input: this.input,\n      // optional inspector for debugging\n      // inspect: this.inspect ? createBrowserInspector().inspect : undefined,\n    });\n\n    /**\n     * Using a ReplaySubject is important because the first snapshots might be\n     * emitted before the observable is subscribed (if the machine goes through\n     * those states fully synchronously).\n     * This way, we ensure that the subscriber always receives the latest snapshot.\n     * */\n    const subject = new ReplaySubject<\n      DeviceActionState<Output, Error, IntermediateValue>\n    >();\n\n    const handleActorSnapshot = (\n      snapshot: SnapshotFrom<typeof stateMachine>,\n    ) => {\n      const { context, status, output, error } = snapshot;\n      switch (status) {\n        case \"active\":\n          subject.next({\n            status: DeviceActionStatus.Pending,\n            intermediateValue: context.intermediateValue,\n          });\n          break;\n        case \"done\":\n          output.caseOf({\n            Left: (err) => {\n              subject.next({\n                status: DeviceActionStatus.Error,\n                error: err,\n              });\n            },\n            Right: (result) => {\n              subject.next({\n                status: DeviceActionStatus.Completed,\n                output: result,\n              });\n            },\n          });\n          subject.complete();\n          break;\n        case \"error\":\n          // this is an error in the execution of the state machine, it should not happen\n          subject.error(error);\n          subject.complete();\n          break;\n        case \"stopped\":\n          subject.next({\n            status: DeviceActionStatus.Stopped,\n          });\n          subject.complete();\n          break;\n        default:\n          this._exhaustiveMatchingGuard(status);\n      }\n    };\n\n    const observable = new Observable<\n      DeviceActionState<Output, Error, IntermediateValue>\n    >((subscriber) => {\n      const subjectSubscription = subject.subscribe(subscriber);\n      return () => {\n        actorSubscription.unsubscribe();\n        subjectSubscription.unsubscribe();\n        actor.stop(); // stop the actor when the observable is unsubscribed\n      };\n    });\n\n    const actorSubscription = actor.subscribe(handleActorSnapshot);\n    actor.start();\n\n    return {\n      observable: observable.pipe(share()), // share to garantee that once there is no more observer, the actor is stopped\n      cancel: () => {\n        actor.stop();\n        actorSubscription.unsubscribe();\n        handleActorSnapshot(actor.getSnapshot());\n      },\n    };\n  }\n\n  private _exhaustiveMatchingGuard(status: never): never {\n    console.log(\"_exhaustiveMatchingGuard status\", status);\n    throw new Error(`Unhandled status: ${status}`);\n  }\n}\n", "import { type GetAppAndVersionResponse } from \"@api/command/os/GetAppAndVersionCommand\";\nimport { type BatteryStatusFlags } from \"@api/command/os/GetBatteryStatusCommand\";\nimport { type GetOsVersionResponse } from \"@api/command/os/GetOsVersionCommand\";\nimport { type DeviceModelId } from \"@api/device/DeviceModel\";\nimport { type DeviceStatus } from \"@api/device/DeviceStatus\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport {\n  type FinalFirmware,\n  type OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport { type LanguagePackage } from \"@internal/manager-api/model/Language\";\n\n/**\n * The battery status of a device.\n */\nexport type BatteryStatus = {\n  readonly level: number;\n  readonly voltage: number;\n  readonly temperature: number;\n  readonly current: number;\n  readonly status: BatteryStatusFlags;\n};\n\n/**\n * The firmware version of a device.\n */\nexport type FirmwareVersion = {\n  /**\n   * Microcontroller Unit version\n   */\n  readonly mcu: string;\n\n  /**\n   * Bootloader version\n   */\n  readonly bootloader: string;\n\n  /**\n   * Operating System version\n   */\n  readonly os: string;\n\n  /**\n   * Metadata for advanced users, to get detailed informations on\n   * the firmware running on the device.\n   */\n  readonly metadata?: GetOsVersionResponse;\n};\n\n/**\n * Context for firmware updates\n */\nexport type FirmwareUpdateContext = {\n  /**\n   * Current installed firmware\n   */\n  readonly currentFirmware: FinalFirmware;\n\n  /**\n   * Available firmware update\n   */\n  readonly availableUpdate?: FirmwareUpdate;\n};\n\n/**\n * Available firmware update\n */\nexport type FirmwareUpdate = {\n  /**\n   * Version of the OS updater firmware\n   */\n  readonly osuFirmware: OsuFirmware;\n\n  /**\n   * Version of the final firmware\n   */\n  readonly finalFirmware: FinalFirmware;\n\n  /**\n   * Indicates if the MCU needs to be updated\n   */\n  readonly mcuUpdateRequired: boolean;\n};\n\n/**\n * The app store catalog for that device.\n */\nexport type Catalog = {\n  /**\n   * Available applications for the device\n   */\n  readonly applications: Application[];\n\n  /**\n   * Available languages packages for the device\n   */\n  readonly languagePackages: LanguagePackage[];\n};\n\n/**\n * Language package installed on the device\n */\nexport type InstalledLanguagePackage = {\n  /**\n   * The identifier of the language package\n   */\n  readonly id: number;\n\n  /**\n   * The size of the language package\n   */\n  readonly size: number;\n};\n\n/**\n * Custom image metadata, if one was loaded on the device\n */\nexport type CustomImage = {\n  /**\n   * The size of loaded custom image, if one was loaded\n   */\n  readonly size?: number;\n};\n\n/**\n * The current application running on a device. Alias of GetAppAndVersionResponse.\n */\nexport type RunningApp = GetAppAndVersionResponse;\n\n/**\n * The state types of a device session.\n */\nexport enum DeviceSessionStateType {\n  Connected,\n  ReadyWithoutSecureChannel,\n  ReadyWithSecureChannel,\n}\n\ntype DeviceSessionBaseState = {\n  readonly sessionStateType: DeviceSessionStateType;\n\n  /**\n   * The status of the device.\n   */\n  readonly deviceStatus: DeviceStatus;\n\n  /**\n   * The model of the device.\n   */\n  readonly deviceModelId: DeviceModelId;\n\n  /**\n   * The name of the device.\n   */\n  readonly deviceName?: string;\n};\n\ntype DeviceSessionReadyState = {\n  /**\n   * The battery status of the device.\n   * TODO: This should not be optional, but it is not in the current implementation.\n   */\n  readonly batteryStatus?: BatteryStatus;\n\n  /**\n   * The firmware version of the device.\n   * TODO: This should not be optional, but it is not in the current implementation.\n   */\n  readonly firmwareVersion?: FirmwareVersion;\n\n  /**\n   * Context of available firmware update\n   */\n  readonly firmwareUpdateContext?: FirmwareUpdateContext;\n\n  /**\n   * The current application running on the device.\n   */\n  readonly currentApp: RunningApp;\n\n  /**\n   * The current applications installed on the device.\n   */\n  readonly installedApps: Application[];\n\n  /**\n   * Available updates from the app store for installed applications.\n   */\n  readonly appsUpdates?: Application[];\n\n  /**\n   * The current language packages installed on the device.\n   */\n  readonly installedLanguages?: InstalledLanguagePackage[];\n\n  /**\n   * Catalog of available applications and languages for the device.\n   */\n  readonly catalog?: Catalog;\n\n  /**\n   * Custom image metadata.\n   */\n  readonly customImage?: CustomImage;\n\n  /**\n   * The device is allowed to establish a secure connection.\n   */\n  readonly isSecureConnectionAllowed: boolean;\n};\n\n/**\n * The state of a connected device session.\n */\nexport type ConnectedState = DeviceSessionBaseState & {\n  /**\n   * The type of the device session state.\n   */\n  readonly sessionStateType: DeviceSessionStateType.Connected;\n};\n\n/**\n * The state of a device session when it is ready without a secure channel.\n */\nexport type ReadyWithoutSecureChannelState = DeviceSessionBaseState &\n  DeviceSessionReadyState & {\n    /**\n     * The type of the device session state.\n     */\n    readonly sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel;\n  };\n\n/**\n * The state of a device session when it is ready with a secure channel.\n */\nexport type ReadyWithSecureChannelState = DeviceSessionBaseState &\n  DeviceSessionReadyState & {\n    /**\n     * The type of the device session state.\n     */\n    readonly sessionStateType: DeviceSessionStateType.ReadyWithSecureChannel;\n  };\n\n/**\n * The state of a device session.\n */\nexport type DeviceSessionState =\n  | ConnectedState\n  | ReadyWithoutSecureChannelState\n  | ReadyWithSecureChannelState;\n", "import { Left, Right } from \"purify-ts\";\nimport {\n  EMPTY,\n  from,\n  interval,\n  mergeMap,\n  type Observable,\n  of,\n  switchMap,\n  take,\n} from \"rxjs\";\nimport { timeout } from \"rxjs/operators\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  GetAppAndVersionCommand,\n  type GetAppAndVersionCommandResult,\n} from \"@api/command/os/GetAppAndVersionCommand\";\nimport { DeviceStatus } from \"@api/device/DeviceStatus\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport {\n  DeviceLockedError,\n  DeviceNotOnboardedError,\n} from \"@api/device-action/os/Errors\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\n\nimport {\n  type GetDeviceStatusDAError,\n  type GetDeviceStatusDAInput,\n  type GetDeviceStatusDAIntermediateValue,\n  type GetDeviceStatusDAOutput,\n} from \"./types\";\n\ntype GetDeviceStatusMachineInternalState = {\n  readonly onboarded: boolean;\n  readonly locked: boolean;\n  readonly currentApp: string | null;\n  readonly currentAppVersion: string | null;\n  readonly error: GetDeviceStatusDAError | null;\n};\n\nexport type MachineDependencies = {\n  readonly getAppAndVersion: () => Promise<GetAppAndVersionCommandResult>;\n  readonly getDeviceSessionState: () => DeviceSessionState;\n  readonly waitForDeviceUnlock: (args: {\n    input: { unlockTimeout: number };\n  }) => Observable<void>;\n  readonly setDeviceSessionState: (\n    state: DeviceSessionState,\n  ) => DeviceSessionState;\n  readonly isDeviceOnboarded: () => boolean;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\nexport class GetDeviceStatusDeviceAction extends XStateDeviceAction<\n  GetDeviceStatusDAOutput,\n  GetDeviceStatusDAInput,\n  GetDeviceStatusDAError,\n  GetDeviceStatusDAIntermediateValue,\n  GetDeviceStatusMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    GetDeviceStatusDAOutput,\n    GetDeviceStatusDAInput,\n    GetDeviceStatusDAError,\n    GetDeviceStatusDAIntermediateValue,\n    GetDeviceStatusMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      GetDeviceStatusDAOutput,\n      GetDeviceStatusDAInput,\n      GetDeviceStatusDAError,\n      GetDeviceStatusDAIntermediateValue,\n      GetDeviceStatusMachineInternalState\n    >;\n\n    const {\n      getAppAndVersion,\n      getDeviceSessionState,\n      setDeviceSessionState,\n      waitForDeviceUnlock,\n      isDeviceOnboarded,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        getAppAndVersion: fromPromise(getAppAndVersion),\n        waitForDeviceUnlock: fromObservable(waitForDeviceUnlock),\n      },\n      guards: {\n        isDeviceOnboarded: () => isDeviceOnboarded(), // TODO: we don't have this info for now, this can be derived from the \"flags\" obtained in the getVersion command\n        isDeviceLocked: ({ context }) => context._internalState.locked,\n        hasError: ({ context }) => context._internalState.error !== null,\n      },\n      actions: {\n        assignErrorDeviceNotOnboarded: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new DeviceNotOnboardedError(),\n          }),\n        }),\n        assignErrorDeviceLocked: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new DeviceLockedError(),\n          }),\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.UnlockDevice,\n          },\n        }),\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n        assignNoUserActionNeeded: assign({\n          intermediateValue: (_) =>\n            ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }) satisfies types[\"context\"][\"intermediateValue\"],\n        }),\n        assignUserActionUnlockNeeded: assign({\n          intermediateValue: (_) =>\n            ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.UnlockDevice,\n            }) satisfies types[\"context\"][\"intermediateValue\"],\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QHEwBcAiYBuBLAxmAMpoCGaArrFnoQIL5q4D2AdgHQ0FgBKYpEAJ4BiANoAGALqJQAB2axcTNjJAAPRAFoArAHZx7AIwAmQ7oCcugMyHzANmMAWYwBoQgxI8vsAHOJM+VuLmVj5e2gC+EW6omDjcJORUXPSMLBwA8qwARsykAE4QuKxQAMIAFmD4ANZiUqryisqsqhoImo4O7OGhPj4h5n6Obh4IunZ2RoZ+ena6nYaGUTHoKcRklNTxqc3sWbkFRSUVVbWihtJIII1K6a1aVtoGTxOOjtbv84YjiObik7ofPM7GFDP9jNofMsQLE1olNmsGLsADLMGrFMqVGp1S5yBS3FRXNqaOzadjiHx2KyORbzcRBczmH4IbTOdjaabaKmdGy6XSRaIw1bbdZJLa0MBI9LsVHo45Ys4XBr45r3dps-n0ubaGxgx6PZlWULkkLBGmDCzGYzQ2Ei+HJEVStjsACqsDA+SdrBdrAANmjqmthBA2GB2MVsMxqmG3R6vT7-TU1hJcdcVXciYgglZycYQiYqRTQoZtMynDmbM4aW8rHYzD4BSs4hL7eLuF7Xe7PWk2AmA0GPflmPl2LJfeQAGbDgC2nbjPe9fv7IpTyqaGdAbXmxnZPkMNNM820VuZ+8M7Dsb3MznpwW31sFtpbGwdEo7dFksjorAgADUPYobAnNiIasGGEZRmGT4JC+bY7NKH5fj+-75IBrDAdUCAQfg5DpCmq5XDcqqZmMjgGDY-yGJeejjFRzJ2P47DZoEJb+Hyx42sKz5ioiC7sIh35-gB6QYcIg7DqO45oFO+SztBhCtrxuwCchwlAQqWGsJGOHNPh9SEemhKbogdLsIMTjmPuNF1nYZaOBW+5OPu9l1oCjZCs2ME8Y6fGIb6BC4WwdDYKQuDjtkvq8HAFC+mgokEXi65GeoiBguYZJOPSJa6Hm1hGsyuglkxxiUjYVjXlq7nyaKCI+cpn7+Tp6TBaF4WRXwsAxXFCpiEqBlJS0JFAo4vg+BCe55e8-QFUVVglVShjlWRtZ2FEgqsMwEBwKo1WKXVG5pgNaokmRZmQg4fyLHR7ieCNpjGPyx7aNo6UNo4nGeQpsFKdKax8AIoyJQSg3Ge0L07q9F3+Istk3Qg1IjUaZ7GNS-LlU4H1wt9+3OvseSFBiGFrsDx01mZ15mHooReFaVj0fZ5Jci5zissYIKY3a2NvnxsrVITCrE8RoMdDucxWgx1jpZCELDHDgKTC9jg6mNXKLDSHPcbV3O7LG3bNH2SYioLB3EmCI1-HuVL6Cj4hU6eNjsIVD3UrWfKXVCj5cV5Wvtr5n6CShaFE-1JMkWzPgXpCjh+Faw3Mjq5jdOlJhGvo-RzRr3uvr79VjgFzQtWFpARVFnWxcHQNCylCBm+eKPjJL4jWMEdNww4O46vSFVsfyD5Nlj3na9KRAUPghCwPAIdV20QIR7e-RzOYbNK98cN7ndgR-BSzgo+YmdfYPOfSgAovkQ75MbyVtItehmSrJgcijz2uHD+pmXyQSQnyVLs2tQA */\n      id: \"GetDeviceStatusDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        const sessionState = getDeviceSessionState();\n        const { sessionStateType } = sessionState;\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            onboarded: false, // we don't know how to check yet\n            locked: false,\n            currentApp:\n              sessionStateType ===\n              DeviceSessionStateType.ReadyWithoutSecureChannel\n                ? sessionState.currentApp.name\n                : null,\n            currentAppVersion: null,\n            error: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"OnboardingCheck\",\n          },\n        },\n        OnboardingCheck: {\n          // TODO: we don't have this info for now\n          always: [\n            {\n              guard: {\n                type: \"isDeviceOnboarded\",\n              },\n              target: \"AppAndVersionCheck\",\n              actions: assign({\n                _internalState: (_) => ({\n                  ..._.context._internalState,\n                  onboarded: true,\n                }),\n              }),\n            },\n            {\n              target: \"Error\",\n              actions: \"assignErrorDeviceNotOnboarded\",\n            },\n          ],\n        },\n        UserActionUnlockDevice: {\n          // we wait for the device to be unlocked (default timeout is 15s)\n          entry: \"assignUserActionUnlockNeeded\",\n          exit: \"assignNoUserActionNeeded\",\n          invoke: {\n            id: \"UserActionUnlockDevice\",\n            src: \"waitForDeviceUnlock\",\n            input: (_) => ({\n              unlockTimeout,\n            }),\n            onDone: {\n              target: \"AppAndVersionCheck\",\n              actions: assign({\n                _internalState: (_) => ({\n                  ..._.context._internalState,\n                  locked: false,\n                }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorDeviceLocked\",\n            },\n          },\n        },\n        AppAndVersionCheck: {\n          // We check the current app and version using the getAppAndVersion command\n          invoke: {\n            src: \"getAppAndVersion\",\n            onDone: {\n              target: \"ApplicationAvailableResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const state: DeviceSessionState = getDeviceSessionState();\n                    if (\n                      state.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      // Update the current app\n                      setDeviceSessionState({\n                        ...state,\n                        currentApp: _.event.output.data,\n                      });\n                    } else {\n                      // The device can be set to Ready if GetAppAndVersionCommand was successful\n                      setDeviceSessionState({\n                        deviceModelId: state.deviceModelId,\n                        sessionStateType:\n                          DeviceSessionStateType.ReadyWithoutSecureChannel,\n                        deviceStatus: DeviceStatus.CONNECTED,\n                        currentApp: _.event.output.data,\n                        installedApps: [],\n                        isSecureConnectionAllowed: false,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      locked: false,\n                      currentApp: _.event.output.data.name,\n                      currentAppVersion: _.event.output.data.version,\n                    };\n                  }\n                  if (\"errorCode\" in _.event.output.error) {\n                    if (_.event.output.error.errorCode === \"5515\") {\n                      // Locked device error\n                      return {\n                        ..._.context._internalState,\n                        locked: true,\n                      };\n                    } else if (_.event.output.error.errorCode === \"6e00\") {\n                      // CLA not supported\n                      // GetAppAndVersion should always be supported by the firmware or any app.\n                      // But on old firmware versions, that APDU was not supported in the dashboard.\n                      // On those firmwares, it fails with CLA_NOT_SUPPORTED in BOLOS, and INS_NOT_SUPPORTED\n                      // in applications. Therefore if CLA is not supported, we can consider we're on the\n                      // dashboard on an old firmware. We should therefore return that information to\n                      // ensure the user can still update his firmware and is not blocked at this step.\n                      return {\n                        ..._.context._internalState,\n                        locked: false,\n                        currentApp: \"BOLOS\",\n                        currentAppVersion: \"0.0.0\",\n                      };\n                    }\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ApplicationAvailableResultCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"UserActionUnlockDevice\",\n              guard: \"isDeviceLocked\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (args) => {\n        // TODO: instead we should rely on the current state (\"Success\" or \"Error\")\n        const { context } = args;\n        const { error, currentApp, currentAppVersion } = context._internalState;\n        if (error) {\n          return Left(error);\n        }\n        return Right<GetDeviceStatusDAOutput>({\n          currentApp: currentApp!,\n          currentAppVersion: currentAppVersion!,\n        });\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getAppAndVersion = () => {\n      return internalApi.sendCommand(new GetAppAndVersionCommand());\n    };\n\n    const waitForDeviceUnlock = ({\n      input,\n    }: {\n      input: { unlockTimeout: number };\n    }) =>\n      interval(1000).pipe(\n        switchMap(() =>\n          from(internalApi.sendCommand(new GetAppAndVersionCommand())),\n        ),\n        mergeMap((output) => {\n          const isLocked =\n            !isSuccessCommandResult(output) &&\n            \"errorCode\" in output.error &&\n            output.error.errorCode === \"5515\";\n          if (isLocked) {\n            return EMPTY; // Continue the polling\n          }\n          return of(undefined); // Complete the observable\n        }),\n        take(1),\n        timeout(input.unlockTimeout),\n      );\n\n    return {\n      getAppAndVersion,\n      waitForDeviceUnlock,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state: DeviceSessionState) =>\n        internalApi.setDeviceSessionState(state),\n      isDeviceOnboarded: () => true, // TODO: we don't have this info for now\n    };\n  }\n}\n", "import { type DmkError } from \"@api/Error\";\n\nexport type ConnectError =\n  | UnknownDeviceError\n  | OpeningConnectionError\n  | DeviceAlreadyConnectedError;\n\nexport class GeneralDmkError implements DmkError {\n  _tag = \"GeneralDmkError\";\n  originalError?: unknown;\n  constructor(err?: unknown) {\n    if (err instanceof Error) {\n      this.originalError = err;\n    } else if (err !== undefined) {\n      this.originalError = new Error(String(err));\n    }\n  }\n}\n\nexport class DeviceAlreadyConnectedError extends GeneralDmkError {\n  override readonly _tag = \"DeviceAlreadyDiscoveredError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class DeviceNotRecognizedError extends GeneralDmkError {\n  override readonly _tag = \"DeviceNotRecognizedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class NoAccessibleDeviceError extends GeneralDmkError {\n  override readonly _tag = \"NoAccessibleDeviceError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class OpeningConnectionError extends GeneralDmkError {\n  override _tag = \"ConnectionOpeningError\";\n  constructor(err?: unknown) {\n    super(err);\n  }\n}\n\nexport class UnknownDeviceError extends GeneralDmkError {\n  override readonly _tag = \"UnknownDeviceError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class TransportNotSupportedError extends GeneralDmkError {\n  override readonly _tag = \"TransportNotSupportedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\nexport class SendApduConcurrencyError extends GeneralDmkError {\n  override readonly _tag = \"SendApduConcurrencyError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class SendApduTimeoutError extends GeneralDmkError {\n  override readonly _tag = \"SendApduTimeoutError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class SendApduEmptyResponseError extends GeneralDmkError {\n  override readonly _tag = \"SendApduEmptyResponseError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class DisconnectError extends GeneralDmkError {\n  override readonly _tag = \"DisconnectError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class ReconnectionFailedError extends GeneralDmkError {\n  override readonly _tag = \"ReconnectionFailedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class DeviceNotInitializedError extends GeneralDmkError {\n  override readonly _tag = \"DeviceNotInitializedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class NoTransportsProvidedError extends GeneralDmkError {\n  override readonly _tag = \"NoTransportsProvidedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class TransportAlreadyExistsError extends GeneralDmkError {\n  override readonly _tag = \"TransportAlreadyExistsError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class DeviceDisconnectedWhileSendingError extends GeneralDmkError {\n  override readonly _tag = \"DeviceDisconnectedWhileSendingError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class AlreadySendingApduError extends GeneralDmkError {\n  override readonly _tag = \"AlreadySendingApduError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class DeviceDisconnectedBeforeSendingApdu extends GeneralDmkError {\n  override readonly _tag = \"DeviceDisconnectedBeforeSendingApdu\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n\nexport class NoTransportProvidedError extends GeneralDmkError {\n  override readonly _tag = \"NoTransportProvidedError\";\n  constructor(readonly err?: unknown) {\n    super(err);\n  }\n}\n", "const DASHBOARD_NAMES = [\"BOLOS\", \"OLOS\", \"OLOS\\u0000\"];\n\nexport const isDashboardName = (name: string) => DASHBOARD_NAMES.includes(name);\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  CloseAppCommand,\n  type CloseAppCommandResult,\n} from \"@api/command/os/CloseAppCommand\";\nimport {\n  OpenAppCommand,\n  type OpenAppCommandResult,\n} from \"@api/command/os/OpenAppCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { DeviceNotOnboardedError } from \"@api/device-action/os/Errors\";\nimport { GetDeviceStatusDeviceAction } from \"@api/device-action/os/GetDeviceStatus/GetDeviceStatusDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { DeviceDisconnectedWhileSendingError } from \"@api/transport/model/Errors\";\nimport { isDashboardName } from \"@api/utils/AppName\";\n\nimport {\n  type OpenAppDAError,\n  type OpenAppDAInput,\n  type OpenAppDAIntermediateValue,\n  type OpenAppDAOutput,\n} from \"./types\";\n\ntype OpenAppStateMachineInternalState = {\n  readonly currentlyRunningApp: string | null;\n  readonly error: OpenAppDAError | null;\n};\n\nexport type MachineDependencies = {\n  readonly closeApp: () => Promise<CloseAppCommandResult>;\n  readonly openApp: (arg0: {\n    input: { appName: string };\n  }) => Promise<OpenAppCommandResult>;\n  readonly getDeviceSessionState: () => DeviceSessionState;\n  readonly setDeviceSessionState: (state: DeviceSessionState) => void;\n  readonly isDeviceOnboarded: () => boolean;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\n/**\n * Opens a given app on the device.\n *\n * It checks if the device is onboarded, unlocked, and which app is currently open.\n * If the current app is the dashboard, it will directly open the requested app.\n * If another app is opened, it will close the current app and open the requested app.\n *\n * Example of usage:\n *\n * ```ts\n * const deviceAction = new OpenAppDeviceAction({\n *    input: {\n *      appName: \"MyApp\",\n *    },\n *  });\n * dmk.executeDeviceAction({ sessionId: \"mySessionId\", deviceAction });\n * ```\n */\nexport class OpenAppDeviceAction extends XStateDeviceAction<\n  OpenAppDAOutput,\n  OpenAppDAInput,\n  OpenAppDAError,\n  OpenAppDAIntermediateValue,\n  OpenAppStateMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    OpenAppDAOutput,\n    OpenAppDAInput,\n    OpenAppDAError,\n    OpenAppDAIntermediateValue,\n    OpenAppStateMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      OpenAppDAOutput,\n      OpenAppDAInput,\n      OpenAppDAError,\n      OpenAppDAIntermediateValue,\n      OpenAppStateMachineInternalState\n    >;\n\n    const {\n      closeApp,\n      openApp,\n      getDeviceSessionState,\n      isDeviceOnboarded,\n      setDeviceSessionState,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const getDeviceStatusMachine = new GetDeviceStatusDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        closeApp: fromPromise(closeApp),\n        openApp: fromPromise(openApp),\n        getDeviceStatus: getDeviceStatusMachine,\n      },\n      guards: {\n        isDeviceOnboarded: () => isDeviceOnboarded(), // TODO: we don't have this info for now, this can be derived from the \"flags\" obtained in the getVersion command\n        isRequestedAppOpen: ({ context }: { context: types[\"context\"] }) => {\n          if (context._internalState.currentlyRunningApp === null) return false;\n          return (\n            context._internalState.currentlyRunningApp === context.input.appName\n          );\n        },\n        isDashboardOpen: ({ context }: { context: types[\"context\"] }) => {\n          if (context._internalState.currentlyRunningApp === null)\n            throw new Error(\"context.currentlyRunningApp === null\");\n          return isDashboardName(context._internalState.currentlyRunningApp);\n        },\n        hasDisconnectedWhileSending: ({ context }) =>\n          context._internalState.error !== null &&\n          context._internalState.error instanceof\n            DeviceDisconnectedWhileSendingError,\n        hasError: ({ context }) => context._internalState.error !== null,\n      },\n      actions: {\n        assignErrorDeviceNotOnboarded: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new DeviceNotOnboardedError(),\n          }),\n        }),\n        assignUserActionNeededOpenApp: assign({\n          intermediateValue: (_) =>\n            ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.ConfirmOpenApp,\n            }) satisfies types[\"context\"][\"intermediateValue\"],\n        }),\n        assignNoUserActionNeeded: assign({\n          intermediateValue: (_) =>\n            ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }) satisfies types[\"context\"][\"intermediateValue\"],\n        }),\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // FIXME: add a typeguard\n          }),\n        }),\n        assignNoError: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: null,\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QHkAOYB2BBVqAiYAbgJYDGYWpALsQPYYB0BJ5ASmAIYQCeAxANoAGALqJQqWrGI16YkAA9EARhWCGADgAsAZm1b1SwUoDspgDQhuiAEzX1DbQE5tJlQDYlm414CsAXz8LNEwcfCIyCmo6RmQMACNaDgAnCGIMKABhAAswUgBrARE5CSkZDDlFBCUPbQYfZx91H0FtTRNjCysEbWM1bTdHAzcfH2q9awCg9GxcZgjKMoZYhOTU9Ozcgv4lUSQQEuloiuUauoamlrbzSxtBNTu7pW1BEe1rJUmQYJmwlkjFgAytHyaUyOXyhV24kkh1ke0q7w8DDcxmqjkM1l6Kh8nUQzR8DEEjjcz3UxKUjiMbk+31Cc3IC2iDCBIPW4K2O2KMLKxwQiKUyNRAwxWKUOJu3TaDFsw28bkExmsgnU-Rp0zp4QZUXoDFCABsyBwylhCBxiHqOHE9WBeBB6GAGGlCLQ8g7abNNf8mfrDcbTebLdaEE7gUbokJhBGuaUjvCbCSCdZNI5UQqhg1cQhNOprAxND4XP0xZTHI01SEPX9GTqfaQw-QTWaLVabWAkklaEkGKgLVQAGadgC2S3Vlfm2sYtfr2H9zaDIbrZQjUb2Bx5cb5CelydTxnT2nFXTcmjUBYTzlazkcE0CX1Hv3HiynfqbgbA7FgAFc9VQNhCV9CMZwqAlQuAWZwHiqbStI0mY+PmdRKNYxLZmKgjvDeUwVg+WpPrgBqLtEjYBi2H7fr+7ICJyq7crGIGIK0LwME8dzJuizzNNYmZeLmAysZ4Ph2KYmiaOWPz0l6Nb4b60R-lsRQ0UB5Qbq0pgMM4FJ8dYx4KpomaOJo6k9G4yHvEhBmYmJGpVhOurSYR9ByVRUL7LRwEKAxYq1PUkGtE8+ZaJmBh1A8hieMh17vFZY64UyeAcLAWQrCkTkAa5Sm8tY-TIkmlJvFojjXuocHysiegvB4JJ6P4t7ujhkmMPFiXJRAqXUYBsLKfRfLZSZyYtHYbF2JmQoaMeIweEmJjHtF9XVowGR6pIFD2dOtr2o6GDOq6I7YRJ80MIty3PtEwZbaGS4iGla50R5CBVYSJkFncbzGC4mYoo4zHlfUCo+KieizfttlHbAK09jJ9C8G2HZdj2RoDkkw51cDiyg+DBHTmdzoORgy4KR167dQ9ghPc8A1vUomZIQqeZksmTw9JoJlA56B3oyd9BkT+qUE+lnW8iohgaDoeioUYpgdBKQu5sz8rEgYxjwaJtX3qjTIc6tZTcxRmzOdGAsbqoagmM8Yr-aTTyOCNpXWAW-TGIMfmO6zNmLHVmNlOtGAOiGO0o2ztke5DGDYxd4ZXXzN3uZU1RPBBjTNM7UtdAWxjqQZ6gqv0LyO9oruPkywe49D7adt2vaI8jauB+796e6dC7TvjLnR11d1x955xJ1cKeIAZ6dGEJqJKk4qqq3ttdF-XIc67zrdue3CLVG4gqZyMpbGG4bhBeoq9b-mB7jaTZYT+JU86sX05z5R2wLxlG78oKYpNKW16mx9x6EkhWdGKTSvXgLrFKSENcbsC4Hwa6i9eQHgQgmCkIlBjKmcEFUY24ejaSTMeCkHxPgYFoBAOAcgA5u1um3XkABaHeEoKEEkKvQwQJ4XjKl6ErIBDUmCenATwA2RM7rknUm4FUhV-oiTJFTCUth05j0xJVFUTxt7sIOssRIKRQRyV4bdWOTNkTqDekqAwbxNDIUzFIhwzhZHVHkf0akZ9rKFx1CyPI6j2SaJjsoUsBIBimB8MMeUZJqFdH6PYDwKYBjwQaEYpRtlOYzlfC2NxS8bB6HsM4RUIwiSH0VNxAy6lkL1EEjTYUtisLn1ISAhuDZZxvhvpsRJmVX51FJFlZ4-Qk5wUYcxR2BTTIGUKtEvCoDpwaMUobbqugUzIg8PmEwIiTJ9yqAMaUW90IngCaIgZcUEpJVUa1Vxoy+GVGMbvZiuVf5IM8CoTZOpNZDL4eQjcIlDLIRRH5FhoxDyIGFMiASe8IoFlGNchaS0waxNqfkepG4tACiMGeQw6IiQeBGncMaMycxEl8eoIFu0fiVPbg87qSE3q6MVBpehPQ4K6G+uoZUJIVB7laNiq+2s4DkRGYTLRygs6GSQtmO4iIaWljgvUBgip-K5RErofOdiYocLBZwHhBzOWSkKqKz6Lw3i6U+QgPchlTB7xTPBeCWVHDYoAMqflIOQWA8AlXuO6KMQylImipgMi4BZzhDIKkpM0FEypRimplXNWyABRMuSRIXjNaKvHQ3h0Q0reCYT+3khGNEKgqIRxgAgBCAA */\n      id: \"OpenAppDeviceAction\",\n      initial: \"DeviceReady\",\n      context: ({ input }) => {\n        const sessionState = getDeviceSessionState();\n        const { sessionStateType } = sessionState;\n        return {\n          input,\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            currentlyRunningApp:\n              sessionStateType ===\n              DeviceSessionStateType.ReadyWithoutSecureChannel\n                ? sessionState.currentApp.name\n                : null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          // check device capabilities & status known\n          always: {\n            target: \"OnboardingCheck\",\n          },\n        },\n\n        OnboardingCheck: {\n          // check onboarding status provided by device session\n          always: [\n            {\n              target: \"GetDeviceStatus\",\n              guard: {\n                type: \"isDeviceOnboarded\",\n              },\n            },\n            {\n              target: \"Error\",\n              actions: \"assignErrorDeviceNotOnboarded\",\n            },\n          ],\n        },\n\n        GetDeviceStatus: {\n          // We run the GetDeviceStatus flow to get information about the device state\n          invoke: {\n            id: \"deviceStatus\",\n            src: \"getDeviceStatus\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"CheckDeviceStatus\",\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf<OpenAppStateMachineInternalState>(\n                    {\n                      Right: (output) => {\n                        const state: DeviceSessionState =\n                          getDeviceSessionState();\n\n                        if (\n                          state.sessionStateType !==\n                          DeviceSessionStateType.Connected\n                        ) {\n                          setDeviceSessionState({\n                            ...state,\n                            currentApp: {\n                              name: output.currentApp,\n                              version: output.currentAppVersion,\n                            },\n                          });\n                        }\n                        return {\n                          ..._.context._internalState,\n                          currentlyRunningApp: output.currentApp,\n                        };\n                      },\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        currentlyRunningApp: null,\n                        error,\n                      }),\n                    },\n                  );\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: [\n                assign({\n                  _internalState: (_) => ({\n                    ..._.context._internalState,\n                    currentlyRunningApp: null,\n                  }),\n                }),\n                \"assignErrorFromEvent\",\n              ],\n            },\n          },\n        },\n        CheckDeviceStatus: {\n          // We check the device status to see if we can have an error\n          always: [\n            {\n              target: \"ApplicationReady\",\n              guard: \"isRequestedAppOpen\",\n              // If target app is currently opened, we can ignore errors\n              actions: \"assignNoError\",\n            },\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"DashboardCheck\",\n            },\n          ],\n        },\n\n        DashboardCheck: {\n          // Is the current application the dashboard\n          always: [\n            {\n              target: \"OpenApplication\",\n              guard: \"isDashboardOpen\",\n            },\n            \"CloseApplication\",\n          ],\n        },\n\n        OpenApplication: {\n          // execute openApp command,\n          entry: \"assignUserActionNeededOpenApp\",\n          exit: \"assignNoUserActionNeeded\",\n          invoke: {\n            src: \"openApp\",\n            input: ({ context }) => ({ appName: context.input.appName }),\n            onDone: {\n              target: \"OpenApplicationResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    return {\n                      ..._.context._internalState,\n                      currentlyRunningApp: _.context.input.appName,\n                    };\n                  } else {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.output.error,\n                    };\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"OpenApplicationResultCheck\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n\n        OpenApplicationResultCheck: {\n          always: [\n            {\n              // When an APDU triggers a disconnection, some transports may possibly\n              // be closed on device side before the APDU response could be received,\n              // especially on BLE transports.\n              // Therefore when a disconnection occurs while sending, we should verify\n              // the device status because it may have been successfully executed.\n              target: \"GetDeviceStatus\",\n              guard: \"hasDisconnectedWhileSending\",\n            },\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"GetDeviceStatus\" },\n          ],\n        },\n\n        CloseApplication: {\n          invoke: {\n            src: \"closeApp\",\n            onDone: {\n              target: \"CloseApplicationResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    return {\n                      ..._.context._internalState,\n                      currentlyRunningApp: \"BOLOS\",\n                    };\n                  } else {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.output.error,\n                    };\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        CloseApplicationResultCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"OpenApplication\" },\n          ],\n        },\n\n        ApplicationReady: {\n          // application is ready to be used\n          always: \"Success\",\n        },\n\n        // success state\n        Success: {\n          type: \"final\",\n          actions: \"assignNoError\", // TODO, we should not need this\n        },\n\n        // error state\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: ({ context }) =>\n        context._internalState.error // TODO: instead we should rely on the current state (\"Success\" or \"Error\")\n          ? Left(context._internalState.error)\n          : Right(undefined),\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const closeApp = async () => internalApi.sendCommand(new CloseAppCommand());\n    const openApp = async (arg0: { input: { appName: string } }) =>\n      internalApi.sendCommand(\n        new OpenAppCommand({ appName: arg0.input.appName }),\n      );\n\n    return {\n      closeApp,\n      openApp,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state: DeviceSessionState) =>\n        internalApi.setDeviceSessionState(state),\n      isDeviceOnboarded: () => true, // TODO: we don't have this info for now, this can be derived from the \"flags\" obtained in the getVersion command\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromPromise, setup } from \"xstate\";\n\nimport {\n  type CommandResult,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { OpenAppDeviceAction } from \"@api/device-action/os/OpenAppDeviceAction/OpenAppDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\n\nimport {\n  type CallTaskInAppDAError,\n  type CallTaskInAppDAInput,\n  type CallTaskInAppDAIntermediateValue,\n  type CallTaskInAppDAInternalState,\n  type CallTaskInAppDAOutput,\n} from \"./CallTaskInAppDeviceActionTypes\";\n\n/**\n * Tries to open an app on the device, and if it is successful, calls a task\n * in the app.\n * The output will be the result of the task.\n *\n * ```ts\n * input: {\n *  appName: string;\n *  task: (internalApi: InternalApi) => Promise<CommandResult<TaskResponse, TaskErrorCodes>>;\n *  requiredUserInteraction: UserInteraction;\n * }\n * ```\n *\n * Example of usage:\n *\n * ```ts\n * const deviceAction = new CallTaskInAppDeviceAction({\n *  input: {\n *   appName: \"MyApp\",\n *   task: async (internalApi: InternalApi) => internalApi.sendCommand(new MyAppSpecificCommand()),\n *   requiredUserInteraction: UserInteractionRequired.None,\n *  },\n * });\n * dmk.executeDeviceAction({ sessionId: \"mySessionId\", deviceAction });\n * ```\n */\nexport class CallTaskInAppDeviceAction<\n  TaskResponse,\n  TaskErrorCodes,\n  UserInteraction extends UserInteractionRequired,\n> extends XStateDeviceAction<\n  CallTaskInAppDAOutput<TaskResponse>,\n  CallTaskInAppDAInput<TaskResponse, TaskErrorCodes, UserInteraction>,\n  CallTaskInAppDAError<TaskErrorCodes>,\n  CallTaskInAppDAIntermediateValue<UserInteraction>,\n  CallTaskInAppDAInternalState<TaskResponse, TaskErrorCodes>\n> {\n  makeStateMachine(\n    internalAPI: InternalApi,\n  ): DeviceActionStateMachine<\n    CallTaskInAppDAOutput<TaskResponse>,\n    CallTaskInAppDAInput<TaskResponse, TaskErrorCodes, UserInteraction>,\n    CallTaskInAppDAError<TaskErrorCodes>,\n    CallTaskInAppDAIntermediateValue<UserInteraction>,\n    CallTaskInAppDAInternalState<TaskResponse, TaskErrorCodes>\n  > {\n    type types = StateMachineTypes<\n      CallTaskInAppDAOutput<TaskResponse>,\n      CallTaskInAppDAInput<TaskResponse, TaskErrorCodes, UserInteraction>,\n      CallTaskInAppDAError<TaskErrorCodes>,\n      CallTaskInAppDAIntermediateValue<UserInteraction>,\n      CallTaskInAppDAInternalState<TaskResponse, TaskErrorCodes>\n    >;\n\n    const { callTask } = this.extractDependencies(internalAPI);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        callTask: fromPromise(callTask),\n        openAppStateMachine: new OpenAppDeviceAction({\n          input: {\n            appName: this.input.appName,\n          },\n        }).makeStateMachine(internalAPI),\n      },\n      guards: {\n        skipOpenApp: () => this.input.skipOpenApp,\n        noInternalError: ({ context }) => context._internalState.error === null,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      id: \"CallTaskInAppDeviceAction\",\n      initial: \"InitialState\",\n      context: ({ input }) => {\n        return {\n          input: input,\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            taskResponse: null,\n            error: null,\n          },\n        };\n      },\n      states: {\n        InitialState: {\n          always: [\n            {\n              target: \"CallTask\",\n              guard: \"skipOpenApp\",\n            },\n            \"OpenAppDeviceAction\",\n          ],\n        },\n        OpenAppDeviceAction: {\n          invoke: {\n            id: \"openAppStateMachine\",\n            input: {\n              appName: this.input.appName,\n            },\n            src: \"openAppStateMachine\",\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf<\n                    CallTaskInAppDAInternalState<TaskResponse, TaskErrorCodes>\n                  >({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n              target: \"CheckOpenAppDeviceActionResult\",\n            },\n          },\n        },\n        CheckOpenAppDeviceActionResult: {\n          always: [\n            {\n              target: \"CallTask\",\n              guard: \"noInternalError\",\n            },\n            \"Error\",\n          ],\n        },\n        CallTask: {\n          entry: assign({\n            intermediateValue: {\n              requiredUserInteraction: this.input.requiredUserInteraction,\n            },\n          }),\n          exit: assign({\n            intermediateValue: {\n              requiredUserInteraction: UserInteractionRequired.None,\n            },\n          }),\n          invoke: {\n            id: \"callTask\",\n            src: \"callTask\",\n            input: (_: { context: types[\"context\"] }) => _.context.input.task,\n            onDone: {\n              target: \"CallTaskResultCheck\",\n              actions: [\n                assign({\n                  _internalState: ({ event, context }) => {\n                    if (isSuccessCommandResult(event.output)) {\n                      return {\n                        ...context._internalState,\n                        taskResponse: event.output.data,\n                      };\n                    }\n                    return {\n                      ...context._internalState,\n                      error: event.output.error,\n                    };\n                  },\n                }),\n              ],\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        CallTaskResultCheck: {\n          always: [\n            {\n              target: \"Success\",\n              guard: \"noInternalError\",\n            },\n            \"Error\",\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: ({ context }) =>\n        context._internalState.taskResponse\n          ? Right(context._internalState.taskResponse)\n          : Left(\n              context._internalState.error ||\n                new UnknownDAError(\"No error in final state\"),\n            ),\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi) {\n    return {\n      callTask: (_: {\n        input: (\n          internalApi: InternalApi,\n        ) => Promise<CommandResult<TaskResponse, TaskErrorCodes>>;\n      }): Promise<CommandResult<TaskResponse, TaskErrorCodes>> =>\n        _.input(internalApi),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  CloseAppCommand,\n  type CloseAppCommandResult,\n} from \"@api/command/os/CloseAppCommand\";\nimport {\n  GetAppAndVersionCommand,\n  type GetAppAndVersionCommandResult,\n} from \"@api/command/os/GetAppAndVersionCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { GetDeviceStatusDeviceAction } from \"@api/device-action/os/GetDeviceStatus/GetDeviceStatusDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { isDashboardName } from \"@api/utils/AppName\";\n\nimport type {\n  GoToDashboardDAError,\n  GoToDashboardDAInput,\n  GoToDashboardDAIntermediateValue,\n  GoToDashboardDAOutput,\n} from \"./types\";\n\ntype GoToDashboardMachineInternalState = {\n  readonly currentApp: string | null;\n  readonly error: GoToDashboardDAError | null;\n};\n\nexport type MachineDependencies = {\n  readonly getAppAndVersion: () => Promise<GetAppAndVersionCommandResult>;\n  readonly closeApp: () => Promise<CloseAppCommandResult>;\n  readonly getDeviceSessionState: () => DeviceSessionState;\n  readonly setDeviceSessionState: (\n    state: DeviceSessionState,\n  ) => DeviceSessionState;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\nexport class GoToDashboardDeviceAction extends XStateDeviceAction<\n  GoToDashboardDAOutput,\n  GoToDashboardDAInput,\n  GoToDashboardDAError,\n  GoToDashboardDAIntermediateValue,\n  GoToDashboardMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    GoToDashboardDAOutput,\n    GoToDashboardDAInput,\n    GoToDashboardDAError,\n    GoToDashboardDAIntermediateValue,\n    GoToDashboardMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      GoToDashboardDAOutput,\n      GoToDashboardDAInput,\n      GoToDashboardDAError,\n      GoToDashboardDAIntermediateValue,\n      GoToDashboardMachineInternalState\n    >;\n\n    const {\n      getDeviceSessionState,\n      setDeviceSessionState,\n      closeApp,\n      getAppAndVersion,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const getDeviceStatusMachine = new GetDeviceStatusDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        getAppAndVersion: fromPromise(getAppAndVersion),\n        closeApp: fromPromise(closeApp),\n        getDeviceStatus: getDeviceStatusMachine,\n      },\n      guards: {\n        hasError: ({ context }: { context: types[\"context\"] }) => {\n          return context._internalState.error !== null;\n        },\n        isDashboardOpen: ({ context }: { context: types[\"context\"] }) =>\n          context._internalState.currentApp !== null &&\n          isDashboardName(context._internalState.currentApp),\n      },\n      actions: {\n        // assignGetDeviceStatusUnknownError: assign({\n        //   _internalState: (_) => ({\n        //     ..._.context._internalState,\n        //     error: new UnknownDAError(\"GetDeviceUnknownStatusError\"),\n        //   }),\n        // }),\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QHED2AVVARAhrAFgEao4BOEWYAbgJYDGYAgnQC42oB2AdJbQwEpgcEAJ4BiANoAGALqJQAB1SwabTvJAAPRAHYAjFwDMATikA2MwA5DOnQBYArGeOGANCBGI9VrlcvmpRyknQwcAXzD3NExcAmIyCmp6JlZ2bmQwFl5kgGUWHBYAV1gxCE4wLhoOKlQAawqIJIY8guLpOSQQJRU1Dg1tBAAmOy49QYcpHQdBvR0pMcszO3dPBEM7My4HYz1pqWNLPRsdJYiojGw8IhJybIZmXq4AYXwwOlq7sBaikvaNbtUaX6iDsgy2g3Wdksjn8JlBDhWiAchk2OkMgysB2RzlBZxA0UucRuiT4KUeLzeHyaX3yP0keg6imUgPUnQGgxmo3hdkcemMwwcG0RCGxXDRGMsWJRxlxkXxF1i1wSnweaR4V3i5Ap70ksn+zN6wIQfMsYsG0LMg2MZlm60mwucDi4HMli0GgX0zjxBMVmpJyVVnHVRIS2tq9MZXQNQLZII5XEcoQx5kO3mWHkQjud5oOlo93mM3oVGuJKtSQd9xLDkkGkYBhtjCEtxi41h5fJs+ysOgdOjBE2Gw1sUmC5qLMRLyupge4ldDrx1EkMdejrNAA2sTu8jsO0Lsej5wr7prsoTGs2CJz748JStu0-L3CeABtlEwFApSuVKtU6hUfZO96kjOzyvrA74KAgVQ1HQBRpO0fydPWMbrl4kwGFMzizMYcyCsK-gjE4OiWBC-jGDK+g3nOQEBo+oFvowH5iGApCkKgpBcAoz4FAAZuxAC2XAASGNH3HRL4MR+UG-rBvQIXqSGrn0jaHGCNocoYko2BiUzCvymyadsdg6Dh+zTFRgH+mJ5JgRB1aIUyPQoVoaHEWKegjsYDgOGi9hjMKHmGAYdg7KCVhLOagoWSJVlkmqEngYxCj2Qy+pOWuLnGuMUhcNagoHMZgqhMYAVSEFCahRKEWWFFcrCXesUgRkLBJYwHAQAAaixKicF+HAVNBf5CcWMVlo8zWte1XWkD1HDSTBcGcPJK7pcpqEIARCZQsMqZSDM+7Cg4limjaXnbHMlhzIYERyhwqCNPAnT1X6Y3OchGUDAAtDKvj6NYgQohYljCsMRjzIYASTN2NjXXVI0Na9FbUoIwirI5LJrZloJcCOI52GVZihD5goIhmxoHq24OQycl02NFCMPuNmSfN8xRpRjRqfRsv16P9p4WFYIOGIYCYjgex1mD5oLrPTL2M-FC5UqSrOPejDbrbMraniZ+4nGV6J6OmqwbJsl3jPY2wQ2YaKy6W8sVpZYbs+rmUzDl4y84T7rBDyZgOvsWvqd4EI67bU7AeJtlJc7zkbnyYrBORxGaVCDh6PhhtGAcJjjPye3EWHolxUGCV2YrMcfWhFi5TyjgUYb9h+2TFG+GMIUhRyUy7IXjV0RNH5tZ13VvUpRpjOYYpBWZCxzOnZNHQZGweSR7qhDLcMTqN9vcDkhR0AwsCq1Gq1GhyIxWvsSYWMZ-I9mTJGEbXsx7Av4Qb7ecsR48ACirHsRXmMBjIi2JaRwEIDzeWtsDMmgUdCthwjadSaJFiWBumEIAA */\n      id: \"GoToDashboardDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        const sessionState = getDeviceSessionState();\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            currentApp:\n              \"currentApp\" in sessionState\n                ? sessionState.currentApp.name\n                : null,\n            error: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"GetDeviceStatus\",\n          },\n        },\n        GetDeviceStatus: {\n          // We run the GetDeviceStatus flow to get information about the device state\n          invoke: {\n            id: \"deviceStatus\",\n            src: \"getDeviceStatus\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"CheckDeviceStatus\",\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf<GoToDashboardMachineInternalState>(\n                    {\n                      Right: (output) => ({\n                        ..._.context._internalState,\n                        currentApp: output.currentApp,\n                      }),\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  );\n                },\n              }),\n            },\n            // NOTE: The way we handle our DeviceActions means that we should never as we return an Either\n            // onError: {\n            //   target: \"Error\",\n            //   actions: \"assignGetDeviceStatusUnknownError\",\n            // },\n          },\n        },\n        CheckDeviceStatus: {\n          // We check the device status to see if we can have an error\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"DashboardCheck\",\n            },\n          ],\n        },\n        DashboardCheck: {\n          // We check if the dashboard is open\n          always: [\n            {\n              target: \"Success\",\n              guard: \"isDashboardOpen\",\n            },\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Error\",\n              guard: (_) => {\n                return _.context._internalState.currentApp === null;\n              },\n              actions: assign({\n                _internalState: (_) => ({\n                  ..._.context._internalState,\n                  error: new UnknownDAError(\"currentApp === null\"),\n                }),\n              }),\n            },\n            {\n              target: \"CloseApp\",\n            },\n          ],\n        },\n        CloseApp: {\n          invoke: {\n            src: \"closeApp\",\n            onDone: {\n              target: \"CloseAppCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    return _.context._internalState;\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        CloseAppCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetAppAndVersion\",\n              reenter: true,\n            },\n          ],\n        },\n        GetAppAndVersion: {\n          invoke: {\n            src: \"getAppAndVersion\",\n            onDone: {\n              target: \"DashboardCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const state: DeviceSessionState = getDeviceSessionState();\n                    // Narrow the type to ReadyWithoutSecureChannelState or ReadyWithSecureChannelState\n                    if (\n                      state.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      setDeviceSessionState({\n                        ...state,\n                        currentApp: _.event.output.data,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      currentApp: _.event.output.data.name,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n          },\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (_) => {\n        if (_.context._internalState.error) {\n          return Left(_.context._internalState.error);\n        }\n\n        return Right(undefined);\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const closeApp = async () => internalApi.sendCommand(new CloseAppCommand());\n    const getAppAndVersion = async () =>\n      internalApi.sendCommand(new GetAppAndVersionCommand());\n\n    return {\n      closeApp,\n      getAppAndVersion,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state: DeviceSessionState) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  type AppResponse,\n  ListAppsCommand,\n  type ListAppsCommandResult,\n} from \"@api/command/os/ListAppsCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\n\nimport {\n  type ListAppsDAError,\n  type ListAppsDAInput,\n  type ListAppsDAIntermediateValue,\n  type ListAppsDAOutput,\n} from \"./types\";\n\ntype ListAppsMachineInternalState = {\n  readonly error: ListAppsDAError | null;\n  readonly apps: AppResponse[];\n  readonly shouldContinue: boolean;\n};\n\nexport type MachineDependencies = {\n  readonly listApps: ({\n    input,\n  }: {\n    input: boolean;\n  }) => Promise<ListAppsCommandResult>;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\nexport class ListAppsDeviceAction extends XStateDeviceAction<\n  ListAppsDAOutput,\n  ListAppsDAInput,\n  ListAppsDAError,\n  ListAppsDAIntermediateValue,\n  ListAppsMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    ListAppsDAOutput,\n    ListAppsDAInput,\n    ListAppsDAError,\n    ListAppsDAIntermediateValue,\n    ListAppsMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      ListAppsDAOutput,\n      ListAppsDAInput,\n      ListAppsDAError,\n      ListAppsDAIntermediateValue,\n      ListAppsMachineInternalState\n    >;\n\n    const { listApps } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        listApps: fromPromise<ListAppsCommandResult, boolean>(listApps),\n        goToDashboard: goToDashboardMachine,\n      },\n      guards: {\n        hasError: ({ context }: { context: types[\"context\"] }) => {\n          return context._internalState.error !== null;\n        },\n        hasMoreApps: (_) => _.context._internalState.shouldContinue,\n      },\n      actions: {\n        assignAllowListApps: assign({\n          intermediateValue: (_) =>\n            ({\n              requiredUserInteraction: UserInteractionRequired.AllowListApps,\n            }) satisfies types[\"context\"][\"intermediateValue\"],\n        }),\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QBkCWsAuBBADj2AImAG6oDGYWZGqA9gHYB0RpFASmAIYQCeAxAG0ADAF1EoHLVioaDcSAAeiAIwBOIYwAcANgDsyzat2HlAJgDMegDQgeKg412ntAVm3mdp1af0uAvn42aJi4+CzklNR0TADitAAqtAScsAAWAEa0nABOEHwQDGCMqPTEtADWRRApGVm5wmJIIJLSsvTySgguquaMACy6rvrKfSOqfTZ2CKZC2v3K2ou6xn2mms7+gSDB2HiEJBFUbYxxiclpmTl5YNnZtNmMOAA2nBgAZvcAtozVF3UQDXkLRk0Q6iG6vQGQ2UIzGE1siE0ykYLiEaLRuiECxcbmUASC6F2YQOFCO0ROCSSNUuuQAwqkwGRyoJRECpCC5E1OsosZpHAZBi5zKpuhjJohTBZHBt3N5UapVGp8dtCaF9qxIsdTlS-ld6YzmQJlI0JOy2mCEDyHPpNILhaKhLpxQg+kI+ZjzGZdD0seYPMqdmrwqSogxGIG9vlCsVShUihHiRqyWGE7AECUymRXtEGoCmsDzVyVAM+cpzGtzKjvdp1ppnZWNNosW4+sLNEJUdo+gHVXtg5ryam+Dc7g9nq8Ptlvqn+8mmKn07Gs21c6z82bQUXLSXGGWK1XVDW1s6XMZ+kKzLaZk3XD2Qn2SQOU738HwFJhXkVOG8MDcABTKKiaIAJR8DOj5zuGL6wHmpqtJuoDcjue6aA21a1s6ejIuo2imDiCy6H0PS6HeRLqocobztBtIMDQ9AAK5gFG9BFBmcZQfeiYUccqY0fQdGMYumbZgwq4ms0G6cohKiaC4pZCOMQjlu4bguPWqyMJKrhdpKmLLNopFBhBlEcWRfECUxI73I8LzvF8plGUmJm8bRJSCWxy45qIsESfBUmKBKMzIjMnpyTitp+uY9ZyburYWDCfQ1ro5aGQ+TnHOZblMT5BYIQFlqoaojDaCK5iuq2XY1s6iW6I4h54bJlheKlXEhhlrkMdlxpsn57RbgYbiMLMeFrLpMxCiewqOOV4xEai6x4sq9C0BAcDyOB6V5bl-mdAAtNozq7S4jAKqdFgKdW+4teRbXkv2HDcFMcEcn10kuqYzowrVTjaR4TXrNds4mdq5y1FcPUvRaazHaVl5Cq66hqQiCDjJpMplQYmijClWwbdx5Ig9S-z6kyEOFm97bIqsh4KsKZYlQdyOSnywrluYsxDJTmwEpxN1PlRvNk3l3IGMiOIDB2ZWtq6H3I5WtV9BePhYm6gymIDxk8dRHWMULO0SlicyyYBPRlt4jXRXM2hqN6lg8j0GubWGmWdXrr35QsOhDbJh5+l44XwlM5hOCixhej4Ip9Ei3a49BQPHAAyvRZAULA8Drr1UM4nMMxeM4NaoR4TrI0KOczX0cWKo7+NhgAorc9xu1DoxFYBuE6O2OgKfWZ46EYimzAsXYBAEQA */\n      id: \"ListAppsDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            apps: [],\n            shouldContinue: false,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"GoToDashboard\",\n          },\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"dashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf<ListAppsMachineInternalState>({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"ListApps\",\n            },\n          ],\n        },\n        ListApps: {\n          // NOTE: This is a timeout that is currently not used\n          // We need to discuss this as a team, how do we want to\n          // handle the case when the user does not validate or reject on the device\n          // after: {\n          //   15000: \"Error\",\n          //   actions: assign({\n          //     _internalState: (_) => ({\n          //       error: new UnknownDAError(\"ListAppsTimeout\"),\n          //     }),\n          //   }),\n          // },\n          entry: \"assignAllowListApps\",\n          invoke: {\n            src: \"listApps\",\n            input: (_) => false,\n            onDone: {\n              target: \"Continue\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    return {\n                      ..._.context._internalState,\n                      apps: _.context._internalState.apps.concat(\n                        _.event.output.data,\n                      ),\n                      shouldContinue: _.event.output.data.length >= 2,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction: UserInteractionRequired.None,\n                }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ListAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            \"ListAppsContinue\",\n          ],\n        },\n        ListAppsContinue: {\n          invoke: {\n            src: \"listApps\",\n            input: (_) => true,\n            onDone: {\n              target: \"Continue\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    return {\n                      ..._.context._internalState,\n                      apps: _.context._internalState.apps.concat(\n                        _.event.output.data,\n                      ),\n                      shouldContinue: _.event.output.data.length >= 2,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        Continue: {\n          always: [\n            {\n              target: \"ListAppsContinue\",\n              guard: \"hasMoreApps\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (_) => {\n        if (_.context._internalState.error) {\n          return Left(_.context._internalState.error);\n        }\n\n        return Right(_.context._internalState.apps);\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const listApps = async ({ input }: { input: boolean }) => {\n      const command = new ListAppsCommand({ isContinue: input });\n      return internalApi.sendCommand(command);\n    };\n\n    return {\n      listApps,\n    };\n  }\n}\n", "import { gt } from \"semver\";\n\nimport { InvalidStatusWordError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { ListLanguagePackCommand } from \"@api/command/os/ListLanguagePackCommand\";\nimport type { InternalApi } from \"@api/device-action/DeviceAction\";\nimport {\n  type Catalog,\n  type FirmwareVersion,\n  type InstalledLanguagePackage,\n} from \"@api/device-session/DeviceSessionState\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\n\nexport type InstalledApp = {\n  hash: string;\n  hashCode: string;\n  name: string;\n};\n\nexport type GetApplicationsMetadataTaskArgs = {\n  deviceVersion: DeviceVersion;\n  firmware: FinalFirmware;\n  firmwareVersion: FirmwareVersion;\n  installedApps: InstalledApp[];\n};\n\nexport type GetApplicationsMetadataTaskResult = CommandResult<{\n  applications: Application[];\n  applicationsUpdates: Application[];\n  installedLanguages: InstalledLanguagePackage[];\n  catalog: Catalog;\n}>;\n\nconst ZERO_HASH =\n  \"0000000000000000000000000000000000000000000000000000000000000000\";\n\nexport class GetApplicationsMetadataTask {\n  constructor(\n    private readonly api: InternalApi,\n    private readonly args: GetApplicationsMetadataTaskArgs,\n  ) {}\n\n  async run(): Promise<GetApplicationsMetadataTaskResult> {\n    // Get applications metadata\n    const installedApps = this.args.installedApps.filter((app) =>\n      this.isApplication(app),\n    );\n    const manager = this.api.getManagerApiService();\n    const appHashes = installedApps.map((app) => app.hash);\n    const result = await manager\n      .getAppsByHash(appHashes)\n      .chain((applications) =>\n        manager\n          .getAppList(this.args.firmwareVersion.metadata!)\n          .map((catalog) => ({ applications, catalog })),\n      );\n    if (result.isLeft()) {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Cannot get the application catalog\"),\n      });\n    }\n    const { applications, catalog } = result.unsafeCoerce();\n\n    // Complete applications metadata using the catalog if needed\n    const appsWithMetadata = applications.reduce((apps, app, index) => {\n      if (app !== null) {\n        // Is the app hash was found in app store, append its metadata\n        return [...apps, app];\n      }\n      // For apps with non-deterministic hash (ie. Security Key, sideloaded app, ...),\n      // use metadata of latest version from the catalog\n      const installedApp = installedApps[index]!;\n      const catalogApp = catalog.find(\n        (c) => c.versionName === installedApp.name,\n      );\n      return catalogApp ? [...apps, catalogApp] : apps;\n    }, [] as Application[]);\n\n    // Filter apps metadata and catalog\n    const filteredApps = applications.filter((app) => app !== null);\n    const filteredCatalog = filteredApps.reduce((apps, app) => {\n      const catalogApp = catalog.find((c) => c.versionName === app.versionName);\n      if (catalogApp && gt(catalogApp.version, app.version)) {\n        return [...apps, catalogApp];\n      }\n      return apps;\n    }, [] as Application[]);\n\n    // Get install language packages\n    let installedLanguages: InstalledLanguagePackage[] = [];\n    for (let i = 0; ; i++) {\n      const language = await this.api.sendCommand(\n        new ListLanguagePackCommand({ firstChunk: i === 0 }),\n      );\n      if (!isSuccessCommandResult(language) || language.data === undefined) {\n        break;\n      }\n      installedLanguages = [...installedLanguages, language.data];\n    }\n\n    // Get all the available language packs for the device\n    const languages = await manager.getLanguagePackages(\n      this.args.deviceVersion,\n      this.args.firmware,\n    );\n    if (languages.isRight()) {\n      // Return the application metadata\n      return CommandResultFactory({\n        data: {\n          applications: appsWithMetadata,\n          applicationsUpdates: filteredCatalog,\n          installedLanguages,\n          catalog: {\n            applications: catalog,\n            languagePackages: languages.extract(),\n          },\n        },\n      });\n    } else {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Cannot get the languages catalog\"),\n      });\n    }\n  }\n\n  private isApplication(app: InstalledApp): boolean {\n    // Applications with no \"code\" hash are not real applications\n    // (typically a language package).\n    return app.hashCode !== ZERO_HASH;\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport { InvalidStatusWordError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport {\n  type CommandErrors,\n  isCommandErrorCode,\n} from \"@api/command/utils/CommandErrors\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type CommandErrorArgs, DeviceExchangeError } from \"@api/Error\";\nimport { bufferToHexaString } from \"@api/utils/HexaString\";\n\nexport type ListLanguagePackCommandArgs = {\n  readonly firstChunk: boolean;\n};\n\nexport type ListLanguagePackResponse =\n  | {\n      readonly id: number;\n      readonly size: number;\n    }\n  | undefined;\n\nexport type ListLanguagePackErrorCodes = \"662d\";\n\nconst LANGUAGE_PACK_ERRORS: CommandErrors<ListLanguagePackErrorCodes> = {\n  \"662d\": {\n    message:\n      \"Invalid LIST_ARG, first command must be sent with P1_LIST_LANGUAGE_PACKS_FIRST.\",\n  },\n};\n\nexport type ListLanguagePackCommandResult = CommandResult<\n  ListLanguagePackResponse,\n  ListLanguagePackErrorCodes\n>;\n\nexport class ListLanguagePackCommandError extends DeviceExchangeError<ListLanguagePackErrorCodes> {\n  constructor({\n    message,\n    errorCode,\n  }: CommandErrorArgs<ListLanguagePackErrorCodes>) {\n    super({ message, errorCode, tag: \"ListLanguagePackCommandError\" });\n  }\n}\n\nexport class ListLanguagePackCommand\n  implements\n    Command<\n      ListLanguagePackResponse,\n      ListLanguagePackCommandArgs,\n      ListLanguagePackErrorCodes\n    >\n{\n  readonly name = \"listLanguagePack\";\n\n  constructor(private args: ListLanguagePackCommandArgs) {}\n\n  getApdu(): Apdu {\n    const apduArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: 0x34,\n      p1: this.args.firstChunk ? 0x00 : 0x01,\n      p2: 0x00,\n    };\n    return new ApduBuilder(apduArgs).build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): ListLanguagePackCommandResult {\n    const parser = new ApduParser(apduResponse);\n\n    if (!CommandUtils.isSuccessResponse(apduResponse)) {\n      const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n      if (isCommandErrorCode(errorCode, LANGUAGE_PACK_ERRORS)) {\n        return CommandResultFactory({\n          error: new ListLanguagePackCommandError({\n            ...LANGUAGE_PACK_ERRORS[errorCode],\n            errorCode,\n          }),\n        });\n      }\n      return CommandResultFactory({\n        error: GlobalCommandErrorHandler.handle(apduResponse),\n      });\n    }\n\n    const tlvVersion = parser.extract8BitUInt();\n    if (tlvVersion === undefined) {\n      // No more language package\n      return CommandResultFactory({\n        data: undefined,\n      });\n    }\n\n    parser.extract8BitUInt(); // total length\n    const idBuffer = parser.extractFieldLVEncoded();\n    if (idBuffer === undefined) {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Failed to get language pack id\"),\n      });\n    }\n\n    const sizeBuffer = parser.extractFieldLVEncoded();\n    if (sizeBuffer === undefined) {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Failed to get language pack size\"),\n      });\n    }\n\n    const id = parseInt(bufferToHexaString(idBuffer), 16);\n    const size = parseInt(bufferToHexaString(sizeBuffer), 16);\n    return CommandResultFactory({\n      data: { id, size },\n    });\n  }\n}\n", "import { type Apdu } from \"@api/apdu/model/Apdu\";\nimport { ApduBuilder, type ApduBuilderArgs } from \"@api/apdu/utils/ApduBuilder\";\nimport { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type Command } from \"@api/command/Command\";\nimport { InvalidStatusWordError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n} from \"@api/command/model/CommandResult\";\nimport {\n  type CommandErrors,\n  isCommandErrorCode,\n} from \"@api/command/utils/CommandErrors\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { GlobalCommandErrorHandler } from \"@api/command/utils/GlobalCommandError\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type CommandErrorArgs, DeviceExchangeError } from \"@api/Error\";\n\nexport type GetCustomImageSizeResponse = number;\n\nexport type GetCustomImageSizeErrorCodes = \"662e\" | \"662f\";\n\nconst IMAGE_SIZE_ERRORS: CommandErrors<GetCustomImageSizeErrorCodes> = {\n  \"662e\": { message: \"Invalid state, no background image loaded.\" },\n  \"662f\": { message: \"Invalid state, device is in recovery mode.\" },\n};\n\nexport type GetCustomImageSizeCommandResult = CommandResult<\n  GetCustomImageSizeResponse,\n  GetCustomImageSizeErrorCodes\n>;\n\nexport class GetCustomImageSizeCommandError extends DeviceExchangeError<GetCustomImageSizeErrorCodes> {\n  constructor({\n    message,\n    errorCode,\n  }: CommandErrorArgs<GetCustomImageSizeErrorCodes>) {\n    super({ message, errorCode, tag: \"GetCustomImageSizeCommandError\" });\n  }\n}\n\nexport class GetCustomImageSizeCommand\n  implements\n    Command<GetCustomImageSizeResponse, void, GetCustomImageSizeErrorCodes>\n{\n  readonly name = \"getCustomImageSize\";\n\n  getApdu(): Apdu {\n    const apduArgs: ApduBuilderArgs = {\n      cla: 0xe0,\n      ins: 0x64,\n      p1: 0x00,\n      p2: 0x00,\n    };\n    return new ApduBuilder(apduArgs).build();\n  }\n\n  parseResponse(apduResponse: ApduResponse): GetCustomImageSizeCommandResult {\n    const parser = new ApduParser(apduResponse);\n\n    if (!CommandUtils.isSuccessResponse(apduResponse)) {\n      const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n      if (isCommandErrorCode(errorCode, IMAGE_SIZE_ERRORS)) {\n        return CommandResultFactory({\n          error: new GetCustomImageSizeCommandError({\n            ...IMAGE_SIZE_ERRORS[errorCode],\n            errorCode,\n          }),\n        });\n      }\n      return CommandResultFactory({\n        error: GlobalCommandErrorHandler.handle(apduResponse),\n      });\n    }\n\n    const size = parser.extract32BitUInt();\n    if (size === undefined) {\n      return CommandResultFactory({\n        error: new InvalidStatusWordError(\"Didn't receive any size\"),\n      });\n    }\n\n    return CommandResultFactory({\n      data: size,\n    });\n  }\n}\n", "import { InvalidGetFirmwareMetadataResponseError } from \"@api/command/Errors\";\nimport {\n  type CommandResult,\n  CommandResultFactory,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { GetCustomImageSizeCommand } from \"@api/command/os/GetCustomImageSizeCommand\";\nimport { GetOsVersionCommand } from \"@api/command/os/GetOsVersionCommand\";\nimport type { InternalApi } from \"@api/device-action/DeviceAction\";\nimport {\n  type CustomImage,\n  type FirmwareUpdate,\n  type FirmwareUpdateContext,\n  type FirmwareVersion,\n} from \"@api/device-session/DeviceSessionState\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\n\nexport type GetFirmwareMetadataTaskResult = CommandResult<{\n  deviceVersion: DeviceVersion;\n  firmware: FinalFirmware;\n  firmwareVersion: FirmwareVersion;\n  firmwareUpdateContext: FirmwareUpdateContext;\n  customImage: CustomImage;\n}>;\n\nexport class GetFirmwareMetadataTask {\n  constructor(private readonly api: InternalApi) {}\n\n  async run(): Promise<GetFirmwareMetadataTaskResult> {\n    // Get installed firmware metadata\n    const osVersion = await this.api.sendCommand(new GetOsVersionCommand());\n    if (!isSuccessCommandResult(osVersion)) {\n      return osVersion;\n    }\n    const firmwareVersion: FirmwareVersion = {\n      mcu: osVersion.data.mcuSephVersion,\n      bootloader: osVersion.data.mcuBootloaderVersion,\n      os: osVersion.data.seVersion,\n      metadata: osVersion.data,\n    };\n\n    // Fetch current firmware metadata from app store\n    const manager = this.api.getManagerApiService();\n    const result = await manager\n      .getDeviceVersion(osVersion.data)\n      .chain((deviceVersion) =>\n        manager\n          .getFirmwareVersion(osVersion.data, deviceVersion)\n          .map((currentFirmware) => ({ deviceVersion, currentFirmware })),\n      );\n    if (result.isLeft()) {\n      return CommandResultFactory({\n        error: new InvalidGetFirmwareMetadataResponseError(),\n      });\n    }\n    const { deviceVersion, currentFirmware } = result.unsafeCoerce();\n\n    // Fetch latest firmware available, if any\n    const maybeUpdate = await manager\n      .getLatestFirmwareVersion(currentFirmware, deviceVersion)\n      .chain((osuFirmware) =>\n        manager.getNextFirmwareVersion(osuFirmware).chain((finalFirmware) =>\n          manager\n            .getMcuList()\n            .map((mcus) => mcus.find((mcu) => mcu.name === firmwareVersion.mcu))\n            .map(\n              (mcu) =>\n                mcu === undefined ||\n                !finalFirmware.mcuVersions.includes(mcu.id),\n            )\n            .map((mcuUpdateRequired) => ({\n              osuFirmware,\n              finalFirmware,\n              mcuUpdateRequired,\n            })),\n        ),\n      );\n    const availableUpdate: FirmwareUpdate | undefined = maybeUpdate.caseOf({\n      Right: (data) => data,\n      Left: (_error) => undefined,\n    });\n    const firmwareUpdateContext = {\n      currentFirmware,\n      availableUpdate,\n    };\n\n    // Get custom image metadata\n    let customImage: CustomImage = {};\n    const imageSize = await this.api.sendCommand(\n      new GetCustomImageSizeCommand(),\n    );\n    if (isSuccessCommandResult(imageSize)) {\n      customImage = { size: imageSize.data };\n    }\n\n    // Return firmware metadata\n    return CommandResultFactory({\n      data: {\n        deviceVersion,\n        firmware: currentFirmware,\n        firmwareVersion,\n        firmwareUpdateContext,\n        customImage,\n      },\n    });\n  }\n}\n", "import { type EitherAsync } from \"purify-ts\";\nimport { type Observable } from \"rxjs\";\n\nimport { type CommandErrorResult } from \"@api/command/model/CommandResult\";\nimport {\n  type GetOsVersionCommandResult,\n  type GetOsVersionResponse,\n} from \"@api/command/os/GetOsVersionCommand\";\nimport { type DeviceActionState } from \"@api/device-action/model/DeviceActionState\";\nimport { type UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { type UnknownDAError } from \"@api/device-action/os/Errors\";\nimport {\n  type GoToDashboardDAError,\n  type GoToDashboardDAInput,\n} from \"@api/device-action/os/GoToDashboard/types\";\nimport { type DeviceSessionState } from \"@api/device-session/DeviceSessionState\";\nimport { type SecureChannelEvent } from \"@api/secure-channel/task/types\";\nimport { type Input } from \"@api/secure-channel/types\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type HttpFetchApiError } from \"@internal/manager-api/model/Errors\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\nimport type { SecureChannelDAErrors } from \"@internal/secure-channel/model/Errors\";\n\nexport type ListInstalledAppsDAOutput = {\n  installedApps: Array<InstalledApp>;\n};\n\nexport type ListInstalledAppsDAInput = GoToDashboardDAInput;\n\nexport type ListInstalledAppsDAError =\n  | CommandErrorResult[\"error\"]\n  | GoToDashboardDAError\n  | HttpFetchApiError\n  | SecureChannelDAErrors\n  | UnknownDAError;\n\nexport type ListInstalledAppsDARequiredInteraction =\n  | UserInteractionRequired.None\n  | UserInteractionRequired.UnlockDevice\n  | UserInteractionRequired.AllowSecureConnection;\n\nexport type ListInstalledAppsDAIntermediateValue = {\n  requiredUserInteraction: ListInstalledAppsDARequiredInteraction;\n  deviceId?: Uint8Array;\n};\n\nexport type ListInstalledAppsDAState = DeviceActionState<\n  ListInstalledAppsDAOutput,\n  ListInstalledAppsDAError,\n  ListInstalledAppsDAIntermediateValue\n>;\n\nexport type ListInstalledAppsStateMachineInternalState = {\n  error: ListInstalledAppsDAError | null;\n  result: { installedApps: Array<InstalledApp> };\n  getOsVersionResponse: GetOsVersionResponse | null;\n  deviceVersion: DeviceVersion | null;\n  firmwareVersion: FinalFirmware | null;\n};\n\nexport type MachineDependencies = {\n  getOsVersion: () => Promise<GetOsVersionCommandResult>;\n  getDeviceVersion: (\n    args: Input<{ deviceInfo: GetOsVersionResponse }>,\n  ) => EitherAsync<HttpFetchApiError, DeviceVersion>;\n  getFirmwareVersion: (\n    args: Input<{\n      deviceInfo: GetOsVersionResponse;\n      deviceVersion: DeviceVersion;\n    }>,\n  ) => EitherAsync<HttpFetchApiError, FinalFirmware>;\n  listInstalledApps: (\n    args: Input<{\n      deviceInfo: GetOsVersionResponse;\n      finalFirmware: FinalFirmware;\n    }>,\n  ) => Observable<SecureChannelEvent>;\n  getDeviceSessionState: () => DeviceSessionState;\n  setDeviceSessionState: (state: DeviceSessionState) => DeviceSessionState;\n};\n\nexport type InstalledApp = {\n  flags: number;\n  hash: string;\n  hash_code_data: string;\n  name: string;\n};\n\nexport function installedAppResultGuard(\n  value: unknown,\n): value is ListInstalledAppsDAOutput[\"installedApps\"] {\n  return (\n    Array.isArray(value) &&\n    value.every(\n      (item) =>\n        typeof item === \"object\" &&\n        item !== null &&\n        \"flags\" in item &&\n        \"hash\" in item &&\n        \"hash_code_data\" in item &&\n        \"name\" in item &&\n        typeof item.flags === \"number\" &&\n        typeof item.hash === \"string\" &&\n        typeof item.hash_code_data === \"string\" &&\n        typeof item.name === \"string\",\n    )\n  );\n}\n", "// https://github.com/maxogden/websocket-stream/blob/48dc3ddf943e5ada668c31ccd94e9186f02fafbd/ws-fallback.js\n\nvar ws = null\n\nif (typeof WebSocket !== 'undefined') {\n  ws = WebSocket\n} else if (typeof MozWebSocket !== 'undefined') {\n  ws = MozWebSocket\n} else if (typeof global !== 'undefined') {\n  ws = global.WebSocket || global.MozWebSocket\n} else if (typeof window !== 'undefined') {\n  ws = window.WebSocket || window.MozWebSocket\n} else if (typeof self !== 'undefined') {\n  ws = self.WebSocket || self.MozWebSocket\n}\n\nexport default ws\n", "import { type SecureChannelError } from \"@internal/secure-channel/model/Errors\";\n\nexport enum SecureChannelOperationEnum {\n  GenuineCheck = \"GenuineCheck\",\n  ListInstalledApps = \"ListInstalledApps\",\n  UpdateMcu = \"UpdateMcu\",\n  UpdateFirmware = \"UpdateFirmware\",\n  InstallApp = \"InstallApp\",\n  UninstallApp = \"UninstallApp\",\n}\n\n/**\n * The message that will be received from the server by the secure channel.\n */\nexport type InMessageType = {\n  uuid: string;\n  session: string;\n  query: InMessageQueryEnum;\n  nonce: number;\n  data: unknown;\n  result?: unknown;\n};\n\nexport enum InMessageQueryEnum {\n  EXCHANGE = \"exchange\",\n  BULK = \"bulk\",\n  ERROR = \"error\",\n  WARNING = \"warning\",\n  SUCCESS = \"success\",\n}\n\n/**\n * The message that will be sent to the server by the secure channel.\n */\nexport type OutMessageType = {\n  nonce: number;\n  response: OutMessageResponseEnum;\n  data: string;\n};\n\nexport enum OutMessageResponseEnum {\n  SUCCESS = \"success\",\n  ERROR = \"error\",\n}\n\n/**\n * The all event types that can be emitted to the client by the secure channel.\n *\n */\nexport enum SecureChannelEventType {\n  Opened = \"opened\",\n  Closed = \"closed\",\n  PermissionRequested = \"permission-requested\",\n  PermissionGranted = \"permission-granted\",\n  PreExchange = \"pre-exchange\",\n  Exchange = \"exchange\",\n  DeviceId = \"device-id\",\n  Progress = \"progress\",\n  Warning = \"warning\",\n  Error = \"error\",\n  Result = \"result\",\n}\n\n/**\n * The possible payload that will be sent to the client when a secure channel event occurs.\n */\nexport type SecureChannelEventPayload = {\n  PreExchange: { nonce: number; apdu: Uint8Array };\n  Exchange: {\n    nonce: number;\n    apdu: Uint8Array;\n    data: Uint8Array;\n    status: Uint8Array;\n  };\n  DeviceId: { deviceId: Uint8Array };\n  Progress: { progress: number; index: number; total: number };\n  Warning: { message: string };\n  Result: unknown;\n};\n\n/**\n * The event type that will be emitted to the client when a secure channel event occurs.\n */\nexport type SecureChannelEvent =\n  | {\n      type: SecureChannelEventType.Opened;\n    }\n  | {\n      type: SecureChannelEventType.Closed;\n    }\n  | {\n      type: SecureChannelEventType.PermissionRequested;\n    }\n  | {\n      type: SecureChannelEventType.PermissionGranted;\n    }\n  | {\n      type: SecureChannelEventType.PreExchange;\n      payload: SecureChannelEventPayload[\"PreExchange\"];\n    }\n  | {\n      type: SecureChannelEventType.Exchange;\n      payload: SecureChannelEventPayload[\"Exchange\"];\n    }\n  | {\n      type: SecureChannelEventType.DeviceId;\n      payload: SecureChannelEventPayload[\"DeviceId\"];\n    }\n  | {\n      type: SecureChannelEventType.Progress;\n      payload: SecureChannelEventPayload[\"Progress\"];\n    }\n  | {\n      type: SecureChannelEventType.Warning;\n      payload: SecureChannelEventPayload[\"Warning\"];\n    }\n  | {\n      type: SecureChannelEventType.Error;\n      error: SecureChannelError;\n    }\n  | {\n      type: SecureChannelEventType.Result;\n      payload: SecureChannelEventPayload[\"Result\"];\n    };\n", "export const GENUINE_DEVICE_RESULT = \"0000\";\n", "import { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { GENUINE_DEVICE_RESULT } from \"@api/secure-channel/constants\";\nimport { type SecureChannelEventPayload } from \"@api/secure-channel/task/types\";\n\n/**\n * Checks if the given APDU command will request permission.\n *\n * This method checks if the first byte of the APDU command is `0xe0` and the second byte is `0x51`.\n *\n * @param apdu - The APDU command as a Uint8Array.\n * @returns `true` if the APDU command will request permission, otherwise `false`.\n */\nexport function willRequestPermission(apdu: Uint8Array): boolean {\n  return apdu[0] === 0xe0 && apdu[1] === 0x51;\n}\n\n/**\n * Checks if the given APDU command is a GetCertificate command.\n *\n * This method checks if the first byte of the APDU command is `0xe0` and the second byte is `0x52`.\n *\n * @param apdu - The APDU command as a Uint8Array.\n * @returns `true` if the APDU command is a GetCertificate command, otherwise `false`.\n */\nexport function isGetCertificateApdu(apdu: Uint8Array): boolean {\n  return apdu[0] === 0xe0 && apdu[1] === 0x52;\n}\n\n/**\n * Extract the public key from a GetCertificate response.\n *\n * @param apduResponse - The APDU response containing the certificate data.\n * @returns The extracted public key as a Uint8Array, or null if extraction fails.\n */\nexport function extractPublicKey(\n  apduResponse: ApduResponse,\n): Uint8Array | null {\n  try {\n    const parser = new ApduParser(apduResponse);\n\n    // Skip header (length-value encoded)\n    const header = parser.extractFieldLVEncoded();\n    if (!header) {\n      return null;\n    }\n\n    // Extract public key (length-value encoded)\n    const publicKey = parser.extractFieldLVEncoded();\n    return publicKey ?? null;\n  } catch (_error) {\n    return null;\n  }\n}\n\n/**\n * Checks if the device is genuine.\n *\n * @param payload - The payload of the result secure channel event.\n * The payload has already been stringified, so that the type check is not necessary.\n * @returns `true` if the device is genuine, otherwise `false`.\n */\nexport function isDeviceGenuine(payload: SecureChannelEventPayload[\"Result\"]) {\n  return payload === GENUINE_DEVICE_RESULT;\n}\n", "/**\n * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.\n * @todo re-check https://issues.chromium.org/issues/42212588\n * @module\n */\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n\nfunction fromBig(\n  n: bigint,\n  le = false\n): {\n  h: number;\n  l: number;\n} {\n  if (le) return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n  return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\n\nfunction split(lst: bigint[], le = false): Uint32Array[] {\n  const len = lst.length;\n  let Ah = new Uint32Array(len);\n  let Al = new Uint32Array(len);\n  for (let i = 0; i < len; i++) {\n    const { h, l } = fromBig(lst[i], le);\n    [Ah[i], Al[i]] = [h, l];\n  }\n  return [Ah, Al];\n}\n\nconst toBig = (h: number, l: number): bigint => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h: number, _l: number, s: number): number => h >>> s;\nconst shrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h: number, l: number, s: number): number => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h: number, l: number, s: number): number => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h: number, l: number, s: number): number => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h: number, l: number): number => l;\nconst rotr32L = (h: number, _l: number): number => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h: number, l: number, s: number): number => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h: number, l: number, s: number): number => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h: number, l: number, s: number): number => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h: number, l: number, s: number): number => (h << (s - 32)) | (l >>> (64 - s));\n\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(\n  Ah: number,\n  Al: number,\n  Bh: number,\n  Bl: number\n): {\n  h: number;\n  l: number;\n} {\n  const l = (Al >>> 0) + (Bl >>> 0);\n  return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al: number, Bl: number, Cl: number): number => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low: number, Ah: number, Bh: number, Ch: number): number =>\n  (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al: number, Bl: number, Cl: number, Dl: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number): number =>\n  (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al: number, Bl: number, Cl: number, Dl: number, El: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number): number =>\n  (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n\n// prettier-ignore\nexport {\n  add, add3H, add3L, add4H, add4L, add5H, add5L, fromBig, rotlBH, rotlBL, rotlSH, rotlSL, rotr32H, rotr32L, rotrBH, rotrBL, rotrSH, rotrSL, shrSH, shrSL, split, toBig\n};\n// prettier-ignore\nconst u64: { fromBig: typeof fromBig; split: typeof split; toBig: (h: number, l: number) => bigint; shrSH: (h: number, _l: number, s: number) => number; shrSL: (h: number, l: number, s: number) => number; rotrSH: (h: number, l: number, s: number) => number; rotrSL: (h: number, l: number, s: number) => number; rotrBH: (h: number, l: number, s: number) => number; rotrBL: (h: number, l: number, s: number) => number; rotr32H: (_h: number, l: number) => number; rotr32L: (h: number, _l: number) => number; rotlSH: (h: number, l: number, s: number) => number; rotlSL: (h: number, l: number, s: number) => number; rotlBH: (h: number, l: number, s: number) => number; rotlBL: (h: number, l: number, s: number) => number; add: typeof add; add3L: (Al: number, Bl: number, Cl: number) => number; add3H: (low: number, Ah: number, Bh: number, Ch: number) => number; add4L: (Al: number, Bl: number, Cl: number, Dl: number) => number; add4H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number) => number; add5H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number) => number; add5L: (Al: number, Bl: number, Cl: number, Dl: number, El: number) => number; } = {\n  fromBig, split, toBig,\n  shrSH, shrSL,\n  rotrSH, rotrSL, rotrBH, rotrBL,\n  rotr32H, rotr32L,\n  rotlSH, rotlSL, rotlBH, rotlBL,\n  add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n", "/**\n * Internal webcrypto alias.\n * We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n * See utils.ts for details.\n * @module\n */\ndeclare const globalThis: Record<string, any> | undefined;\nexport const crypto: any =\n  typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n", "/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a: unknown): a is Uint8Array {\n  return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n\n/** Asserts something is positive integer. */\nexport function anumber(n: number): void {\n  if (!Number.isSafeInteger(n) || n < 0) throw new Error('positive integer expected, got ' + n);\n}\n\n/** Asserts something is Uint8Array. */\nexport function abytes(b: Uint8Array | undefined, ...lengths: number[]): void {\n  if (!isBytes(b)) throw new Error('Uint8Array expected');\n  if (lengths.length > 0 && !lengths.includes(b.length))\n    throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\n\n/** Asserts something is hash */\nexport function ahash(h: IHash): void {\n  if (typeof h !== 'function' || typeof h.create !== 'function')\n    throw new Error('Hash should be wrapped by utils.createHasher');\n  anumber(h.outputLen);\n  anumber(h.blockLen);\n}\n\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance: any, checkFinished = true): void {\n  if (instance.destroyed) throw new Error('Hash instance has been destroyed');\n  if (checkFinished && instance.finished) throw new Error('Hash#digest() has already been called');\n}\n\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out: any, instance: any): void {\n  abytes(out);\n  const min = instance.outputLen;\n  if (out.length < min) {\n    throw new Error('digestInto() expects output buffer of length at least ' + min);\n  }\n}\n\n/** Generic type encompassing 8/16/32-byte arrays - but not 64-byte. */\n// prettier-ignore\nexport type TypedArray = Int8Array | Uint8ClampedArray | Uint8Array |\n  Uint16Array | Int16Array | Uint32Array | Int32Array;\n\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr: TypedArray): Uint8Array {\n  return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr: TypedArray): Uint32Array {\n  return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays: TypedArray[]): void {\n  for (let i = 0; i < arrays.length; i++) {\n    arrays[i].fill(0);\n  }\n}\n\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr: TypedArray): DataView {\n  return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word: number, shift: number): number {\n  return (word << (32 - shift)) | (word >>> shift);\n}\n\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word: number, shift: number): number {\n  return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE: boolean = /* @__PURE__ */ (() =>\n  new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n\n/** The byte swap operation for uint32 */\nexport function byteSwap(word: number): number {\n  return (\n    ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff)\n  );\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const swap8IfBE: (n: number) => number = isLE\n  ? (n: number) => n\n  : (n: number) => byteSwap(n);\n\n/** @deprecated */\nexport const byteSwapIfBE: typeof swap8IfBE = swap8IfBE;\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr: Uint32Array): Uint32Array {\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = byteSwap(arr[i]);\n  }\n  return arr;\n}\n\nexport const swap32IfBE: (u: Uint32Array) => Uint32Array = isLE\n  ? (u: Uint32Array) => u\n  : byteSwap32;\n\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin: boolean = /* @__PURE__ */ (() =>\n  // @ts-ignore\n  typeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) =>\n  i.toString(16).padStart(2, '0')\n);\n\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes: Uint8Array): string {\n  abytes(bytes);\n  // @ts-ignore\n  if (hasHexBuiltin) return bytes.toHex();\n  // pre-caching improves the speed 6x\n  let hex = '';\n  for (let i = 0; i < bytes.length; i++) {\n    hex += hexes[bytes[i]];\n  }\n  return hex;\n}\n\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 } as const;\nfunction asciiToBase16(ch: number): number | undefined {\n  if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48\n  if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n  if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n  return;\n}\n\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex: string): Uint8Array {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  // @ts-ignore\n  if (hasHexBuiltin) return Uint8Array.fromHex(hex);\n  const hl = hex.length;\n  const al = hl / 2;\n  if (hl % 2) throw new Error('hex string expected, got unpadded hex of length ' + hl);\n  const array = new Uint8Array(al);\n  for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n    const n1 = asciiToBase16(hex.charCodeAt(hi));\n    const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n    if (n1 === undefined || n2 === undefined) {\n      const char = hex[hi] + hex[hi + 1];\n      throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n    }\n    array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n  }\n  return array;\n}\n\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async (): Promise<void> => {};\n\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(\n  iters: number,\n  tick: number,\n  cb: (i: number) => void\n): Promise<void> {\n  let ts = Date.now();\n  for (let i = 0; i < iters; i++) {\n    cb(i);\n    // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n    const diff = Date.now() - ts;\n    if (diff >= 0 && diff < tick) continue;\n    await nextTick();\n    ts += diff;\n  }\n}\n\n// Global symbols, but ts doesn't see them: https://github.com/microsoft/TypeScript/issues/31535\ndeclare const TextEncoder: any;\ndeclare const TextDecoder: any;\n\n/**\n * Converts string to bytes using UTF8 encoding.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str: string): Uint8Array {\n  if (typeof str !== 'string') throw new Error('string expected');\n  return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(Uint8Array.from([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n/** Accepted input of hash functions. Strings are converted to byte arrays. */\nexport type Input = string | Uint8Array;\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data: Input): Uint8Array {\n  if (typeof data === 'string') data = utf8ToBytes(data);\n  abytes(data);\n  return data;\n}\n\n/** KDFs can accept string or Uint8Array for user convenience. */\nexport type KDFInput = string | Uint8Array;\n/**\n * Helper for KDFs: consumes uint8array or string.\n * When string is passed, does utf8 decoding, using TextDecoder.\n */\nexport function kdfInputToBytes(data: KDFInput): Uint8Array {\n  if (typeof data === 'string') data = utf8ToBytes(data);\n  abytes(data);\n  return data;\n}\n\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays: Uint8Array[]): Uint8Array {\n  let sum = 0;\n  for (let i = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    abytes(a);\n    sum += a.length;\n  }\n  const res = new Uint8Array(sum);\n  for (let i = 0, pad = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    res.set(a, pad);\n    pad += a.length;\n  }\n  return res;\n}\n\ntype EmptyObj = {};\nexport function checkOpts<T1 extends EmptyObj, T2 extends EmptyObj>(\n  defaults: T1,\n  opts?: T2\n): T1 & T2 {\n  if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n    throw new Error('options should be object or undefined');\n  const merged = Object.assign(defaults, opts);\n  return merged as T1 & T2;\n}\n\n/** Hash interface. */\nexport type IHash = {\n  (data: Uint8Array): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create: any;\n};\n\n/** For runtime check if class implements interface */\nexport abstract class Hash<T extends Hash<T>> {\n  abstract blockLen: number; // Bytes per block\n  abstract outputLen: number; // Bytes in output\n  abstract update(buf: Input): this;\n  // Writes digest into buf\n  abstract digestInto(buf: Uint8Array): void;\n  abstract digest(): Uint8Array;\n  /**\n   * Resets internal state. Makes Hash instance unusable.\n   * Reset is impossible for keyed hashes if key is consumed into state. If digest is not consumed\n   * by user, they will need to manually call `destroy()` when zeroing is necessary.\n   */\n  abstract destroy(): void;\n  /**\n   * Clones hash instance. Unsafe: doesn't check whether `to` is valid. Can be used as `clone()`\n   * when no options are passed.\n   * Reasons to use `_cloneInto` instead of clone: 1) performance 2) reuse instance => all internal\n   * buffers are overwritten => causes buffer overwrite which is used for digest in some cases.\n   * There are no guarantees for clean-up because it's impossible in JS.\n   */\n  abstract _cloneInto(to?: T): T;\n  // Safe version that clones internal state\n  abstract clone(): T;\n}\n\n/**\n * XOF: streaming API to read digest in chunks.\n * Same as 'squeeze' in keccak/k12 and 'seek' in blake3, but more generic name.\n * When hash used in XOF mode it is up to user to call '.destroy' afterwards, since we cannot\n * destroy state, next call can require more bytes.\n */\nexport type HashXOF<T extends Hash<T>> = Hash<T> & {\n  xof(bytes: number): Uint8Array; // Read 'bytes' bytes from digest stream\n  xofInto(buf: Uint8Array): Uint8Array; // read buf.length bytes from digest stream into buf\n};\n\n/** Hash function */\nexport type CHash = ReturnType<typeof createHasher>;\n/** Hash function with output */\nexport type CHashO = ReturnType<typeof createOptHasher>;\n/** XOF with output */\nexport type CHashXO = ReturnType<typeof createXOFer>;\n\n/** Wraps hash function, creating an interface on top of it */\nexport function createHasher<T extends Hash<T>>(\n  hashCons: () => Hash<T>\n): {\n  (msg: Input): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(): Hash<T>;\n} {\n  const hashC = (msg: Input): Uint8Array => hashCons().update(toBytes(msg)).digest();\n  const tmp = hashCons();\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = () => hashCons();\n  return hashC;\n}\n\nexport function createOptHasher<H extends Hash<H>, T extends Object>(\n  hashCons: (opts?: T) => Hash<H>\n): {\n  (msg: Input, opts?: T): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(opts?: T): Hash<H>;\n} {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts?: T) => hashCons(opts);\n  return hashC;\n}\n\nexport function createXOFer<H extends HashXOF<H>, T extends Object>(\n  hashCons: (opts?: T) => HashXOF<H>\n): {\n  (msg: Input, opts?: T): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(opts?: T): HashXOF<H>;\n} {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts?: T) => hashCons(opts);\n  return hashC;\n}\nexport const wrapConstructor: typeof createHasher = createHasher;\nexport const wrapConstructorWithOpts: typeof createOptHasher = createOptHasher;\nexport const wrapXOFConstructorWithOpts: typeof createXOFer = createXOFer;\n\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32): Uint8Array {\n  if (crypto && typeof crypto.getRandomValues === 'function') {\n    return crypto.getRandomValues(new Uint8Array(bytesLength));\n  }\n  // Legacy Node.js compatibility\n  if (crypto && typeof crypto.randomBytes === 'function') {\n    return Uint8Array.from(crypto.randomBytes(bytesLength));\n  }\n  throw new Error('crypto.getRandomValues must be defined');\n}\n", "/**\n * SHA3 (keccak) hash function, based on a new \"Sponge function\" design.\n * Different from older hashes, the internal state is bigger than output size.\n *\n * Check out [FIPS-202](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf),\n * [Website](https://keccak.team/keccak.html),\n * [the differences between SHA-3 and Keccak](https://crypto.stackexchange.com/questions/15727/what-are-the-key-differences-between-the-draft-sha-3-standard-and-the-keccak-sub).\n *\n * Check out `sha3-addons` module for cSHAKE, k12, and others.\n * @module\n */\nimport { rotlBH, rotlBL, rotlSH, rotlSL, split } from './_u64.ts';\n// prettier-ignore\nimport {\n  abytes, aexists, anumber, aoutput,\n  clean, createHasher, createXOFer, Hash,\n  swap32IfBE,\n  toBytes, u32,\n  type CHash, type CHashXO, type HashXOF, type Input\n} from './utils.ts';\n\n// No __PURE__ annotations in sha3 header:\n// EVERYTHING is in fact used on every export.\n// Various per round constants calculations\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst _7n = BigInt(7);\nconst _256n = BigInt(256);\nconst _0x71n = BigInt(0x71);\nconst SHA3_PI: number[] = [];\nconst SHA3_ROTL: number[] = [];\nconst _SHA3_IOTA: bigint[] = [];\nfor (let round = 0, R = _1n, x = 1, y = 0; round < 24; round++) {\n  // Pi\n  [x, y] = [y, (2 * x + 3 * y) % 5];\n  SHA3_PI.push(2 * (5 * y + x));\n  // Rotational\n  SHA3_ROTL.push((((round + 1) * (round + 2)) / 2) % 64);\n  // Iota\n  let t = _0n;\n  for (let j = 0; j < 7; j++) {\n    R = ((R << _1n) ^ ((R >> _7n) * _0x71n)) % _256n;\n    if (R & _2n) t ^= _1n << ((_1n << /* @__PURE__ */ BigInt(j)) - _1n);\n  }\n  _SHA3_IOTA.push(t);\n}\nconst IOTAS = split(_SHA3_IOTA, true);\nconst SHA3_IOTA_H = IOTAS[0];\nconst SHA3_IOTA_L = IOTAS[1];\n\n// Left rotation (without 0, 32, 64)\nconst rotlH = (h: number, l: number, s: number) => (s > 32 ? rotlBH(h, l, s) : rotlSH(h, l, s));\nconst rotlL = (h: number, l: number, s: number) => (s > 32 ? rotlBL(h, l, s) : rotlSL(h, l, s));\n\n/** `keccakf1600` internal function, additionally allows to adjust round count. */\nexport function keccakP(s: Uint32Array, rounds: number = 24): void {\n  const B = new Uint32Array(5 * 2);\n  // NOTE: all indices are x2 since we store state as u32 instead of u64 (bigints to slow in js)\n  for (let round = 24 - rounds; round < 24; round++) {\n    // Theta \n    for (let x = 0; x < 10; x++) B[x] = s[x] ^ s[x + 10] ^ s[x + 20] ^ s[x + 30] ^ s[x + 40];\n    for (let x = 0; x < 10; x += 2) {\n      const idx1 = (x + 8) % 10;\n      const idx0 = (x + 2) % 10;\n      const B0 = B[idx0];\n      const B1 = B[idx0 + 1];\n      const Th = rotlH(B0, B1, 1) ^ B[idx1];\n      const Tl = rotlL(B0, B1, 1) ^ B[idx1 + 1];\n      for (let y = 0; y < 50; y += 10) {\n        s[x + y] ^= Th;\n        s[x + y + 1] ^= Tl;\n      }\n    }\n    // Rho () and Pi ()\n    let curH = s[2];\n    let curL = s[3];\n    for (let t = 0; t < 24; t++) {\n      const shift = SHA3_ROTL[t];\n      const Th = rotlH(curH, curL, shift);\n      const Tl = rotlL(curH, curL, shift);\n      const PI = SHA3_PI[t];\n      curH = s[PI];\n      curL = s[PI + 1];\n      s[PI] = Th;\n      s[PI + 1] = Tl;\n    }\n    // Chi ()\n    for (let y = 0; y < 50; y += 10) {\n      for (let x = 0; x < 10; x++) B[x] = s[y + x];\n      for (let x = 0; x < 10; x++) s[y + x] ^= ~B[(x + 2) % 10] & B[(x + 4) % 10];\n    }\n    // Iota ()\n    s[0] ^= SHA3_IOTA_H[round];\n    s[1] ^= SHA3_IOTA_L[round];\n  }\n  clean(B);\n}\n\n/** Keccak sponge function. */\nexport class Keccak extends Hash<Keccak> implements HashXOF<Keccak> {\n  protected state: Uint8Array;\n  protected pos = 0;\n  protected posOut = 0;\n  protected finished = false;\n  protected state32: Uint32Array;\n  protected destroyed = false;\n\n  public blockLen: number;\n  public suffix: number;\n  public outputLen: number;\n  protected enableXOF = false;\n  protected rounds: number;\n\n  // NOTE: we accept arguments in bytes instead of bits here.\n  constructor(\n    blockLen: number,\n    suffix: number,\n    outputLen: number,\n    enableXOF = false,\n    rounds: number = 24\n  ) {\n    super();\n    this.blockLen = blockLen;\n    this.suffix = suffix;\n    this.outputLen = outputLen;\n    this.enableXOF = enableXOF;\n    this.rounds = rounds;\n    // Can be passed from user as dkLen\n    anumber(outputLen);\n    // 1600 = 5x5 matrix of 64bit.  1600 bits === 200 bytes\n    // 0 < blockLen < 200\n    if (!(0 < blockLen && blockLen < 200))\n      throw new Error('only keccak-f1600 function is supported');\n    this.state = new Uint8Array(200);\n    this.state32 = u32(this.state);\n  }\n  clone(): Keccak {\n    return this._cloneInto();\n  }\n  protected keccak(): void {\n    swap32IfBE(this.state32);\n    keccakP(this.state32, this.rounds);\n    swap32IfBE(this.state32);\n    this.posOut = 0;\n    this.pos = 0;\n  }\n  update(data: Input): this {\n    aexists(this);\n    data = toBytes(data);\n    abytes(data);\n    const { blockLen, state } = this;\n    const len = data.length;\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      for (let i = 0; i < take; i++) state[this.pos++] ^= data[pos++];\n      if (this.pos === blockLen) this.keccak();\n    }\n    return this;\n  }\n  protected finish(): void {\n    if (this.finished) return;\n    this.finished = true;\n    const { state, suffix, pos, blockLen } = this;\n    // Do the padding\n    state[pos] ^= suffix;\n    if ((suffix & 0x80) !== 0 && pos === blockLen - 1) this.keccak();\n    state[blockLen - 1] ^= 0x80;\n    this.keccak();\n  }\n  protected writeInto(out: Uint8Array): Uint8Array {\n    aexists(this, false);\n    abytes(out);\n    this.finish();\n    const bufferOut = this.state;\n    const { blockLen } = this;\n    for (let pos = 0, len = out.length; pos < len; ) {\n      if (this.posOut >= blockLen) this.keccak();\n      const take = Math.min(blockLen - this.posOut, len - pos);\n      out.set(bufferOut.subarray(this.posOut, this.posOut + take), pos);\n      this.posOut += take;\n      pos += take;\n    }\n    return out;\n  }\n  xofInto(out: Uint8Array): Uint8Array {\n    // Sha3/Keccak usage with XOF is probably mistake, only SHAKE instances can do XOF\n    if (!this.enableXOF) throw new Error('XOF is not possible for this instance');\n    return this.writeInto(out);\n  }\n  xof(bytes: number): Uint8Array {\n    anumber(bytes);\n    return this.xofInto(new Uint8Array(bytes));\n  }\n  digestInto(out: Uint8Array): Uint8Array {\n    aoutput(out, this);\n    if (this.finished) throw new Error('digest() was already called');\n    this.writeInto(out);\n    this.destroy();\n    return out;\n  }\n  digest(): Uint8Array {\n    return this.digestInto(new Uint8Array(this.outputLen));\n  }\n  destroy(): void {\n    this.destroyed = true;\n    clean(this.state);\n  }\n  _cloneInto(to?: Keccak): Keccak {\n    const { blockLen, suffix, outputLen, rounds, enableXOF } = this;\n    to ||= new Keccak(blockLen, suffix, outputLen, enableXOF, rounds);\n    to.state32.set(this.state32);\n    to.pos = this.pos;\n    to.posOut = this.posOut;\n    to.finished = this.finished;\n    to.rounds = rounds;\n    // Suffix can change in cSHAKE\n    to.suffix = suffix;\n    to.outputLen = outputLen;\n    to.enableXOF = enableXOF;\n    to.destroyed = this.destroyed;\n    return to;\n  }\n}\n\nconst gen = (suffix: number, blockLen: number, outputLen: number) =>\n  createHasher(() => new Keccak(blockLen, suffix, outputLen));\n\n/** SHA3-224 hash function. */\nexport const sha3_224: CHash = /* @__PURE__ */ (() => gen(0x06, 144, 224 / 8))();\n/** SHA3-256 hash function. Different from keccak-256. */\nexport const sha3_256: CHash = /* @__PURE__ */ (() => gen(0x06, 136, 256 / 8))();\n/** SHA3-384 hash function. */\nexport const sha3_384: CHash = /* @__PURE__ */ (() => gen(0x06, 104, 384 / 8))();\n/** SHA3-512 hash function. */\nexport const sha3_512: CHash = /* @__PURE__ */ (() => gen(0x06, 72, 512 / 8))();\n\n/** keccak-224 hash function. */\nexport const keccak_224: CHash = /* @__PURE__ */ (() => gen(0x01, 144, 224 / 8))();\n/** keccak-256 hash function. Different from SHA3-256. */\nexport const keccak_256: CHash = /* @__PURE__ */ (() => gen(0x01, 136, 256 / 8))();\n/** keccak-384 hash function. */\nexport const keccak_384: CHash = /* @__PURE__ */ (() => gen(0x01, 104, 384 / 8))();\n/** keccak-512 hash function. */\nexport const keccak_512: CHash = /* @__PURE__ */ (() => gen(0x01, 72, 512 / 8))();\n\nexport type ShakeOpts = { dkLen?: number };\n\nconst genShake = (suffix: number, blockLen: number, outputLen: number) =>\n  createXOFer<HashXOF<Keccak>, ShakeOpts>(\n    (opts: ShakeOpts = {}) =>\n      new Keccak(blockLen, suffix, opts.dkLen === undefined ? outputLen : opts.dkLen, true)\n  );\n\n/** SHAKE128 XOF with 128-bit security. */\nexport const shake128: CHashXO = /* @__PURE__ */ (() => genShake(0x1f, 168, 128 / 8))();\n/** SHAKE256 XOF with 256-bit security. */\nexport const shake256: CHashXO = /* @__PURE__ */ (() => genShake(0x1f, 136, 256 / 8))();\n", "import { sha3_256 } from \"@noble/hashes/sha3\";\n\nimport { type CryptoService } from \"./CryptoService\";\n\n/**\n * Noble implementation of the crypto service\n */\nexport class NobleCryptoService implements CryptoService {\n  sha3_256(data: Uint8Array): Uint8Array {\n    return sha3_256(data);\n  }\n}\n", "import {\n  AppAlreadyInstalledDAError,\n  DeviceLockedError,\n  OutOfMemoryDAError,\n  RefusedByUserDAError,\n} from \"@api/device-action/os/Errors\";\nimport type { DmkError } from \"@api/Error\";\n\nexport enum SecureChannelErrorType {\n  AppAlreadyInstalled,\n  DeviceLocked,\n  OutOfMemory,\n  RefusedByUser,\n  Unknown,\n}\n\n/**\n * Errors that can possibly occur during a secure channel operation\n */\nexport type SecureChannelDAErrors =\n  | SecureChannelError\n  | DeviceLockedError\n  | RefusedByUserDAError;\n\n/**\n * Errors that can possibly occur during a secure channel install operation\n * such as installApp or installFirmware\n */\nexport type SecureChannelInstallDAErrors =\n  | SecureChannelError\n  | AppAlreadyInstalledDAError\n  | OutOfMemoryDAError\n  | DeviceLockedError\n  | RefusedByUserDAError;\n\nexport class WebSocketConnectionError implements DmkError {\n  _tag = \"WebSocketConnectionError\";\n  originalError?: unknown;\n\n  constructor(public readonly error: unknown) {\n    this.originalError = error;\n  }\n}\n\nexport class SecureChannelError implements DmkError {\n  _tag = \"SecureChannelError\";\n  originalError?: unknown;\n\n  constructor(\n    public readonly error: unknown,\n    public readonly errorType: SecureChannelErrorType = SecureChannelErrorType.Unknown,\n  ) {\n    this.originalError = error;\n  }\n\n  mapDAErrors(): SecureChannelDAErrors {\n    switch (this.errorType) {\n      case SecureChannelErrorType.DeviceLocked:\n        return new DeviceLockedError();\n      case SecureChannelErrorType.RefusedByUser:\n        return new RefusedByUserDAError();\n      default:\n        return this;\n    }\n  }\n\n  mapInstallDAErrors(): SecureChannelInstallDAErrors {\n    switch (this.errorType) {\n      case SecureChannelErrorType.DeviceLocked:\n        return new DeviceLockedError();\n      case SecureChannelErrorType.RefusedByUser:\n        return new RefusedByUserDAError();\n      case SecureChannelErrorType.AppAlreadyInstalled:\n        return new AppAlreadyInstalledDAError();\n      case SecureChannelErrorType.OutOfMemory:\n        return new OutOfMemoryDAError();\n      default:\n        return this;\n    }\n  }\n}\n", "import WebSocket from \"isomorphic-ws\";\nimport { type Either } from \"purify-ts\";\nimport { Observable } from \"rxjs\";\n\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport {\n  InMessageQueryEnum,\n  type InMessageType,\n  OutMessageResponseEnum,\n  type OutMessageType,\n  type SecureChannelEvent,\n  SecureChannelEventType,\n} from \"@api/secure-channel/task/types\";\nimport {\n  extractPublicKey,\n  isGetCertificateApdu,\n  willRequestPermission,\n} from \"@api/secure-channel/utils\";\nimport { bufferToHexaString, hexaStringToBuffer } from \"@api/utils/HexaString\";\nimport { type CryptoService } from \"@internal/crypto/CryptoService\";\nimport { NobleCryptoService } from \"@internal/crypto/NobleCryptoService\";\nimport {\n  SecureChannelError,\n  SecureChannelErrorType,\n  type WebSocketConnectionError,\n} from \"@internal/secure-channel/model/Errors\";\n\nexport type ConnectToSecureChannelTaskArgs = {\n  connection: Either<WebSocketConnectionError, WebSocket>;\n  cryptoService?: CryptoService;\n};\n\nexport class ConnectToSecureChannelTask {\n  private readonly _connection: WebSocket;\n  private readonly _cryptoService: CryptoService;\n  private _deviceIdCaptured: boolean = false;\n  constructor(\n    private readonly _api: InternalApi,\n    private readonly _args: ConnectToSecureChannelTaskArgs,\n  ) {\n    if (this._args.connection.isRight()) {\n      this._connection = this._args.connection.extract();\n    } else {\n      throw new SecureChannelError(\n        `Invalid WebSocket connection: ${String(this._args.connection.extract())}`,\n      );\n    }\n    this._cryptoService = this._args.cryptoService ?? new NobleCryptoService();\n  }\n\n  run(): Observable<SecureChannelEvent> {\n    const reenableRefresher = this._api.disableRefresher(\n      \"connectToSecureChannel\",\n    );\n\n    const obs = new Observable<SecureChannelEvent>((subscriber) => {\n      let unsubscribed: boolean = false;\n      let ignoreNetworkEvents = false;\n      let communicationFinished = false;\n\n      const notifyError = (error: SecureChannelError) => {\n        subscriber.next({\n          type: SecureChannelEventType.Error,\n          error,\n        });\n        subscriber.complete();\n\n        // Netowrks events can be ignored once the obervable has been completed\n        ignoreNetworkEvents = true;\n      };\n\n      this._connection.onopen = () => {\n        subscriber.next({\n          type: SecureChannelEventType.Opened,\n        });\n      };\n\n      this._connection.onerror = (error) => {\n        if (ignoreNetworkEvents) {\n          return;\n        }\n\n        subscriber.next({\n          type: SecureChannelEventType.Error,\n          error: new SecureChannelError({\n            url: this._connection.url,\n            errorMessage: error.message,\n          }),\n        });\n        subscriber.complete();\n      };\n\n      this._connection.onclose = () => {\n        if (ignoreNetworkEvents) {\n          return;\n        }\n\n        if (communicationFinished) {\n          subscriber.next({\n            type: SecureChannelEventType.Closed,\n          });\n        } else {\n          subscriber.next({\n            type: SecureChannelEventType.Error,\n            error: new SecureChannelError({\n              url: this._connection.url,\n              errorMessage: \"Connection closed unexpectedly\",\n            }),\n          });\n        }\n        subscriber.complete();\n      };\n\n      this._connection.onmessage = async (event) => {\n        // When unsubscribed, ignore the message\n        if (unsubscribed) {\n          return;\n        }\n\n        // Parse input message\n        let input: InMessageType;\n        try {\n          const jsonData = JSON.parse(String(event.data));\n          if (this.isInMessageType(jsonData)) {\n            input = jsonData;\n          } else {\n            throw new Error(\"Data does not match InMessageType\");\n          }\n        } catch (_) {\n          notifyError(\n            new SecureChannelError({\n              url: this._connection.url,\n              errorMessage: `Invalid message received: ${String(event.data)}`,\n            }),\n          );\n          return;\n        }\n\n        // Execute message query\n        switch (input.query) {\n          case InMessageQueryEnum.EXCHANGE: {\n            const { nonce, data } = input;\n\n            // Exchange query should contain a single APDU\n            if (typeof data !== \"string\") {\n              notifyError(\n                new SecureChannelError(\n                  `${InMessageQueryEnum.EXCHANGE} data type should be an APDU`,\n                ),\n              );\n              return;\n            }\n\n            // APDU should be a valid hex string\n            const apdu = hexaStringToBuffer(data);\n            if (apdu === null || apdu.length < 5) {\n              notifyError(\n                new SecureChannelError(`Received invalid APDU data: ${data}`),\n              );\n              return;\n            }\n            subscriber.next({\n              type: SecureChannelEventType.PreExchange,\n              payload: { nonce, apdu },\n            });\n\n            // Notify permission requested\n            let permissionRequested = false;\n            if (\n              willRequestPermission(apdu) &&\n              !this.isSecureConnectionAllowed()\n            ) {\n              permissionRequested = true;\n              subscriber.next({\n                type: SecureChannelEventType.PermissionRequested,\n              });\n            }\n\n            // Send APDU to the device\n            const response = await this._api.sendApdu(apdu);\n            if (unsubscribed) {\n              return;\n            }\n\n            // Map device response\n            response.caseOf({\n              Left: (error) => {\n                notifyError(new SecureChannelError(error));\n              },\n              Right: (apduResponse: ApduResponse) => {\n                let outMessageResponse: OutMessageResponseEnum;\n                const deviceError = this.mapDeviceError(apduResponse);\n                if (deviceError === null) {\n                  outMessageResponse = OutMessageResponseEnum.SUCCESS;\n\n                  // Check if this is the first GetCertificate call\n                  if (!this._deviceIdCaptured && isGetCertificateApdu(apdu)) {\n                    this._deviceIdCaptured = true;\n                    const publicKey = extractPublicKey(apduResponse);\n                    if (publicKey) {\n                      // Compute SHA3-256 hash of the public key to get the device ID\n                      const deviceId = this._cryptoService.sha3_256(publicKey);\n                      subscriber.next({\n                        type: SecureChannelEventType.DeviceId,\n                        payload: { deviceId },\n                      });\n                    }\n                  }\n\n                  // Emit event for the exchange\n                  subscriber.next({\n                    type: SecureChannelEventType.Exchange,\n                    payload: {\n                      nonce,\n                      apdu,\n                      data: apduResponse.data,\n                      status: apduResponse.statusCode,\n                    },\n                  });\n\n                  // If manager consent was requested, notify the \"granted\" event\n                  if (permissionRequested) {\n                    subscriber.next({\n                      type: SecureChannelEventType.PermissionGranted,\n                    });\n                  }\n                } else {\n                  outMessageResponse = OutMessageResponseEnum.ERROR;\n                  notifyError(deviceError);\n                }\n\n                // Send the message back to the server\n                const message: OutMessageType = {\n                  nonce,\n                  response: outMessageResponse,\n                  data: bufferToHexaString(apduResponse.data, false),\n                };\n                this._connection.send(JSON.stringify(message));\n              },\n            });\n            break;\n          }\n          case InMessageQueryEnum.BULK: {\n            // Network not needed anymore during bulk APDUs sending\n            ignoreNetworkEvents = true;\n            this._connection.close();\n\n            // A valid array of APDUs is required in a bulk query\n            if (\n              !Array.isArray(input.data) ||\n              input.data.length === 0 ||\n              !input.data.every((data) => typeof data === \"string\")\n            ) {\n              notifyError(new SecureChannelError(\"Invalid bulk data received\"));\n              return;\n            }\n\n            for (let i = 0, len = input.data.length; i < len; i++) {\n              // APDU should be a valid hex string\n              const apdu = hexaStringToBuffer(input.data[i]!);\n              if (apdu === null || apdu.length < 5) {\n                notifyError(\n                  new SecureChannelError(\n                    `Received invalid APDU bulk data: ${input.data[i]}`,\n                  ),\n                );\n                return;\n              }\n\n              // Send APDU to the device\n              const response = await this._api.sendApdu(apdu);\n              if (unsubscribed) {\n                return;\n              }\n\n              // Map device response\n              if (response.isLeft()) {\n                notifyError(new SecureChannelError(response.extract()));\n                return;\n              } else if (response.isRight()) {\n                const deviceError = this.mapDeviceError(response.extract());\n                if (deviceError === null) {\n                  // Notify the progress\n                  subscriber.next({\n                    type: SecureChannelEventType.Progress,\n                    payload: {\n                      progress: +Number((i + 1) / len).toFixed(2),\n                      index: i,\n                      total: len,\n                    },\n                  });\n                } else {\n                  notifyError(deviceError);\n                  return;\n                }\n              }\n            }\n            communicationFinished = true;\n            subscriber.complete();\n            break;\n          }\n          case InMessageQueryEnum.SUCCESS: {\n            if (ignoreNetworkEvents) {\n              break;\n            }\n            // Emit the result if there is any\n            const payload = input.result ?? input.data;\n            if (payload) {\n              subscriber.next({\n                type: SecureChannelEventType.Result,\n                payload: payload ?? \"\",\n              });\n            }\n            communicationFinished = true;\n            subscriber.complete();\n            break;\n          }\n          case InMessageQueryEnum.WARNING: {\n            if (ignoreNetworkEvents) {\n              break;\n            }\n            subscriber.next({\n              type: SecureChannelEventType.Warning,\n              payload: { message: String(input.data) },\n            });\n            break;\n          }\n          case InMessageQueryEnum.ERROR: {\n            if (ignoreNetworkEvents) {\n              break;\n            }\n            notifyError(\n              new SecureChannelError({\n                url: this._connection.url,\n                errorMessage: String(input.data),\n              }),\n            );\n          }\n        }\n      };\n\n      return () => {\n        reenableRefresher();\n        unsubscribed = true;\n        // Close the connection if it is open when unsubscribing\n        if (this._connection.readyState === WebSocket.OPEN) {\n          this._connection.close();\n        }\n      };\n    });\n\n    return obs;\n  }\n\n  /**\n   * Determines if a secure connection is already allowed based on the current device session state.\n   *\n   * @returns {boolean} `true` if a secure connection is allowed, otherwise `false`.\n   */\n  isSecureConnectionAllowed(): boolean {\n    const deviceSessionState = this._api.getDeviceSessionState();\n    return (\n      \"isSecureConnectionAllowed\" in deviceSessionState &&\n      deviceSessionState.isSecureConnectionAllowed\n    );\n  }\n\n  isInMessageType(data: unknown): data is InMessageType {\n    if (typeof data !== \"object\" || !data) {\n      return false;\n    }\n\n    const message = data as InMessageType;\n    return (\n      typeof message.uuid === \"string\" &&\n      typeof message.session === \"string\" &&\n      typeof message.query === \"string\" &&\n      Object.values(InMessageQueryEnum).includes(message.query) &&\n      typeof message.nonce === \"number\"\n    );\n  }\n\n  mapDeviceError(apduResponse: ApduResponse): SecureChannelError | null {\n    if (CommandUtils.isSuccessResponse(apduResponse)) {\n      return null;\n    }\n\n    // Device is locked\n    if (CommandUtils.isLockedDeviceResponse(apduResponse)) {\n      return new SecureChannelError(\n        {\n          url: this._connection.url,\n          errorMessage: `Device is locked`,\n        },\n        SecureChannelErrorType.DeviceLocked,\n      );\n    }\n\n    // User refused the permission\n    if (CommandUtils.isRefusedByUser(apduResponse)) {\n      return new SecureChannelError(\n        {\n          url: this._connection.url,\n          errorMessage: \"User refused on the device\",\n        },\n        SecureChannelErrorType.RefusedByUser,\n      );\n    }\n\n    // App already installed\n    if (CommandUtils.isAppAlreadyInstalled(apduResponse)) {\n      return new SecureChannelError(\n        {\n          url: this._connection.url,\n          errorMessage: \"App already installed\",\n        },\n        SecureChannelErrorType.AppAlreadyInstalled,\n      );\n    }\n\n    // Out of memory\n    if (CommandUtils.isOutOfMemory(apduResponse)) {\n      return new SecureChannelError(\n        {\n          url: this._connection.url,\n          errorMessage: \"Out of memory\",\n        },\n        SecureChannelErrorType.OutOfMemory,\n      );\n    }\n\n    return new SecureChannelError({\n      url: this._connection.url,\n      errorMessage: `Invalid status code: ${bufferToHexaString(\n        apduResponse.statusCode,\n      )}`,\n    });\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { type Observable } from \"rxjs\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { ListAppsDeviceAction } from \"@api/device-action/os/ListApps/ListAppsDeviceAction\";\nimport {\n  GetApplicationsMetadataTask,\n  type GetApplicationsMetadataTaskResult,\n  type InstalledApp,\n} from \"@api/device-action/task/GetApplicationsMetadataTask\";\nimport {\n  GetFirmwareMetadataTask,\n  type GetFirmwareMetadataTaskResult,\n} from \"@api/device-action/task/GetFirmwareMetadataTask\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type Catalog,\n  type CustomImage,\n  DeviceSessionStateType,\n  type FirmwareUpdateContext,\n  type FirmwareVersion,\n  type InstalledLanguagePackage,\n} from \"@api/device-session/DeviceSessionState\";\nimport { installedAppResultGuard } from \"@api/secure-channel/device-action/ListInstalledApps/types\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type SecureChannelEvent } from \"@api/secure-channel/task/types\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\n\nimport {\n  type GetDeviceMetadataDAError,\n  type GetDeviceMetadataDAInput,\n  type GetDeviceMetadataDAIntermediateValue,\n  type GetDeviceMetadataDAOutput,\n} from \"./types\";\n\ntype GetDeviceMetadataMachineInternalState = {\n  readonly error: GetDeviceMetadataDAError | null;\n  readonly deviceVersion: DeviceVersion | null;\n  readonly firmware: FinalFirmware | null;\n  readonly firmwareVersion: FirmwareVersion | null;\n  readonly firmwareUpdateContext: FirmwareUpdateContext | null;\n  readonly customImage: CustomImage | null;\n  readonly installedApps: InstalledApp[] | null;\n  readonly applications: Application[] | null;\n  readonly applicationsUpdates: Application[] | null;\n  readonly installedLanguages: InstalledLanguagePackage[] | null;\n  readonly catalog: Catalog | null;\n};\n\nexport type GetDeviceMetadataFromContextTaskResult = {\n  readonly firmwareVersion: FirmwareVersion;\n  readonly firmwareUpdateContext: FirmwareUpdateContext;\n  readonly customImage: CustomImage;\n  readonly applications: Application[];\n  readonly applicationsUpdates: Application[];\n  readonly installedLanguages: InstalledLanguagePackage[];\n  readonly catalog: Catalog;\n} | null;\n\nexport type MachineDependencies = {\n  readonly getDeviceMetadata: () => Promise<GetDeviceMetadataFromContextTaskResult>;\n  readonly getFirmwareMetadata: () => Promise<GetFirmwareMetadataTaskResult>;\n  readonly getApplicationsMetadata: (arg0: {\n    input: {\n      deviceVersion: DeviceVersion;\n      firmware: FinalFirmware;\n      firmwareVersion: FirmwareVersion;\n      installedApps: InstalledApp[];\n    };\n  }) => Promise<GetApplicationsMetadataTaskResult>;\n  readonly listAppsSecureChannel: (arg0: {\n    input: {\n      firmware: FinalFirmware;\n      firmwareVersion: FirmwareVersion;\n    };\n  }) => Observable<SecureChannelEvent>;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\nexport class GetDeviceMetadataDeviceAction extends XStateDeviceAction<\n  GetDeviceMetadataDAOutput,\n  GetDeviceMetadataDAInput,\n  GetDeviceMetadataDAError,\n  GetDeviceMetadataDAIntermediateValue,\n  GetDeviceMetadataMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    GetDeviceMetadataDAOutput,\n    GetDeviceMetadataDAInput,\n    GetDeviceMetadataDAError,\n    GetDeviceMetadataDAIntermediateValue,\n    GetDeviceMetadataMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      GetDeviceMetadataDAOutput,\n      GetDeviceMetadataDAInput,\n      GetDeviceMetadataDAError,\n      GetDeviceMetadataDAIntermediateValue,\n      GetDeviceMetadataMachineInternalState\n    >;\n\n    const {\n      getDeviceMetadata,\n      getFirmwareMetadata,\n      getApplicationsMetadata,\n      listAppsSecureChannel,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n    const listAppsMachine = new ListAppsDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        goToDashboard: goToDashboardMachine,\n        getDeviceMetadata: fromPromise(getDeviceMetadata),\n        getFirmwareMetadata: fromPromise(getFirmwareMetadata),\n        getApplicationsMetadata: fromPromise(getApplicationsMetadata),\n        listApps: listAppsMachine,\n        listAppsSecureChannel: fromObservable(listAppsSecureChannel),\n      },\n      guards: {\n        hasError: ({ context }) => context._internalState.error !== null,\n        hasMetadata: ({ context }) =>\n          context._internalState.firmwareVersion !== null &&\n          context._internalState.firmwareUpdateContext !== null &&\n          context._internalState.customImage !== null &&\n          context._internalState.applications !== null &&\n          context._internalState.applicationsUpdates !== null &&\n          context._internalState.installedLanguages !== null &&\n          context._internalState.catalog !== null,\n        forceUpdate: ({ context }) => Boolean(context.input.forceUpdate),\n        useSecureChannel: ({ context }) =>\n          Boolean(context.input.useSecureChannel),\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      id: \"GetDeviceMetadataDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            useSecureChannel: _.input.useSecureChannel,\n            forceUpdate: _.input.forceUpdate,\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            deviceVersion: null,\n            firmware: null,\n            firmwareVersion: null,\n            firmwareUpdateContext: null,\n            customImage: null,\n            installedApps: null,\n            applications: null,\n            applicationsUpdates: null,\n            installedLanguages: null,\n            catalog: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: [\n            {\n              target: \"GoToDashboard\",\n              guard: \"forceUpdate\",\n            },\n            {\n              target: \"GetDeviceMetadataFromContext\",\n            },\n          ],\n        },\n        GetDeviceMetadataFromContext: {\n          invoke: {\n            src: \"getDeviceMetadata\",\n            onDone: {\n              target: \"GetDeviceMetadataFromContextResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (_.event.output === null) {\n                    return _.context._internalState;\n                  } else {\n                    return {\n                      ..._.context._internalState,\n                      firmwareVersion: _.event.output.firmwareVersion,\n                      firmwareUpdateContext:\n                        _.event.output.firmwareUpdateContext,\n                      customImage: _.event.output.customImage,\n                      applications: _.event.output.applications,\n                      applicationsUpdates: _.event.output.applicationsUpdates,\n                      installedLanguages: _.event.output.installedLanguages,\n                      catalog: _.event.output.catalog,\n                    };\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetDeviceMetadataFromContextResultCheck: {\n          always: [\n            {\n              target: \"Success\",\n              guard: \"hasMetadata\",\n            },\n            {\n              target: \"GoToDashboard\",\n            },\n          ],\n        },\n        GoToDashboard: {\n          exit: assign({\n            intermediateValue: {\n              requiredUserInteraction: UserInteractionRequired.None,\n            },\n          }),\n          invoke: {\n            id: \"dashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetFirmwareMetadata\",\n            },\n          ],\n        },\n        GetFirmwareMetadata: {\n          invoke: {\n            src: \"getFirmwareMetadata\",\n            onDone: {\n              target: \"GetFirmwareMetadataResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const deviceState = internalApi.getDeviceSessionState();\n                    if (\n                      deviceState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      internalApi.setDeviceSessionState({\n                        ...deviceState,\n                        firmwareVersion: _.event.output.data.firmwareVersion,\n                        firmwareUpdateContext:\n                          _.event.output.data.firmwareUpdateContext,\n                        customImage: _.event.output.data.customImage,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      deviceVersion: _.event.output.data.deviceVersion,\n                      firmware: _.event.output.data.firmware,\n                      firmwareVersion: _.event.output.data.firmwareVersion,\n                      firmwareUpdateContext:\n                        _.event.output.data.firmwareUpdateContext,\n                      customImage: _.event.output.data.customImage,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetFirmwareMetadataResultCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              guard: \"useSecureChannel\",\n              target: \"ListAppsSecureChannel\",\n            },\n            {\n              target: \"ListApps\",\n            },\n          ],\n        },\n        ListAppsSecureChannel: {\n          exit: assign({\n            intermediateValue: {\n              requiredUserInteraction: UserInteractionRequired.None,\n            },\n          }),\n          invoke: {\n            id: \"listAppsSecureChannel\",\n            src: \"listAppsSecureChannel\",\n            input: (_) => ({\n              firmware: _.context._internalState.firmware!,\n              firmwareVersion: _.context._internalState.firmwareVersion!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  switch (_.event.snapshot.context?.type) {\n                    case SecureChannelEventType.DeviceId: {\n                      return {\n                        ..._.context.intermediateValue,\n                        deviceId: _.event.snapshot.context.payload.deviceId,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionRequested: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction:\n                          UserInteractionRequired.AllowSecureConnection,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionGranted: {\n                      const deviceState = internalApi.getDeviceSessionState();\n                      if (\n                        deviceState.sessionStateType !==\n                        DeviceSessionStateType.Connected\n                      ) {\n                        internalApi.setDeviceSessionState({\n                          ...deviceState,\n                          isSecureConnectionAllowed: true,\n                        });\n                      }\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction: UserInteractionRequired.None,\n                      };\n                    }\n                    default:\n                      return {\n                        ..._.context.intermediateValue,\n                      };\n                  }\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.snapshot.context.error.mapDAErrors(),\n                    };\n                  } else if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Result\n                  ) {\n                    if (\n                      installedAppResultGuard(_.event.snapshot.context.payload)\n                    ) {\n                      return {\n                        ..._.context._internalState,\n                        installedApps: _.event.snapshot.context.payload.map(\n                          (app) => ({\n                            name: app.name,\n                            hash: app.hash,\n                            hashCode: app.hash_code_data,\n                          }),\n                        ),\n                      };\n                    }\n                    throw new Error(\n                      `Invalid result ${JSON.stringify(_.event.snapshot.context.payload)}`,\n                    );\n                  }\n                  return { ..._.context._internalState };\n                },\n              }),\n            },\n            onDone: {\n              target: \"ListAppsCheck\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ListApps: {\n          exit: assign({\n            intermediateValue: {\n              requiredUserInteraction: UserInteractionRequired.None,\n            },\n          }),\n          invoke: {\n            id: \"listApps\",\n            src: \"listApps\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"ListAppsCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (_.event.output.isLeft()) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.output.extract(),\n                    };\n                  } else {\n                    return {\n                      ..._.context._internalState,\n                      installedApps: _.event.output\n                        .unsafeCoerce()\n                        .map((app) => ({\n                          name: app.appName,\n                          hash: app.appFullHash,\n                          hashCode: app.appCodeHash,\n                        })),\n                    };\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ListAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetApplicationsMetadata\",\n            },\n          ],\n        },\n        GetApplicationsMetadata: {\n          invoke: {\n            src: \"getApplicationsMetadata\",\n            input: (_) => ({\n              deviceVersion: _.context._internalState.deviceVersion!,\n              firmware: _.context._internalState.firmware!,\n              firmwareVersion: _.context._internalState.firmwareVersion!,\n              installedApps: _.context._internalState.installedApps!,\n            }),\n            onDone: {\n              target: \"GetApplicationsMetadataResultCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const deviceState = internalApi.getDeviceSessionState();\n                    if (\n                      deviceState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      internalApi.setDeviceSessionState({\n                        ...deviceState,\n                        installedApps: _.event.output.data.applications,\n                        appsUpdates: _.event.output.data.applicationsUpdates,\n                        installedLanguages:\n                          _.event.output.data.installedLanguages,\n                        catalog: _.event.output.data.catalog,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      applications: _.event.output.data.applications,\n                      applicationsUpdates:\n                        _.event.output.data.applicationsUpdates,\n                      installedLanguages:\n                        _.event.output.data.installedLanguages,\n                      catalog: _.event.output.data.catalog,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetApplicationsMetadataResultCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (args) => {\n        const { context } = args;\n        const {\n          error,\n          firmwareVersion,\n          firmwareUpdateContext,\n          customImage,\n          applications,\n          applicationsUpdates,\n          installedLanguages,\n          catalog,\n        } = context._internalState;\n        if (error) {\n          return Left(error);\n        }\n        return Right({\n          firmwareVersion: firmwareVersion!,\n          firmwareUpdateContext: firmwareUpdateContext!,\n          customImage: customImage!,\n          applications: applications!,\n          applicationsUpdates: applicationsUpdates!,\n          installedLanguages: installedLanguages!,\n          catalog: catalog!,\n        });\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getDeviceMetadata = () => {\n      const deviceState = internalApi.getDeviceSessionState();\n      if (\n        deviceState.sessionStateType === DeviceSessionStateType.Connected ||\n        deviceState.firmwareVersion?.metadata === undefined ||\n        deviceState.firmwareUpdateContext === undefined ||\n        deviceState.customImage === undefined ||\n        deviceState.installedApps.length === 0 ||\n        deviceState.appsUpdates === undefined ||\n        deviceState.installedLanguages === undefined ||\n        deviceState.catalog === undefined\n      ) {\n        return Promise.resolve(null);\n      }\n      return Promise.resolve({\n        firmwareVersion: deviceState.firmwareVersion,\n        firmwareUpdateContext: deviceState.firmwareUpdateContext,\n        customImage: deviceState.customImage,\n        applications: deviceState.installedApps,\n        applicationsUpdates: deviceState.appsUpdates,\n        installedLanguages: deviceState.installedLanguages,\n        catalog: deviceState.catalog,\n      });\n    };\n\n    const getFirmwareMetadata = async () =>\n      new GetFirmwareMetadataTask(internalApi).run();\n\n    const getApplicationsMetadata = async (arg0: {\n      input: {\n        deviceVersion: DeviceVersion;\n        firmware: FinalFirmware;\n        firmwareVersion: FirmwareVersion;\n        installedApps: InstalledApp[];\n      };\n    }) =>\n      new GetApplicationsMetadataTask(internalApi, {\n        deviceVersion: arg0.input.deviceVersion,\n        firmware: arg0.input.firmware,\n        firmwareVersion: arg0.input.firmwareVersion,\n        installedApps: arg0.input.installedApps,\n      }).run();\n\n    const listAppsSecureChannel = (arg0: {\n      input: {\n        firmware: FinalFirmware;\n        firmwareVersion: FirmwareVersion;\n      };\n    }) => {\n      const { firmware, firmwareVersion } = arg0.input;\n      const connection = internalApi\n        .getSecureChannelService()\n        .listInstalledApps(firmwareVersion.metadata!, firmware);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection,\n      }).run();\n    };\n\n    return {\n      getDeviceMetadata,\n      getFirmwareMetadata,\n      getApplicationsMetadata,\n      listAppsSecureChannel,\n    };\n  }\n}\n", "import { gte } from \"semver\";\n\nimport type { DeviceModelId } from \"@api/device/DeviceModel\";\nimport type { InternalApi } from \"@api/device-action/DeviceAction\";\nimport {\n  UnknownDAError,\n  UnsupportedApplicationDAError,\n  UnsupportedFirmwareDAError,\n} from \"@api/device-action/os/Errors\";\nimport type {\n  ApplicationConstraint,\n  ApplicationDependency,\n} from \"@api/device-action/os/InstallOrUpdateApps/types\";\nimport { DeviceSessionStateType } from \"@api/device-session/DeviceSessionState\";\nimport type { Application } from \"@internal/manager-api/model/Application\";\n\nexport type BuildAppsInstallPlanTaskArgs = {\n  /**\n   * List of applications to install or update\n   */\n  readonly applications: ApplicationDependency[];\n\n  /**\n   * Indicates if the device action should fail if an application is missing from the app store.\n   */\n  readonly allowMissingApplication: boolean;\n};\n\nexport type BuildAppsInstallPlanTaskResult =\n  | {\n      installPlan: Application[];\n      alreadyInstalled: string[];\n      missingApplications: string[];\n    }\n  | {\n      error:\n        | UnknownDAError\n        | UnsupportedApplicationDAError\n        | UnsupportedFirmwareDAError;\n    };\n\nexport class BuildAppsInstallPlanTask {\n  private readonly deviceModelId: DeviceModelId;\n\n  constructor(\n    private readonly api: InternalApi,\n    private readonly args: BuildAppsInstallPlanTaskArgs,\n  ) {\n    const deviceModel = api.getDeviceModel();\n    this.deviceModelId = deviceModel.id;\n  }\n\n  run(): BuildAppsInstallPlanTaskResult {\n    // Get device session state.\n    const deviceState = this.api.getDeviceSessionState();\n    if (deviceState.sessionStateType === DeviceSessionStateType.Connected) {\n      return { error: new UnknownDAError(\"Invalid device state\") };\n    }\n\n    // Ensure the device metadata were correctly fetched.\n    if (deviceState.catalog === undefined) {\n      return { error: new UnknownDAError(\"Device apps metadata not fetched\") };\n    }\n\n    // Build the install plan\n    let installPlan: Application[] = [];\n    let alreadyInstalled: string[] = [];\n    let missingApplications: string[] = [];\n    for (const app of this.args.applications) {\n      // Get app entry from catalog and from installed apps\n      const catalogApp = deviceState.catalog.applications.find(\n        (a) => a.versionName === app.name,\n      );\n      const installedApp = deviceState.installedApps.find(\n        (a) => a.versionName === app.name,\n      );\n\n      // If app is already installed, with validated constraints, continue the iteration\n      if (\n        installedApp !== undefined &&\n        this.validateConstraint(installedApp, catalogApp, app.constraints)\n      ) {\n        alreadyInstalled = [...alreadyInstalled, app.name];\n        continue;\n      }\n\n      // Handle the catalog application\n      if (\n        catalogApp !== undefined &&\n        this.validateConstraint(catalogApp, undefined, app.constraints)\n      ) {\n        // Add the catalog application to the install plan\n        installPlan = [...installPlan, catalogApp];\n      } else if (this.args.allowMissingApplication) {\n        missingApplications = [...missingApplications, app.name];\n      } else {\n        /**\n         * Fail immediately if missing application is not allowed.\n         *\n         * TODO: If the application is not in catalog, we should also check if the application will be available in the\n         * latest firmware catalog before throwing `UnsupportedApplicationDAError`. The actual implementation will always\n         * throw `UnsupportedFirmwareDAError` to force the user to update firmware first, even though the application may\n         * be still not available after the firmware update. For now, we keep `catalogApp !== undefined` check to prevent\n         * from forgetting this case.\n         *\n         * Decision matrix for application availability according to OS and catalog:\n         *\n         * \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         * \u2502 Not valid constraint \u2502 Found in catalog              \u2502 Not found in catalog               \u2502\n         * \u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         * \u2502 OS up-to-date        \u2502 UnsupportedApplicationDAError \u2502 UnsupportedApplicationDAError      \u2502\n         * \u2502 OS out-of-date       \u2502 UnsupportedFirmwareDAError    \u2502 UnsupportedFirmwareDAError => TODO \u2502\n         * \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         */\n        if (\n          deviceState.firmwareUpdateContext?.availableUpdate !== undefined &&\n          catalogApp !== undefined\n        ) {\n          return {\n            error: new UnsupportedFirmwareDAError(\n              `Application ${app.name} needs latest firmware`,\n            ),\n          };\n        } else if (\n          deviceState.firmwareUpdateContext?.availableUpdate !== undefined\n        ) {\n          // TODO: Application not found in out-of-date firmware catalog, needs to check if the application will be available\n          // after firmware update\n          return {\n            error: new UnsupportedFirmwareDAError(\n              `Application ${app.name} needs latest firmware`,\n            ),\n          };\n        } else {\n          return {\n            error: new UnsupportedApplicationDAError(\n              `Application ${app.name} not supported for this device`,\n            ),\n          };\n        }\n      }\n    }\n\n    // Find installPlan dependencies\n    const dependencies = installPlan.reduce((apps, app) => {\n      const dependency = app.parentName;\n      if (dependency) {\n        const catalogApp = deviceState.catalog!.applications.find(\n          (a) => a.versionName === dependency,\n        );\n        const installedApp = deviceState.installedApps.find(\n          (a) => a.versionName === dependency,\n        );\n        if (catalogApp && !installedApp) {\n          return [...apps, catalogApp];\n        }\n      }\n      return apps;\n    }, [] as Application[]);\n\n    // Reorder and deduplicate the install plan with its dependencies first\n    installPlan = [...dependencies, ...installPlan];\n    const reorderedInstallPlan = installPlan.filter(\n      (app, index) =>\n        installPlan.findIndex((a) => a.versionName === app.versionName) ===\n        index,\n    );\n\n    return {\n      installPlan: reorderedInstallPlan,\n      missingApplications,\n      alreadyInstalled,\n    };\n  }\n\n  private validateConstraint(\n    app: Application,\n    catalogApp?: Application,\n    constraints?: ApplicationConstraint[],\n  ): boolean {\n    if (constraints === undefined) {\n      // No constraint\n      return true;\n    }\n\n    // Validate the constraint\n    for (const constraint of constraints) {\n      // Is current device exempt from the constraint?\n      if (\n        constraint.exemptModels !== undefined &&\n        constraint.exemptModels.includes(this.deviceModelId)\n      ) {\n        continue;\n      }\n\n      // Is current device not applicable for the constraint?\n      if (\n        constraint.applicableModels !== undefined &&\n        !constraint.applicableModels.includes(this.deviceModelId)\n      ) {\n        continue;\n      }\n\n      // Validate the min version\n      if (constraint.minVersion === \"latest\") {\n        return !catalogApp || gte(app.version, catalogApp.version);\n      } else {\n        return gte(app.version, constraint.minVersion);\n      }\n    }\n\n    // No constraint for the device\n    return true;\n  }\n}\n", "import type { InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { type TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\nimport {\n  type CustomImage,\n  DeviceSessionStateType,\n  type FirmwareUpdateContext,\n  type FirmwareVersion,\n  type InstalledLanguagePackage,\n} from \"@api/device-session/DeviceSessionState\";\nimport type { Application } from \"@internal/manager-api/model/Application\";\n\nexport type PredictOutOfMemoryTaskArgs = {\n  installPlan: Application[];\n};\n\nexport type PredictOutOfMemoryTaskResult =\n  | {\n      outOfMemory: boolean;\n    }\n  | {\n      error: UnknownDAError;\n    };\n\nexport class PredictOutOfMemoryTask {\n  private readonly deviceModel: TransportDeviceModel;\n\n  constructor(\n    private readonly api: InternalApi,\n    private readonly args: PredictOutOfMemoryTaskArgs,\n  ) {\n    this.deviceModel = api.getDeviceModel();\n  }\n\n  run(): PredictOutOfMemoryTaskResult {\n    const deviceState = this.api.getDeviceSessionState();\n\n    if (deviceState.sessionStateType === DeviceSessionStateType.Connected) {\n      return { error: new UnknownDAError(\"Invalid device state\") };\n    }\n\n    const {\n      firmwareUpdateContext,\n      customImage,\n      firmwareVersion,\n      installedLanguages,\n      installedApps,\n    } = deviceState;\n\n    if (\n      firmwareUpdateContext === undefined ||\n      customImage === undefined ||\n      firmwareVersion === undefined ||\n      installedLanguages === undefined\n    ) {\n      return { error: new UnknownDAError(\"Device metadata not fetched\") };\n    }\n\n    const { blockSize, totalMemoryBlocks } =\n      this.getMemoryConstants(firmwareVersion);\n\n    const currentMemoryBlocksUsage = this.getCurrentMemoryBlocksUsage({\n      firmwareUpdateContext,\n      customImage,\n      installedApps,\n      installedLanguages,\n      blockSize,\n    });\n\n    const installPlanBlocksUsage = this.getInstallPlanMemoryBlocksUsage(\n      this.args.installPlan,\n      blockSize,\n    );\n\n    return {\n      outOfMemory:\n        currentMemoryBlocksUsage + installPlanBlocksUsage > totalMemoryBlocks,\n    };\n  }\n\n  private getMemoryConstants(firmwareVersion: FirmwareVersion): {\n    blockSize: number;\n    totalMemoryBlocks: number;\n  } {\n    const blockSize = this.deviceModel.getBlockSize({\n      firmwareVersion: firmwareVersion.os,\n    });\n    const totalMemoryBlocks = Math.floor(\n      this.deviceModel.memorySize / blockSize,\n    );\n    return { blockSize, totalMemoryBlocks };\n  }\n\n  private getCurrentMemoryBlocksUsage({\n    firmwareUpdateContext,\n    customImage,\n    installedApps,\n    installedLanguages,\n    blockSize,\n  }: {\n    firmwareUpdateContext: FirmwareUpdateContext;\n    customImage: CustomImage;\n    installedApps: Application[];\n    installedLanguages: InstalledLanguagePackage[];\n    blockSize: number;\n  }): number {\n    const bytesToBlocks = (size: number) => Math.ceil(size / blockSize);\n    const firmwareBlocks = bytesToBlocks(\n      firmwareUpdateContext.currentFirmware.bytes || 0,\n    );\n    const customImageBlocks = bytesToBlocks(customImage.size || 0);\n    const applicationsBlocks = installedApps.reduce(\n      (size, app) => size + bytesToBlocks(app.bytes || 0),\n      0,\n    );\n    const languagesBlocks = installedLanguages.reduce(\n      (size, lang) => size + bytesToBlocks(lang.size),\n      0,\n    );\n    return (\n      firmwareBlocks + customImageBlocks + applicationsBlocks + languagesBlocks\n    );\n  }\n\n  private getInstallPlanMemoryBlocksUsage(\n    installPlan: Application[],\n    blockSize: number,\n  ): number {\n    const bytesToBlocks = (size: number) => Math.ceil(size / blockSize);\n    return installPlan.reduce(\n      (size, app) => size + bytesToBlocks(app.bytes || 0),\n      0,\n    );\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { type Observable } from \"rxjs\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { OutOfMemoryDAError } from \"@api/device-action/os/Errors\";\nimport { GetDeviceMetadataDeviceAction } from \"@api/device-action/os/GetDeviceMetadata/GetDeviceMetadataDeviceAction\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport {\n  BuildAppsInstallPlanTask,\n  type BuildAppsInstallPlanTaskResult,\n} from \"@api/device-action/task/BuildAppsInstallPlanTask\";\nimport {\n  PredictOutOfMemoryTask,\n  type PredictOutOfMemoryTaskResult,\n} from \"@api/device-action/task/PredictOutOfMemoryTask\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport { DeviceSessionStateType } from \"@api/device-session/DeviceSessionState\";\nimport { type GetOsVersionResponse } from \"@api/index\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type SecureChannelEvent } from \"@api/secure-channel/task/types\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\n\nimport {\n  type ApplicationDependency,\n  type InstallOrUpdateAppsDAError,\n  type InstallOrUpdateAppsDAInput,\n  type InstallOrUpdateAppsDAIntermediateValue,\n  type InstallOrUpdateAppsDAOutput,\n} from \"./types\";\n\ntype InstallOrUpdateAppsMachineInternalState = {\n  readonly error: InstallOrUpdateAppsDAError | null;\n  readonly osVersion: GetOsVersionResponse | null;\n  readonly currentIndex: number;\n};\n\nexport type MachineDependencies = {\n  readonly buildInstallPlan: (arg0: {\n    input: {\n      applications: ApplicationDependency[];\n      allowMissingApplication: boolean;\n    };\n  }) => Promise<BuildAppsInstallPlanTaskResult>;\n  readonly predictOutOfMemory: (arg0: {\n    input: {\n      installPlan: Application[];\n    };\n  }) => Promise<PredictOutOfMemoryTaskResult>;\n  readonly installApp: (arg0: {\n    input: {\n      osVersion: GetOsVersionResponse;\n      application: Application;\n    };\n  }) => Observable<SecureChannelEvent>;\n};\n\nexport type ExtractMachineDependencies = (\n  internalApi: InternalApi,\n) => MachineDependencies;\n\nexport class InstallOrUpdateAppsDeviceAction extends XStateDeviceAction<\n  InstallOrUpdateAppsDAOutput,\n  InstallOrUpdateAppsDAInput,\n  InstallOrUpdateAppsDAError,\n  InstallOrUpdateAppsDAIntermediateValue,\n  InstallOrUpdateAppsMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    InstallOrUpdateAppsDAOutput,\n    InstallOrUpdateAppsDAInput,\n    InstallOrUpdateAppsDAError,\n    InstallOrUpdateAppsDAIntermediateValue,\n    InstallOrUpdateAppsMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      InstallOrUpdateAppsDAOutput,\n      InstallOrUpdateAppsDAInput,\n      InstallOrUpdateAppsDAError,\n      InstallOrUpdateAppsDAIntermediateValue,\n      InstallOrUpdateAppsMachineInternalState\n    >;\n\n    const { buildInstallPlan, predictOutOfMemory, installApp } =\n      this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const updateMetadataMachine = new GetDeviceMetadataDeviceAction({\n      input: {\n        unlockTimeout,\n        useSecureChannel: true,\n        forceUpdate: false,\n      },\n    }).makeStateMachine(internalApi);\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        updateMetadata: updateMetadataMachine,\n        buildInstallPlan: fromPromise(buildInstallPlan),\n        predictOutOfMemory: fromPromise(predictOutOfMemory),\n        goToDashboard: goToDashboardMachine,\n        installApp: fromObservable(installApp),\n      },\n      guards: {\n        hasError: ({ context }) => context._internalState.error !== null,\n        hasInstallPlan: (_) => _.context.intermediateValue.installPlan !== null,\n        hasMoreApps: (_) =>\n          _.context._internalState.currentIndex <\n          _.context.intermediateValue.installPlan!.installPlan.length,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n        nextAppIndex: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            currentIndex: _.context._internalState.currentIndex + 1,\n          }),\n        }),\n        cleanupDeviceState: () => {\n          // After app successful installation, cleanup the device session state\n          // to force fetching the new device state when required\n          const state = internalApi.getDeviceSessionState();\n          if (state.sessionStateType !== DeviceSessionStateType.Connected) {\n            internalApi.setDeviceSessionState({\n              ...state,\n              installedApps: [],\n              appsUpdates: undefined,\n            });\n          }\n        },\n      },\n    }).createMachine({\n      id: \"InstallOrUpdateAppsDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            applications: _.input.applications,\n            allowMissingApplication: _.input.allowMissingApplication,\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n            installPlan: null,\n          },\n          _internalState: {\n            error: null,\n            osVersion: null,\n            currentIndex: 0,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: [\n            {\n              target: \"UpdateDeviceMetadata\",\n            },\n          ],\n        },\n        UpdateDeviceMetadata: {\n          exit: assign({\n            intermediateValue: (_) => ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }),\n          }),\n          invoke: {\n            id: \"updateMetadata\",\n            src: \"updateMetadata\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n              useSecureChannel: true,\n              forceUpdate: false,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                  deviceId:\n                    _.event.snapshot.context.intermediateValue.deviceId ??\n                    _.context.intermediateValue.deviceId,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"UpdateDeviceMetadataCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<InstallOrUpdateAppsMachineInternalState>(\n                    {\n                      Right: (data) => ({\n                        ..._.context._internalState,\n                        osVersion: data.firmwareVersion.metadata!,\n                      }),\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        UpdateDeviceMetadataCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n              guard: \"hasInstallPlan\",\n            },\n            {\n              target: \"BuildInstallPlan\",\n            },\n          ],\n        },\n        BuildInstallPlan: {\n          invoke: {\n            src: \"buildInstallPlan\",\n            input: (_) => ({\n              applications: _.context.input.applications,\n              allowMissingApplication: _.context.input.allowMissingApplication,\n            }),\n            onDone: {\n              target: \"BuildInstallPlanCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (\"error\" in _.event.output) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.output.error,\n                    };\n                  } else {\n                    return _.context._internalState;\n                  }\n                },\n                intermediateValue: (_) => {\n                  if (\"error\" in _.event.output) {\n                    return _.context.intermediateValue;\n                  } else {\n                    return {\n                      ..._.context.intermediateValue,\n                      installPlan: {\n                        installPlan: _.event.output.installPlan,\n                        alreadyInstalled: _.event.output.alreadyInstalled,\n                        missingApplications: _.event.output.missingApplications,\n                        currentIndex: 0,\n                        currentProgress: 0,\n                      },\n                    };\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        BuildInstallPlanCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"PredictOutOfMemory\",\n              guard: \"hasMoreApps\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        PredictOutOfMemory: {\n          invoke: {\n            src: \"predictOutOfMemory\",\n            input: (_) => ({\n              installPlan: _.context.intermediateValue.installPlan!.installPlan,\n            }),\n            onDone: {\n              target: \"PredictOutOfMemoryCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (\"error\" in _.event.output) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.output.error,\n                    };\n                  } else if (_.event.output.outOfMemory) {\n                    return {\n                      ..._.context._internalState,\n                      error: new OutOfMemoryDAError(\n                        \"Not enough memory for those applications\",\n                      ),\n                    };\n                  } else {\n                    return _.context._internalState;\n                  }\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        PredictOutOfMemoryCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"GoToDashboard\",\n            },\n          ],\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"goToDashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<InstallOrUpdateAppsMachineInternalState>(\n                    {\n                      Right: () => _.context._internalState,\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"InstallApp\",\n              actions: \"cleanupDeviceState\",\n            },\n          ],\n        },\n        InstallApp: {\n          exit: assign({\n            intermediateValue: (_) => ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }),\n          }),\n          invoke: {\n            id: \"installApp\",\n            src: \"installApp\",\n            input: (_) => ({\n              osVersion: _.context._internalState.osVersion!,\n              application:\n                _.context.intermediateValue.installPlan!.installPlan[\n                  _.context._internalState.currentIndex\n                ]!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  switch (_.event.snapshot.context?.type) {\n                    case SecureChannelEventType.DeviceId: {\n                      return {\n                        ..._.context.intermediateValue,\n                        deviceId: _.event.snapshot.context.payload.deviceId,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionRequested: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction:\n                          UserInteractionRequired.AllowSecureConnection,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionGranted: {\n                      const deviceState = internalApi.getDeviceSessionState();\n                      if (\n                        deviceState.sessionStateType !==\n                        DeviceSessionStateType.Connected\n                      ) {\n                        internalApi.setDeviceSessionState({\n                          ...deviceState,\n                          isSecureConnectionAllowed: true,\n                        });\n                      }\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction: UserInteractionRequired.None,\n                      };\n                    }\n                    case SecureChannelEventType.Progress: {\n                      return {\n                        ..._.context.intermediateValue,\n                        installPlan: {\n                          ..._.context.intermediateValue.installPlan!,\n                          currentIndex: _.context._internalState.currentIndex,\n                          currentProgress:\n                            _.event.snapshot.context.payload.progress,\n                        },\n                      };\n                    }\n                    default:\n                      return _.context.intermediateValue;\n                  }\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error:\n                        _.event.snapshot.context.error.mapInstallDAErrors(),\n                    };\n                  }\n                  return _.context._internalState;\n                },\n              }),\n            },\n            onDone: {\n              target: \"InstallAppCheck\",\n              actions: \"nextAppIndex\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        InstallAppCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"InstallApp\",\n              guard: \"hasMoreApps\",\n            },\n            {\n              target: \"UpdateDeviceMetadata\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (args) => {\n        const { context } = args;\n        const { error } = context._internalState;\n        const { installPlan } = context.intermediateValue;\n        if (error) {\n          return Left(error);\n        }\n        return Right({\n          successfullyInstalled: installPlan!.installPlan,\n          alreadyInstalled: installPlan!.alreadyInstalled,\n          missingApplications: installPlan!.missingApplications,\n        });\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const buildInstallPlan = (arg0: {\n      input: {\n        applications: ApplicationDependency[];\n        allowMissingApplication: boolean;\n      };\n    }) =>\n      Promise.resolve(\n        new BuildAppsInstallPlanTask(internalApi, {\n          applications: arg0.input.applications,\n          allowMissingApplication: arg0.input.allowMissingApplication,\n        }).run(),\n      );\n\n    const predictOutOfMemory = (arg0: {\n      input: {\n        installPlan: Application[];\n      };\n    }) =>\n      Promise.resolve(\n        new PredictOutOfMemoryTask(internalApi, {\n          installPlan: arg0.input.installPlan,\n        }).run(),\n      );\n\n    const installApp = (arg0: {\n      input: {\n        osVersion: GetOsVersionResponse;\n        application: Application;\n      };\n    }) => {\n      const { osVersion, application } = arg0.input;\n      const connection = internalApi\n        .getSecureChannelService()\n        .installApp(osVersion, application);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection,\n      }).run();\n    };\n\n    return {\n      buildInstallPlan,\n      predictOutOfMemory,\n      installApp,\n    };\n  }\n}\n", "import { type EitherAsync, Left, Right } from \"purify-ts\";\nimport {\n  type AnyEventObject,\n  assign,\n  fromCallback,\n  fromPromise,\n  setup,\n} from \"xstate\";\n\nimport { type ListAppsResponse } from \"@api/command/os/ListAppsCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { ListAppsDeviceAction } from \"@api/device-action/os/ListApps/ListAppsDeviceAction\";\nimport { type ListAppsDAOutput } from \"@api/device-action/os/ListApps/types\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport { type DeviceSessionState } from \"@api/device-session/DeviceSessionState\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport { type HttpFetchApiError } from \"@internal/manager-api/model/Errors\";\n\nimport {\n  type ListAppsWithMetadataDAError,\n  type ListAppsWithMetadataDAInput,\n  type ListAppsWithMetadataDAIntermediateValue,\n  type ListAppsWithMetadataDAOutput,\n} from \"./types\";\n\ntype ListAppsWithMetadataMachineInternalState = {\n  error: ListAppsWithMetadataDAError | null;\n  apps: ListAppsResponse;\n  appsWithMetadata: ListAppsWithMetadataDAOutput;\n};\n\nexport type MachineDependencies = {\n  getAppsByHash: ({\n    input,\n  }: {\n    input: ListAppsDAOutput;\n  }) => EitherAsync<HttpFetchApiError, Array<Application | null>>;\n  getDeviceSessionState: () => DeviceSessionState;\n  setDeviceSessionState: (state: DeviceSessionState) => DeviceSessionState;\n};\n\nexport class ListAppsWithMetadataDeviceAction extends XStateDeviceAction<\n  ListAppsWithMetadataDAOutput,\n  ListAppsWithMetadataDAInput,\n  ListAppsWithMetadataDAError,\n  ListAppsWithMetadataDAIntermediateValue,\n  ListAppsWithMetadataMachineInternalState\n> {\n  makeStateMachine(\n    internalAPI: InternalApi,\n  ): DeviceActionStateMachine<\n    ListAppsWithMetadataDAOutput,\n    ListAppsWithMetadataDAInput,\n    ListAppsWithMetadataDAError,\n    ListAppsWithMetadataDAIntermediateValue,\n    ListAppsWithMetadataMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      ListAppsWithMetadataDAOutput,\n      ListAppsWithMetadataDAInput,\n      ListAppsWithMetadataDAError,\n      ListAppsWithMetadataDAIntermediateValue,\n      ListAppsWithMetadataMachineInternalState\n    >;\n\n    const { getAppsByHash, setDeviceSessionState, getDeviceSessionState } =\n      this.extractDependencies(internalAPI);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const listAppsMachine = new ListAppsDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalAPI);\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        listApps: listAppsMachine,\n        getAppsByHash: fromPromise(getAppsByHash),\n        updateDeviceSessionState: fromCallback(\n          ({\n            input,\n            sendBack,\n          }: {\n            sendBack: (event: AnyEventObject) => void;\n            input: {\n              appsWithMetadata: Array<Application | null>;\n            };\n          }) => {\n            const { appsWithMetadata } = input;\n\n            const filterted = appsWithMetadata.filter((app) => app !== null);\n\n            const sessionState = getDeviceSessionState();\n            const updatedState = {\n              ...sessionState,\n              installedApps: filterted,\n            };\n            try {\n              setDeviceSessionState(updatedState);\n              sendBack({ type: \"done\" });\n            } catch (error) {\n              sendBack({ type: \"error\", error });\n            }\n          },\n        ),\n      },\n      guards: {\n        hasError: ({ context }: { context: types[\"context\"] }) => {\n          return context._internalState.error !== null;\n        },\n        hasNoAppsInstalled: ({ context }: { context: types[\"context\"] }) =>\n          context._internalState.apps.length === 0,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QBkCWsAuBBADj2A6qhgBYCyYGAhhFdQCJgBuqAxmFqxqgPYB2AOkYt2AJTA0AngGIA2gAYAuolA4esYrz4qQAD0QBGAJzyBADgBsAdgNWAzPIAs8+TceOANCEmILAJjMBKwsHOyMjAzN7SIBfGK80TFx8IlIKaloGZjYOLi0BROw8WGkIfjABVD4mHgBrCoAbdCL8BWUkEDUNbn4dfQQAVgCBIz9IgacQ6z8-Lx8Ef1N5OwsBlbs7dyNHCziE5uTCYnJKGjoqYRzOHsFCw+kwACdHnkeBHAa6ADNXgFsBJpJYptHRdTS9Dr9IaBUbjSYrKwzOaIMwGAQTFx2MxmOx+AYDKxGAZ7EB3YqpE4Zc6XdjXfJk-AAYRIYFYtTkSlB6nB2khKKGAj89jCRjCFmWdmRCD8LiCGIMMysqIsCpJDKOaVOmQu2VpeX4BQOxWZrPZsgM7VU3JufX5fkFwvCYolUqVjkFyxlA3FeO9VjVRpSx3SZyyIlyN0NQKZLLZcj8ls61q0toQZgFQo2TqM4o2UosjjsQRC8iFa1GfiJAejGspoZ14bpBoAYpRWHXtaVypVqnUKjAWrAAEKSAASVFgJBBHTBNr5CAM7gsAkcY3TZmW-iMiPzm0Flkc2PX8gMTmrg4pIe1NIj+VbGHbV-OD2er3enwwP0e-wHhxH48nacrW6FN50XHYVzXAYNxWSsd28RA7GMQUMUcaCLFFTZdniUlA1rJ8wyufVBHvR8tXOE04yApMQIhUB+kiVYBFLTYbBmPwCwsKUdjRRxghVMwAlWSIjHPQ5L3Iwi9UjUiOwo2MzQtLlaN5ejDEsAZmL8ViFRmTj8wLSDt3kbFtzGZYxPJYNJIbIjIwAZSoJgwHsuANH4Ls+DAajZ1AtTpQ4wJnH8UyHB9fNgiMjCzCdcUzEcSyg01KkpNvA1HOc1zYHcvgXxeR4fOTOi9EQPSgvkEKYrC0spQJIwRn4pw8QLAwQjiHC+B4CA4B0dUJJS2zpL8mieVTABaLiEIQMbNPCOb5vmyxEvwmybybQQb3EKRlNG+dV3zIVizCxwc3sPxlv6+s1uIqNBx2ud-ICWa1lPexsWMb18ycQUS3FfEFTsb0LusgbrsjdVKNqe7hv6CwogECwCxPQGhSsNCjHzVdmIMMKBgMBV8eMYHkqu3U0pIts5OoaHioY093QCEwMNFJV5Gg-NInRHGKoqnNSzR4mqcG8mBFkgiqEhmnVJKhdVndQTlncKxXCsfF829H6HFsEJvSFbD9hrS7rzJ9aBAyly3OG3zadK-nzAGUUzKsQlxQxqaQnq2xt1XNnnBMuxBfFsH8nsgBXVh2GyqXUzxCqBEB7YxlXGLIisV0cy5sLlcR53RUD1aTZugBRV9Hmj+dY+XBPV0XRnU9qyxzGiiqNwmOxgnamIgA */\n      id: \"ListAppsWithMetadataDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: _.input,\n          _internalState: {\n            error: null,\n            apps: [],\n            appsWithMetadata: [],\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"ListApps\",\n          },\n        },\n        ListApps: {\n          invoke: {\n            id: \"listApps\",\n            src: \"listApps\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              target: \"ListAppsCheck\",\n              actions: assign({\n                intermediateValue: (_) => ({\n                  requiredUserInteraction: UserInteractionRequired.None,\n                }),\n                _internalState: (_) => {\n                  return _.event.output.caseOf({\n                    Right: (apps) => ({\n                      ..._.context._internalState,\n                      apps,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n            },\n          },\n        },\n        ListAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n              guard: \"hasNoAppsInstalled\",\n              actions: assign({\n                _internalState: (_) => {\n                  return {\n                    ..._.context._internalState,\n                    appsWithMetadata: [],\n                  };\n                },\n              }),\n            },\n            {\n              target: \"FetchMetadata\",\n            },\n          ],\n        },\n        FetchMetadata: {\n          invoke: {\n            id: \"getAppsByHash\",\n            src: \"getAppsByHash\",\n            input: (_) => _.context._internalState.apps,\n            onDone: {\n              target: \"FetchMetadataCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf({\n                    Right: (appsWithMetadata) => ({\n                      ..._.context._internalState,\n                      appsWithMetadata,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        FetchMetadataCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"SaveSession\",\n            },\n          ],\n        },\n        SaveSession: {\n          invoke: {\n            src: \"updateDeviceSessionState\",\n            input: (_) => ({\n              appsWithMetadata: _.context._internalState.appsWithMetadata,\n            }),\n          },\n          on: {\n            done: {\n              target: \"Success\",\n            },\n            error: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (_) => {\n        if (_.context._internalState.error) {\n          return Left(_.context._internalState.error);\n        }\n\n        return Right(_.context._internalState.appsWithMetadata);\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getAppsByHash = ({ input }: { input: ListAppsDAOutput }) => {\n      const appHashes = input.reduce<string[]>((acc, app) => {\n        if (app.appFullHash) {\n          return acc.concat(app.appFullHash);\n        }\n        return acc;\n      }, []);\n      return internalApi.getManagerApiService().getAppsByHash(appHashes);\n    };\n    return {\n      getAppsByHash,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state: DeviceSessionState) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, setup } from \"xstate\";\n\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { UnsupportedFirmwareDAError } from \"@api/device-action/os/Errors\";\nimport { GetDeviceMetadataDeviceAction } from \"@api/device-action/os/GetDeviceMetadata/GetDeviceMetadataDeviceAction\";\nimport type { GetDeviceMetadataDAOutput } from \"@api/device-action/os/GetDeviceMetadata/types\";\nimport { InstallOrUpdateAppsDeviceAction } from \"@api/device-action/os/InstallOrUpdateApps/InstallOrUpdateAppsDeviceAction\";\nimport type { InstallOrUpdateAppsDAOutput } from \"@api/device-action/os/InstallOrUpdateApps/types\";\nimport { OpenAppDeviceAction } from \"@api/device-action/os/OpenAppDeviceAction/OpenAppDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\n\nimport {\n  type OpenAppWithDependenciesDAError,\n  type OpenAppWithDependenciesDAInput,\n  type OpenAppWithDependenciesDAIntermediateValue,\n  type OpenAppWithDependenciesDAOutput,\n} from \"./types\";\n\ntype OpenAppWithDependenciesMachineInternalState = {\n  readonly error: OpenAppWithDependenciesDAError | null;\n  readonly deviceMetadata: GetDeviceMetadataDAOutput | null;\n  readonly installResult: InstallOrUpdateAppsDAOutput | null;\n};\n\nexport class OpenAppWithDependenciesDeviceAction extends XStateDeviceAction<\n  OpenAppWithDependenciesDAOutput,\n  OpenAppWithDependenciesDAInput,\n  OpenAppWithDependenciesDAError,\n  OpenAppWithDependenciesDAIntermediateValue,\n  OpenAppWithDependenciesMachineInternalState\n> {\n  makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    OpenAppWithDependenciesDAOutput,\n    OpenAppWithDependenciesDAInput,\n    OpenAppWithDependenciesDAError,\n    OpenAppWithDependenciesDAIntermediateValue,\n    OpenAppWithDependenciesMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      OpenAppWithDependenciesDAOutput,\n      OpenAppWithDependenciesDAInput,\n      OpenAppWithDependenciesDAError,\n      OpenAppWithDependenciesDAIntermediateValue,\n      OpenAppWithDependenciesMachineInternalState\n    >;\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const getMetadataMachine = new GetDeviceMetadataDeviceAction({\n      input: {\n        unlockTimeout,\n        useSecureChannel: true,\n        forceUpdate: false,\n      },\n    }).makeStateMachine(internalApi);\n\n    const installAppsMachine = new InstallOrUpdateAppsDeviceAction({\n      input: {\n        unlockTimeout,\n        applications: [...this.input.dependencies, this.input.application],\n        allowMissingApplication: false,\n      },\n    }).makeStateMachine(internalApi);\n\n    const openAppMachine = new OpenAppDeviceAction({\n      input: {\n        unlockTimeout,\n        appName: this.input.application.name,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {\n          unlockTimeout,\n        } as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        getMetadata: getMetadataMachine,\n        installApps: installAppsMachine,\n        openApp: openAppMachine,\n      },\n      guards: {\n        hasError: ({ context }) => context._internalState.error !== null,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      id: \"OpenAppWithDependenciesDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            application: _.input.application,\n            dependencies: _.input.dependencies,\n            requireLatestFirmware: _.input.requireLatestFirmware,\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n            installPlan: null,\n          },\n          _internalState: {\n            error: null,\n            deviceMetadata: null,\n            installResult: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: [\n            {\n              target: \"GetDeviceMetadata\",\n            },\n          ],\n        },\n        GetDeviceMetadata: {\n          exit: assign({\n            intermediateValue: (_) => ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }),\n          }),\n          invoke: {\n            id: \"getMetadata\",\n            src: \"getMetadata\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n              useSecureChannel: true,\n              forceUpdate: false,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                  deviceId:\n                    _.event.snapshot.context.intermediateValue.deviceId ??\n                    _.context.intermediateValue.deviceId,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GetDeviceMetadataCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<OpenAppWithDependenciesMachineInternalState>(\n                    {\n                      Right: (data) => {\n                        if (\n                          _.context.input.requireLatestFirmware &&\n                          data.firmwareUpdateContext.availableUpdate !==\n                            undefined\n                        ) {\n                          return {\n                            ..._.context._internalState,\n                            error: new UnsupportedFirmwareDAError(\n                              \"Firmware is not the latest version\",\n                            ),\n                          };\n                        } else {\n                          return {\n                            ..._.context._internalState,\n                            deviceMetadata: data,\n                          };\n                        }\n                      },\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetDeviceMetadataCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"InstallDependencies\",\n            },\n          ],\n        },\n        InstallDependencies: {\n          exit: assign({\n            intermediateValue: (_) => ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }),\n          }),\n          invoke: {\n            src: \"installApps\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n              applications: [\n                ..._.context.input.dependencies,\n                _.context.input.application,\n              ],\n              allowMissingApplication: false,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                  installPlan:\n                    _.event.snapshot.context.intermediateValue.installPlan,\n                  deviceId:\n                    _.event.snapshot.context.intermediateValue.deviceId ??\n                    _.context.intermediateValue.deviceId,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"InstallDependenciesCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<OpenAppWithDependenciesMachineInternalState>(\n                    {\n                      Right: (data) => ({\n                        ..._.context._internalState,\n                        installResult: data,\n                      }),\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        InstallDependenciesCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"OpenApp\",\n            },\n          ],\n        },\n        OpenApp: {\n          exit: assign({\n            intermediateValue: (_) => ({\n              ..._.context.intermediateValue,\n              requiredUserInteraction: UserInteractionRequired.None,\n            }),\n          }),\n          invoke: {\n            src: \"openApp\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n              appName: _.context.input.application.name,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                  installPlan: null,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"OpenAppCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<OpenAppWithDependenciesMachineInternalState>(\n                    {\n                      Right: () => _.context._internalState,\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        OpenAppCheck: {\n          always: [\n            {\n              guard: \"hasError\",\n              target: \"Error\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (args) => {\n        const { context } = args;\n        const { error, deviceMetadata, installResult } = context._internalState;\n        if (error) {\n          return Left(error);\n        }\n        return Right({\n          deviceMetadata: deviceMetadata!,\n          installResult: installResult!,\n        });\n      },\n    });\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromPromise, setup } from \"xstate\";\n\nimport {\n  type CommandResult,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { OpenAppDeviceAction } from \"@api/device-action/os/OpenAppDeviceAction/OpenAppDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport { type Command } from \"@api/types\";\n\nimport {\n  type SendCommandInAppDAError,\n  type SendCommandInAppDAInput,\n  type SendCommandInAppDAIntermediateValue,\n  type SendCommandInAppDAInternalState,\n  type SendCommandInAppDAOutput,\n} from \"./SendCommandInAppDeviceActionTypes\";\n\n/**\n * Tries to open an app on the device, and if it is successful, sends a command\n * to the app.\n * The output will be the result of the command.\n *\n * ```ts\n * input: {\n *  appName: string;\n *  command: Command<CommandResult, CommandArgs>;\n *  requiredUserInteraction: UserInteraction;\n * }\n * ```\n *\n * Example of usage:\n *\n * ```ts\n * const deviceAction = new SendCommandInAppDeviceAction({\n *  input: {\n *   appName: \"MyApp\",\n *   command: new MyAppSpecificCommand({commandSpecificArg: \"foo\"}),\n *   requiredUserInteraction: UserInteractionRequired.None,\n *  },\n * });\n * dmk.executeDeviceAction({ sessionId: \"mySessionId\", deviceAction });\n * ```\n */\nexport class SendCommandInAppDeviceAction<\n  CommandResponse,\n  CommandArgs,\n  CommandErrorCodes,\n  UserInteraction extends UserInteractionRequired,\n> extends XStateDeviceAction<\n  SendCommandInAppDAOutput<CommandResponse>,\n  SendCommandInAppDAInput<\n    CommandResponse,\n    CommandArgs,\n    CommandErrorCodes,\n    UserInteraction\n  >,\n  SendCommandInAppDAError<CommandErrorCodes>,\n  SendCommandInAppDAIntermediateValue<UserInteraction>,\n  SendCommandInAppDAInternalState<CommandResponse, CommandErrorCodes>\n> {\n  makeStateMachine(\n    internalAPI: InternalApi,\n  ): DeviceActionStateMachine<\n    SendCommandInAppDAOutput<CommandResponse>,\n    SendCommandInAppDAInput<\n      CommandResponse,\n      CommandArgs,\n      CommandErrorCodes,\n      UserInteraction\n    >,\n    SendCommandInAppDAError<CommandErrorCodes>,\n    SendCommandInAppDAIntermediateValue<UserInteraction>,\n    SendCommandInAppDAInternalState<CommandResponse, CommandErrorCodes>\n  > {\n    type types = StateMachineTypes<\n      SendCommandInAppDAOutput<CommandResponse>,\n      SendCommandInAppDAInput<\n        CommandResponse,\n        CommandArgs,\n        CommandErrorCodes,\n        UserInteraction\n      >,\n      SendCommandInAppDAError<CommandErrorCodes>,\n      SendCommandInAppDAIntermediateValue<UserInteraction>,\n      SendCommandInAppDAInternalState<CommandResponse, CommandErrorCodes>\n    >;\n\n    const { sendCommand } = this.extractDependencies(internalAPI);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        sendCommand: fromPromise(sendCommand),\n        openAppStateMachine: new OpenAppDeviceAction({\n          input: {\n            appName: this.input.appName,\n          },\n        }).makeStateMachine(internalAPI),\n      },\n      guards: {\n        skipOpenApp: () => this.input.skipOpenApp,\n        noInternalError: ({ context }) => context._internalState.error === null,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"], // NOTE: it should never happen, the error is not typed anymore here\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QFEAuALA0mAngJwEsA7KAcTFQEEII85YARMANwIGMxK3UCB7IgHQB5AA5gilESKasOXHvwDEEfmAHFmvANZreYiVIDKqAIaowAWRNt0xMAG0ADAF1EoEb1gEFRNyAAeiACMQQDsAgAcACwAzKEArABMUfGpEQCcEYkANCA4iFGO8QKhjokxERUpQenp8QC+9bloWLiEJORUNHSwjCzsnNx8ggDC6GBsWqLiktL9ckP8AEpwAK4ANqiKTq5IIB5ePn6BCEFR4YkAbKE1Zemh55URufkI8fcC8TGXl0EVoelHJcio1mhhsPhiGQKNRaPQZAN5MMBGMJlN9LMEQsfCtYBstvYgrt3J5vMNjgUQgJLokHlEgldko50rEXoh3uEvj8-hEAUCQU0QC0Ie1oV04b0sYMfAJOrCerARrwALbKkxECDKVTqIiaHQCGDihVK1XqiA7PwHMn8CmnRJBASOFIxKJXJ21GLpHJ5RARGoCEL3CKXDLpS4pCKgoXgtpQuXdeHzaXI+MSxUqtUaxRgPB4Xh4AQidZmABm+eVBphCd6Jsz5pcltJRz2Jyiv0dvIeNJi8UqoWePoQIccn3iId+sSqkajRF4EDgfmFsY6VbTUqRNr2VuboBOAFpLmzTpd0iV+0EkkEylcAVEo0vISujYnZMn+MIMVJ14tfFum+SWwKb1XkSMdIhuQFEidYNSjvQUH1FVMFW-GVUUmaYDDmV8NyIXF8UbQ4AN3X0ogEF17S9eJQhiJ0ojbI8khHc54mvRwGUBXl7xjR8xXlF9ER-WVV2NDMzQI61f2IhBXUdRw5NDX54gvXkjx+CIzxuMdfnKd44LBVoeKQ-jsWRQxVjYDhenEncAmCcMBHKBlqKyIEYivGIjzDGJqQSYMamDa4BX0kU42E4y30EZBc3zayiNshBSmKFjqn7GCMgHV57lIz0aT9P0lL+S5GkaIA */\n      id: \"SendCommandInAppDeviceAction\",\n      initial: \"InitialState\",\n      context: ({ input }) => {\n        return {\n          input: input,\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            commandResponse: null,\n            error: null,\n          },\n        };\n      },\n      states: {\n        InitialState: {\n          always: [\n            {\n              target: \"SendCommand\",\n              guard: \"skipOpenApp\",\n            },\n            \"OpenAppDeviceAction\",\n          ],\n        },\n        OpenAppDeviceAction: {\n          invoke: {\n            id: \"openAppStateMachine\",\n            input: {\n              appName: this.input.appName,\n            },\n            src: \"openAppStateMachine\",\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) =>\n                  _.event.snapshot.context.intermediateValue,\n              }),\n            },\n            onDone: {\n              actions: assign({\n                _internalState: (_) => {\n                  return _.event.output.caseOf<\n                    SendCommandInAppDAInternalState<\n                      CommandResponse,\n                      CommandErrorCodes\n                    >\n                  >({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  });\n                },\n              }),\n              target: \"CheckOpenAppDeviceActionResult\",\n            },\n          },\n        },\n        CheckOpenAppDeviceActionResult: {\n          always: [\n            {\n              target: \"SendCommand\",\n              guard: \"noInternalError\",\n            },\n            \"Error\",\n          ],\n        },\n        SendCommand: {\n          entry: assign({\n            intermediateValue: {\n              requiredUserInteraction: this.input.requiredUserInteraction,\n            },\n          }),\n          exit: assign({\n            intermediateValue: {\n              requiredUserInteraction: UserInteractionRequired.None,\n            },\n          }),\n          invoke: {\n            id: \"sendCommand\",\n            src: \"sendCommand\",\n            input: ({ context }) => context.input.command,\n            onDone: {\n              target: \"SendCommandResultCheck\",\n              actions: [\n                assign({\n                  _internalState: ({ event, context }) => {\n                    if (isSuccessCommandResult(event.output)) {\n                      return {\n                        ...context._internalState,\n                        commandResponse: event.output.data,\n                      };\n                    }\n                    return {\n                      ...context._internalState,\n                      error: event.output.error,\n                    };\n                  },\n                }),\n              ],\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        SendCommandResultCheck: {\n          always: [\n            {\n              target: \"Success\",\n              guard: \"noInternalError\",\n            },\n            \"Error\",\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: ({ context }) =>\n        context._internalState.commandResponse\n          ? Right(context._internalState.commandResponse)\n          : Left(\n              context._internalState.error ||\n                new UnknownDAError(\"No error in final state\"),\n            ),\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi) {\n    return {\n      sendCommand: (_: {\n        input: Command<CommandResponse, CommandArgs, CommandErrorCodes>;\n      }): Promise<CommandResult<CommandResponse, CommandErrorCodes>> =>\n        internalApi.sendCommand(_.input),\n    };\n  }\n}\n", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "import { injectable } from \"inversify\";\nimport semver from \"semver\";\n\nimport { DeviceModelId } from \"@api/device/DeviceModel\";\nimport { DeviceModelDataSource } from \"@api/device-model/data/DeviceModelDataSource\";\nimport { BleDeviceInfos } from \"@api/device-model/model/BleDeviceInfos\";\nimport { TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\n\n/**\n * Static/in memory implementation of the device model data source\n */\n@injectable()\nexport class StaticDeviceModelDataSource implements DeviceModelDataSource {\n  private static deviceModelByIds: {\n    [_key in DeviceModelId]: TransportDeviceModel;\n  } = {\n    [DeviceModelId.NANO_S]: new TransportDeviceModel({\n      id: DeviceModelId.NANO_S,\n      productName: \"Ledger Nano S\",\n      usbProductId: 0x10,\n      bootloaderUsbProductId: 0x0001,\n      usbOnly: true,\n      memorySize: 320 * 1024,\n      getBlockSize: (p: { firmwareVersion: string }) =>\n        semver.lt(semver.coerce(p.firmwareVersion) ?? \"\", \"2.0.0\")\n          ? 4 * 1024\n          : 2 * 1024,\n      masks: [0x31100000],\n    }),\n    [DeviceModelId.NANO_SP]: new TransportDeviceModel({\n      id: DeviceModelId.NANO_SP,\n      productName: \"Ledger Nano S Plus\",\n      usbProductId: 0x50,\n      bootloaderUsbProductId: 0x0005,\n      usbOnly: true,\n      memorySize: 1533 * 1024,\n      getBlockSize: () => 32,\n      masks: [0x33100000],\n    }),\n    [DeviceModelId.NANO_X]: new TransportDeviceModel({\n      id: DeviceModelId.NANO_X,\n      productName: \"Ledger Nano X\",\n      usbProductId: 0x40,\n      bootloaderUsbProductId: 0x0004,\n      usbOnly: false,\n      memorySize: 2 * 1024 * 1024,\n      getBlockSize: () => 4 * 1024,\n      masks: [0x33000000],\n      bluetoothSpec: [\n        {\n          serviceUuid: \"13d63400-2c97-0004-0000-4c6564676572\",\n          notifyUuid: \"13d63400-2c97-0004-0001-4c6564676572\",\n          writeUuid: \"13d63400-2c97-0004-0002-4c6564676572\",\n          writeCmdUuid: \"13d63400-2c97-0004-0003-4c6564676572\",\n        },\n      ],\n    }),\n    [DeviceModelId.STAX]: new TransportDeviceModel({\n      id: DeviceModelId.STAX,\n      productName: \"Ledger Stax\",\n      usbProductId: 0x60,\n      bootloaderUsbProductId: 0x0006,\n      usbOnly: false,\n      memorySize: 1533 * 1024,\n      getBlockSize: () => 32,\n      masks: [0x33200000],\n      bluetoothSpec: [\n        {\n          serviceUuid: \"13d63400-2c97-6004-0000-4c6564676572\",\n          notifyUuid: \"13d63400-2c97-6004-0001-4c6564676572\",\n          writeUuid: \"13d63400-2c97-6004-0002-4c6564676572\",\n          writeCmdUuid: \"13d63400-2c97-6004-0003-4c6564676572\",\n        },\n      ],\n    }),\n    [DeviceModelId.FLEX]: new TransportDeviceModel({\n      id: DeviceModelId.FLEX,\n      productName: \"Ledger Flex\",\n      usbProductId: 0x70,\n      bootloaderUsbProductId: 0x0007,\n      usbOnly: false,\n      memorySize: 1533 * 1024,\n      getBlockSize: () => 32,\n      masks: [0x33300000],\n      bluetoothSpec: [\n        {\n          serviceUuid: \"13d63400-2c97-3004-0000-4c6564676572\",\n          notifyUuid: \"13d63400-2c97-3004-0001-4c6564676572\",\n          writeUuid: \"13d63400-2c97-3004-0002-4c6564676572\",\n          writeCmdUuid: \"13d63400-2c97-3004-0003-4c6564676572\",\n        },\n      ],\n    }),\n    [DeviceModelId.APEX]: new TransportDeviceModel({\n      id: DeviceModelId.APEX,\n      productName: \"Ledger Apex\",\n      usbProductId: 0x80,\n      bootloaderUsbProductId: 0x0008,\n      usbOnly: false,\n      memorySize: 1533 * 1024,\n      getBlockSize: () => 32,\n      masks: [0x33400000],\n      bluetoothSpec: [\n        {\n          serviceUuid: \"13d63400-2c97-8004-0000-4c6564676572\",\n          notifyUuid: \"13d63400-2c97-8004-0001-4c6564676572\",\n          writeUuid: \"13d63400-2c97-8004-0002-4c6564676572\",\n          writeCmdUuid: \"13d63400-2c97-8004-0003-4c6564676572\",\n        },\n      ],\n    }),\n  };\n\n  getAllDeviceModels(): TransportDeviceModel[] {\n    return Object.values(StaticDeviceModelDataSource.deviceModelByIds);\n  }\n\n  getDeviceModel(params: { id: DeviceModelId }): TransportDeviceModel {\n    return StaticDeviceModelDataSource.deviceModelByIds[params.id];\n  }\n\n  /**\n   * Returns the list of device models that match all the given parameters\n   */\n  filterDeviceModels(\n    params: Partial<TransportDeviceModel>,\n  ): TransportDeviceModel[] {\n    return this.getAllDeviceModels().filter((deviceModel) => {\n      return Object.entries(params).every(([key, value]) => {\n        return deviceModel[key as keyof TransportDeviceModel] === value;\n      });\n    });\n  }\n\n  getBluetoothServicesInfos(): Record<string, BleDeviceInfos> {\n    return Object.values(StaticDeviceModelDataSource.deviceModelByIds).reduce<\n      Record<string, BleDeviceInfos>\n    >((acc, deviceModel) => {\n      const { bluetoothSpec } = deviceModel;\n      if (bluetoothSpec) {\n        return {\n          ...acc,\n          ...bluetoothSpec.reduce<Record<string, BleDeviceInfos>>(\n            (serviceToModel, bleSpec) => ({\n              ...serviceToModel,\n              [bleSpec.serviceUuid]: new BleDeviceInfos(\n                deviceModel,\n                bleSpec.serviceUuid,\n                bleSpec.writeUuid,\n                bleSpec.writeCmdUuid,\n                bleSpec.notifyUuid,\n              ),\n            }),\n            {},\n          ),\n        };\n      }\n      return acc;\n    }, {});\n  }\n\n  getBluetoothServices(): string[] {\n    return Object.values(StaticDeviceModelDataSource.deviceModelByIds)\n      .map((deviceModel) =>\n        (deviceModel.bluetoothSpec || []).map((spec) => spec.serviceUuid),\n      )\n      .flat()\n      .filter((uuid) => !!uuid);\n  }\n}\n", "import { type TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\n\nexport class BleDeviceInfos {\n  constructor(\n    public deviceModel: TransportDeviceModel,\n    public serviceUuid: string,\n    public writeUuid: string,\n    public writeCmdUuid: string,\n    public notifyUuid: string,\n  ) {}\n}\n", "import { type DeviceModelId } from \"@api/device/DeviceModel\";\n\ntype DeviceModel = {\n  /** Identifier of the device model */\n  id: DeviceModelId;\n\n  /** Displayed name of the device model */\n  productName: string;\n\n  /** USB product ID of the device model */\n  usbProductId: number;\n\n  /** USB product ID of the device model, in bootloader mode */\n  bootloaderUsbProductId: number;\n\n  /** Whether the device model is only USB-based */\n  usbOnly: boolean;\n\n  /** Memory size of the device model, in bytes */\n  memorySize: number;\n\n  /**\n   * Function to get the block size of the device model, in bytes\n   * Blocks are the smallest units of memory that can be written to the device.\n   * The block size can be different for different firmware versions.\n   */\n  getBlockSize: (p: { firmwareVersion: string }) => number;\n\n  /**\n   * When applying 0xffff0000 to a device target id (obtained from the getOSVersion command),\n   * the result will be one of the masks for the device model.\n   */\n  masks: number[];\n\n  /**\n   * Bluetooth specifications for the device model.\n   * Only available for devices that support Bluetooth.\n   */\n  bluetoothSpec?: {\n    serviceUuid: string;\n    writeUuid: string;\n    writeCmdUuid: string;\n    notifyUuid: string;\n  }[];\n};\n\n/**\n * The info of a device model\n */\nexport class TransportDeviceModel implements DeviceModel {\n  id: DeviceModelId;\n  productName: string;\n  usbProductId: number;\n  bootloaderUsbProductId: number;\n  usbOnly: boolean;\n  memorySize: number;\n  getBlockSize: (p: { firmwareVersion: string }) => number;\n  masks: number[];\n  bluetoothSpec?: {\n    serviceUuid: string;\n    writeUuid: string;\n    writeCmdUuid: string;\n    notifyUuid: string;\n  }[];\n\n  constructor(props: DeviceModel) {\n    this.id = props.id;\n    this.productName = props.productName;\n    this.usbProductId = props.usbProductId;\n    this.bootloaderUsbProductId = props.bootloaderUsbProductId;\n    this.usbOnly = props.usbOnly;\n    this.memorySize = props.memorySize;\n    this.getBlockSize = props.getBlockSize;\n    this.masks = props.masks;\n    this.bluetoothSpec = props.bluetoothSpec;\n  }\n}\n", "export type ApduResponseConstructorArgs = {\n  readonly statusCode: Uint8Array;\n  readonly data: Uint8Array;\n};\n\nexport class ApduResponse {\n  public readonly statusCode: Uint8Array;\n  public readonly data: Uint8Array;\n\n  constructor({ statusCode, data }: ApduResponseConstructorArgs) {\n    this.statusCode = statusCode;\n    this.data = data;\n  }\n}\n", "export const HEAD_TAG = 0x05;\nexport const HEAD_TAG_LENGTH = 1;\nexport const CHANNEL_LENGTH = 2;\nexport const INDEX_LENGTH = 2;\nexport const APDU_DATA_LENGTH_LENGTH = 2;\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  GetOsVersionCommand,\n  type GetOsVersionResponse,\n} from \"@api/command/os/GetOsVersionCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport {\n  type GenuineCheckDAError,\n  type GenuineCheckDAInput,\n  type GenuineCheckDAIntermediateValue,\n  type GenuineCheckDAOutput,\n  type GenuineCheckStateMachineInternalState,\n  type MachineDependencies,\n} from \"@api/secure-channel/device-action/GenuineCheck/types\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type Input } from \"@api/secure-channel/types\";\nimport { isDeviceGenuine } from \"@api/secure-channel/utils\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\n\nexport class GenuineCheckDeviceAction extends XStateDeviceAction<\n  GenuineCheckDAOutput,\n  GenuineCheckDAInput,\n  GenuineCheckDAError,\n  GenuineCheckDAIntermediateValue,\n  GenuineCheckStateMachineInternalState\n> {\n  override makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    GenuineCheckDAOutput,\n    GenuineCheckDAInput,\n    GenuineCheckDAError,\n    GenuineCheckDAIntermediateValue,\n    GenuineCheckStateMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      GenuineCheckDAOutput,\n      GenuineCheckDAInput,\n      GenuineCheckDAError,\n      GenuineCheckDAIntermediateValue,\n      GenuineCheckStateMachineInternalState\n    >;\n\n    const {\n      getOsVersion,\n      getDeviceVersion,\n      getFirmwareVersion,\n      genuineCheck,\n      getDeviceSessionState,\n      setDeviceSessionState,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        goToDashboard: goToDashboardMachine,\n        getOsVersion: fromPromise(getOsVersion),\n        getDeviceVersion: fromPromise(getDeviceVersion),\n        getFirmwareVersion: fromPromise(getFirmwareVersion),\n        genuineCheck: fromObservable(genuineCheck),\n      },\n      guards: {\n        hasError: (_) => _.context._internalState.error !== null,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"],\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QHEwDsCuBLNYDCAFmAMYDWAImAG5bFgCCxALlgPZoB0lNdASmAEMIATwDEAbQAMAXUSgADq1hYW7OSAAeiAIwB2AGwAWDvskBOAKwAmC9YvbJADkMAaEMMQBmT2ZPazuo6SFp6SDpKG+gC+UW6omDj4RGTctAzMbJzIrAAqrOQCsAQARqwCAE4QohDsYBw4VKykdVC5+YUlZZVSskggisqqaOpaCFaGntocEwaOFkYR2oa6bh4IZsEcuta6Nmbajp76tjFx6Ni4hCQU1GmMQxzZeQVFpRVVYOXlrOUc8gA2AiYADMfgBbDitZ4dN7dGTqAYqTIjRDjSbTTyzeaGRbLVaIOa6LY7PYHI4nWIgeIXJLXVJ0e6ZR5tF6dd5XMgSeF9RFDFFjQ5WExhXQbYKGRxWKwrdyoo4cbT+UUOQz+UyeU5U86JDk3HjpB5PdqvLoQXUSbS9BRKJFqPqjKyC4V6MUWCVSmVrfySBVKsxSyxmAKSaKU6k65J6u4ZdiPMBMADysAAap9lOxqrV6mhGs1IfGk6nyum0D0ETa+favJFPNNDBtHAcQ8cQ-j1qEOJ43d5JMFG8dDJrw5dI-SDUzUImU2nMuayzyK8iq2NDELtoFVWZ9JilmY2-X9BxnNvbLYjBMzEPtSO6bcGTGsgXp8XZ5GLVb+ou7aAHaviRu1R3es220Kx-A4EMbEmVcg0kaUrwSG8UjvcdY0nMcixLTNcGzXMWnjDCZ3YedrUGJcf0QAxjElRZMWcSx5hAqxzA4Cw5i3XtRWcKUEJpXUx0ZNCCJQzDMlET5vl+AEgVBcoIRgJhCJfYjuVI21hmXKij2Y1U6PrM8230bQLE7Gs3X9MxVwpM5ENpZD9UEx9FJEoi0DnVTPzI79NB0MChSOXZRS7SQjn0Nt11Y3Z-U48xpQsXiI1vByHzjZz9VE9g50tcsvI0iiEFA0DO30QKzGC0KmJ8LYrH2OYLH2QwLF0BKkKje9DXjAAxLA5IAdwqMAMrQbC6gaJp8KYbq+oGoaSM89T+T0IxhUsGw7AcZwQIcEzvHq2xQJCZirBauy2tQpyprBfrykG1zxK+H4-kBEFwXzSaequmbXLm3lyJ8gqtNMVbbBsDbXFlAqrA7GwrCM1ddK3eKw2vU6BJSydLuu27lLct8fq-PL-qhiIFSMcZtkbZjdE9HRtC7aZlSCbd9DKkITv4lDHNSzGvpxrKP1+7yHVCYxtDJ5Y2NAyRqbbAJfF7WGJhsUVmMvZHbI55KOo1t8ahwsa8xgHXrnx3L+UdCUthZsDdG8W3dEMcGvQiIlHA2Bw4u2ZZ2dHTn0ZR80JMe6SXrk-NjbIU2FuXR1PCFUwXV7N1JWlNtHAMCCov8R2fHMbQfaS6Ntb4yN3IFgn+VCWt9HTiwQKOKZJhsCWJeCAv7KLicA9LvHsoXM3lyrkxa5AzdOwOlvtjbzU0FYCA4HUYdUb9ys1NX-6AFo6Z9A5pWCSyzBozaIY9vw5fsaxEfg9WS8L9qmTHfghDWNe-tGMXjK2Vc44mEJ7AONs3hHBnyCBYCIwZQw2Vvh3e+aEWQwlNDlaO+V-BbhMDiRsIYcSqjxBDSYJlFQBBKtsMCbsJjtzOlzI0rJYRmkjEg9eDomq+HJqYUUQYKoQw9BwSwoR9DSgONTO2FC0YdSnENBhb8vD+GAV2ckLME72H3GLaYtUdJBjFjXERK8u7iNcrqSRQtEAb0lAqSUuh971iPk7AkbEOCq28KBYmjttFa10UpEshjCajBxCZeqngaL2BCttGxBV-C1kpm6L2U8kZQMSjA86qUPGvmuF4-kh8pgGCahEJqsNTyVSmPMZu9VoqQK1BHSh-t3rTRuhI-uyD-p022PYkKys3YKIASfMCxhljRT0OYfex0b7xMqWInmtT9H0PqYw1EIVRYYL0MFJqRwtrSnHs3BwmIQiOFcZ3ISFS0kx3mMA221hHDnJqjiOm9dHasRqmVR0cx+w7OGa1URXcKkGOmVIhAkhR5Q1Yvwt0JTmL1ReXEt5OjYwAGUMDEDoLAeA3yjFjEsD0+Yug9AzFhp4ECBghQ4qMuclsl9dmwM4AAUQeuUQ5+VvA1S2JKbOzEWZ1xPm6Q8QiJSSwdkcDUMQohAA */\n      id: \"GenuineCheckDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            result: { isGenuine: false },\n            getOsVersionResponse: null,\n            deviceVersion: null,\n            firmwareVersion: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"GoToDashboard\",\n          },\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"goToDashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<GenuineCheckStateMachineInternalState>({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetOsVersion\",\n            },\n          ],\n        },\n        GetOsVersion: {\n          invoke: {\n            id: \"getOsVersion\",\n            src: \"getOsVersion\",\n            input: (_) => undefined,\n            onDone: {\n              target: \"GetOsVersionCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const currentState: DeviceSessionState =\n                      getDeviceSessionState();\n                    const isSecureConnectionAllowed =\n                      _.event.output.data.secureElementFlags\n                        .isSecureConnectionAllowed;\n                    if (\n                      currentState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      setDeviceSessionState({\n                        ...currentState,\n                        isSecureConnectionAllowed,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      getOsVersionResponse: _.event.output.data,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n          },\n        },\n        GetOsVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetDeviceVersion\",\n            },\n          ],\n        },\n        GetDeviceVersion: {\n          invoke: {\n            id: \"getDeviceVersion\",\n            src: \"getDeviceVersion\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n            }),\n            onDone: {\n              target: \"GetDeviceVersionCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<GenuineCheckStateMachineInternalState>({\n                    Right: (deviceVersion) => ({\n                      ..._.context._internalState,\n                      deviceVersion,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetDeviceVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"GetFirmwareVersion\" },\n          ],\n        },\n        GetFirmwareVersion: {\n          invoke: {\n            id: \"getFirmwareVersion\",\n            src: \"getFirmwareVersion\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              deviceVersion: _.context._internalState.deviceVersion!,\n            }),\n            onDone: {\n              target: \"GetFirmwareVersionCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<GenuineCheckStateMachineInternalState>({\n                    Right: (firmwareVersion) => ({\n                      ..._.context._internalState,\n                      firmwareVersion,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetFirmwareVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"GenuineCheck\" },\n          ],\n        },\n        GenuineCheck: {\n          invoke: {\n            id: \"genuineCheck\",\n            src: \"genuineCheck\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              finalFirmware: _.context._internalState.firmwareVersion!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  switch (_.event.snapshot.context?.type) {\n                    case SecureChannelEventType.DeviceId: {\n                      return {\n                        ..._.context.intermediateValue,\n                        deviceId: _.event.snapshot.context.payload.deviceId,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionRequested: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction:\n                          UserInteractionRequired.AllowSecureConnection,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionGranted: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction: UserInteractionRequired.None,\n                      };\n                    }\n                    default:\n                      return {\n                        ..._.context.intermediateValue,\n                      };\n                  }\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.snapshot.context.error.mapDAErrors(),\n                    };\n                  } else if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Result\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      result: {\n                        isGenuine: isDeviceGenuine(\n                          _.event.snapshot.context.payload,\n                        ),\n                      },\n                    };\n                  }\n                  return _.context._internalState;\n                },\n              }),\n            },\n            onDone: {\n              target: \"GenuineCheckCheck\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GenuineCheckCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (_) => {\n        if (_.context._internalState.error) {\n          return Left(_.context._internalState.error);\n        } else {\n          return Right(_.context._internalState.result);\n        }\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getOsVersion = () =>\n      internalApi.sendCommand(new GetOsVersionCommand());\n\n    const getDeviceVersion = ({\n      input,\n    }: Input<{ deviceInfo: GetOsVersionResponse }>) => {\n      const { deviceInfo } = input;\n      return internalApi.getManagerApiService().getDeviceVersion(deviceInfo);\n    };\n\n    const getFirmwareVersion = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      deviceVersion: DeviceVersion;\n    }>) => {\n      const { deviceInfo, deviceVersion } = input;\n      return internalApi\n        .getManagerApiService()\n        .getFirmwareVersion(deviceInfo, deviceVersion);\n    };\n\n    const genuineCheck = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      finalFirmware: FinalFirmware;\n    }>) => {\n      const { deviceInfo, finalFirmware } = input;\n      const eitherConnection = internalApi\n        .getSecureChannelService()\n        .genuineCheck(deviceInfo, finalFirmware);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection: eitherConnection,\n      }).run();\n    };\n\n    return {\n      getOsVersion,\n      getDeviceVersion,\n      getFirmwareVersion,\n      genuineCheck,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state: DeviceSessionState) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  GetOsVersionCommand,\n  type GetOsVersionResponse,\n} from \"@api/command/os/GetOsVersionCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type Input } from \"@api/secure-channel/types\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { type FinalFirmware } from \"@internal/manager-api/model/Firmware\";\n\nimport {\n  installedAppResultGuard,\n  type ListInstalledAppsDAError,\n  type ListInstalledAppsDAInput,\n  type ListInstalledAppsDAIntermediateValue,\n  type ListInstalledAppsDAOutput,\n  type ListInstalledAppsStateMachineInternalState,\n  type MachineDependencies,\n} from \"./types\";\n\nexport class ListInstalledAppsDeviceAction extends XStateDeviceAction<\n  ListInstalledAppsDAOutput,\n  ListInstalledAppsDAInput,\n  ListInstalledAppsDAError,\n  ListInstalledAppsDAIntermediateValue,\n  ListInstalledAppsStateMachineInternalState\n> {\n  override makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    ListInstalledAppsDAOutput,\n    ListInstalledAppsDAInput,\n    ListInstalledAppsDAError,\n    ListInstalledAppsDAIntermediateValue,\n    ListInstalledAppsStateMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      ListInstalledAppsDAOutput,\n      ListInstalledAppsDAInput,\n      ListInstalledAppsDAError,\n      ListInstalledAppsDAIntermediateValue,\n      ListInstalledAppsStateMachineInternalState\n    >;\n\n    const {\n      getOsVersion,\n      getDeviceVersion,\n      getFirmwareVersion,\n      listInstalledApps,\n      getDeviceSessionState,\n      setDeviceSessionState,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        goToDashboard: goToDashboardMachine,\n        getOsVersion: fromPromise(getOsVersion),\n        getDeviceVersion: fromPromise(getDeviceVersion),\n        getFirmwareVersion: fromPromise(getFirmwareVersion),\n        listInstalledApps: fromObservable(listInstalledApps),\n      },\n      guards: {\n        hasError: (_) => _.context._internalState.error !== null,\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"],\n          }),\n        }),\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QEkB2sAuBDANjgggA6EAiYAbgJYDGY+1GlA9qgHRlW0BKYWEAngGIA2gAYAuolCEmsSoxZSQAD0QBGAJyjWADgDsAFg0A2HSb2iArMbUBmADQh+iAExrjrS6KuWNtte7Glga2AL6hjmiYuATEHDR0DMxsAOJMACpMJFiwABYARkxYAE4QghAsYKyUqORMANZVUBlZOQVFpWKSSCAycgqoSqoIxi6WrKJq1rYGNgaiBrOOzgi2th5qonouorYuo9YBBuGR6Nh4RKQUCfQDrGmZ2XmFJWVgxcVMxayEOFgYADMvgBbVjNR5tF6dCRKPryZJDRAHCZTYwzOYLJZOdR6DSeFy2MwBPaaXzGE4gKLnWJXTiJO4PVrPDoQADCuTA1HqIhhPThA0RCE2XlY+0semMomMBgsOjMyyRoh0E28BmClhc+0mxwilLOMUu8Vot2S9xaT3ar3ZnO5wjU3Wksnhih6w2F2jFEqlMqV8uxq0stlYgTlGg02wJOjCuqpBri12NSRY9zAGAA8rAAGrvOQscqVaq1BpNVMZ7PFXOoLqwp0C13qDVqVhaIK+HSifazNQK1YuPHGLTWQxabaLSwU2MXeN0k3JlKlrM55LWrk8h29WsI+tCjRqAysebSvY6TWagw6HvnvFeDsaGX6UR+Wx6Cf6qe0m5J1IL8uVle2+0a36LdQDdXd90PEIXBPU9zx7dFWD0LwxgMHYFkmckYzfGkjXpU15wwS4ABlKEwfNUCqGo6kaFNCOIEjMGrPlNxdUDXFscVRR0VFxXDJCL39PYgxcPRbD8NQ9DUOV9BfLDonfXDZ2-OjCAYjB-zXIDnUGbcRIkxDNEfEIwwCFx4MDYNjFMMxw01Qlo1OeScITPC51TYjSPUjlVztdd+RAlRXEkvQDK0O8xN3NQzP9HR9xvKxCT0E9Jj0WTdVQJgIDgJRJ2cmcvy0us2IQABaYwezK18nMNFylPYFyeD4FZHWA1jAoQVCezccYb02JDDPcQkqupGr8oZc1IRZQqAuGaDxhMfQxjsKMlQcf1NBcFVdlmPs9wJNVhrjD9E3GiFmStbz6mmtrhijTaFu4tZRJMSZzJCqNnyS9x5m2DRDoU2qv1osslza-ybvUNwg02DRLFi+YZnbSx4JE5sJO8Xc3CsWZMMckbp0-Bkf1B1B-2unTiokuxWGlJULHWWwOzGcymwMKnULEuzRn+vLCfw9z6M88nBR2VLRWQ6xxR0GxRhRpsb2fNYjDcXFZLxo7FKBgiPMwMnmNain2rGDiD01PdUs0NVu0EtUtq8KydginV1YBsbTQAZQAV2oWhYHgfXtJFsxtGsXbuMsCPdh7bjPG8AkNFi70-B50a+eTABRD4vmF3Tg88UZd3DyO1pWDj9wlCwLFMDQ+1xcdwlCIA */\n      id: \"ListInstalledAppsDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            getOsVersionResponse: null,\n            deviceVersion: null,\n            firmwareVersion: null,\n            result: { installedApps: [] },\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"GoToDashboard\",\n          },\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"goToDashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<ListInstalledAppsStateMachineInternalState>(\n                    {\n                      Right: () => _.context._internalState,\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetOsVersion\",\n            },\n          ],\n        },\n        GetOsVersion: {\n          invoke: {\n            id: \"getOsVersion\",\n            src: \"getOsVersion\",\n            input: (_) => undefined,\n            onDone: {\n              target: \"GetOsVersionCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const currentState: DeviceSessionState =\n                      getDeviceSessionState();\n                    const isSecureConnectionAllowed =\n                      _.event.output.data.secureElementFlags\n                        .isSecureConnectionAllowed;\n                    if (\n                      currentState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      setDeviceSessionState({\n                        ...currentState,\n                        isSecureConnectionAllowed,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      getOsVersionResponse: _.event.output.data,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n          },\n        },\n        GetOsVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetDeviceVersion\",\n            },\n          ],\n        },\n        GetDeviceVersion: {\n          invoke: {\n            id: \"getDeviceVersion\",\n            src: \"getDeviceVersion\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n            }),\n            onDone: {\n              target: \"GetDeviceVersionCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<ListInstalledAppsStateMachineInternalState>(\n                    {\n                      Right: (deviceVersion) => ({\n                        ..._.context._internalState,\n                        deviceVersion,\n                      }),\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetDeviceVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"GetFirmwareVersion\" },\n          ],\n        },\n        GetFirmwareVersion: {\n          invoke: {\n            id: \"getFirmwareVersion\",\n            src: \"getFirmwareVersion\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              deviceVersion: _.context._internalState.deviceVersion!,\n            }),\n            onDone: {\n              target: \"GetFirmwareVersionCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<ListInstalledAppsStateMachineInternalState>(\n                    {\n                      Right: (firmwareVersion) => ({\n                        ..._.context._internalState,\n                        firmwareVersion,\n                      }),\n                      Left: (error) => ({\n                        ..._.context._internalState,\n                        error,\n                      }),\n                    },\n                  ),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetFirmwareVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            { target: \"ListInstalledApps\" },\n          ],\n        },\n        ListInstalledApps: {\n          invoke: {\n            id: \"listInstalledApps\",\n            src: \"listInstalledApps\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              finalFirmware: _.context._internalState.firmwareVersion!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  switch (_.event.snapshot.context?.type) {\n                    case SecureChannelEventType.DeviceId: {\n                      return {\n                        ..._.context.intermediateValue,\n                        deviceId: _.event.snapshot.context.payload.deviceId,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionRequested: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction:\n                          UserInteractionRequired.AllowSecureConnection,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionGranted: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction: UserInteractionRequired.None,\n                      };\n                    }\n                    default:\n                      return {\n                        ..._.context.intermediateValue,\n                      };\n                  }\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.snapshot.context.error.mapDAErrors(),\n                    };\n                  } else if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Result\n                  ) {\n                    if (\n                      installedAppResultGuard(_.event.snapshot.context.payload)\n                    ) {\n                      return {\n                        ..._.context._internalState,\n                        result: {\n                          installedApps: _.event.snapshot.context.payload,\n                        },\n                      };\n                    }\n                    throw new Error(\n                      `Invalid result ${JSON.stringify(_.event.snapshot.context.payload)}`,\n                    );\n                  }\n                  return { ..._.context._internalState };\n                },\n              }),\n            },\n            onDone: {\n              target: \"Success\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ListInstalledAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n            },\n          ],\n        },\n        Success: {\n          type: \"final\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: (_) => {\n        if (_.context._internalState.error) {\n          return Left(_.context._internalState.error);\n        } else {\n          return Right(_.context._internalState.result);\n        }\n      },\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getOsVersion = () =>\n      internalApi.sendCommand(new GetOsVersionCommand());\n\n    const getDeviceVersion = ({\n      input,\n    }: Input<{ deviceInfo: GetOsVersionResponse }>) => {\n      const { deviceInfo } = input;\n      return internalApi.getManagerApiService().getDeviceVersion(deviceInfo);\n    };\n\n    const getFirmwareVersion = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      deviceVersion: DeviceVersion;\n    }>) => {\n      const { deviceInfo, deviceVersion } = input;\n      return internalApi\n        .getManagerApiService()\n        .getFirmwareVersion(deviceInfo, deviceVersion);\n    };\n\n    const listInstalledApps = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      finalFirmware: FinalFirmware;\n    }>) => {\n      const { deviceInfo, finalFirmware } = input;\n      const eitherConnection = internalApi\n        .getSecureChannelService()\n        .listInstalledApps(deviceInfo, finalFirmware);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection: eitherConnection,\n      }).run();\n    };\n\n    return {\n      getOsVersion,\n      getDeviceVersion,\n      getFirmwareVersion,\n      listInstalledApps,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  GetOsVersionCommand,\n  type GetOsVersionResponse,\n} from \"@api/command/os/GetOsVersionCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { ListInstalledAppsDeviceAction } from \"@api/secure-channel/device-action/ListInstalledApps/ListInstalledAppsDeviceAction\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type Input } from \"@api/secure-channel/types\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\n\nimport {\n  type InstallAppDAError,\n  type InstallAppDAInput,\n  type InstallAppDAIntermediateValue,\n  type InstallAppDAOutput,\n  type InstallAppStateMachineInternalState,\n  type MachineDependencies,\n} from \"./types\";\n\nexport class InstallAppDeviceAction extends XStateDeviceAction<\n  InstallAppDAOutput,\n  InstallAppDAInput,\n  InstallAppDAError,\n  InstallAppDAIntermediateValue,\n  InstallAppStateMachineInternalState\n> {\n  override makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    InstallAppDAOutput,\n    InstallAppDAInput,\n    InstallAppDAError,\n    InstallAppDAIntermediateValue,\n    InstallAppStateMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      InstallAppDAOutput,\n      InstallAppDAInput,\n      InstallAppDAError,\n      InstallAppDAIntermediateValue,\n      InstallAppStateMachineInternalState\n    >;\n\n    const {\n      getOsVersion,\n      getAppList,\n      installApp,\n      getDeviceSessionState,\n      setDeviceSessionState,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const listInstalledAppsMachine = new ListInstalledAppsDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        listInstalledApps: listInstalledAppsMachine,\n        goToDashboard: goToDashboardMachine,\n        getOsVersion: fromPromise(getOsVersion),\n        getAppList: fromPromise(getAppList),\n        installApp: fromObservable(installApp),\n      },\n      guards: {\n        hasError: (_) => _.context._internalState.error !== null,\n        appInstalled: (_) =>\n          _.context._internalState.installedApps.some(\n            (app) => app.name === _.context.input.appName,\n          ),\n        appNotFound: (_) =>\n          _.context._internalState.appList.findIndex(\n            ({ versionName }) => versionName === _.context.input.appName,\n          ) === -1,\n        depAppNotInstalled: (_) => {\n          const appToInstall = _.context._internalState.appList.find(\n            ({ versionName }) => versionName === _.context.input.appName,\n          );\n          if (appToInstall?.parentName) {\n            return (\n              _.context._internalState.installedApps.findIndex(\n                ({ name }) => name === appToInstall.parentName,\n              ) === -1\n            );\n          }\n          return false;\n        },\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"],\n          }),\n        }),\n        assignAppNotFound: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new UnknownDAError(\n              \"App to install not found in manager API\",\n            ),\n          }),\n        }),\n        assignDepAppNotInstalled: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new UnknownDAError(\"Dep app is not installed on the device\"),\n          }),\n        }),\n        cleanupDeviceState: () => {\n          // After app successful installation, cleanup the device session state\n          // to force fetching the new device state when required\n          const state = getDeviceSessionState();\n          if (state.sessionStateType !== DeviceSessionStateType.Connected) {\n            setDeviceSessionState({\n              ...state,\n              installedApps: [],\n              appsUpdates: undefined,\n            });\n          }\n        },\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QEkB2sAuBDANjgggA6EAiYAbgJYDGY+1GlA9qgHRlW0BKYWEAngGIA2gAYAuolCEmsSoxZSQAD0QBGAJyjWADgDsAFg0A2HSb2iArMbUBmADQh+iAExrjrS6KuWNtte7Glga2AL6hjmiYuATEHDR0DMxsADKUmFHYeJBEhLCCECxgrJSo5EwA1sU46RiZMTnEsGKSSCAycgqoSqoIBgaWrC6i-i6Wjs4ItqJqnt62BsYuGmoGLguW4ZHoWbGkFAn0XaxpGTsNELmwAMIAFmDUFSISSh3yyT2Ituu6vrZ64yciB0djmogGAxcLmMMwMWxA9TwuXitCOyROtUROEaeTuDyewjUrWksneijavW+tl+fgBE2BelmXnBwUsUJhq3hWORB1RSRYGLO0WylyaeMeIhcxPapK6nymPx0fzpQIQGmWYIhbOhsK55yRcV5iWOAHEmAAVJgkLCwW4AIyYWAAThACkUSmVKsUoBarTb7Y6XS1XrKPhTEEtBjNrAsbAZwYt6VNbB41KI9MNvpGbJyIgj9XsUcb0WbLdbbQ7na6wE6nUwnaxCDgsBgAGb1gC2rB9Zf9laDLzabzl4YQkdY0eMsdWCeMSbUeg0nnWZgC300vmMeuFhaNaIFpb9FcDEHFBMHJM6YdAvTTXiGQT0MOMBgsOjMSZhOgn3i17N1ebcoanDFgevrlgGVZniIRIhle5I3uoVjaNClhPqIL5vh+qq2JY1KBO+GgaBmK5hIBBY8iB+5sCaYAYAA8rAABqNZyCwbqoMUpTlFU3Z0YxLFOmxqDBkOoYISo6hsrMWhBL4OiiNCixqEm3xLsYWjWIYWgZv0mzkTulGHPyNH8cxrHJNBomXmS3SjpoqysPGL7fDoUJQgYOhJp5S7Mssr76KIfj-NuuxGXyppmYJwlWbBYnwXZiEIA5BhORhIQuG57meapiysACinBMM4IzFuBlhcBxmRRguSnBgHFcZ6vEwDVxB1dZMoJfKLgQvlsb+GhOg2Es3npmCXjGEsIxEXC5UxOFoGma1hB1VZF6dbZ3WMno+WaEFIREQELiqXhrAEWYxFQrYOhkdshmVRFJZ0bVtSxdKw7XpJCBjFoTkBTYjKmENc6qjCrDEY+Gj6E+-lPqF80PYtrC0ctq33BKwhSnBm2jplaiDLYWhmHojIaAMKmqgYmj5cYFgWKY6rERo+l3RV+xUSZyPPW1r3owStjveJiVfXjBNE8RpPk0mbLUhsG4M8sOjwwa7NVeiQGEA1Ho8Y192EB1H0SZSQSsP8gKTFDO3Mn+Oq5qzCOq49Aoa4INZ1g2TYtu2TpdqUesG0L8opgTKqTGmr4-iykK22VeaoEwEBwEoGtFtR2MjklAC0OWqpn0LLgsAwrIYaZ2Mru4c8cRY8Hwkw2RnX1rEmbiDMyaYAnt7jXeXC3UYKdQFji8DxTjSWiEmFipd4Ufahys32yrqec3VWJD2e6efb04+qu+re-qy-52-metL6a4F9ieG9G64Srg6YGaWHYN2iDd87qpHsbLKs6wDD3iN94eCC-ZTx8yvsLXoN0XB33fHYf4hMOQnR2jdf4egQQvnTMsP+jskYowEhZCShtwHqDcPhIKlgdD9BGJ5KwqkXA7WLt4FYbgrCLDKgvCuasDxRXwagdeI8G63kZNSdBgUUzTChObL4j8nILm-oTK6SwsGnyeqjWoYDurph2mMQqj4hruGOjhNwYI4ELHVAuYiSi9ycxRi9TAfD66b1cJNbQpivCeXjERSRCBUGzGUjCTKj8oSKUsZXdWFFiDqNHNvMOiltDTxtnPEJnC2AAGUACu1BaCwGHg46+30zDaGsF-EElhSkjCTCCME6wobOSMLdY+bNlECgAKK1nrJEpKmVfpFJWCUspDgcLBBpnTDCZhliLn0uEIAA */\n      id: \"InstallAppDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => ({\n        input: {\n          unlockTimeout: _.input.unlockTimeout,\n          appName: _.input.appName,\n        },\n        intermediateValue: {\n          requiredUserInteraction: UserInteractionRequired.None,\n          progress: 0,\n        },\n        _internalState: {\n          error: null,\n          installedApps: [],\n          getOsVersionResponse: null,\n          appList: [],\n        },\n      }),\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"ListInstalledApps\",\n          },\n        },\n        ListInstalledApps: {\n          value: \"ListInstalledApps\",\n          invoke: {\n            id: \"listInstalledApps\",\n            src: \"listInstalledApps\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"ListInstalledAppsCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<InstallAppStateMachineInternalState>({\n                    Right: ({ installedApps }) => ({\n                      ..._.context._internalState,\n                      installedApps,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n          },\n        },\n        ListInstalledAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n              guard: \"appInstalled\",\n            },\n            {\n              target: \"GoToDashboard\",\n            },\n          ],\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"goToDashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<InstallAppStateMachineInternalState>({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetOsVersion\",\n            },\n          ],\n        },\n        GetOsVersion: {\n          invoke: {\n            id: \"getOsVersion\",\n            src: \"getOsVersion\",\n            input: (_) => undefined,\n            onDone: {\n              target: \"GetOsVersionCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const currentState: DeviceSessionState =\n                      getDeviceSessionState();\n                    const isSecureConnectionAllowed =\n                      _.event.output.data.secureElementFlags\n                        .isSecureConnectionAllowed;\n                    if (\n                      currentState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      setDeviceSessionState({\n                        ...currentState,\n                        isSecureConnectionAllowed,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      getOsVersionResponse: _.event.output.data,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n          },\n        },\n        GetOsVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetAppList\",\n            },\n          ],\n        },\n        GetAppList: {\n          invoke: {\n            id: \"getAppList\",\n            src: \"getAppList\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n            }),\n            onDone: {\n              target: \"GetAppListCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<InstallAppStateMachineInternalState>({\n                    Right: (appList) => ({\n                      ..._.context._internalState,\n                      appList,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n          },\n        },\n        GetAppListCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Error\",\n              guard: \"appNotFound\",\n              actions: \"assignAppNotFound\",\n            },\n            {\n              target: \"Error\",\n              guard: \"depAppNotInstalled\",\n              actions: \"assignDepAppNotInstalled\",\n            },\n            {\n              target: \"InstallApp\",\n            },\n          ],\n        },\n        InstallApp: {\n          invoke: {\n            id: \"installApp\",\n            src: \"installApp\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              app: _.context._internalState.appList.find(\n                ({ versionName }) => versionName === _.context.input.appName,\n              )!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.DeviceId\n                  ) {\n                    return {\n                      ..._.context.intermediateValue,\n                      deviceId: _.event.snapshot.context.payload.deviceId,\n                    };\n                  }\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Progress\n                  ) {\n                    return {\n                      ..._.context.intermediateValue,\n                      progress: _.event.snapshot.context.payload.progress,\n                    };\n                  }\n                  return { ..._.context.intermediateValue };\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error:\n                        _.event.snapshot.context.error.mapInstallDAErrors(),\n                    };\n                  }\n                  return _.context._internalState;\n                },\n              }),\n            },\n            onDone: {\n              target: \"ListInstalledApps\",\n              actions: \"cleanupDeviceState\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        Success: {\n          type: \"final\",\n          description: \"App installed successfully\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: ({ context }) =>\n        context._internalState.error\n          ? Left(context._internalState.error)\n          : Right(undefined),\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getOsVersion = () =>\n      internalApi.sendCommand(new GetOsVersionCommand());\n\n    const getAppList = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n    }>) => {\n      const { deviceInfo } = input;\n      return internalApi.getManagerApiService().getAppList(deviceInfo);\n    };\n\n    const installApp = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      app: Application;\n    }>) => {\n      const { deviceInfo, app } = input;\n      const eitherConnection = internalApi\n        .getSecureChannelService()\n        .installApp(deviceInfo, app);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection: eitherConnection,\n      }).run();\n    };\n\n    return {\n      getOsVersion,\n      getAppList,\n      installApp,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "import { Left, Right } from \"purify-ts\";\nimport { assign, fromObservable, fromPromise, setup } from \"xstate\";\n\nimport { isSuccessCommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  GetOsVersionCommand,\n  type GetOsVersionResponse,\n} from \"@api/command/os/GetOsVersionCommand\";\nimport { type InternalApi } from \"@api/device-action/DeviceAction\";\nimport { UserInteractionRequired } from \"@api/device-action/model/UserInteractionRequired\";\nimport { DEFAULT_UNLOCK_TIMEOUT_MS } from \"@api/device-action/os/Const\";\nimport { UnknownDAError } from \"@api/device-action/os/Errors\";\nimport { GoToDashboardDeviceAction } from \"@api/device-action/os/GoToDashboard/GoToDashboardDeviceAction\";\nimport { type StateMachineTypes } from \"@api/device-action/xstate-utils/StateMachineTypes\";\nimport {\n  type DeviceActionStateMachine,\n  XStateDeviceAction,\n} from \"@api/device-action/xstate-utils/XStateDeviceAction\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { ListInstalledAppsDeviceAction } from \"@api/secure-channel/device-action/ListInstalledApps/ListInstalledAppsDeviceAction\";\nimport { type InstalledApp } from \"@api/secure-channel/device-action/ListInstalledApps/types\";\nimport { ConnectToSecureChannelTask } from \"@api/secure-channel/task/ConnectToSecureChannelTask\";\nimport { SecureChannelEventType } from \"@api/secure-channel/task/types\";\nimport { type Input } from \"@api/secure-channel/types\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\n\nimport {\n  type MachineDependencies,\n  type UninstallAppDAError,\n  type UninstallAppDAInput,\n  type UninstallAppDAIntermediateValue,\n  type UninstallAppDAOutput,\n  type UninstallAppStateMachineInternalState,\n} from \"./types\";\n\nexport class UninstallAppDeviceAction extends XStateDeviceAction<\n  UninstallAppDAOutput,\n  UninstallAppDAInput,\n  UninstallAppDAError,\n  UninstallAppDAIntermediateValue,\n  UninstallAppStateMachineInternalState\n> {\n  override makeStateMachine(\n    internalApi: InternalApi,\n  ): DeviceActionStateMachine<\n    UninstallAppDAOutput,\n    UninstallAppDAInput,\n    UninstallAppDAError,\n    UninstallAppDAIntermediateValue,\n    UninstallAppStateMachineInternalState\n  > {\n    type types = StateMachineTypes<\n      UninstallAppDAOutput,\n      UninstallAppDAInput,\n      UninstallAppDAError,\n      UninstallAppDAIntermediateValue,\n      UninstallAppStateMachineInternalState\n    >;\n\n    const {\n      getOsVersion,\n      getAppsByHash,\n      uninstallApp,\n      getDeviceSessionState,\n      setDeviceSessionState,\n    } = this.extractDependencies(internalApi);\n\n    const unlockTimeout = this.input.unlockTimeout ?? DEFAULT_UNLOCK_TIMEOUT_MS;\n\n    const goToDashboardMachine = new GoToDashboardDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    const listInstalledAppsMachine = new ListInstalledAppsDeviceAction({\n      input: {\n        unlockTimeout,\n      },\n    }).makeStateMachine(internalApi);\n\n    return setup({\n      types: {\n        input: {} as types[\"input\"],\n        context: {} as types[\"context\"],\n        output: {} as types[\"output\"],\n      },\n      actors: {\n        listInstalledApps: listInstalledAppsMachine,\n        goToDashboard: goToDashboardMachine,\n        getOsVersion: fromPromise(getOsVersion),\n        getAppsByHash: fromPromise(getAppsByHash),\n        uninstallApp: fromObservable(uninstallApp),\n      },\n      guards: {\n        hasError: (_) => _.context._internalState.error !== null,\n        appNotInstalled: (_) =>\n          !_.context._internalState.installedApps.some(\n            (app) => app.name === _.context.input.appName,\n          ),\n        appNotFound: (_) =>\n          _.context._internalState.appList.findIndex(\n            (app) => app?.versionName === _.context.input.appName,\n          ) === -1,\n        isDepAppOfOther: (_) =>\n          _.context._internalState.appList.some(\n            (app) => app?.parentName === _.context.input.appName,\n          ),\n      },\n      actions: {\n        assignErrorFromEvent: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: _.event[\"error\"],\n          }),\n        }),\n        assignAppNotFound: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new UnknownDAError(\n              \"App to uninstall not found in manager API\",\n            ),\n          }),\n        }),\n        assignIsDepAppOfOther: assign({\n          _internalState: (_) => ({\n            ..._.context._internalState,\n            error: new UnknownDAError(\n              \"App to uninstall is a dependency of another installed app\",\n            ),\n          }),\n        }),\n        cleanupDeviceState: () => {\n          // After app successful uninstallation, cleanup the device session state\n          // to force fetching the new device state when required\n          const state = getDeviceSessionState();\n          if (state.sessionStateType !== DeviceSessionStateType.Connected) {\n            setDeviceSessionState({\n              ...state,\n              installedApps: [],\n              appsUpdates: undefined,\n            });\n          }\n        },\n      },\n    }).createMachine({\n      /** @xstate-layout N4IgpgJg5mDOIC5QEkB2sAuBDANjgggA6EAiYAbgJYDGY+1GlA9qgHRlW0BKYWEAngGIA2gAYAuolCEmsSoxZSQAD0QBGAJyjWADgDsAFg0A2HSb2iArMbUBmADQh+iAExrjrS6KuWNtte7Glga2AL6hjmiYuATEHDR0DMxsAOJMACpMJFiwABYARkxYAE4QghAsYKyUqORMANZVUBlZOQVFpWKSSCAycgqoSqoIxi6WrKJq1rYGNgaiBrOOzgi2th5qonouorYuo9YBBuGR6Nh4RKQUCfQDrGmZ2XmFJWVgxcVMxayEOFgYADMvgBbVjNR5tF6dCRKPryZJDRAHCZTYwzOYLJZOdR6DSeFy2MwBPaaXzGE4gKLnWJXTiJO4PVrPDoQADCuTA1HqIhhPThA0RCE2XlY+0semMomMBgsOjMyyRoh0E28BmClhc+0mxwilLOMUu8Vot2S9xaT3ar3ZnO5wjU3Wksnhih6w2F2jFEqlMqV8uxq0stlYgTlGg02wJOjCuqpBri12NSRY9zAGAA8rAAGrvOQscqVaq1BpNVMZ7PFXOoLqwp0C13qDVqVhaIK+HSifazNQK1YuPHGLTWQxabaLSwU2MXeN0k3JlKlrM55LWrk8h29WsI+tCjRqAysebSvY6TWagw6HvnvFeDsaGX6UR+Wx6Cf6qe0m5J1IL8uVle2+0a36LdQDdXd90PEIXBPU9zx7dFWD0LwxgMHYFkmckYzfGkjXpU15wwS4ABlKEwfNUCqGo6kaFNCOIEjMGrPlNxdUDXFscVRR0VFxXDJCL39PYgxcPRbD8NQ9DUOV9BfLDonfXDZ2-OjCAYjB-zXIDnUGbcRIkxDNEfEIwwCFx4MDYNjFMMxw01Qlo1OeScITPC51TYjSPUjlVztdd+RAlRXEkvQDK0O8xN3NQzP9HR9xvKxCT0E9Jj0WTdVQJgIDgJRJ2cmcvy0us2IQABaYwezK18nMNFylPYFyeD4FZHWA1jAoQVCezccYb02JDDPcQkqupGr8oZc1IRZQqAuGaDxhMfQxjsKMlQcf1NBcFVdlmPs9wJNVhrjD9E3GiFmStbz6mmtrhijTaFu4tZRJMSZzJCqNnyS9x5m2DRDoU2qv1osslza-ybvUNwg02DRLFi+YZnbSx4JE5sJO8Xc3CsWZMMckbp0-Bkf1B1B-2unTiokuxWGlJULHWWwOzGcymwMKnULEuzRn+vLCfw9z6M88nBR2VLRWQ6xxR0GxRhRpsb2fNYjDcXFZLxo7FKBgiPMwMnmNain2rGDiD01PdUs0NVu0EtUtq8KydginV1YBsbTQAZQAV2oWhYHgfXtJFsxtGsXbuMsCPdh7bjPG8AkNFi70-B50a+eTABRD4vmF3Tg88UZd3DyO1pWDj9wlCwLFMDQ+1xcdwlCIA */\n      id: \"UninstallAppDeviceAction\",\n      initial: \"DeviceReady\",\n      context: (_) => {\n        return {\n          input: {\n            unlockTimeout: _.input.unlockTimeout,\n            appName: _.input.appName,\n          },\n          intermediateValue: {\n            requiredUserInteraction: UserInteractionRequired.None,\n          },\n          _internalState: {\n            error: null,\n            installedApps: [],\n            appList: [],\n            getOsVersionResponse: null,\n          },\n        };\n      },\n      states: {\n        DeviceReady: {\n          always: {\n            target: \"ListInstalledApps\",\n          },\n        },\n        ListInstalledApps: {\n          invoke: {\n            id: \"listInstalledApps\",\n            src: \"listInstalledApps\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"ListInstalledAppsCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<UninstallAppStateMachineInternalState>({\n                    Right: ({ installedApps }) => ({\n                      ..._.context._internalState,\n                      installedApps,\n                      hasCheckedInstalledApps: true,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        ListInstalledAppsCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Success\",\n              guard: \"appNotInstalled\",\n            },\n            {\n              target: \"GetAppsByHash\",\n            },\n          ],\n        },\n        GetAppsByHash: {\n          invoke: {\n            id: \"getAppsByHash\",\n            src: \"getAppsByHash\",\n            input: (_) => _.context._internalState.installedApps!,\n            onDone: {\n              target: \"GetAppsByHashCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf({\n                    Right: (apps) => ({\n                      ..._.context._internalState,\n                      appList: apps,\n                    }),\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GetAppsByHashCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"Error\",\n              guard: \"appNotFound\",\n              actions: \"assignAppNotFound\",\n            },\n            {\n              target: \"Error\",\n              guard: \"isDepAppOfOther\",\n              actions: \"assignIsDepAppOfOther\",\n            },\n            {\n              target: \"GoToDashboard\",\n            },\n          ],\n        },\n        GoToDashboard: {\n          invoke: {\n            id: \"goToDashboard\",\n            src: \"goToDashboard\",\n            input: (_) => ({\n              unlockTimeout: _.context.input.unlockTimeout,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => ({\n                  ..._.context.intermediateValue,\n                  requiredUserInteraction:\n                    _.event.snapshot.context.intermediateValue\n                      .requiredUserInteraction,\n                }),\n              }),\n            },\n            onDone: {\n              target: \"GoToDashboardCheck\",\n              actions: assign({\n                _internalState: (_) =>\n                  _.event.output.caseOf<UninstallAppStateMachineInternalState>({\n                    Right: () => _.context._internalState,\n                    Left: (error) => ({\n                      ..._.context._internalState,\n                      error,\n                    }),\n                  }),\n              }),\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        GoToDashboardCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"GetOsVersion\",\n            },\n          ],\n        },\n        GetOsVersion: {\n          invoke: {\n            id: \"getOsVersion\",\n            src: \"getOsVersion\",\n            input: (_) => undefined,\n            onDone: {\n              target: \"GetOsVersionCheck\",\n              actions: assign({\n                _internalState: (_) => {\n                  if (isSuccessCommandResult(_.event.output)) {\n                    const currentState: DeviceSessionState =\n                      getDeviceSessionState();\n                    const isSecureConnectionAllowed =\n                      _.event.output.data.secureElementFlags\n                        .isSecureConnectionAllowed;\n                    if (\n                      currentState.sessionStateType !==\n                      DeviceSessionStateType.Connected\n                    ) {\n                      setDeviceSessionState({\n                        ...currentState,\n                        isSecureConnectionAllowed,\n                      });\n                    }\n                    return {\n                      ..._.context._internalState,\n                      getOsVersionResponse: _.event.output.data,\n                    };\n                  }\n                  return {\n                    ..._.context._internalState,\n                    error: _.event.output.error,\n                  };\n                },\n              }),\n            },\n          },\n        },\n        GetOsVersionCheck: {\n          always: [\n            {\n              target: \"Error\",\n              guard: \"hasError\",\n            },\n            {\n              target: \"UninstallApp\",\n            },\n          ],\n        },\n        UninstallApp: {\n          invoke: {\n            id: \"uninstallApp\",\n            src: \"uninstallApp\",\n            input: (_) => ({\n              deviceInfo: _.context._internalState.getOsVersionResponse!,\n              app: _.context._internalState.appList.find(\n                (app) => app?.versionName === _.context.input.appName,\n              )!,\n            }),\n            onSnapshot: {\n              actions: assign({\n                intermediateValue: (_) => {\n                  switch (_.event.snapshot.context?.type) {\n                    case SecureChannelEventType.DeviceId: {\n                      return {\n                        ..._.context.intermediateValue,\n                        deviceId: _.event.snapshot.context.payload.deviceId,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionRequested: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction:\n                          UserInteractionRequired.AllowSecureConnection,\n                      };\n                    }\n                    case SecureChannelEventType.PermissionGranted: {\n                      return {\n                        ..._.context.intermediateValue,\n                        requiredUserInteraction: UserInteractionRequired.None,\n                      };\n                    }\n                    default:\n                      return {\n                        ..._.context.intermediateValue,\n                      };\n                  }\n                },\n                _internalState: (_) => {\n                  if (\n                    _.event.snapshot.context?.type ===\n                    SecureChannelEventType.Error\n                  ) {\n                    return {\n                      ..._.context._internalState,\n                      error: _.event.snapshot.context.error.mapDAErrors(),\n                    };\n                  }\n                  return _.context._internalState;\n                },\n              }),\n            },\n            onDone: {\n              target: \"ListInstalledApps\",\n              actions: \"cleanupDeviceState\",\n            },\n            onError: {\n              target: \"Error\",\n              actions: \"assignErrorFromEvent\",\n            },\n          },\n        },\n        Success: {\n          type: \"final\",\n          description: \"App uninstalled successfully\",\n        },\n        Error: {\n          type: \"final\",\n        },\n      },\n      output: ({ context }) =>\n        context._internalState.error\n          ? Left(context._internalState.error)\n          : Right(undefined),\n    });\n  }\n\n  extractDependencies(internalApi: InternalApi): MachineDependencies {\n    const getOsVersion = () =>\n      internalApi.sendCommand(new GetOsVersionCommand());\n\n    const getAppsByHash = ({ input }: Input<InstalledApp[]>) => {\n      const appHashes = input.map((app) => app.hash);\n      return internalApi.getManagerApiService().getAppsByHash(appHashes);\n    };\n\n    const uninstallApp = ({\n      input,\n    }: Input<{\n      deviceInfo: GetOsVersionResponse;\n      app: Application;\n    }>) => {\n      const { deviceInfo, app } = input;\n      const eitherConnection = internalApi\n        .getSecureChannelService()\n        .uninstallApp(deviceInfo, app);\n      return new ConnectToSecureChannelTask(internalApi, {\n        connection: eitherConnection,\n      }).run();\n    };\n\n    return {\n      getOsVersion,\n      getAppsByHash,\n      uninstallApp,\n      getDeviceSessionState: () => internalApi.getDeviceSessionState(),\n      setDeviceSessionState: (state) =>\n        internalApi.setDeviceSessionState(state),\n    };\n  }\n}\n", "export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;\n", "import REGEX from './regex.js';\nfunction validate(uuid) {\n    return typeof uuid === 'string' && REGEX.test(uuid);\n}\nexport default validate;\n", "import validate from './validate.js';\nfunction parse(uuid) {\n    if (!validate(uuid)) {\n        throw TypeError('Invalid UUID');\n    }\n    let v;\n    return Uint8Array.of((v = parseInt(uuid.slice(0, 8), 16)) >>> 24, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff, (v = parseInt(uuid.slice(9, 13), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(14, 18), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(19, 23), 16)) >>> 8, v & 0xff, ((v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000) & 0xff, (v / 0x100000000) & 0xff, (v >>> 24) & 0xff, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff);\n}\nexport default parse;\n", "import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n", "let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n", "function md5(bytes) {\n    const words = uint8ToUint32(bytes);\n    const md5Bytes = wordsToMd5(words, bytes.length * 8);\n    return uint32ToUint8(md5Bytes);\n}\nfunction uint32ToUint8(input) {\n    const bytes = new Uint8Array(input.length * 4);\n    for (let i = 0; i < input.length * 4; i++) {\n        bytes[i] = (input[i >> 2] >>> ((i % 4) * 8)) & 0xff;\n    }\n    return bytes;\n}\nfunction getOutputLength(inputLength8) {\n    return (((inputLength8 + 64) >>> 9) << 4) + 14 + 1;\n}\nfunction wordsToMd5(x, len) {\n    const xpad = new Uint32Array(getOutputLength(len)).fill(0);\n    xpad.set(x);\n    xpad[len >> 5] |= 0x80 << len % 32;\n    xpad[xpad.length - 1] = len;\n    x = xpad;\n    let a = 1732584193;\n    let b = -271733879;\n    let c = -1732584194;\n    let d = 271733878;\n    for (let i = 0; i < x.length; i += 16) {\n        const olda = a;\n        const oldb = b;\n        const oldc = c;\n        const oldd = d;\n        a = md5ff(a, b, c, d, x[i], 7, -680876936);\n        d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n        c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n        b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n        a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n        d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n        c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n        b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n        a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n        d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n        c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n        b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n        a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n        d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n        c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n        b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n        a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n        d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n        c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n        b = md5gg(b, c, d, a, x[i], 20, -373897302);\n        a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n        d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n        c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n        b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n        a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n        d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n        c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n        b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n        a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n        d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n        c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n        b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n        a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n        d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n        c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n        b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n        a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n        d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n        c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n        b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n        a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n        d = md5hh(d, a, b, c, x[i], 11, -358537222);\n        c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n        b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n        a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n        d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n        c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n        b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n        a = md5ii(a, b, c, d, x[i], 6, -198630844);\n        d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n        c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n        b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n        a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n        d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n        c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n        b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n        a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n        d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n        c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n        b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n        a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n        d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n        c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n        b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n        a = safeAdd(a, olda);\n        b = safeAdd(b, oldb);\n        c = safeAdd(c, oldc);\n        d = safeAdd(d, oldd);\n    }\n    return Uint32Array.of(a, b, c, d);\n}\nfunction uint8ToUint32(input) {\n    if (input.length === 0) {\n        return new Uint32Array();\n    }\n    const output = new Uint32Array(getOutputLength(input.length * 8)).fill(0);\n    for (let i = 0; i < input.length; i++) {\n        output[i >> 2] |= (input[i] & 0xff) << ((i % 4) * 8);\n    }\n    return output;\n}\nfunction safeAdd(x, y) {\n    const lsw = (x & 0xffff) + (y & 0xffff);\n    const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n    return (msw << 16) | (lsw & 0xffff);\n}\nfunction bitRotateLeft(num, cnt) {\n    return (num << cnt) | (num >>> (32 - cnt));\n}\nfunction md5cmn(q, a, b, x, s, t) {\n    return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\nfunction md5ff(a, b, c, d, x, s, t) {\n    return md5cmn((b & c) | (~b & d), a, b, x, s, t);\n}\nfunction md5gg(a, b, c, d, x, s, t) {\n    return md5cmn((b & d) | (c & ~d), a, b, x, s, t);\n}\nfunction md5hh(a, b, c, d, x, s, t) {\n    return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\nfunction md5ii(a, b, c, d, x, s, t) {\n    return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\nexport default md5;\n", "import parse from './parse.js';\nimport { unsafeStringify } from './stringify.js';\nexport function stringToBytes(str) {\n    str = unescape(encodeURIComponent(str));\n    const bytes = new Uint8Array(str.length);\n    for (let i = 0; i < str.length; ++i) {\n        bytes[i] = str.charCodeAt(i);\n    }\n    return bytes;\n}\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function v35(version, hash, value, namespace, buf, offset) {\n    const valueBytes = typeof value === 'string' ? stringToBytes(value) : value;\n    const namespaceBytes = typeof namespace === 'string' ? parse(namespace) : namespace;\n    if (typeof namespace === 'string') {\n        namespace = parse(namespace);\n    }\n    if (namespace?.length !== 16) {\n        throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    }\n    let bytes = new Uint8Array(16 + valueBytes.length);\n    bytes.set(namespaceBytes);\n    bytes.set(valueBytes, namespaceBytes.length);\n    bytes = hash(bytes);\n    bytes[6] = (bytes[6] & 0x0f) | version;\n    bytes[8] = (bytes[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = bytes[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(bytes);\n}\n", "import md5 from './md5.js';\nimport v35, { DNS, URL } from './v35.js';\nexport { DNS, URL } from './v35.js';\nfunction v3(value, namespace, buf, offset) {\n    return v35(0x30, md5, value, namespace, buf, offset);\n}\nv3.DNS = DNS;\nv3.URL = URL;\nexport default v3;\n", "const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n", "import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random || (options.rng || rng)();\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n", "function f(s, x, y, z) {\n    switch (s) {\n        case 0:\n            return (x & y) ^ (~x & z);\n        case 1:\n            return x ^ y ^ z;\n        case 2:\n            return (x & y) ^ (x & z) ^ (y & z);\n        case 3:\n            return x ^ y ^ z;\n    }\n}\nfunction ROTL(x, n) {\n    return (x << n) | (x >>> (32 - n));\n}\nfunction sha1(bytes) {\n    const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n    const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n    const newBytes = new Uint8Array(bytes.length + 1);\n    newBytes.set(bytes);\n    newBytes[bytes.length] = 0x80;\n    bytes = newBytes;\n    const l = bytes.length / 4 + 2;\n    const N = Math.ceil(l / 16);\n    const M = new Array(N);\n    for (let i = 0; i < N; ++i) {\n        const arr = new Uint32Array(16);\n        for (let j = 0; j < 16; ++j) {\n            arr[j] =\n                (bytes[i * 64 + j * 4] << 24) |\n                    (bytes[i * 64 + j * 4 + 1] << 16) |\n                    (bytes[i * 64 + j * 4 + 2] << 8) |\n                    bytes[i * 64 + j * 4 + 3];\n        }\n        M[i] = arr;\n    }\n    M[N - 1][14] = ((bytes.length - 1) * 8) / Math.pow(2, 32);\n    M[N - 1][14] = Math.floor(M[N - 1][14]);\n    M[N - 1][15] = ((bytes.length - 1) * 8) & 0xffffffff;\n    for (let i = 0; i < N; ++i) {\n        const W = new Uint32Array(80);\n        for (let t = 0; t < 16; ++t) {\n            W[t] = M[i][t];\n        }\n        for (let t = 16; t < 80; ++t) {\n            W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n        }\n        let a = H[0];\n        let b = H[1];\n        let c = H[2];\n        let d = H[3];\n        let e = H[4];\n        for (let t = 0; t < 80; ++t) {\n            const s = Math.floor(t / 20);\n            const T = (ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t]) >>> 0;\n            e = d;\n            d = c;\n            c = ROTL(b, 30) >>> 0;\n            b = a;\n            a = T;\n        }\n        H[0] = (H[0] + a) >>> 0;\n        H[1] = (H[1] + b) >>> 0;\n        H[2] = (H[2] + c) >>> 0;\n        H[3] = (H[3] + d) >>> 0;\n        H[4] = (H[4] + e) >>> 0;\n    }\n    return Uint8Array.of(H[0] >> 24, H[0] >> 16, H[0] >> 8, H[0], H[1] >> 24, H[1] >> 16, H[1] >> 8, H[1], H[2] >> 24, H[2] >> 16, H[2] >> 8, H[2], H[3] >> 24, H[3] >> 16, H[3] >> 8, H[3], H[4] >> 24, H[4] >> 16, H[4] >> 8, H[4]);\n}\nexport default sha1;\n", "import sha1 from './sha1.js';\nimport v35, { DNS, URL } from './v35.js';\nexport { DNS, URL } from './v35.js';\nfunction v5(value, namespace, buf, offset) {\n    return v35(0x50, sha1, value, namespace, buf, offset);\n}\nv5.DNS = DNS;\nv5.URL = URL;\nexport default v5;\n", "export const FramerUtils = {\n  /*\n   * Get last bytes of Uint8Array\n   *\n   * @param Uint8Array\n   */\n  getLastBytesFrom(array: Uint8Array, size: number): Uint8Array {\n    return array.slice(-size);\n  },\n\n  /*\n   * Get first bytes of Uint8Array\n   *\n   * @param Uint8Array\n   */\n  getFirstBytesFrom(array: Uint8Array, size: number): Uint8Array {\n    return array.slice(0, size);\n  },\n\n  /*\n   * Get number from Uint8Array\n   *\n   * @param Uint8Array\n   */\n  bytesToNumber(array: Uint8Array): number {\n    return array.reduce(\n      (acc, val, index) =>\n        acc + val * Math.pow(0x100, array.length - 1 - index),\n      0,\n    );\n  },\n\n  /*\n   *  Get bytes Uint8Array from number\n   *\n   * @param number\n   * @param size\n   */\n  numberToByteArray(number: number, size: number): Uint8Array {\n    return new Uint8Array(size).map((_el, index) => {\n      return (number >> (8 * (size - 1 - index))) & 0xff;\n    });\n  },\n};\n", "export const APDU_RESPONSE_STATUS_CODE_LENGTH = 2;\nexport const PINGER_TIMEOUT = 800;\n", "import { type DmkError } from \"@api/Error\";\n\nexport class FramerOverflowError implements DmkError {\n  readonly _tag = \"FramerOverflowError\";\n  originalError?: Error;\n  constructor() {\n    this.originalError = new Error(\n      \"Frame header length is greater than frame size\",\n    );\n  }\n}\n\nexport class FramerApduError implements DmkError {\n  readonly _tag = \"FramerApduError\";\n  originalError?: Error;\n\n  constructor() {\n    this.originalError = new Error(\"Frame offset is greater than apdu length\");\n  }\n}\n\nexport class ReceiverApduError implements DmkError {\n  readonly _tag = \"ReceiverApduError\";\n  originalError: Error;\n\n  constructor(message?: string) {\n    this.originalError = new Error(message ?? \"Unable to parse apdu\");\n  }\n}\n\nexport class DeviceSessionNotFound implements DmkError {\n  readonly _tag = \"DeviceSessionNotFound\";\n  originalError?: Error;\n\n  constructor(originalError?: Error) {\n    this.originalError = originalError ?? new Error(\"Device session not found\");\n  }\n}\n\nexport class DeviceSessionRefresherError implements DmkError {\n  readonly _tag = \"DeviceSessionRefresherError\";\n  originalError?: Error;\n\n  constructor(originalError?: Error) {\n    this.originalError =\n      originalError ?? new Error(\"Device session refresher error\");\n  }\n}\n", "import { bufferToHexaString } from \"@api/index\";\nimport { type FrameHeader } from \"@internal/device-session/model/FrameHeader\";\n\ntype FrameConstructorArgs = {\n  header: FrameHeader;\n  data: Uint8Array;\n};\n\nexport class Frame {\n  protected _header: FrameHeader;\n  protected _data: Uint8Array;\n\n  constructor({ header, data }: FrameConstructorArgs) {\n    this._header = header;\n    this._data = data;\n  }\n\n  toString(): string {\n    return JSON.stringify(\n      {\n        header: this._header.toString(),\n        data: bufferToHexaString(this._data),\n      },\n      null,\n      2,\n    );\n  }\n\n  getRawData(): Uint8Array {\n    const headerRaw = this._header.getRawData();\n    const raw = new Uint8Array(headerRaw.length + this._data.length);\n\n    raw.set(headerRaw, 0);\n    raw.set(this._data, headerRaw.length);\n    return raw;\n  }\n\n  getHeader(): FrameHeader {\n    return this._header;\n  }\n\n  getData(): Uint8Array {\n    return this._data;\n  }\n}\n", "import { type Maybe } from \"purify-ts\";\n\nimport { FramerUtils } from \"@api/device-session/utils/FramerUtils\";\n\ntype FrameHeaderConstructorArgs = {\n  uuid: string;\n  channel: Maybe<Uint8Array>;\n  headTag: Uint8Array;\n  index: Uint8Array;\n  length: number;\n  dataSize: Maybe<Uint8Array>;\n};\n\nexport class FrameHeader {\n  protected _uuid: string;\n  protected _channel: Maybe<Uint8Array>;\n  protected _headTag: Uint8Array;\n  protected _index: Uint8Array;\n  protected _length: number;\n  protected _dataLength: Maybe<Uint8Array>;\n  constructor({\n    uuid,\n    dataSize,\n    index,\n    headTag,\n    length,\n    channel,\n  }: FrameHeaderConstructorArgs) {\n    this._uuid = uuid;\n    this._dataLength = dataSize;\n    this._index = index;\n    this._headTag = headTag;\n    this._length = length;\n    this._channel = channel;\n  }\n  getDataLength(): Maybe<number> {\n    return this._dataLength.map((value) => FramerUtils.bytesToNumber(value));\n  }\n  setDataSize(dataSize: Maybe<Uint8Array>): FrameHeader {\n    this._dataLength = dataSize;\n    return this;\n  }\n  getLength(): number {\n    return this._length;\n  }\n  toString(): string {\n    return JSON.stringify({\n      uuid: this._uuid.toString(),\n      dataSize: this._dataLength.extract()?.toString(),\n      index: this._index.toString(),\n      headTag: this._headTag.toString(),\n      length: this._length.toString(),\n      channel: this._channel.extract()?.toString(),\n    });\n  }\n  getRawData(): Uint8Array {\n    return new Uint8Array([\n      ...this._channel.caseOf({\n        Just: (channel) => [...channel],\n        Nothing: () => [],\n      }),\n      ...this._headTag,\n      ...this._index,\n      ...this._dataLength.caseOf({\n        Just: (dataSize) => [...dataSize],\n        Nothing: () => [],\n      }),\n    ]);\n  }\n}\n", "export const loggerTypes = {\n  LoggerPublisherServiceFactory: Symbol.for(\"LoggerPublisherServiceFactory\"),\n};\n", "import { inject, injectable } from \"inversify\";\nimport { Either, Just, Left, Maybe, Nothing, Right } from \"purify-ts\";\nimport { v4 } from \"uuid\";\n\nimport { ApduResponse } from \"@api/device-session/ApduResponse\";\nimport {\n  APDU_DATA_LENGTH_LENGTH,\n  CHANNEL_LENGTH,\n  HEAD_TAG_LENGTH,\n  INDEX_LENGTH,\n} from \"@api/device-session/data/FramerConst\";\nimport {\n  type ApduReceiverConstructorArgs,\n  ApduReceiverService,\n} from \"@api/device-session/service/ApduReceiverService\";\nimport { FramerUtils } from \"@api/device-session/utils/FramerUtils\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { APDU_RESPONSE_STATUS_CODE_LENGTH } from \"@internal/device-session/data/ApduResponseConst\";\nimport { ReceiverApduError } from \"@internal/device-session/model/Errors\";\nimport { Frame } from \"@internal/device-session/model/Frame\";\nimport { FrameHeader } from \"@internal/device-session/model/FrameHeader\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\n@injectable()\nexport class DefaultApduReceiverService implements ApduReceiverService {\n  private readonly _channel: Maybe<Uint8Array>;\n  private readonly _logger: LoggerPublisherService;\n  private _pendingFrames: Frame[];\n\n  constructor(\n    { channel = Maybe.zero() }: ApduReceiverConstructorArgs,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._channel = channel;\n    this._logger = loggerModuleFactory(\"ApduReceiverService\");\n    this._pendingFrames = [];\n  }\n\n  /*\n   * Return\n   * - A complete ApduResponse\n   * - Or a Nothing if not all the data has been received\n   * - Or a ReceiverApduError if the apdu is not formatted correctly\n   *\n   * @param Uint8Array\n   */\n  public handleFrame(\n    frameBytes: Uint8Array,\n  ): Either<ReceiverApduError, Maybe<ApduResponse>> {\n    const frame = this.getFrameFromBytes(frameBytes);\n\n    return frame.map((value) => {\n      this._pendingFrames.push(value);\n      if (!this._pendingFrames[0]) {\n        return Nothing;\n      }\n      const dataSize = this._pendingFrames[0].getHeader().getDataLength();\n      return this.getCompleteFrame(dataSize);\n    });\n  }\n\n  /*\n   * Return\n   * - A complete ApduResponse\n   * - Or a Nothing if not all the data has been received\n   *\n   * @param Maybe<number>\n   */\n  private getCompleteFrame(dataSize: Maybe<number>): Maybe<ApduResponse> {\n    return dataSize.chain((value) => {\n      if (!this.isComplete(value)) {\n        this._logger.debug(\"frame is not complete, waiting for more\");\n        return Nothing;\n      }\n\n      const concatenatedFramesData = FramerUtils.getFirstBytesFrom(\n        this.concatFrames(this._pendingFrames),\n        value,\n      );\n      const data = FramerUtils.getFirstBytesFrom(\n        concatenatedFramesData,\n        concatenatedFramesData.length - APDU_RESPONSE_STATUS_CODE_LENGTH,\n      );\n      const statusCode = FramerUtils.getLastBytesFrom(\n        concatenatedFramesData,\n        APDU_RESPONSE_STATUS_CODE_LENGTH,\n      );\n\n      this._pendingFrames = [];\n\n      return Just(\n        new ApduResponse({\n          data: data,\n          statusCode,\n        }),\n      );\n    });\n  }\n\n  /*\n   * Parse an Uint8Array to a Frame\n   * Return an error if the frame is not formatted correctly\n   *\n   * @param Uint8Array\n   */\n  private getFrameFromBytes(\n    rawFrame: Uint8Array,\n  ): Either<ReceiverApduError, Frame> {\n    const channelSize = this._channel.caseOf({\n      Just: () => CHANNEL_LENGTH,\n      Nothing: () => 0,\n    });\n\n    const headTag = rawFrame.slice(channelSize, channelSize + HEAD_TAG_LENGTH);\n    const index = rawFrame.slice(\n      channelSize + HEAD_TAG_LENGTH,\n      channelSize + HEAD_TAG_LENGTH + INDEX_LENGTH,\n    );\n\n    const isFirstIndex = index.reduce((curr, val) => curr + val, 0) === 0;\n\n    if (!isFirstIndex && this._pendingFrames.length === 0) {\n      return Left(new ReceiverApduError());\n    }\n\n    const dataSizeIndex = channelSize + HEAD_TAG_LENGTH + INDEX_LENGTH;\n    const dataSizeLength = isFirstIndex ? APDU_DATA_LENGTH_LENGTH : 0;\n\n    if (\n      rawFrame.length <\n      channelSize + HEAD_TAG_LENGTH + INDEX_LENGTH + dataSizeLength\n    ) {\n      return Left(new ReceiverApduError(\"Unable to parse header from apdu\"));\n    }\n\n    const dataSize = isFirstIndex\n      ? Just(rawFrame.slice(dataSizeIndex, dataSizeIndex + dataSizeLength))\n      : Nothing;\n\n    const dataIndex = dataSizeIndex + dataSizeLength;\n    const data = rawFrame.slice(dataIndex);\n\n    const frame = new Frame({\n      header: new FrameHeader({\n        uuid: v4(),\n        channel: this._channel,\n        dataSize,\n        headTag,\n        index,\n        length: channelSize + HEAD_TAG_LENGTH + INDEX_LENGTH + dataSizeLength,\n      }),\n      data,\n    });\n\n    return Right(frame);\n  }\n\n  /*\n   * Return true if all the datas has been received\n   *\n   * @param number\n   */\n  private isComplete(dataSize: number): boolean {\n    const totalReceiveLength = this._pendingFrames.reduce(\n      (prev, curr) => prev + curr.getData().length,\n      0,\n    );\n\n    return totalReceiveLength >= dataSize;\n  }\n\n  private concatFrames(frames: Frame[]): Uint8Array {\n    return frames.reduce(\n      (prev: Uint8Array, curr: Frame) =>\n        Uint8Array.from([...prev, ...curr.getData()]),\n      new Uint8Array(0),\n    );\n  }\n}\n", "import { Maybe } from \"purify-ts\";\n\nimport { type ApduReceiverService } from \"@api/device-session/service/ApduReceiverService\";\nimport { type ApduReceiverConstructorArgs } from \"@api/device-session/service/ApduReceiverService\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DefaultApduReceiverService } from \"@internal/device-session/service/DefaultApduReceiverService\";\n\nexport const defaultApduReceiverServiceStubBuilder = (\n  props: Partial<ApduReceiverConstructorArgs> = {},\n  loggerFactory: (tag: string) => LoggerPublisherService,\n): ApduReceiverService =>\n  new DefaultApduReceiverService(\n    {\n      channel: Maybe.of(new Uint8Array([0x12, 0x34])),\n      ...props,\n    },\n    loggerFactory,\n  );\n", "import { inject, injectable } from \"inversify\";\nimport { Either, Left, Maybe, Right } from \"purify-ts\";\nimport { v4 } from \"uuid\";\n\nimport {\n  APDU_DATA_LENGTH_LENGTH,\n  CHANNEL_LENGTH,\n  HEAD_TAG,\n  HEAD_TAG_LENGTH,\n  INDEX_LENGTH,\n} from \"@api/device-session/data/FramerConst\";\nimport type {\n  ApduSenderService,\n  ApduSenderServiceConstructorArgs,\n} from \"@api/device-session/service/ApduSenderService\";\nimport { FramerUtils } from \"@api/device-session/utils/FramerUtils\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport {\n  FramerApduError,\n  FramerOverflowError,\n} from \"@internal/device-session/model/Errors\";\nimport { Frame } from \"@internal/device-session/model/Frame\";\nimport { FrameHeader } from \"@internal/device-session/model/FrameHeader\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { DmkError } from \"@root/src/api/Error\";\n/**\n * Default implementation of ApduSenderService\n *\n * Split APDU in an array of frames readies to send to a TransportConnectedDevice\n */\n@injectable()\nexport class DefaultApduSenderService implements ApduSenderService {\n  protected _frameSize: number;\n  protected _channel: Maybe<Uint8Array>;\n  protected _padding: boolean;\n  private _logger: LoggerPublisherService;\n\n  /**\n   * Constructor\n   *\n   * @param frameSize\n   * @param channel\n   * @param padding\n   * @param loggerServiceFactory\n   */\n  constructor(\n    {\n      frameSize,\n      channel = Maybe.zero(),\n      padding = false,\n    }: ApduSenderServiceConstructorArgs,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerServiceFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._frameSize = frameSize;\n    this._channel = channel;\n    this._padding = padding;\n    this._logger = loggerServiceFactory(\"DefaultApduSenderService\");\n  }\n\n  /**\n   * Get frames from apdu\n   *\n   * @param apdu\n   */\n  public getFrames(apdu: Uint8Array): Frame[] {\n    const frames: Frame[] = [];\n    let count = 0;\n    let frame = this.getFrameAtIndex(apdu, count);\n\n    while (frame.isRight()) {\n      frames.push(frame.extract());\n      count += 1;\n      frame = this.getFrameAtIndex(apdu, count).mapLeft((error) => {\n        if (error instanceof FramerOverflowError) {\n          // do nothing\n        } else {\n          this._logger.error(\"Error while parsing frame\", { data: { error } });\n        }\n        return error;\n      });\n    }\n    return frames;\n  }\n\n  /**\n   * Get apdu frame at index\n   * Split every {{PACKET_SIZE - HEADER_SIZE}} bytes of apdu\n   * @param apdu\n   * @param frameIndex\n   * @private\n   */\n  private getFrameAtIndex(\n    apdu: Uint8Array,\n    frameIndex: number,\n  ): Either<DmkError, Frame> {\n    const header = this.getFrameHeaderFrom(frameIndex, apdu.length);\n    const frameOffset =\n      frameIndex === 0\n        ? 0\n        : frameIndex * this._frameSize - this.getHeaderSizeSumFrom(frameIndex);\n\n    if (frameOffset >= apdu.length) {\n      return Left(new FramerOverflowError());\n    }\n    if (header.getLength() > this._frameSize) {\n      return Left(new FramerApduError());\n    }\n    const dataMaxSize = this._frameSize - header.getLength();\n    const data = apdu.slice(\n      frameOffset,\n      frameOffset + this._frameSize - header.getLength(),\n    );\n    const frameData = this._padding\n      ? new Uint8Array(dataMaxSize).fill(0)\n      : new Uint8Array(data.length < dataMaxSize ? data.length : dataMaxSize);\n    frameData.set(data, 0);\n    const frame = new Frame({\n      header,\n      data: frameData,\n    });\n    return Right(frame);\n  }\n\n  /**\n   * Get frame header\n   * @param frameIndex\n   * @param apduSize\n   * @private\n   */\n  private getFrameHeaderFrom(\n    frameIndex: number,\n    apduSize: number,\n  ): FrameHeader {\n    const header = new FrameHeader({\n      uuid: v4(),\n      channel: this._channel.map((channel) =>\n        FramerUtils.getLastBytesFrom(channel, CHANNEL_LENGTH),\n      ),\n      headTag: new Uint8Array([HEAD_TAG]),\n      index: FramerUtils.numberToByteArray(frameIndex, INDEX_LENGTH),\n      length: this.getFrameHeaderSizeFromIndex(frameIndex),\n      dataSize: Maybe.zero(),\n    });\n    if (frameIndex === 0) {\n      header.setDataSize(\n        Maybe.of(\n          FramerUtils.numberToByteArray(apduSize, APDU_DATA_LENGTH_LENGTH),\n        ),\n      );\n    }\n    return header;\n  }\n\n  /**\n   * Get frame offset\n   * First frame has more bytes of header\n   * Padding append means a 0 bytes is added at the end of each frame\n   * @private\n   * @param frameIndex\n   */\n  private getHeaderSizeSumFrom(frameIndex: number): number {\n    let sum = this.getFrameHeaderSizeFromIndex(0);\n    let i = 1;\n    while (i < frameIndex) {\n      sum += this.getFrameHeaderSizeFromIndex(i);\n      i += 1;\n    }\n    return sum;\n  }\n\n  /**\n   * Get frame header size\n   * @private\n   * @param frameIndex\n   */\n  private getFrameHeaderSizeFromIndex(frameIndex: number): number {\n    return (\n      this._channel.caseOf({\n        Just: () => CHANNEL_LENGTH,\n        Nothing: () => 0,\n      }) +\n      INDEX_LENGTH +\n      HEAD_TAG_LENGTH +\n      (frameIndex === 0 ? APDU_DATA_LENGTH_LENGTH : 0)\n    );\n  }\n}\n", "import { Maybe } from \"purify-ts\";\n\nimport { type ApduSenderService } from \"@api/device-session/service/ApduSenderService\";\nimport { type ApduSenderServiceConstructorArgs } from \"@api/device-session/service/ApduSenderService\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DefaultApduSenderService } from \"@internal/device-session/service/DefaultApduSenderService\";\n\nexport const defaultApduSenderServiceStubBuilder = (\n  props: Partial<ApduSenderServiceConstructorArgs> = {},\n  loggerFactory: (tag: string) => LoggerPublisherService,\n): ApduSenderService =>\n  new DefaultApduSenderService(\n    {\n      frameSize: 64,\n      channel: Maybe.of(new Uint8Array([0x12, 0x34])),\n      padding: true,\n      ...props,\n    },\n    loggerFactory,\n  );\n", "export const commandTypes = {\n  SendCommandUseCase: Symbol.for(\"SendCommandUseCase\"),\n};\n", "export const configTypes = {\n  LocalConfigDataSource: Symbol.for(\"LocalConfigDataSource\"),\n  RemoteConfigDataSource: Symbol.for(\"RemoteConfigDataSource\"),\n  ConfigService: Symbol.for(\"ConfigService\"),\n  GetDmkVersionUseCase: Symbol.for(\"GetDmkVersionUseCase\"),\n};\n", "export const deviceSessionTypes = {\n  ApduSenderServiceFactory: Symbol.for(\"ApduSenderServiceFactory\"),\n  ApduReceiverServiceFactory: Symbol.for(\"ApduReceiverServiceFactory\"),\n  DeviceSessionService: Symbol.for(\"DeviceSessionService\"),\n  GetDeviceSessionStateUseCase: Symbol.for(\"GetDeviceSessionStateUseCase\"),\n  DisableDeviceSessionRefresherUseCase: Symbol.for(\n    \"DisableDeviceSessionRefresherUseCase\",\n  ),\n  CloseSessionsUseCase: Symbol.for(\"CloseSessionsUseCase\"),\n};\n", "export const discoveryTypes = {\n  StartDiscoveringUseCase: Symbol.for(\"StartDiscoveringUseCase\"),\n  StopDiscoveringUseCase: Symbol.for(\"StopDiscoveringUseCase\"),\n  ConnectUseCase: Symbol.for(\"ConnectUseCase\"),\n  DisconnectUseCase: Symbol.for(\"DisconnectUseCase\"),\n  GetConnectedDeviceUseCase: Symbol.for(\"GetConnectedDeviceUseCase\"),\n  ListenToAvailableDevicesUseCase: Symbol.for(\n    \"ListenToAvailableDevicesUseCase\",\n  ),\n  ListenToConnectedDeviceUseCase: Symbol.for(\"ListenToConnectedDeviceUseCase\"),\n  ListConnectedDevicesUseCase: Symbol.for(\"ListConnectedDevicesUseCase\"),\n  ReconnectUseCase: Symbol.for(\"ReconnectUseCase\"),\n};\n", "export const managerApiTypes = {\n  ManagerApiService: Symbol.for(\"ManagerApiService\"),\n  ManagerApiDataSource: Symbol.for(\"ManagerApiDataSource\"),\n  DmkConfig: Symbol.for(\"ManagerApiDmkConfig\"),\n  SetProviderUseCase: Symbol.for(\"SetProviderUseCase\"),\n};\n", "export const sendTypes = {\n  SendApduUseCase: Symbol.for(\"SendApduUseCase\"),\n};\n", "export const transportDiTypes = {\n  DmkConfig: Symbol.for(\"TransportDmkConfig\"),\n  TransportService: Symbol.for(\"TransportService\"),\n  TransportsInput: Symbol.for(\"TransportsInput\"),\n};\n", "import { inject, injectable } from \"inversify\";\n\nimport { Command } from \"@api/command/Command\";\nimport { CommandResult } from \"@api/command/model/CommandResult\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type SendCommandUseCaseArgs<Response, ErrorStatusCodes, Args = void> = {\n  /**\n   * The device session id.\n   */\n  readonly sessionId: string;\n  /**\n   * The command to send.\n   */\n  readonly command: Command<Response, ErrorStatusCodes, Args>;\n  /**\n   * The timeout to abort the command.\n   */\n  readonly abortTimeout?: number;\n};\n\n/**\n * Sends a command to a device through a device session.\n */\n@injectable()\nexport class SendCommandUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"SendCommandUseCase\");\n  }\n\n  /**\n   * Sends a command to a device through a device session.\n   *\n   * @param sessionId - The device session id.\n   * @param command - The command to send.\n   * @returns The response from the command.\n   */\n  async execute<Response, Args, ErrorStatusCodes>({\n    sessionId,\n    command,\n    abortTimeout,\n  }: SendCommandUseCaseArgs<Response, Args, ErrorStatusCodes>): Promise<\n    CommandResult<Response, ErrorStatusCodes>\n  > {\n    const deviceSessionOrError =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return deviceSessionOrError.caseOf({\n      // Case device session found\n      Right: async (deviceSession) =>\n        await deviceSession.sendCommand<Response, Args, ErrorStatusCodes>(\n          command,\n          abortTimeout,\n        ),\n      // Case device session not found\n      Left: (error) => {\n        this._logger.error(\"Error getting session\", {\n          data: { error },\n        });\n        throw error;\n      },\n    });\n  }\n}\n", "import { injectable } from \"inversify\";\n\n@injectable()\nexport class StubUseCase {\n  execute = vi.fn(() => \"stub\");\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { SendCommandUseCase } from \"@api/command/use-case/SendCommandUseCase\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { commandTypes } from \"./commandTypes\";\n\ntype CommandModuleArgs = Partial<{\n  readonly stub: boolean;\n}>;\n\nexport const commandModuleFactory = ({\n  stub = false,\n}: CommandModuleArgs = {}) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(commandTypes.SendCommandUseCase).to(SendCommandUseCase);\n    if (stub) {\n      rebindSync(commandTypes.SendCommandUseCase).to(StubUseCase);\n    }\n  });\n", "import { inject, injectable } from \"inversify\";\n\nimport {\n  DeviceAction,\n  DeviceActionIntermediateValue,\n  ExecuteDeviceActionReturnType,\n} from \"@api/device-action/DeviceAction\";\nimport { DmkError } from \"@api/Error\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type ExecuteDeviceActionUseCaseArgs<\n  Output,\n  Input,\n  Error extends DmkError,\n  IntermediateValue extends DeviceActionIntermediateValue,\n> = {\n  /**\n   * The device session id.\n   */\n  readonly sessionId: string;\n  /**\n   * The device action to execute.\n   */\n  readonly deviceAction: DeviceAction<Output, Input, Error, IntermediateValue>;\n};\n\n/**\n * Executes a device action to a device through a device session.\n */\n@injectable()\nexport class ExecuteDeviceActionUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"ExecuteDeviceActionUseCase\");\n  }\n\n  /**\n   * Executes a device action to a device through a device session.\n   *\n   * @param sessionId - The device session id.\n   * @param deviceAction - The device action to execute\n   * @returns An object containing an observable of the device action state, and a cancel function.\n   */\n  execute<\n    Output,\n    Error extends DmkError,\n    IntermediateValue extends DeviceActionIntermediateValue,\n    Input,\n  >({\n    sessionId,\n    deviceAction,\n  }: ExecuteDeviceActionUseCaseArgs<\n    Output,\n    Input,\n    Error,\n    IntermediateValue\n  >): ExecuteDeviceActionReturnType<Output, Error, IntermediateValue> {\n    const deviceSessionOrError =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return deviceSessionOrError.caseOf({\n      // Case device session found\n      Right: (deviceSession) =>\n        deviceSession.executeDeviceAction<\n          Output,\n          Input,\n          Error,\n          IntermediateValue\n        >(deviceAction),\n      // Case device session not found\n      Left: (error) => {\n        this._logger.error(\"Error getting session\", {\n          data: { error },\n        });\n        throw error;\n      },\n    });\n  }\n}\n", "export const deviceActionTypes = {\n  ExecuteDeviceActionUseCase: Symbol.for(\"ExecuteDeviceActionUseCase\"),\n};\n", "import { ContainerModule } from \"inversify\";\n\nimport { ExecuteDeviceActionUseCase } from \"@api/device-action/use-case/ExecuteDeviceActionUseCase\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { deviceActionTypes } from \"./deviceActionTypes\";\n\ntype DeviceActionModuleArgs = Partial<{\n  readonly stub: boolean;\n}>;\n\nexport const deviceActionModuleFactory = ({\n  stub = false,\n}: DeviceActionModuleArgs = {}) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(deviceActionTypes.ExecuteDeviceActionUseCase).to(\n      ExecuteDeviceActionUseCase,\n    );\n    if (stub) {\n      rebindSync(deviceActionTypes.ExecuteDeviceActionUseCase).to(StubUseCase);\n    }\n  });\n", "// Domain scoped types\n\nexport type Config = {\n  version: string;\n  name: string;\n};\n\n/**\n * Checks if the provided object is a valid Config object.\n * @param obj - The object to be checked.\n * @returns A boolean indicating whether the object is a Config object.\n */\nexport function isConfig(obj: unknown): obj is Config {\n  return (\n    typeof obj === \"object\" &&\n    obj !== null &&\n    \"version\" in obj &&\n    \"name\" in obj &&\n    typeof obj.version === \"string\" &&\n    typeof obj.name === \"string\"\n  );\n}\n", "export class ApiCallError {\n  readonly _tag = \"ApiCallError\";\n  originalError?: Error;\n  constructor(readonly err?: Error) {\n    this.originalError = err;\n  }\n}\n\nexport class ParseResponseError {\n  readonly _tag = \"ParseResponseError\";\n  originalError?: Error;\n  constructor(readonly err?: Error) {\n    this.originalError = err;\n  }\n}\n\nexport class JSONParseError {\n  readonly _tag = \"JSONParseError\";\n  originalError?: Error;\n  constructor(readonly err?: Error) {\n    this.originalError = err;\n  }\n}\n\nexport type RemoteConfigFailure =\n  | ApiCallError\n  | ParseResponseError\n  | JSONParseError;\n\nexport class ReadFileError {\n  readonly _tag = \"ReadFileError\";\n  originalError?: Error;\n  constructor(readonly err?: Error) {\n    this.originalError = err;\n  }\n}\n\nexport type LocalConfigFailure = JSONParseError | ReadFileError;\n", "{\n  \"dependencies\": {\n    \"@noble/hashes\": \"^1.8.0\",\n    \"@sentry/minimal\": \"catalog:\",\n    \"axios\": \"catalog:\",\n    \"inversify\": \"catalog:\",\n    \"isomorphic-ws\": \"catalog:\",\n    \"purify-ts\": \"catalog:\",\n    \"reflect-metadata\": \"catalog:\",\n    \"semver\": \"catalog:\",\n    \"url\": \"catalog:\",\n    \"uuid\": \"catalog:\",\n    \"ws\": \"catalog:\",\n    \"xstate\": \"catalog:\"\n  },\n  \"devDependencies\": {\n    \"@ledgerhq/eslint-config-dsdk\": \"workspace:^\",\n    \"@ledgerhq/ldmk-tool\": \"workspace:^\",\n    \"@ledgerhq/prettier-config-dsdk\": \"workspace:^\",\n    \"@ledgerhq/tsconfig-dsdk\": \"workspace:^\",\n    \"@ledgerhq/vitest-config-dmk\": \"workspace:^\",\n    \"@statelyai/inspect\": \"catalog:\",\n    \"@types/semver\": \"catalog:\",\n    \"@types/uuid\": \"catalog:\",\n    \"@types/ws\": \"catalog:\",\n    \"rxjs\": \"catalog:\",\n    \"ts-node\": \"catalog:\"\n  },\n  \"exports\": {\n    \".\": {\n      \"import\": \"./lib/esm/index.js\",\n      \"require\": \"./lib/cjs/index.js\",\n      \"types\": \"./lib/types/index.d.ts\"\n    }\n  },\n  \"files\": [\n    \"./lib\",\n    \"package.json\"\n  ],\n  \"license\": \"Apache-2.0\",\n  \"name\": \"@ledgerhq/device-management-kit\",\n  \"peerDependencies\": {\n    \"rxjs\": \"catalog:\"\n  },\n  \"private\": false,\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/LedgerHQ/device-sdk-ts.git\"\n  },\n  \"scripts\": {\n    \"build\": \"pnpm ldmk-tool build --entryPoints index.ts,src/**/*.ts --tsconfig tsconfig.prod.json\",\n    \"dev\": \"concurrently \\\"pnpm watch:builds\\\" \\\"pnpm watch:types\\\"\",\n    \"lint\": \"eslint\",\n    \"lint:fix\": \"pnpm lint --fix\",\n    \"module:create\": \"pnpm hygen core-module with-prompt\",\n    \"postpack\": \"find . -name '*.tgz' -exec cp {} ../../dist/ \\\\; \",\n    \"prebuild\": \"rimraf lib\",\n    \"prettier\": \"prettier . --check\",\n    \"prettier:fix\": \"prettier . --write\",\n    \"test\": \"vitest run\",\n    \"test:coverage\": \"vitest run --coverage\",\n    \"test:watch\": \"vitest\",\n    \"typecheck\": \"tsc --noEmit\",\n    \"watch:builds\": \"pnpm ldmk-tool watch --entryPoints index.ts,src/**/*.ts --tsconfig tsconfig.prod.json\",\n    \"watch:types\": \"concurrently \\\"tsc --watch -p tsconfig.prod.json\\\" \\\"tsc-alias --watch -p tsconfig.prod.json\\\"\"\n  },\n  \"version\": \"0.13.0\"\n}\n", "import { injectable } from \"inversify\";\nimport { Either } from \"purify-ts\";\n\nimport { Config, isConfig } from \"@internal/config/model/Config\";\nimport {\n  JSONParseError,\n  LocalConfigFailure,\n  ReadFileError,\n} from \"@internal/config/model/Errors\";\nimport pkg from \"@root/package.json\";\n\nimport { LocalConfigDataSource } from \"./ConfigDataSource\";\n\nconst version = {\n  name: pkg.name,\n  version: pkg.version,\n};\n\nexport const stubFsReadFile = () => JSON.stringify(version);\n\n@injectable()\n/**\n * The data source for retrieving local configuration.\n */\nexport class FileLocalConfigDataSource implements LocalConfigDataSource {\n  /**\n   * Retrieves the local configuration.\n   * @returns An `Either` containing either a `LocalConfigFailure` or a `Config` object.\n   */\n  getConfig(): Either<LocalConfigFailure, Config> {\n    return Either.encase(() => stubFsReadFile())\n      .mapLeft((error) => new ReadFileError(error))\n      .chain((str) => {\n        return Either.encase(() => {\n          const config: unknown = JSON.parse(str);\n          if (isConfig(config)) {\n            return config;\n          }\n          throw new Error(\"Invalid config file\");\n        }).mapLeft((error) => new JSONParseError(error));\n      });\n  }\n}\n", "import { injectable } from \"inversify\";\nimport { Either } from \"purify-ts\";\n\nimport { Config } from \"@internal/config/model/Config\";\n\nimport { LocalConfigDataSource } from \"./ConfigDataSource\";\n\n/**\n *\n * class StubLocalConfigDataSource\n *\n */\n@injectable()\nexport class StubLocalConfigDataSource implements LocalConfigDataSource {\n  getConfig(): Either<never, Config> {\n    return Either.of({\n      name: \"DeviceSDK\",\n      version: \"0.0.0-stub.1\",\n    });\n  }\n}\n", "import { injectable } from \"inversify\";\nimport { Either, Left } from \"purify-ts\";\n\nimport { Config } from \"@internal/config/model/Config\";\nimport {\n  ApiCallError,\n  JSONParseError,\n  ParseResponseError,\n  RemoteConfigFailure,\n} from \"@internal/config/model/Errors\";\n\nimport { RemoteConfigDataSource } from \"./ConfigDataSource\";\nimport { ConfigDto } from \"./Dto\";\n\n/**\n * class RemoteRestConfigDataSource\n * This is a remote data source that reads the config from a remote API (example).\n */\n@injectable()\nexport class RestRemoteConfigDataSource implements RemoteConfigDataSource {\n  async getConfig(): Promise<Either<RemoteConfigFailure, Config>> {\n    const call = await this._callApi();\n    if (call.isLeft()) {\n      return Left(new ApiCallError(call.extract()));\n    }\n\n    if (!call.extract().ok) {\n      return Left(new ApiCallError(new Error(\"response not ok\")));\n    }\n\n    const json = await call.extract().json();\n    if (json.isLeft()) {\n      return Left(new JSONParseError());\n    }\n\n    return json\n      .chain((dto) => this._parseResponse(dto))\n      .map((config) => config);\n  }\n\n  // Parser for the Dto\n  // parserResponse: ConfigDto => Config\n  private _parseResponse(dto: ConfigDto): Either<ParseResponseError, Config> {\n    const { name, version } = dto;\n    if (!name || !version) {\n      return Left(new ParseResponseError());\n    }\n    return Either.of({ name, version });\n  }\n\n  private _callApi(): Promise<\n    Either<\n      never,\n      {\n        ok: boolean;\n        json: () => Promise<Either<JSONParseError, ConfigDto>>;\n      }\n    >\n  > {\n    return new Promise((res) => {\n      res(\n        Either.of({\n          ok: true,\n          json: async () =>\n            new Promise((r) => {\n              r(\n                Either.of({\n                  name: \"DeviceSDK\",\n                  version: \"0.0.0-fake.1\",\n                  yolo: \"yolo\",\n                }),\n              );\n            }),\n        }),\n      );\n    });\n  }\n}\n", "import { injectable } from \"inversify\";\nimport { Either } from \"purify-ts\";\n\nimport { Config } from \"@internal/config/model/Config\";\n\nimport { RemoteConfigDataSource } from \"./ConfigDataSource\";\n\n/**\n * class RemoteRestConfigDataSource\n * This is a remote data source that reads the config from a remote API (example).\n */\n@injectable()\nexport class StubRemoteConfigDataSource implements RemoteConfigDataSource {\n  async getConfig(): Promise<Either<never, Config>> {\n    return new Promise((res) =>\n      res(\n        Either.of({\n          name: \"DeviceSDK\",\n          version: \"0.0.0-fake.2\",\n        }),\n      ),\n    );\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport type { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport type {\n  LocalConfigDataSource,\n  RemoteConfigDataSource,\n} from \"@internal/config/data/ConfigDataSource\";\nimport { configTypes } from \"@internal/config/di/configTypes\";\nimport { Config } from \"@internal/config/model/Config\";\nimport {\n  LocalConfigFailure,\n  RemoteConfigFailure,\n} from \"@internal/config/model/Errors\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nimport { ConfigService } from \"./ConfigService\";\n\n@injectable()\nexport class DefaultConfigService implements ConfigService {\n  private _local: LocalConfigDataSource;\n  private _remote: RemoteConfigDataSource;\n  private _logger: LoggerPublisherService;\n  constructor(\n    @inject(configTypes.LocalConfigDataSource) local: LocalConfigDataSource,\n    @inject(configTypes.RemoteConfigDataSource) remote: RemoteConfigDataSource,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerServiceFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._local = local;\n    this._remote = remote;\n    this._logger = loggerServiceFactory(\"config\");\n  }\n\n  async getDmkConfig(): Promise<Config> {\n    // Returns an Either<ReadFileError | JsonParseError, Config>\n    const localConfig = this._local\n      .getConfig()\n      .ifLeft((error: LocalConfigFailure) => {\n        this._logger.error(\"Local config not available\", {\n          data: { error },\n        });\n      });\n\n    if (localConfig.isRight()) {\n      const val = localConfig.extract();\n      this._logger.info(\"Local config available\", { data: { config: val } });\n      return val;\n    }\n\n    return this._remote.getConfig().then((config) => {\n      return config\n        .mapLeft((error: RemoteConfigFailure) => {\n          // Here we handle the error and return a default value\n          this._logger.error(\"Local config available\", { data: { error } });\n          return { name: \"DeadDmk\", version: \"0.0.0-dead.1\" };\n        })\n        .extract();\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { configTypes } from \"@internal/config/di/configTypes\";\nimport type { ConfigService } from \"@internal/config/service/ConfigService\";\n\n/**\n * class GetDmkVersionUseCase\n * This is our actual use case that our DMK will use.\n * We will have many use cases in our DMK, and each should be contained in its own file.\n */\n@injectable()\nexport class GetDmkVersionUseCase {\n  private _configService: ConfigService;\n  constructor(@inject(configTypes.ConfigService) configService: ConfigService) {\n    this._configService = configService;\n  }\n  async getDmkVersion(): Promise<string> {\n    return (await this._configService.getDmkConfig()).version;\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { FileLocalConfigDataSource } from \"@internal/config/data/LocalConfigDataSource\";\nimport { StubLocalConfigDataSource } from \"@internal/config/data/LocalConfigDataSource.stub\";\nimport { RestRemoteConfigDataSource } from \"@internal/config/data/RemoteConfigDataSource\";\nimport { StubRemoteConfigDataSource } from \"@internal/config/data/RemoteConfigDataSource.stub\";\nimport { DefaultConfigService } from \"@internal/config/service/DefaultConfigService\";\nimport { GetDmkVersionUseCase } from \"@internal/config/use-case/GetDmkVersionUseCase\";\n\nimport { configTypes } from \"./configTypes\";\n\n// This module is used to configure the dependency injection container\n// This is where we will bind our interfaces to their implementations (or mocks...)\ntype FactoryProps = {\n  stub: boolean;\n};\n\nexport const configModuleFactory = ({ stub }: FactoryProps) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(configTypes.LocalConfigDataSource).to(FileLocalConfigDataSource);\n    bind(configTypes.RemoteConfigDataSource).to(RestRemoteConfigDataSource);\n    bind(configTypes.GetDmkVersionUseCase).to(GetDmkVersionUseCase);\n    bind(configTypes.ConfigService).to(DefaultConfigService);\n\n    if (stub) {\n      // We can rebind our interfaces to their mock implementations\n      rebindSync(configTypes.LocalConfigDataSource).to(\n        StubLocalConfigDataSource,\n      );\n      rebindSync(configTypes.RemoteConfigDataSource).to(\n        StubRemoteConfigDataSource,\n      );\n    }\n  });\n", "export const deviceModelTypes = {\n  DeviceModelDataSource: Symbol.for(\"DeviceModelDataSource\"),\n};\n", "import { ContainerModule } from \"inversify\";\n\nimport { StaticDeviceModelDataSource } from \"@api/device-model/data/StaticDeviceModelDataSource\";\n\nimport { deviceModelTypes } from \"./deviceModelTypes\";\n\ntype FactoryProps = {\n  stub: boolean;\n};\n\nexport const deviceModelModuleFactory = ({ stub }: FactoryProps) =>\n  new ContainerModule(({ bind }) => {\n    bind(deviceModelTypes.DeviceModelDataSource).to(\n      StaticDeviceModelDataSource,\n    );\n\n    if (stub) {\n      // We can rebind our interfaces to their mock implementations\n      // rebind(...).to(....);\n    }\n  });\n", "import { inject, injectable } from \"inversify\";\n\nimport { type DeviceSessionId } from \"@api/device-session/types\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport { type DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type DisableDeviceSessionRefresherUseCaseArgs = {\n  sessionId: DeviceSessionId;\n  blockerId: string;\n};\n\n/**\n * Disable the device session refresher.\n */\n@injectable()\nexport class DisableDeviceSessionRefresherUseCase {\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    private readonly _sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._logger = loggerFactory(\"DisableDeviceSessionRefresherUseCase\");\n  }\n\n  execute({ sessionId, blockerId }: DisableDeviceSessionRefresherUseCaseArgs) {\n    const errorOrDeviceSession =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return errorOrDeviceSession.caseOf({\n      Left: (error) => {\n        this._logger.error(\"Error getting device session\", { data: { error } });\n        throw error;\n      },\n      // Return a function that can be used to reenable the refresher\n      Right: (deviceSession) => deviceSession.disableRefresher(blockerId),\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { Either, Maybe } from \"purify-ts\";\nimport { Observable, ReplaySubject } from \"rxjs\";\n\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DeviceId } from \"@api/types\";\nimport { DeviceSession } from \"@internal/device-session/model/DeviceSession\";\nimport { DeviceSessionNotFound } from \"@internal/device-session/model/Errors\";\nimport { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\n@injectable()\nexport class DefaultDeviceSessionService implements DeviceSessionService {\n  private _sessions: DeviceSession[];\n  private readonly _sessionsSubject: ReplaySubject<DeviceSession>;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessions = [];\n    this._sessionsSubject = new ReplaySubject();\n    this._logger = loggerModuleFactory(\"DeviceSessionService\");\n  }\n\n  public get sessionsObs(): Observable<DeviceSession> {\n    return this._sessionsSubject.asObservable();\n  }\n\n  addDeviceSession(deviceSession: DeviceSession): DeviceSessionService {\n    const found = this._sessions.find((s) => s.id === deviceSession.id);\n    if (found) {\n      this._logger.warn(\"DeviceSession already exists\", {\n        data: { deviceSession },\n      });\n      return this;\n    }\n    this._sessions.push(deviceSession);\n    this._sessionsSubject.next(deviceSession);\n    this._logger.info(\"DeviceSession added\", {\n      data: { sessionId: deviceSession.id },\n    });\n    return this;\n  }\n\n  removeDeviceSession(sessionId: string): DeviceSessionService {\n    const found = this._sessions.find((s) => s.id === sessionId);\n    if (found) {\n      found.close();\n      this._sessions = this._sessions.filter((s) => s.id !== sessionId);\n      this._logger.info(\"DeviceSession removed\", { data: { sessionId } });\n      return this;\n    }\n    this._logger.warn(\"DeviceSession not found\", { data: { sessionId } });\n    return this;\n  }\n\n  getDeviceSessionById(\n    sessionId: string,\n  ): Either<DeviceSessionNotFound, DeviceSession> {\n    return Maybe.fromNullable(\n      this._sessions.find((s) => s.id === sessionId),\n    ).toEither(new DeviceSessionNotFound());\n  }\n\n  getDeviceSessionsByDeviceId(\n    deviceId: DeviceId,\n  ): Either<DeviceSessionNotFound, DeviceSession[]> {\n    return Maybe.fromPredicate(\n      ({ length }) => length > 0,\n      this._sessions.filter((s) => s.connectedDevice.id === deviceId),\n    ).toEither(new DeviceSessionNotFound());\n  }\n\n  getDeviceSessions(): DeviceSession[] {\n    return this._sessions;\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport type { TransportService } from \"@internal/transport/service/TransportService\";\n\n@injectable()\nexport class CloseSessionsUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _transportService: TransportService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(transportDiTypes.TransportService)\n    transportService: TransportService,\n  ) {\n    this._sessionService = sessionService;\n    this._transportService = transportService;\n  }\n\n  execute() {\n    const deviceSessions = this._sessionService.getDeviceSessions();\n\n    for (const dSession of deviceSessions) {\n      this._transportService.closeConnection(dSession.connectedDevice);\n      this._sessionService.removeDeviceSession(dSession.id);\n    }\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { DeviceSessionId } from \"@api/device-session/types\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type GetSessionDeviceStateUseCaseArgs = {\n  sessionId: DeviceSessionId;\n};\n\n/**\n * Get deviceSession state from its id.\n */\n@injectable()\nexport class GetDeviceSessionStateUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"GetDeviceSessionStateUseCase\");\n  }\n\n  execute({ sessionId }: GetSessionDeviceStateUseCaseArgs) {\n    const errorOrDeviceSession =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return errorOrDeviceSession.caseOf({\n      Left: (error) => {\n        this._logger.error(\"Error getting session device\", { data: { error } });\n        throw error;\n      },\n      Right: (deviceSession) => deviceSession.state,\n    });\n  }\n}\n", "import { ContainerModule, type Factory } from \"inversify\";\n\nimport { type ApduReceiverService } from \"@api/device-session/service/ApduReceiverService\";\nimport { type ApduReceiverConstructorArgs } from \"@api/device-session/service/ApduReceiverService\";\nimport { type ApduSenderService } from \"@api/device-session/service/ApduSenderService\";\nimport { type ApduSenderServiceConstructorArgs } from \"@api/device-session/service/ApduSenderService\";\nimport { DisableDeviceSessionRefresherUseCase } from \"@api/device-session/use-case/DisableDeviceSessionRefresher\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DefaultApduReceiverService } from \"@internal/device-session/service/DefaultApduReceiverService\";\nimport { DefaultApduSenderService } from \"@internal/device-session/service/DefaultApduSenderService\";\nimport { DefaultDeviceSessionService } from \"@internal/device-session/service/DefaultDeviceSessionService\";\nimport { CloseSessionsUseCase } from \"@internal/device-session/use-case/CloseSessionsUseCase\";\nimport { GetDeviceSessionStateUseCase } from \"@internal/device-session/use-case/GetDeviceSessionStateUseCase\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { deviceSessionTypes } from \"./deviceSessionTypes\";\n\nexport type DeviceSessionModuleArgs = Partial<{\n  stub: boolean;\n}>;\n\nexport const deviceSessionModuleFactory = (\n  { stub }: DeviceSessionModuleArgs = { stub: false },\n) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind<Factory<ApduSenderService>>(\n      deviceSessionTypes.ApduSenderServiceFactory,\n    ).toFactory((context) => {\n      const logger = context.get<(name: string) => LoggerPublisherService>(\n        loggerTypes.LoggerPublisherServiceFactory,\n      );\n\n      return (args: ApduSenderServiceConstructorArgs) => {\n        return new DefaultApduSenderService(args, logger);\n      };\n    });\n\n    bind<Factory<ApduReceiverService>>(\n      deviceSessionTypes.ApduReceiverServiceFactory,\n    ).toFactory((context) => {\n      const logger = context.get<(name: string) => LoggerPublisherService>(\n        loggerTypes.LoggerPublisherServiceFactory,\n      );\n\n      return (args: ApduReceiverConstructorArgs = {}) => {\n        return new DefaultApduReceiverService(args, logger);\n      };\n    });\n\n    bind(deviceSessionTypes.DeviceSessionService)\n      .to(DefaultDeviceSessionService)\n      .inSingletonScope();\n\n    bind(deviceSessionTypes.GetDeviceSessionStateUseCase).to(\n      GetDeviceSessionStateUseCase,\n    );\n    bind(deviceSessionTypes.CloseSessionsUseCase).to(CloseSessionsUseCase);\n    bind(deviceSessionTypes.DisableDeviceSessionRefresherUseCase).to(\n      DisableDeviceSessionRefresherUseCase,\n    );\n\n    if (stub) {\n      rebindSync(deviceSessionTypes.GetDeviceSessionStateUseCase).to(\n        StubUseCase,\n      );\n      rebindSync(deviceSessionTypes.DisableDeviceSessionRefresherUseCase).to(\n        StubUseCase,\n      );\n    }\n  });\n", "// used for default args\nexport const DEVICE_SESSION_REFRESHER_POLLING_INTERVAL = 1000;\n\n// used to set a minimum interval for the exposed refresher options\nexport const DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL = 1000;\n\nexport const DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS = {\n  isRefresherDisabled: false,\n  pollingInterval: DEVICE_SESSION_REFRESHER_POLLING_INTERVAL,\n};\n", "export class MutexService {\n  private _queue: Array<() => void> = [];\n  private _locked = false;\n\n  async lock(): Promise<() => void> {\n    return new Promise((resolve) => {\n      const release = () => {\n        this._locked = false;\n        if (this._queue.length > 0) {\n          const next = this._queue.shift();\n          this._locked = true;\n          next!();\n        }\n      };\n\n      if (!this._locked) {\n        this._locked = true;\n        resolve(release);\n      } else {\n        this._queue.push(() => resolve(release));\n      }\n    });\n  }\n}\n", "import { v4 as uuidv4 } from \"uuid\";\n\nimport { type LoggerPublisherService } from \"@api/types\";\n\nexport interface RefresherController {\n  start(): void;\n  stop(): void;\n}\n\nexport class RefresherService {\n  private readonly _refresherBlockers = new Set<string>();\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n    private readonly _refresher: RefresherController,\n  ) {\n    this._logger = loggerModuleFactory(\"refresher-service\");\n  }\n\n  public disableRefresher(id: string): () => void {\n    const uniqueId = `${id}-${uuidv4()}`;\n    this.addRefresherBlocker(uniqueId);\n\n    this._logger.debug(\"Refresher disabled\", {\n      data: {\n        blockerId: uniqueId,\n        blockers: Array.from(this._refresherBlockers),\n      },\n    });\n\n    let hasBeenReenabled = false;\n\n    return () => {\n      if (hasBeenReenabled) return;\n      hasBeenReenabled = true;\n      this.removeRefresherBlocker(uniqueId);\n\n      this._logger.debug(\"Refresher re-enabled\", {\n        data: {\n          blockerId: uniqueId,\n          blockers: Array.from(this._refresherBlockers),\n        },\n      });\n    };\n  }\n\n  private addRefresherBlocker(blockerId: string): void {\n    const prevBlockersCount = this._refresherBlockers.size;\n    this._refresherBlockers.add(blockerId);\n\n    if (prevBlockersCount === 0) {\n      this._refresher.stop();\n    }\n  }\n\n  private removeRefresherBlocker(blockerId: string): void {\n    const prevBlockersCount = this._refresherBlockers.size;\n    this._refresherBlockers.delete(blockerId);\n\n    if (prevBlockersCount > 0 && this._refresherBlockers.size === 0) {\n      this._refresher.start();\n    }\n  }\n}\n", "import { type Observable, Subject } from \"rxjs\";\n\nimport { type GetAppAndVersionResponse } from \"@api/index\";\nimport { type CommandResult } from \"@api/types\";\n\nexport enum SessionEvents {\n  NEW_STATE = \"NEW_STATE\",\n  REFRESH_NEEDED = \"REFRESH_NEEDED\",\n  COMMAND_SUCCEEDED = \"COMMAND_SUCCEEDED\",\n  DEVICE_STATE_UPDATE_BUSY = \"DEVICE_STATE_UPDATE_BUSY\",\n  DEVICE_STATE_UPDATE_LOCKED = \"DEVICE_STATE_UPDATE_LOCKED\",\n  DEVICE_STATE_UPDATE_CONNECTED = \"DEVICE_STATE_UPDATE_CONNECTED\",\n}\n\ninterface SessionEventPayloads {\n  [SessionEvents.NEW_STATE]: undefined;\n  [SessionEvents.REFRESH_NEEDED]: undefined;\n  [SessionEvents.DEVICE_STATE_UPDATE_BUSY]: undefined;\n  [SessionEvents.DEVICE_STATE_UPDATE_LOCKED]: undefined;\n  [SessionEvents.DEVICE_STATE_UPDATE_CONNECTED]: undefined;\n  [SessionEvents.COMMAND_SUCCEEDED]: CommandResult<GetAppAndVersionResponse>;\n}\n\nexport type NewEvent = {\n  [K in SessionEvents]: SessionEventPayloads[K] extends undefined\n    ? { eventName: K; eventData?: undefined }\n    : { eventName: K; eventData: SessionEventPayloads[K] };\n}[SessionEvents];\n\nexport class DeviceSessionEventDispatcher {\n  private _eventEmitter: Subject<NewEvent> = new Subject();\n\n  public listen(): Observable<NewEvent> {\n    return this._eventEmitter.asObservable();\n  }\n\n  public dispatch(event: NewEvent): void {\n    this._eventEmitter.next(event);\n  }\n}\n", "import { type Subscription } from \"rxjs\";\n\nimport { DeviceModelId } from \"@api/device/DeviceModel\";\nimport {\n  GetAppAndVersionCommand,\n  type GetAppAndVersionResponse,\n  GetOsVersionCommand,\n  type TransportConnectedDevice,\n} from \"@api/index\";\nimport {\n  type Command,\n  type CommandResult,\n  type LoggerPublisherService,\n} from \"@api/types\";\nimport { PINGER_TIMEOUT } from \"@internal/device-session/data/ApduResponseConst\";\nimport { DEVICE_SESSION_REFRESHER_POLLING_INTERVAL } from \"@internal/device-session/data/DeviceSessionRefresherConst\";\nimport {\n  type DeviceSessionEventDispatcher,\n  type NewEvent,\n  SessionEvents,\n} from \"@internal/device-session/model/DeviceSessionEventDispatcher\";\n\ntype SendCommandFunction = <Response, Args, ErrorStatusCodes>(\n  command: Command<Response, Args, ErrorStatusCodes>,\n  abortTimeout?: number,\n) => Promise<CommandResult<Response, ErrorStatusCodes>>;\n\nexport class DevicePinger {\n  private readonly _sendCommandFunction: SendCommandFunction;\n  private _subscription: Subscription;\n  private _logger: LoggerPublisherService;\n\n  constructor(\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n    private connectedDevice: TransportConnectedDevice,\n    private _sessionEventDispatcher: DeviceSessionEventDispatcher,\n    sendCommandFunction: SendCommandFunction,\n  ) {\n    this._sendCommandFunction = sendCommandFunction;\n    this._logger = loggerModuleFactory(\"device-pinger\");\n    this._subscription = this._sessionEventDispatcher\n      .listen()\n      .subscribe(async (event) => await this.mapEventAction(event));\n  }\n\n  public async ping(): Promise<CommandResult<GetAppAndVersionResponse> | null> {\n    try {\n      const result = await this.mapDevicePingAction(\n        this.connectedDevice.deviceModel.id,\n      );\n      return result;\n    } catch (error) {\n      this._logger.error(\"Error while pinging device\", {\n        data: {\n          error,\n        },\n      });\n      throw error;\n    }\n  }\n\n  private mapEventAction = async (event: NewEvent) => {\n    switch (event.eventName) {\n      case SessionEvents.REFRESH_NEEDED:\n        return await this.ping();\n      default:\n        return null;\n    }\n  };\n\n  private async mapDevicePingAction(deviceModelId: DeviceModelId) {\n    switch (deviceModelId) {\n      case DeviceModelId.NANO_S: {\n        const chainPromise: () => Promise<\n          CommandResult<GetAppAndVersionResponse>\n        > = async () => {\n          const appVersionResult = await this._sendCommandFunction(\n            new GetAppAndVersionCommand(),\n            PINGER_TIMEOUT,\n          );\n\n          this._sendCommandFunction(new GetOsVersionCommand(), PINGER_TIMEOUT);\n          return appVersionResult;\n        };\n\n        const timeoutPromise: Promise<null> = new Promise((resolve) => {\n          setTimeout(\n            () => resolve(null),\n            DEVICE_SESSION_REFRESHER_POLLING_INTERVAL * 2 + 100,\n          );\n        });\n\n        const resultOrTimeout: CommandResult<GetAppAndVersionResponse> | null =\n          await Promise.race([chainPromise(), timeoutPromise]);\n\n        if (!resultOrTimeout) {\n          this._sessionEventDispatcher.dispatch({\n            eventName: SessionEvents.DEVICE_STATE_UPDATE_LOCKED,\n          });\n        } else {\n          this._sessionEventDispatcher.dispatch({\n            eventName: SessionEvents.COMMAND_SUCCEEDED,\n            eventData: resultOrTimeout,\n          });\n        }\n        return resultOrTimeout;\n      }\n      default: {\n        const result = await this._sendCommandFunction(\n          new GetAppAndVersionCommand(),\n          PINGER_TIMEOUT,\n        );\n        this._sessionEventDispatcher.dispatch({\n          eventName: SessionEvents.COMMAND_SUCCEEDED,\n          eventData: result,\n        });\n        return result;\n      }\n    }\n  }\n\n  public unsubscribe(): void {\n    this._subscription.unsubscribe();\n  }\n}\n", "import { type Subscription, timer } from \"rxjs\";\n\nimport { DeviceModelId } from \"@api/device/DeviceModel\";\nimport { type TransportConnectedDevice } from \"@api/transport/model/TransportConnectedDevice\";\nimport { type LoggerPublisherService } from \"@api/types\";\nimport {\n  DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL,\n  DEVICE_SESSION_REFRESHER_POLLING_INTERVAL,\n} from \"@internal/device-session/data/DeviceSessionRefresherConst\";\nimport {\n  type DeviceSessionEventDispatcher,\n  SessionEvents,\n} from \"@internal/device-session/model/DeviceSessionEventDispatcher\";\n\nexport interface DeviceSessionRefresherOptions {\n  isRefresherDisabled: boolean;\n  pollingInterval?: number;\n}\n\nexport class DeviceSessionRefresher {\n  private _refresherSubscription!: Subscription | undefined;\n  private _refresherOptions: DeviceSessionRefresherOptions;\n  private readonly _logger: LoggerPublisherService;\n  private _connectedDeviceID: DeviceModelId;\n\n  constructor(\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n    refresherOptions: DeviceSessionRefresherOptions,\n    private _sessionEventDispatcher: DeviceSessionEventDispatcher,\n    connectedDevice: TransportConnectedDevice,\n  ) {\n    this._refresherOptions = refresherOptions;\n    this._logger = loggerModuleFactory(\"device-session-refresher\");\n    this._connectedDeviceID = connectedDevice.deviceModel.id;\n  }\n\n  public startRefresher(): void {\n    if (this._refresherOptions.isRefresherDisabled) return;\n\n    const pollingInterval =\n      this.getValidPollingInterval(this._refresherOptions, this._logger) * 2;\n\n    this._refresherSubscription = timer(0, pollingInterval).subscribe(() => {\n      this._sessionEventDispatcher.dispatch({\n        eventName: SessionEvents.REFRESH_NEEDED,\n      });\n    });\n  }\n\n  public stopRefresher(): void {\n    if (this._refresherSubscription) {\n      this._refresherSubscription.unsubscribe();\n      this._refresherSubscription = undefined;\n      this._logger.info(\"Refresher stopped.\");\n    }\n  }\n\n  public restartRefresher(): void {\n    this.stopRefresher();\n    this.startRefresher();\n    this._logger.info(\"Refresher restarted.\");\n  }\n\n  public destroy(): void {\n    this.stopRefresher();\n  }\n\n  private getValidPollingInterval = (\n    refresherOptions: DeviceSessionRefresherOptions,\n    logger: LoggerPublisherService,\n  ): number => {\n    const { pollingInterval } = refresherOptions;\n    switch (this._connectedDeviceID) {\n      case DeviceModelId.NANO_S: {\n        const defaultNanoPollingInterval =\n          DEVICE_SESSION_REFRESHER_POLLING_INTERVAL * 2;\n        if (\n          pollingInterval !== undefined &&\n          pollingInterval < defaultNanoPollingInterval\n        ) {\n          logger.warn(\n            `Polling interval of ${pollingInterval} is too low, setting to minimum as ${defaultNanoPollingInterval}`,\n          );\n          return defaultNanoPollingInterval;\n        }\n        return pollingInterval ?? defaultNanoPollingInterval;\n      }\n      default:\n        if (\n          pollingInterval !== undefined &&\n          pollingInterval < DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL\n        ) {\n          logger.warn(\n            `Polling interval of ${pollingInterval} is too low, setting to minimum as ${DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL}`,\n          );\n          return DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL;\n        }\n\n        return pollingInterval ?? DEVICE_SESSION_REFRESHER_POLLING_INTERVAL;\n    }\n  };\n}\n", "import { type BehaviorSubject, type Subscription } from \"rxjs\";\n\nimport { type DeviceSessionState } from \"@api/device-session/DeviceSessionState\";\nimport {\n  DeviceSessionStateType,\n  DeviceStatus,\n  type GetAppAndVersionResponse,\n  isSuccessCommandResult,\n  type TransportConnectedDevice,\n} from \"@api/index\";\nimport { type CommandResult, type LoggerPublisherService } from \"@api/types\";\nimport {\n  type DeviceSessionEventDispatcher,\n  type NewEvent,\n  SessionEvents,\n} from \"@internal/device-session/model/DeviceSessionEventDispatcher\";\n\nexport type SetDeviceSessionStateFn = (state: DeviceSessionState) => void;\n\ntype NewDeviceStatus = {\n  sessionStateType: DeviceSessionStateType;\n  deviceStatus: DeviceStatus;\n  currentApp: {\n    name: string;\n    version: string;\n  };\n};\n\nexport class DeviceSessionStateHandler {\n  private _subscription: Subscription;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n    private _sessionEventDispatcher: DeviceSessionEventDispatcher,\n    private _connectedDevice: TransportConnectedDevice,\n    private _deviceState: BehaviorSubject<DeviceSessionState>,\n    private setDeviceSessionState: SetDeviceSessionStateFn,\n  ) {\n    this._subscription = this._sessionEventDispatcher\n      .listen()\n      .subscribe((event) => this.mapEventAction(event));\n    this._logger = loggerModuleFactory(\"device-session-state-handler\");\n  }\n\n  private _updateDeviceState(\n    parsedResponse: CommandResult<GetAppAndVersionResponse>,\n  ): void {\n    const newDeviceStatus = this._parseDeviceStatus(parsedResponse);\n\n    if (newDeviceStatus) {\n      const { sessionStateType, deviceStatus, currentApp } = newDeviceStatus;\n      const state = this._deviceState.getValue();\n      if (state.sessionStateType === DeviceSessionStateType.Connected) {\n        // When device is connected, initialize fields to default values\n        this.setDeviceSessionState({\n          sessionStateType,\n          deviceStatus,\n          deviceModelId: this._connectedDevice.deviceModel.id,\n          currentApp,\n          installedApps: [],\n          isSecureConnectionAllowed: false,\n        });\n      } else {\n        // When device is ready, keep un-modified state fields\n        this.setDeviceSessionState({\n          ...state,\n          sessionStateType,\n          deviceStatus,\n          deviceModelId: this._connectedDevice.deviceModel.id,\n          currentApp,\n        });\n      }\n    }\n  }\n\n  private mapEventAction = (event: NewEvent) => {\n    switch (event.eventName) {\n      case SessionEvents.COMMAND_SUCCEEDED:\n        return this._updateDeviceState(event.eventData);\n      case SessionEvents.DEVICE_STATE_UPDATE_BUSY:\n        return this.setDeviceSessionState({\n          ...this._deviceState.getValue(),\n          deviceStatus: DeviceStatus.BUSY,\n        });\n      case SessionEvents.DEVICE_STATE_UPDATE_LOCKED:\n        return this.setDeviceSessionState({\n          ...this._deviceState.getValue(),\n          deviceStatus: DeviceStatus.LOCKED,\n        });\n      case SessionEvents.DEVICE_STATE_UPDATE_CONNECTED:\n        return this.setDeviceSessionState({\n          ...this._deviceState.getValue(),\n          deviceStatus: DeviceStatus.CONNECTED,\n        });\n      default:\n        return null;\n    }\n  };\n\n  private _parseDeviceStatus(\n    parsedResponse: CommandResult<GetAppAndVersionResponse>,\n  ): NewDeviceStatus | null {\n    if (isSuccessCommandResult(parsedResponse)) {\n      return {\n        sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel,\n        deviceStatus: DeviceStatus.CONNECTED,\n        currentApp: {\n          name: parsedResponse.data.name,\n          version: parsedResponse.data.version,\n        },\n      };\n    } else {\n      this._logger.debug(\"Error while parsing APDU response\", {\n        data: { parsedResponse },\n      });\n      return null;\n    }\n  }\n\n  public unsubscribe(): void {\n    this._subscription.unsubscribe();\n  }\n}\n", "import { type Either } from \"purify-ts\";\nimport { BehaviorSubject, type Observable } from \"rxjs\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport { type Command } from \"@api/command/Command\";\nimport { type CommandResult } from \"@api/command/model/CommandResult\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { DeviceStatus } from \"@api/device/DeviceStatus\";\nimport {\n  type DeviceAction,\n  type DeviceActionIntermediateValue,\n  type ExecuteDeviceActionReturnType,\n} from \"@api/device-action/DeviceAction\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport {\n  type DeviceSessionState,\n  DeviceSessionStateType,\n} from \"@api/device-session/DeviceSessionState\";\nimport { type DeviceSessionId } from \"@api/device-session/types\";\nimport { type DmkError } from \"@api/Error\";\nimport { bufferToHexaString } from \"@api/index\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { type TransportConnectedDevice } from \"@api/transport/model/TransportConnectedDevice\";\nimport { DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS } from \"@internal/device-session/data/DeviceSessionRefresherConst\";\nimport { MutexService } from \"@internal/device-session/service/MutexService\";\nimport { RefresherService } from \"@internal/device-session/service/RefresherService\";\nimport { type ManagerApiService } from \"@internal/manager-api/service/ManagerApiService\";\nimport { type SecureChannelService } from \"@internal/secure-channel/service/SecureChannelService\";\n\nimport { DevicePinger } from \"./DevicePinger\";\nimport {\n  DeviceSessionEventDispatcher,\n  SessionEvents,\n} from \"./DeviceSessionEventDispatcher\";\nimport { DeviceSessionRefresher } from \"./DeviceSessionRefresher\";\nimport { DeviceSessionStateHandler } from \"./DeviceSessionStateHandler\";\n\nexport type SessionConstructorArgs = {\n  connectedDevice: TransportConnectedDevice;\n  id?: DeviceSessionId;\n};\n\nexport type DeviceSessionRefresherOptions = {\n  isRefresherDisabled: boolean;\n  pollingInterval?: number;\n};\n\ntype SendApduOptions = {\n  isPolling?: boolean;\n  triggersDisconnection?: boolean;\n  abortTimeout?: number;\n};\n\n/**\n * Represents a session with a device.\n */\nexport class DeviceSession {\n  private readonly _id: DeviceSessionId;\n  private readonly _connectedDevice: TransportConnectedDevice;\n  private readonly _deviceState: BehaviorSubject<DeviceSessionState>;\n  private readonly _managerApiService: ManagerApiService;\n  private readonly _secureChannelService: SecureChannelService;\n  private readonly _logger: LoggerPublisherService;\n  private readonly _refresherOptions: DeviceSessionRefresherOptions;\n  private _pinger: DevicePinger;\n  private _deviceSessionRefresher: DeviceSessionRefresher;\n  private readonly _refresherService: RefresherService;\n  private _commandMutex = new MutexService();\n  private _sessionEventDispatcher = new DeviceSessionEventDispatcher();\n\n  constructor(\n    { connectedDevice, id = uuidv4() }: SessionConstructorArgs,\n    loggerModuleFactory: (tag: string) => LoggerPublisherService,\n    managerApiService: ManagerApiService,\n    secureChannelService: SecureChannelService,\n    deviceSessionRefresherOptions: DeviceSessionRefresherOptions | undefined,\n  ) {\n    this._id = id;\n    this._connectedDevice = connectedDevice;\n    this._logger = loggerModuleFactory(\"device-session\");\n    this._managerApiService = managerApiService;\n    this._secureChannelService = secureChannelService;\n    this._refresherOptions = {\n      ...DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS,\n      ...deviceSessionRefresherOptions,\n    };\n    this._deviceState = new BehaviorSubject<DeviceSessionState>({\n      sessionStateType: DeviceSessionStateType.Connected,\n      deviceStatus: DeviceStatus.CONNECTED,\n      deviceModelId: this._connectedDevice.deviceModel.id,\n    });\n\n    this._pinger = new DevicePinger(\n      loggerModuleFactory,\n      connectedDevice,\n      this._sessionEventDispatcher,\n      (command, abortTimeout) => this.sendCommand(command, abortTimeout),\n    );\n    this._deviceSessionRefresher = new DeviceSessionRefresher(\n      loggerModuleFactory,\n      this._refresherOptions,\n      this._sessionEventDispatcher,\n      this._connectedDevice,\n    );\n    new DeviceSessionStateHandler(\n      loggerModuleFactory,\n      this._sessionEventDispatcher,\n      this._connectedDevice,\n      this._deviceState,\n      (state) => this.setDeviceSessionState(state),\n    );\n\n    this._refresherService = new RefresherService(loggerModuleFactory, {\n      start: () => this._deviceSessionRefresher.restartRefresher(),\n      stop: () => this._deviceSessionRefresher.stopRefresher(),\n    });\n  }\n\n  public async initialiseSession(): Promise<void> {\n    try {\n      await this._pinger.ping();\n    } catch (error) {\n      this._logger.error(\"Error while initialising session\", {\n        data: { error },\n      });\n      throw error;\n    } finally {\n      if (!this._refresherOptions.isRefresherDisabled) {\n        this._deviceSessionRefresher.startRefresher();\n      }\n    }\n  }\n\n  public get id(): DeviceSessionId {\n    return this._id;\n  }\n\n  public get connectedDevice(): TransportConnectedDevice {\n    return this._connectedDevice;\n  }\n\n  public get state(): Observable<DeviceSessionState> {\n    return this._deviceState.asObservable();\n  }\n\n  public getDeviceSessionState(): DeviceSessionState {\n    return this._deviceState.getValue();\n  }\n\n  public setDeviceSessionState(state: DeviceSessionState): void {\n    this._deviceState.next(state);\n  }\n\n  public async sendApdu(\n    rawApdu: Uint8Array,\n    options: SendApduOptions = {\n      isPolling: false,\n      triggersDisconnection: false,\n      abortTimeout: undefined,\n    },\n  ): Promise<Either<DmkError, ApduResponse>> {\n    const release = await this._commandMutex.lock();\n\n    try {\n      this._sessionEventDispatcher.dispatch({\n        eventName: SessionEvents.DEVICE_STATE_UPDATE_BUSY,\n      });\n\n      this._logger.debug(`[exchange] => ${bufferToHexaString(rawApdu, false)}`);\n      const result = await this._connectedDevice.sendApdu(\n        rawApdu,\n        options.triggersDisconnection,\n        options.abortTimeout,\n      );\n\n      result\n        .ifRight((response: ApduResponse) => {\n          this._logger.debug(\n            `[exchange] <= ${bufferToHexaString(response.data, false)}${bufferToHexaString(response.statusCode, false)}`,\n          );\n          if (CommandUtils.isLockedDeviceResponse(response)) {\n            this._sessionEventDispatcher.dispatch({\n              eventName: SessionEvents.DEVICE_STATE_UPDATE_LOCKED,\n            });\n          } else {\n            this._sessionEventDispatcher.dispatch({\n              eventName: SessionEvents.DEVICE_STATE_UPDATE_CONNECTED,\n            });\n          }\n        })\n        .ifLeft(() => {\n          this._sessionEventDispatcher.dispatch({\n            eventName: SessionEvents.DEVICE_STATE_UPDATE_CONNECTED,\n          });\n        });\n      return result;\n    } finally {\n      release();\n    }\n  }\n\n  public async sendCommand<Response, Args, ErrorStatusCodes>(\n    command: Command<Response, Args, ErrorStatusCodes>,\n    abortTimeout?: number,\n  ): Promise<CommandResult<Response, ErrorStatusCodes>> {\n    this._logger.debug(`[sendCommand] ${command.name}`);\n    const apdu = command.getApdu();\n\n    const response = await this.sendApdu(apdu.getRawApdu(), {\n      isPolling: false,\n      triggersDisconnection: command.triggersDisconnection ?? false,\n      abortTimeout,\n    });\n\n    return response.caseOf({\n      Left: (err) => {\n        this._logger.error(\"[sendCommand] error\", { data: { err } });\n        throw err;\n      },\n      Right: (r) => {\n        const result = command.parseResponse(\n          r,\n          this._connectedDevice.deviceModel.id,\n        );\n        this._logger.debug(\"[sendCommand] result\", { data: { result } });\n        return result;\n      },\n    });\n  }\n\n  public executeDeviceAction<\n    Output,\n    Input,\n    E extends DmkError,\n    IntermediateValue extends DeviceActionIntermediateValue,\n  >(\n    deviceAction: DeviceAction<Output, Input, E, IntermediateValue>,\n  ): ExecuteDeviceActionReturnType<Output, E, IntermediateValue> {\n    const { observable, cancel } = deviceAction._execute({\n      sendApdu: async (apdu: Uint8Array) => this.sendApdu(apdu),\n      sendCommand: async <Response, ErrorStatusCodes, Args>(\n        command: Command<Response, ErrorStatusCodes, Args>,\n        abortTimeout?: number,\n      ) => this.sendCommand(command, abortTimeout),\n      getDeviceModel: () => this._connectedDevice.deviceModel,\n      getDeviceSessionState: () => this._deviceState.getValue(),\n      getDeviceSessionStateObservable: () => this.state,\n      setDeviceSessionState: (state: DeviceSessionState) => {\n        this.setDeviceSessionState(state);\n        return this._deviceState.getValue();\n      },\n      disableRefresher: (blockerId: string) =>\n        this._refresherService.disableRefresher(blockerId),\n      getManagerApiService: () => this._managerApiService,\n      getSecureChannelService: () => this._secureChannelService,\n    });\n    return { observable, cancel };\n  }\n\n  public close(): void {\n    this._updateDeviceStatus(DeviceStatus.NOT_CONNECTED);\n    this._deviceState.complete();\n    this._deviceSessionRefresher.stopRefresher();\n  }\n\n  public disableRefresher(id: string): () => void {\n    return this._refresherService.disableRefresher(id);\n  }\n\n  private _updateDeviceStatus(deviceStatus: DeviceStatus): void {\n    const state = this._deviceState.getValue();\n    this._deviceState.next({ ...state, deviceStatus });\n  }\n}\n", "export const secureChannelTypes = {\n  SecureChannelService: Symbol.for(\"SecureChannelService\"),\n  SecureChannelDataSource: Symbol.for(\"SecureChannelDataSource\"),\n  DmkConfig: Symbol.for(\"SecureChannelDmkConfig\"),\n};\n", "import { inject, injectable } from \"inversify\";\nimport { EitherAsync } from \"purify-ts\";\n\nimport { DeviceSessionId } from \"@api/device-session/types\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport { DiscoveredDevice } from \"@api/transport/model/DiscoveredDevice\";\nimport { TransportNotSupportedError } from \"@api/transport/model/Errors\";\nimport { DeviceId } from \"@api/types\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport {\n  DeviceSession,\n  DeviceSessionRefresherOptions,\n} from \"@internal/device-session/model/DeviceSession\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\nimport type { ManagerApiService } from \"@internal/manager-api/service/ManagerApiService\";\nimport { secureChannelTypes } from \"@internal/secure-channel/di/secureChannelTypes\";\nimport type { SecureChannelService } from \"@internal/secure-channel/service/SecureChannelService\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\n/**\n * The arguments for the ConnectUseCase.\n */\nexport type ConnectUseCaseArgs = {\n  /**\n   * Discovered device or connected device.\n   */\n  device: DiscoveredDevice | ConnectedDevice;\n\n  /**\n   * sessionRefresherOptions - optional\n   * isRefresherDisabled - whether the refresher is disabled\n   * pollingInterval - optional - the refresh interval in milliseconds\n   */\n  sessionRefresherOptions?: DeviceSessionRefresherOptions;\n};\n\n/**\n * Connects to a discovered device.\n */\n@injectable()\nexport class ConnectUseCase {\n  private readonly _transportService: TransportService;\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _loggerFactory: (tag: string) => LoggerPublisherService;\n  private readonly _managerApi: ManagerApiService;\n  private readonly _secureChannel: SecureChannelService;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(transportDiTypes.TransportService)\n    transportService: TransportService,\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n    @inject(managerApiTypes.ManagerApiService)\n    managerApi: ManagerApiService,\n    @inject(secureChannelTypes.SecureChannelService)\n    secureChannel: SecureChannelService,\n  ) {\n    this._sessionService = sessionService;\n    this._transportService = transportService;\n    this._loggerFactory = loggerFactory;\n    this._logger = loggerFactory(\"ConnectUseCase\");\n    this._managerApi = managerApi;\n    this._secureChannel = secureChannel;\n  }\n\n  private handleDeviceDisconnect(deviceId: DeviceId) {\n    this._sessionService\n      .getDeviceSessionsByDeviceId(deviceId)\n      .ifRight((deviceSessions) => {\n        deviceSessions.forEach((deviceSession) => {\n          this._sessionService.removeDeviceSession(deviceSession.id);\n          this._logger.info(\"Session removed\", {\n            data: { deviceId, sessionId: deviceSession.id },\n          });\n        });\n      });\n  }\n\n  async execute({\n    device,\n    sessionRefresherOptions,\n  }: ConnectUseCaseArgs): Promise<DeviceSessionId> {\n    const transport = this._transportService.getTransport(device.transport);\n    // In case of a connected device, we reconnect using the same session id.\n    // If not provided, a new device session id will be generated.\n    const deviceSessionId =\n      \"sessionId\" in device ? device.sessionId : undefined;\n\n    return EitherAsync.liftEither(\n      transport.toEither(\n        new TransportNotSupportedError(new Error(\"Unknown transport\")),\n      ),\n    )\n      .chain(async (t) => {\n        return t.connect({\n          deviceId: device.id,\n          onDisconnect: (dId) => this.handleDeviceDisconnect(dId),\n        });\n      })\n      .ifLeft((error) => {\n        this._logger.error(\"Error connecting to device\", {\n          data: { deviceId: device.id, error },\n        });\n      })\n      .map(async (connectedDevice) => {\n        const deviceSession = new DeviceSession(\n          { connectedDevice, id: deviceSessionId },\n          this._loggerFactory,\n          this._managerApi,\n          this._secureChannel,\n          sessionRefresherOptions,\n        );\n        this._sessionService.addDeviceSession(deviceSession);\n        await deviceSession.initialiseSession();\n        return deviceSession.id;\n      })\n      .caseOf({\n        Left: (error) => {\n          throw error;\n        },\n        Right: (s) => s,\n      });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { EitherAsync } from \"purify-ts\";\n\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { TransportNotSupportedError } from \"@api/transport/model/Errors\";\nimport type { DeviceSessionId } from \"@api/types\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\n/**\n * The arguments for the DisconnectUseCase.\n */\nexport type DisconnectUseCaseArgs = {\n  /**\n   * Device session identifier from `DeviceManagementKit.connect`.\n   */\n  sessionId: DeviceSessionId;\n};\n\n/**\n * Disconnects to a discovered device.\n */\n@injectable()\nexport class DisconnectUseCase {\n  private readonly _transportService: TransportService;\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(transportDiTypes.TransportService)\n    transportService: TransportService,\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._transportService = transportService;\n    this._logger = loggerFactory(\"DisconnectUseCase\");\n  }\n\n  async execute({ sessionId }: DisconnectUseCaseArgs): Promise<void> {\n    this._logger.debug(\"Disconnecting from device\", {\n      data: {\n        test: this._sessionService\n          .getDeviceSessions()\n          .map((session) => session.id),\n      },\n    });\n    return EitherAsync(async ({ liftEither }) => {\n      const session = await liftEither(\n        this._sessionService.getDeviceSessionById(sessionId).ifLeft((error) => {\n          this._logger.error(\"Device session not found\", {\n            data: { sessionId, error },\n          });\n        }),\n      );\n\n      const transportIdentifier = session.connectedDevice.transport;\n      const transport = await liftEither(\n        this._transportService\n          .getTransport(transportIdentifier)\n          .toEither(\n            new TransportNotSupportedError(new Error(\"Unknown transport\")),\n          ),\n      );\n\n      session.close();\n      this._sessionService.removeDeviceSession(sessionId);\n\n      await transport.disconnect({\n        connectedDevice: session.connectedDevice,\n      });\n    }).caseOf({\n      Left: (error) => {\n        this._logger.error(\"Error disconnecting from device\", {\n          data: { error },\n        });\n        throw error;\n      },\n      Right: () => {},\n    });\n  }\n}\n", "import { type DeviceId, type DeviceModelId } from \"@api/device/DeviceModel\";\nimport { type ConnectionType } from \"@api/discovery/ConnectionType\";\nimport { type TransportConnectedDevice } from \"@api/transport/model/TransportConnectedDevice\";\nimport { type DeviceSessionId, type TransportIdentifier } from \"@api/types\";\n\ntype ConnectedDeviceConstructorArgs = {\n  readonly sessionId: DeviceSessionId;\n  readonly transportConnectedDevice: TransportConnectedDevice;\n};\n\nexport class ConnectedDevice {\n  public readonly id: DeviceId;\n  public readonly sessionId: DeviceSessionId;\n  public readonly modelId: DeviceModelId;\n  public readonly name: string;\n  public readonly type: ConnectionType;\n  public readonly transport: TransportIdentifier;\n\n  constructor({\n    transportConnectedDevice: {\n      id,\n      deviceModel: { id: deviceModelId, productName },\n      type,\n      transport,\n      name,\n    },\n    sessionId,\n  }: ConnectedDeviceConstructorArgs) {\n    this.id = id;\n    this.sessionId = sessionId;\n    this.modelId = deviceModelId;\n    this.name = name ?? productName;\n    this.type = type;\n    this.transport = transport;\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { DeviceSessionId } from \"@api/device-session/types\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type GetConnectedDeviceUseCaseArgs = {\n  sessionId: DeviceSessionId;\n};\n\n/**\n * Get a connected device from deviceSession id.\n */\n@injectable()\nexport class GetConnectedDeviceUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"GetConnectedDeviceUseCase\");\n  }\n\n  execute({ sessionId }: GetConnectedDeviceUseCaseArgs): ConnectedDevice {\n    const deviceSessionOrError =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return deviceSessionOrError.caseOf({\n      Right: (deviceSession) =>\n        new ConnectedDevice({\n          sessionId: deviceSession.id,\n          transportConnectedDevice: deviceSession.connectedDevice,\n        }),\n      Left: (error) => {\n        this._logger.error(\"Error getting session\", {\n          data: { error },\n        });\n        throw error;\n      },\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\n/**\n * List all connected devices.\n */\n@injectable()\nexport class ListConnectedDevicesUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"ListConnectedDeviceUseCase\");\n  }\n\n  execute(): ConnectedDevice[] {\n    this._logger.info(\"Listing connected devices\");\n    return this._sessionService.getDeviceSessions().map(\n      (session) =>\n        new ConnectedDevice({\n          transportConnectedDevice: session.connectedDevice,\n          sessionId: session.id,\n        }),\n    );\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { from, map, merge, Observable, of, scan } from \"rxjs\";\n\nimport { DeviceModel } from \"@api/device/DeviceModel\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DiscoveredDevice } from \"@api/transport/model/DiscoveredDevice\";\nimport { type Transport } from \"@api/transport/model/Transport\";\nimport { type TransportDiscoveredDevice } from \"@api/transport/model/TransportDiscoveredDevice\";\nimport { type TransportIdentifier } from \"@api/transport/model/TransportIdentifier\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\nexport type ListenToAvailableDevicesUseCaseArgs = {\n  /**\n   * Identifier of the transport to start discovering devices.\n   * Can be undefined to discover all available transports in parallel.\n   */\n  transport?: TransportIdentifier;\n};\n\n/**\n * Listen to list of known discovered devices (and later BLE).\n */\n@injectable()\nexport class ListenToAvailableDevicesUseCase {\n  private readonly _transports: Transport[];\n  private readonly _transportService: TransportService;\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(transportDiTypes.TransportService)\n    transportService: TransportService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._transports = transportService.getAllTransports();\n    this._transportService = transportService;\n    this._logger = loggerFactory(\"ListenToAvailableDevicesUseCase\");\n  }\n\n  private mapTransportDiscoveredDeviceToDiscoveredDevice(\n    discoveredDevice: TransportDiscoveredDevice,\n  ): DiscoveredDevice {\n    const deviceModel = new DeviceModel({\n      id: discoveredDevice.id,\n      model: discoveredDevice.deviceModel.id,\n      name: discoveredDevice.deviceModel.productName,\n    });\n    return {\n      id: discoveredDevice.id,\n      deviceModel,\n      transport: discoveredDevice.transport,\n      name: discoveredDevice.name || deviceModel.name,\n      rssi: discoveredDevice.rssi,\n    };\n  }\n\n  execute({ transport }: ListenToAvailableDevicesUseCaseArgs = {}): Observable<\n    DiscoveredDevice[]\n  > {\n    this._logger.info(\"Listening to available devices\");\n\n    if (this._transports.length === 0) {\n      this._logger.warn(\"No transports available\");\n      return from([[]]);\n    }\n\n    if (!transport) {\n      this._logger.info(\"Discovering all available transports\");\n      /**\n       * Note: we're not using combineLatest because combineLatest will\n       * - wait for all observables to emit at least once before emitting.\n       * - complete as soon as one of the observables completes.\n       * Some transports will just return an empty array and complete.\n       * We want to keep listening to all transports until all have completed.\n       */\n\n      const observablesWithIndex = this._transports.map((t, index) =>\n        t.listenToAvailableDevices().pipe(\n          map((arr) => ({\n            index,\n            arr,\n          })),\n        ),\n      );\n\n      return merge(...observablesWithIndex).pipe(\n        scan<\n          { index: number; arr: TransportDiscoveredDevice[] },\n          { [key: number]: TransportDiscoveredDevice[] }\n        >((acc, { index, arr }) => {\n          acc[index] = arr;\n          return acc;\n        }, {}),\n        map((acc) =>\n          Object.values(acc)\n            .flat()\n            .map(this.mapTransportDiscoveredDeviceToDiscoveredDevice),\n        ),\n      );\n    }\n\n    this._logger.info(`Discovering devices on transport ${transport}`);\n\n    const instance = this._transportService.getTransport(transport);\n\n    return instance.caseOf({\n      Nothing: () => {\n        this._logger.error(`Transport ${transport} not found`);\n        return of([]);\n      },\n      Just: (t) => {\n        return t\n          .listenToAvailableDevices()\n          .pipe(\n            map((devices) =>\n              devices.map(this.mapTransportDiscoveredDeviceToDiscoveredDevice),\n            ),\n          );\n      },\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { map, Observable } from \"rxjs\";\n\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\n/**\n * Listen to connected devices\n */\n@injectable()\nexport class ListenToConnectedDeviceUseCase {\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    private readonly _sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._logger = loggerFactory(\"ListenToConnectedDeviceUseCase\");\n  }\n\n  execute(): Observable<ConnectedDevice> {\n    this._logger.info(\"Observe connected devices\");\n    return this._sessionService.sessionsObs.pipe(\n      map(\n        (deviceSession) =>\n          new ConnectedDevice({\n            transportConnectedDevice: deviceSession.connectedDevice,\n            sessionId: deviceSession.id,\n          }),\n      ),\n    );\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { DeviceSessionId } from \"@api/device-session/types\";\nimport { ConnectedDevice } from \"@api/index\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DeviceSessionRefresherOptions } from \"@internal/device-session/model/DeviceSession\";\nimport { discoveryTypes } from \"@internal/discovery/di/discoveryTypes\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nimport { ConnectUseCase } from \"./ConnectUseCase\";\nimport { DisconnectUseCase } from \"./DisconnectUseCase\";\n\n/**\n * The arguments for the ReconnectUseCase.\n */\nexport type ReconnectUseCaseArgs = {\n  /**\n   * Connected device\n   */\n  device: ConnectedDevice;\n\n  /**\n   * sessionRefresherOptions - optional\n   * isRefresherDisabled - whether the refresher is disabled\n   * pollingInterval - optional - the refresh interval in milliseconds\n   */\n  sessionRefresherOptions?: DeviceSessionRefresherOptions;\n};\n\n/**\n * Reconnects a device session by disconnecting and reconnecting to the device.\n */\n@injectable()\nexport class ReconnectUseCase {\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(discoveryTypes.ConnectUseCase)\n    private readonly connectUseCase: ConnectUseCase,\n    @inject(discoveryTypes.DisconnectUseCase)\n    private readonly disconnectUseCase: DisconnectUseCase,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._logger = loggerFactory(\"ReconnectUseCase\");\n  }\n\n  async execute({\n    device,\n    sessionRefresherOptions,\n  }: ReconnectUseCaseArgs): Promise<DeviceSessionId> {\n    this._logger.debug(\"Reconnecting device session\", {\n      data: { deviceId: device.id, transport: device.transport },\n    });\n    await this.disconnectUseCase.execute({ sessionId: device.sessionId });\n\n    return this.connectUseCase.execute({\n      device,\n      sessionRefresherOptions,\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { map, mergeMap, Observable, of } from \"rxjs\";\n\nimport { DeviceModel } from \"@api/device/DeviceModel\";\nimport { DiscoveredDevice } from \"@api/transport/model/DiscoveredDevice\";\nimport { TransportNotSupportedError } from \"@api/transport/model/Errors\";\nimport { TransportDiscoveredDevice } from \"@api/transport/model/TransportDiscoveredDevice\";\nimport { TransportIdentifier } from \"@api/transport/model/TransportIdentifier\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\nexport type StartDiscoveringUseCaseArgs = {\n  /**\n   * Identifier of the transport to start discovering devices.\n   * Can be undefined to discover all available transports in parralel.\n   */\n  transport?: TransportIdentifier;\n};\n\n/**\n * Starts discovering devices connected.\n *\n * For the WebHID implementation, this use-case needs to be called as a result of an user interaction (button \"click\" event for ex).\n */\n@injectable()\nexport class StartDiscoveringUseCase {\n  constructor(\n    @inject(transportDiTypes.TransportService)\n    private readonly _transportService: TransportService,\n  ) {}\n\n  private mapDiscoveredDevice(\n    device: TransportDiscoveredDevice,\n  ): DiscoveredDevice {\n    const deviceModel = new DeviceModel({\n      id: device.id,\n      model: device.deviceModel.id,\n      name: device.deviceModel.productName,\n    });\n    return {\n      id: device.id,\n      deviceModel,\n      transport: device.transport,\n      name: device.name || deviceModel.name,\n      rssi: device.rssi,\n    };\n  }\n\n  execute({\n    transport,\n  }: StartDiscoveringUseCaseArgs = {}): Observable<DiscoveredDevice> {\n    if (!transport) {\n      const transports = this._transportService.getAllTransports();\n      return of(...transports).pipe(\n        mergeMap((instance) =>\n          instance\n            .startDiscovering()\n            .pipe(map((device) => this.mapDiscoveredDevice(device))),\n        ),\n      );\n    }\n\n    const instance = this._transportService.getTransport(transport);\n\n    return instance.caseOf({\n      Just: (t) => {\n        return t\n          .startDiscovering()\n          .pipe(map((device) => this.mapDiscoveredDevice(device)));\n      },\n      Nothing: () => {\n        throw new TransportNotSupportedError(new Error(\"Unknown transport\"));\n      },\n    });\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { LoggerPublisherService } from \"@api/types\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\n/**\n * Stops discovering devices connected.\n */\n@injectable()\nexport class StopDiscoveringUseCase {\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(transportDiTypes.TransportService)\n    private transportService: TransportService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._logger = loggerFactory(\"StopDiscoveringUseCase\");\n  }\n\n  async execute(): Promise<void> {\n    this._logger.debug(\"Stopping discovering devices\");\n    for (const transport of this.transportService.getAllTransports()) {\n      await transport.stopDiscovering();\n    }\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { ConnectUseCase } from \"@internal/discovery/use-case/ConnectUseCase\";\nimport { DisconnectUseCase } from \"@internal/discovery/use-case/DisconnectUseCase\";\nimport { GetConnectedDeviceUseCase } from \"@internal/discovery/use-case/GetConnectedDeviceUseCase\";\nimport { ListConnectedDevicesUseCase } from \"@internal/discovery/use-case/ListConnectedDevicesUseCase\";\nimport { ListenToAvailableDevicesUseCase } from \"@internal/discovery/use-case/ListenToAvailableDevicesUseCase\";\nimport { ListenToConnectedDeviceUseCase } from \"@internal/discovery/use-case/ListenToConnectedDeviceUseCase\";\nimport { ReconnectUseCase } from \"@internal/discovery/use-case/ReconnectUseCase\";\nimport { StartDiscoveringUseCase } from \"@internal/discovery/use-case/StartDiscoveringUseCase\";\nimport { StopDiscoveringUseCase } from \"@internal/discovery/use-case/StopDiscoveringUseCase\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { discoveryTypes } from \"./discoveryTypes\";\n\ntype FactoryProps = {\n  stub: boolean;\n};\n\nexport const discoveryModuleFactory = ({ stub = false }: FactoryProps) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(discoveryTypes.ConnectUseCase).to(ConnectUseCase);\n    bind(discoveryTypes.DisconnectUseCase).to(DisconnectUseCase);\n    bind(discoveryTypes.ReconnectUseCase).to(ReconnectUseCase);\n    bind(discoveryTypes.StartDiscoveringUseCase).to(StartDiscoveringUseCase);\n    bind(discoveryTypes.StopDiscoveringUseCase).to(StopDiscoveringUseCase);\n    bind(discoveryTypes.GetConnectedDeviceUseCase).to(\n      GetConnectedDeviceUseCase,\n    );\n    bind(discoveryTypes.ListenToAvailableDevicesUseCase).to(\n      ListenToAvailableDevicesUseCase,\n    );\n    bind(discoveryTypes.ListenToConnectedDeviceUseCase).to(\n      ListenToConnectedDeviceUseCase,\n    );\n    bind(discoveryTypes.ListConnectedDevicesUseCase).to(\n      ListConnectedDevicesUseCase,\n    );\n\n    if (stub) {\n      rebindSync(discoveryTypes.ConnectUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.DisconnectUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.StartDiscoveringUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.StopDiscoveringUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.GetConnectedDeviceUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.ListenToAvailableDevicesUseCase).to(\n        StubUseCase,\n      );\n      rebindSync(discoveryTypes.ListenToConnectedDeviceUseCase).to(StubUseCase);\n      rebindSync(discoveryTypes.ListConnectedDevicesUseCase).to(StubUseCase);\n    }\n  });\n", "export enum LogLevel {\n  Fatal = 0,\n  Error = 1,\n  Warning = 2,\n  Info = 3,\n  Debug = 4,\n}\n", "import { injectable } from \"inversify\";\n\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { LogLevel } from \"@api/logger-subscriber/model/LogLevel\";\nimport { LogSubscriberOptions } from \"@api/logger-subscriber/model/LogSubscriberOptions\";\nimport { LoggerSubscriberService } from \"@api/logger-subscriber/service/LoggerSubscriberService\";\nimport { LogPublisherOptions } from \"@internal/logger-publisher/model/LogPublisherOptions\";\n\n@injectable()\nexport class DefaultLoggerPublisherService implements LoggerPublisherService {\n  subscribers: LoggerSubscriberService[];\n  tag: string;\n\n  constructor(subscribers: LoggerSubscriberService[], tag: string) {\n    this.subscribers = subscribers;\n    this.tag = tag;\n  }\n\n  _log(level: LogLevel, message: string, options?: LogPublisherOptions): void {\n    this.subscribers.forEach((subscriber) => {\n      const subscriberOptions: LogSubscriberOptions = {\n        timestamp: Date.now(),\n        tag: this.tag,\n        ...options,\n      };\n      subscriber.log(level, message, subscriberOptions);\n    });\n  }\n\n  info(message: string, options?: LogPublisherOptions): void {\n    this._log(LogLevel.Info, message, options);\n  }\n\n  warn(message: string, options?: LogPublisherOptions): void {\n    this._log(LogLevel.Warning, message, options);\n  }\n\n  debug(message: string, options?: LogPublisherOptions): void {\n    this._log(LogLevel.Debug, message, options);\n  }\n\n  error(message: string, options?: LogPublisherOptions): void {\n    this._log(LogLevel.Error, message, options);\n  }\n}\n", "import { ContainerModule, type Factory } from \"inversify\";\n\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { type LoggerSubscriberService } from \"@api/logger-subscriber/service/LoggerSubscriberService\";\nimport { DefaultLoggerPublisherService } from \"@internal/logger-publisher/service/DefaultLoggerPublisherService\";\n\nimport { loggerTypes } from \"./loggerTypes\";\n\ntype FactoryProps = {\n  subscribers: LoggerSubscriberService[];\n};\n\nexport const loggerModuleFactory = (\n  { subscribers }: FactoryProps = { subscribers: [] },\n) =>\n  new ContainerModule(({ bind }) => {\n    bind<Factory<LoggerPublisherService>>(\n      loggerTypes.LoggerPublisherServiceFactory,\n    ).toFactory((_context) => {\n      return (tag: string) =>\n        new DefaultLoggerPublisherService(subscribers, tag);\n    });\n  });\n", "'use strict';\n\n/**\n * Create a bound version of a function with a specified `this` context\n *\n * @param {Function} fn - The function to bind\n * @param {*} thisArg - The value to be passed as the `this` parameter\n * @returns {Function} A new function that will call the original function with the specified `this` context\n */\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n", "'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is an empty object (safely handles Buffers)\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an empty object, otherwise false\n */\nconst isEmptyObject = (val) => {\n  // Early return for non-objects or Buffers to prevent RangeError\n  if (!isObject(val) || isBuffer(val)) {\n    return false;\n  }\n\n  try {\n    return Object.keys(val).length === 0 && Object.getPrototypeOf(val) === Object.prototype;\n  } catch (e) {\n    // Fallback for any other objects that might cause RangeError with Object.keys()\n    return false;\n  }\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Buffer check\n    if (isBuffer(obj)) {\n      return;\n    }\n\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  if (isBuffer(obj)){\n    return null;\n  }\n\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless, skipUndefined} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else if (!skipUndefined || !isUndefined(val)) {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      //Buffer check\n      if (isBuffer(source)) {\n        return source;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isEmptyObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n", "'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  const msg = error && error.message ? error.message : 'Error';\n\n  // Prefer explicit code; otherwise copy the low-level error's code (e.g. ECONNREFUSED)\n  const errCode = code == null && error ? error.code : code;\n  AxiosError.call(axiosError, msg, errCode, config, request, response);\n\n  // Chain the original error on the standard field; non-enumerable to avoid JSON noise\n  if (error && axiosError.cause == null) {\n    Object.defineProperty(axiosError, 'cause', { value: error, configurable: true });\n  }\n\n  axiosError.name = (error && error.name) || 'Error';\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n", "// eslint-disable-next-line strict\nexport default null;\n", "'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (utils.isBoolean(value)) {\n      return value.toString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n", "'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n", "'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n", "'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {void}\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n", "'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n", "'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n", "'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n", "'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n", "import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n", "const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n", "import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n", "'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), {\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    },\n    ...options\n  });\n}\n", "'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n", "'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data, this.parseReviver);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n", "'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n", "'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n", "'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n", "'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n", "'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n", "'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n", "'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n", "'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n", "/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn(...args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n", "import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n", "import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n", "import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure, sameSite) {\n      if (typeof document === 'undefined') return;\n\n      const cookie = [`${name}=${encodeURIComponent(value)}`];\n\n      if (utils.isNumber(expires)) {\n        cookie.push(`expires=${new Date(expires).toUTCString()}`);\n      }\n      if (utils.isString(path)) {\n        cookie.push(`path=${path}`);\n      }\n      if (utils.isString(domain)) {\n        cookie.push(`domain=${domain}`);\n      }\n      if (secure === true) {\n        cookie.push('secure');\n      }\n      if (utils.isString(sameSite)) {\n        cookie.push(`SameSite=${sameSite}`);\n      }\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      if (typeof document === 'undefined') return null;\n      const match = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));\n      return match ? decodeURIComponent(match[1]) : null;\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000, '/');\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n", "'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n", "'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n", "'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n", "'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop, caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop, caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop, caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b, prop) => mergeDeepProperties(headersToObject(a), headersToObject(b), prop, true)\n  };\n\n  utils.forEach(Object.keys({...config1, ...config2}), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n", "import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let { data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth } = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // browser handles it\n    } else if (utils.isFunction(data.getHeaders)) {\n      // Node.js FormData (like form-data package)\n      const formHeaders = data.getHeaders();\n      // Only set safe headers to avoid overwriting security headers\n      const allowedHeaders = ['content-type', 'content-length'];\n      Object.entries(formHeaders).forEach(([key, val]) => {\n        if (allowedHeaders.includes(key.toLowerCase())) {\n          headers.set(key, val);\n        }\n      });\n    }\n  }  \n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n", "import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n  request.onerror = function handleError(event) {\n       // Browsers deliver a ProgressEvent in XHR onerror\n       // (message may be empty; when present, surface it)\n       // See https://developer.mozilla.org/docs/Web/API/XMLHttpRequest/error_event\n       const msg = event && event.message ? event.message : 'Network Error';\n       const err = new AxiosError(msg, AxiosError.ERR_NETWORK, config, request);\n       // attach the underlying event for consumers who want details\n       err.event = event || null;\n       reject(err);\n       request = null;\n    };\n    \n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n", "import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n", "\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n", "import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst {isFunction} = utils;\n\nconst globalFetchAPI = (({Request, Response}) => ({\n  Request, Response\n}))(utils.global);\n\nconst {\n  ReadableStream, TextEncoder\n} = utils.global;\n\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst factory = (env) => {\n  env = utils.merge.call({\n    skipUndefined: true\n  }, globalFetchAPI, env);\n\n  const {fetch: envFetch, Request, Response} = env;\n  const isFetchSupported = envFetch ? isFunction(envFetch) : typeof fetch === 'function';\n  const isRequestSupported = isFunction(Request);\n  const isResponseSupported = isFunction(Response);\n\n  if (!isFetchSupported) {\n    return false;\n  }\n\n  const isReadableStreamSupported = isFetchSupported && isFunction(ReadableStream);\n\n  const encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n      ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n      async (str) => new Uint8Array(await new Request(str).arrayBuffer())\n  );\n\n  const supportsRequestStream = isRequestSupported && isReadableStreamSupported && test(() => {\n    let duplexAccessed = false;\n\n    const hasContentType = new Request(platform.origin, {\n      body: new ReadableStream(),\n      method: 'POST',\n      get duplex() {\n        duplexAccessed = true;\n        return 'half';\n      },\n    }).headers.has('Content-Type');\n\n    return duplexAccessed && !hasContentType;\n  });\n\n  const supportsResponseStream = isResponseSupported && isReadableStreamSupported &&\n    test(() => utils.isReadableStream(new Response('').body));\n\n  const resolvers = {\n    stream: supportsResponseStream && ((res) => res.body)\n  };\n\n  isFetchSupported && ((() => {\n    ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n      !resolvers[type] && (resolvers[type] = (res, config) => {\n        let method = res && res[type];\n\n        if (method) {\n          return method.call(res);\n        }\n\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n    });\n  })());\n\n  const getBodyLength = async (body) => {\n    if (body == null) {\n      return 0;\n    }\n\n    if (utils.isBlob(body)) {\n      return body.size;\n    }\n\n    if (utils.isSpecCompliantForm(body)) {\n      const _request = new Request(platform.origin, {\n        method: 'POST',\n        body,\n      });\n      return (await _request.arrayBuffer()).byteLength;\n    }\n\n    if (utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n      return body.byteLength;\n    }\n\n    if (utils.isURLSearchParams(body)) {\n      body = body + '';\n    }\n\n    if (utils.isString(body)) {\n      return (await encodeText(body)).byteLength;\n    }\n  }\n\n  const resolveBodyLength = async (headers, body) => {\n    const length = utils.toFiniteNumber(headers.getContentLength());\n\n    return length == null ? getBodyLength(body) : length;\n  }\n\n  return async (config) => {\n    let {\n      url,\n      method,\n      data,\n      signal,\n      cancelToken,\n      timeout,\n      onDownloadProgress,\n      onUploadProgress,\n      responseType,\n      headers,\n      withCredentials = 'same-origin',\n      fetchOptions\n    } = resolveConfig(config);\n\n    let _fetch = envFetch || fetch;\n\n    responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n    let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n    let request = null;\n\n    const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n    });\n\n    let requestContentLength;\n\n    try {\n      if (\n        onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n        (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n      ) {\n        let _request = new Request(url, {\n          method: 'POST',\n          body: data,\n          duplex: \"half\"\n        });\n\n        let contentTypeHeader;\n\n        if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n          headers.setContentType(contentTypeHeader)\n        }\n\n        if (_request.body) {\n          const [onProgress, flush] = progressEventDecorator(\n            requestContentLength,\n            progressEventReducer(asyncDecorator(onUploadProgress))\n          );\n\n          data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n        }\n      }\n\n      if (!utils.isString(withCredentials)) {\n        withCredentials = withCredentials ? 'include' : 'omit';\n      }\n\n      // Cloudflare Workers throws when credentials are defined\n      // see https://github.com/cloudflare/workerd/issues/902\n      const isCredentialsSupported = isRequestSupported && \"credentials\" in Request.prototype;\n\n      const resolvedOptions = {\n        ...fetchOptions,\n        signal: composedSignal,\n        method: method.toUpperCase(),\n        headers: headers.normalize().toJSON(),\n        body: data,\n        duplex: \"half\",\n        credentials: isCredentialsSupported ? withCredentials : undefined\n      };\n\n      request = isRequestSupported && new Request(url, resolvedOptions);\n\n      let response = await (isRequestSupported ? _fetch(request, fetchOptions) : _fetch(url, resolvedOptions));\n\n      const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n      if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n        const options = {};\n\n        ['status', 'statusText', 'headers'].forEach(prop => {\n          options[prop] = response[prop];\n        });\n\n        const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n        const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n          responseContentLength,\n          progressEventReducer(asyncDecorator(onDownloadProgress), true)\n        ) || [];\n\n        response = new Response(\n          trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n            flush && flush();\n            unsubscribe && unsubscribe();\n          }),\n          options\n        );\n      }\n\n      responseType = responseType || 'text';\n\n      let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n      !isStreamResponse && unsubscribe && unsubscribe();\n\n      return await new Promise((resolve, reject) => {\n        settle(resolve, reject, {\n          data: responseData,\n          headers: AxiosHeaders.from(response.headers),\n          status: response.status,\n          statusText: response.statusText,\n          config,\n          request\n        })\n      })\n    } catch (err) {\n      unsubscribe && unsubscribe();\n\n      if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n        throw Object.assign(\n          new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n          {\n            cause: err.cause || err\n          }\n        )\n      }\n\n      throw AxiosError.from(err, err && err.code, config, request);\n    }\n  }\n}\n\nconst seedCache = new Map();\n\nexport const getFetch = (config) => {\n  let env = (config && config.env) || {};\n  const {fetch, Request, Response} = env;\n  const seeds = [\n    Request, Response, fetch\n  ];\n\n  let len = seeds.length, i = len,\n    seed, target, map = seedCache;\n\n  while (i--) {\n    seed = seeds[i];\n    target = map.get(seed);\n\n    target === undefined && map.set(seed, target = (i ? new Map() : factory(env)))\n\n    map = target;\n  }\n\n  return target;\n};\n\nconst adapter = getFetch();\n\nexport default adapter;\n", "import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport * as fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\n/**\n * Known adapters mapping.\n * Provides environment-specific adapters for Axios:\n * - `http` for Node.js\n * - `xhr` for browsers\n * - `fetch` for fetch API-based requests\n * \n * @type {Object<string, Function|Object>}\n */\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: {\n    get: fetchAdapter.getFetch,\n  }\n};\n\n// Assign adapter names for easier debugging and identification\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', { value });\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', { value });\n  }\n});\n\n/**\n * Render a rejection reason string for unknown or unsupported adapters\n * \n * @param {string} reason\n * @returns {string}\n */\nconst renderReason = (reason) => `- ${reason}`;\n\n/**\n * Check if the adapter is resolved (function, null, or false)\n * \n * @param {Function|null|false} adapter\n * @returns {boolean}\n */\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\n/**\n * Get the first suitable adapter from the provided list.\n * Tries each adapter in order until a supported one is found.\n * Throws an AxiosError if no adapter is suitable.\n * \n * @param {Array<string|Function>|string|Function} adapters - Adapter(s) by name or function.\n * @param {Object} config - Axios request configuration\n * @throws {AxiosError} If no suitable adapter is available\n * @returns {Function} The resolved adapter function\n */\nfunction getAdapter(adapters, config) {\n  adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n  const { length } = adapters;\n  let nameOrAdapter;\n  let adapter;\n\n  const rejectedReasons = {};\n\n  for (let i = 0; i < length; i++) {\n    nameOrAdapter = adapters[i];\n    let id;\n\n    adapter = nameOrAdapter;\n\n    if (!isResolvedHandle(nameOrAdapter)) {\n      adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n      if (adapter === undefined) {\n        throw new AxiosError(`Unknown adapter '${id}'`);\n      }\n    }\n\n    if (adapter && (utils.isFunction(adapter) || (adapter = adapter.get(config)))) {\n      break;\n    }\n\n    rejectedReasons[id || '#' + i] = adapter;\n  }\n\n  if (!adapter) {\n    const reasons = Object.entries(rejectedReasons)\n      .map(([id, state]) => `adapter ${id} ` +\n        (state === false ? 'is not supported by the environment' : 'is not available in the build')\n      );\n\n    let s = length ?\n      (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n      'as no adapter specified';\n\n    throw new AxiosError(\n      `There is no suitable adapter to dispatch the request ` + s,\n      'ERR_NOT_SUPPORT'\n    );\n  }\n\n  return adapter;\n}\n\n/**\n * Exports Axios adapters and utility to resolve an adapter\n */\nexport default {\n  /**\n   * Resolve an adapter from a list of adapter names or functions.\n   * @type {Function}\n   */\n  getAdapter,\n\n  /**\n   * Exposes all known adapters\n   * @type {Object<string, Function|Object>}\n   */\n  adapters: knownAdapters\n};\n", "'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter, config);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n", "export const VERSION = \"1.13.2\";", "'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n", "'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift(...requestInterceptorChain);\n      chain.push(...responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n", "'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n", "'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n", "'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n", "const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n  WebServerIsDown: 521,\n  ConnectionTimedOut: 522,\n  OriginIsUnreachable: 523,\n  TimeoutOccurred: 524,\n  SslHandshakeFailed: 525,\n  InvalidSslCertificate: 526,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n", "'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n", "import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n", "export enum AppType {\n  currency = \"currency\",\n  plugin = \"plugin\",\n  tool = \"tool\",\n  swap = \"swap\",\n}\n\nexport type Application = {\n  versionId: number;\n  versionName: string;\n  versionDisplayName: string | null;\n  version: string;\n  currencyId: string | null;\n  description: string | null;\n  applicationType: AppType | null;\n  dateModified: string;\n  icon: string | null;\n  authorName: string | null;\n  supportURL: string | null;\n  contactURL: string | null;\n  sourceURL: string | null;\n  compatibleWallets: string | null;\n  hash: string;\n  perso: string;\n  firmware: string;\n  firmwareKey: string;\n  delete: string;\n  deleteKey: string;\n  bytes: number | null;\n  warning: string | null;\n  isDevTools: boolean;\n  category: number | null;\n  parent: number | null;\n  parentName: string | null;\n};\n", "export const DEFAULT_MANAGER_API_BASE_URL =\n  \"https://manager.api.live.ledger.com/api\";\nexport const DEFAULT_MOCK_SERVER_BASE_URL = \"http://localhost:8080\";\nexport const DEFAULT_PROVIDER = 1;\nexport const DEFAULT_FIRMWARE_DISTRIBUTION_SALT = \"0\";\n", "import { type DmkError } from \"@api/Error\";\n\nexport class HttpFetchApiError implements DmkError {\n  _tag = \"FetchError\";\n  originalError?: unknown;\n\n  constructor(public readonly error: unknown) {\n    this.originalError = error;\n  }\n}\n", "export type Id = number;\n\nexport enum AppTypeDto {\n  currency = \"currency\",\n  plugin = \"plugin\",\n  tool = \"tool\",\n  swap = \"swap\",\n}\n\nexport type DeviceVersionDto = {\n  id: Id | null;\n  name: string;\n  display_name: string | null;\n  target_id: string | null;\n  description: string | null;\n  device: Id;\n  providers: Id[];\n  mcu_versions: Id[];\n  se_firmware_final_versions: Id[];\n  osu_versions: Id[];\n  application_versions: Id[];\n  date_creation: string | null;\n  date_last_modified: string | null;\n};\n\nexport type ApplicationDto = {\n  versionId: Id;\n  versionName: string;\n  versionDisplayName: string | null;\n  version: string;\n  currencyId: string | null;\n  description: string | null;\n  applicationType: AppTypeDto | null;\n  dateModified: string;\n  icon: string | null;\n  authorName: string | null;\n  supportURL: string | null;\n  contactURL: string | null;\n  sourceURL: string | null;\n  compatibleWallets: string | null;\n  hash: string | null;\n  perso: string | null;\n  firmware: string | null;\n  firmwareKey: string | null;\n  delete: string | null;\n  deleteKey: string | null;\n  bytes: number | null;\n  warning: string | null;\n  isDevTools: boolean;\n  category: number | null;\n  parent: number | null;\n  parentName: string | null;\n};\n\nexport type FirmwareOsuVersionDto = {\n  id: Id;\n  name: string;\n  description: string | null;\n  display_name: string | null;\n  notes: string | null;\n  perso: string | null;\n  firmware: string | null;\n  firmware_key: string | null;\n  hash: string | null;\n  next_se_firmware_final_version: Id | null;\n  previous_se_firmware_final_versions: Id[];\n  date_creation: string;\n  date_last_modified: string;\n  device_versions: Id[];\n  providers: Id[];\n  minimum_live_common_version: string | null;\n};\n\nexport type FirmwareFinalVersionDto = {\n  id: Id;\n  name: string;\n  version: string;\n  se_firmware: Id | null;\n  description: string | null;\n  display_name: string | null;\n  notes: string | null;\n  perso: string | null;\n  firmware: string | null;\n  firmware_key: string | null;\n  hash: string | null;\n  distribution_ratio: number | null;\n  exclude_by_default: boolean;\n  osu_versions: FirmwareOsuVersionDto[];\n  date_creation: string;\n  date_last_modified: string;\n  device_versions: Id[];\n  mcu_versions: Id[];\n  application_versions: Id[];\n  providers: Id[];\n  bytes: number | null;\n};\n\nexport type LatestFirmwareOsuVersionResponseDto = {\n  result: string;\n  se_firmware_osu_version: FirmwareOsuVersionDto | null;\n};\n\nexport type McuVersionDto = {\n  id: Id;\n  mcu: Id;\n  name: string;\n  description: string | null;\n  providers: Id[];\n  device_versions: Id[];\n  from_bootloader_version: string;\n  from_bootloader_version_id: Id | null;\n  se_firmware_final_versions: Id[];\n  date_creation: string;\n  date_last_modified: string;\n};\n\nexport type LanguagePackageVersionDto = {\n  language: string;\n  languagePackageVersionId: Id;\n  version: string;\n  language_package_id: Id;\n  apdu_install_url: string;\n  apdu_uninstall_url: string;\n  device_versions: Id[];\n  se_firmware_final_versions: Id[];\n  bytes: number;\n  date_creation: string;\n  date_last_modified: string;\n};\n", "import axios from \"axios\";\nimport { inject, injectable } from \"inversify\";\nimport { EitherAsync } from \"purify-ts\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\nimport {\n  type Application,\n  AppType,\n} from \"@internal/manager-api/model/Application\";\nimport { DEFAULT_PROVIDER } from \"@internal/manager-api/model/Const\";\nimport { DEFAULT_FIRMWARE_DISTRIBUTION_SALT } from \"@internal/manager-api/model/Const\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { HttpFetchApiError } from \"@internal/manager-api/model/Errors\";\nimport type {\n  FinalFirmware,\n  McuFirmware,\n  OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport { type LanguagePackage } from \"@internal/manager-api/model/Language\";\nimport {\n  type GetAppByHashParams,\n  type GetAppListParams,\n  type GetDeviceVersionParams,\n  type GetFirmwareVersionParams,\n  type GetLanguagePackagesParams,\n  type GetLatestFirmwareVersionParams,\n} from \"@internal/manager-api/model/Params\";\n\nimport { ManagerApiDataSource } from \"./ManagerApiDataSource\";\nimport {\n  ApplicationDto,\n  AppTypeDto,\n  DeviceVersionDto,\n  FirmwareFinalVersionDto,\n  FirmwareOsuVersionDto,\n  LanguagePackageVersionDto,\n  LatestFirmwareOsuVersionResponseDto,\n  McuVersionDto,\n} from \"./ManagerApiDto\";\n\n@injectable()\nexport class AxiosManagerApiDataSource implements ManagerApiDataSource {\n  private readonly _managerApiBaseUrl: string;\n  private _provider: number = DEFAULT_PROVIDER;\n  private _firmwareDistributionSalt: string =\n    DEFAULT_FIRMWARE_DISTRIBUTION_SALT;\n\n  constructor(\n    @inject(managerApiTypes.DmkConfig)\n    { managerApiUrl, provider, firmwareDistributionSalt }: DmkConfig,\n  ) {\n    this._managerApiBaseUrl = managerApiUrl;\n    this._provider = provider;\n    this._firmwareDistributionSalt = firmwareDistributionSalt;\n  }\n\n  setProvider(provider: number): void {\n    if (this._provider === provider || provider < 1) {\n      return;\n    }\n    this._provider = provider;\n  }\n\n  getProvider(): number {\n    return this._provider;\n  }\n\n  getAppList(\n    params: GetAppListParams,\n  ): EitherAsync<HttpFetchApiError, Array<Application>> {\n    const { targetId, firmwareVersionName } = params;\n    return EitherAsync(() =>\n      axios.get<Array<ApplicationDto>>(\n        `${this._managerApiBaseUrl}/v2/apps/by-target`,\n        {\n          params: {\n            target_id: targetId,\n            provider: this._provider,\n            firmware_version_name: firmwareVersionName,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((apps) => this.mapApplicationDtoToApplication(apps))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getMcuList(): EitherAsync<HttpFetchApiError, Array<McuFirmware>> {\n    return EitherAsync(() =>\n      axios.get<Array<McuVersionDto>>(\n        `${this._managerApiBaseUrl}/mcu_versions`,\n        {},\n      ),\n    )\n      .map((res) => res.data)\n      .chain((mcus) => this.mapMcuDtoToMcu(mcus))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getDeviceVersion(\n    params: GetDeviceVersionParams,\n  ): EitherAsync<HttpFetchApiError, DeviceVersion> {\n    const { targetId } = params;\n    return EitherAsync(() =>\n      axios.get<DeviceVersionDto>(\n        `${this._managerApiBaseUrl}/get_device_version`,\n        {\n          params: {\n            target_id: targetId,\n            provider: this._provider,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((deviceVersion) => this.mapDeviceVersionDto(deviceVersion))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getFirmwareVersion(\n    params: GetFirmwareVersionParams,\n  ): EitherAsync<HttpFetchApiError, FinalFirmware> {\n    const { deviceId, version } = params;\n    return EitherAsync(() =>\n      axios.get<FirmwareFinalVersionDto>(\n        `${this._managerApiBaseUrl}/get_firmware_version`,\n        {\n          params: {\n            device_version: deviceId,\n            version_name: version,\n            provider: this._provider,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((finalFirmware) => this.mapFinalFirmwareDto(finalFirmware))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getFirmwareVersionById(\n    finalFirmwareId: number,\n  ): EitherAsync<HttpFetchApiError, FinalFirmware> {\n    return EitherAsync(() =>\n      axios.get<FirmwareFinalVersionDto>(\n        `${this._managerApiBaseUrl}/firmware_final_versions/${finalFirmwareId}`,\n        {},\n      ),\n    )\n      .map((res) => res.data)\n      .chain((finalFirmware) => this.mapFinalFirmwareDto(finalFirmware))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getOsuFirmwareVersion(\n    params: GetFirmwareVersionParams,\n  ): EitherAsync<HttpFetchApiError, OsuFirmware> {\n    const { deviceId, version } = params;\n    return EitherAsync(() =>\n      axios.get<FirmwareOsuVersionDto>(\n        `${this._managerApiBaseUrl}/get_osu_version`,\n        {\n          params: {\n            device_version: deviceId,\n            version_name: version,\n            provider: this._provider,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((osuFirmware) => this.mapOsuFirmwareDto(osuFirmware))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getLatestFirmwareVersion(\n    params: GetLatestFirmwareVersionParams,\n  ): EitherAsync<HttpFetchApiError, OsuFirmware> {\n    const livecommonversion = \"34.27.0\"; // Legacy parameter that should just be a too old\n    const { currentFinalFirmwareId, deviceId } = params;\n    return EitherAsync(() =>\n      axios.get<LatestFirmwareOsuVersionResponseDto>(\n        `${this._managerApiBaseUrl}/get_latest_firmware`,\n        {\n          params: {\n            current_se_firmware_final_version: currentFinalFirmwareId,\n            device_version: deviceId,\n            provider: this._provider,\n            salt: this._firmwareDistributionSalt,\n            livecommonversion,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((latestFirmware) => this.mapLatestFirmwareDto(latestFirmware))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getAppsByHash(\n    params: GetAppByHashParams,\n  ): EitherAsync<HttpFetchApiError, Array<Application | null>> {\n    const { hashes } = params;\n    return EitherAsync(() =>\n      axios.post<Array<ApplicationDto | null>>(\n        `${this._managerApiBaseUrl}/v2/apps/hash`,\n        hashes,\n      ),\n    )\n      .map((res) => res.data)\n      .chain((apps) => this.mapNullableApplicationDtoToApplication(apps))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  getLanguagePackages(\n    params: GetLanguagePackagesParams,\n  ): EitherAsync<HttpFetchApiError, Array<LanguagePackage>> {\n    const { deviceId, currentFinalFirmwareId } = params;\n    return EitherAsync(() =>\n      axios.get<Array<LanguagePackageVersionDto>>(\n        `${this._managerApiBaseUrl}/language-packages`,\n        {\n          params: {\n            device_version: deviceId,\n            current_se_firmware_final_version: currentFinalFirmwareId,\n          },\n        },\n      ),\n    )\n      .map((res) => res.data)\n      .chain((apps) => this.mapLanguagesDtoToLanguages(apps))\n      .mapLeft((error) => new HttpFetchApiError(error));\n  }\n\n  private mapAppTypeDtoToAppType(appType: AppTypeDto | null): AppType | null {\n    if (appType === null) {\n      return null;\n    }\n    switch (appType) {\n      case AppTypeDto.currency:\n        return AppType.currency;\n      case AppTypeDto.plugin:\n        return AppType.plugin;\n      case AppTypeDto.tool:\n        return AppType.tool;\n      case AppTypeDto.swap:\n        return AppType.swap;\n    }\n  }\n\n  private mapApplicationDtoToApplication(\n    apps: Array<ApplicationDto>,\n  ): EitherAsync<Error, Array<Application>> {\n    return EitherAsync(() =>\n      Promise.resolve(apps.map((app) => this.mapApplicationDto(app))),\n    );\n  }\n\n  private mapNullableApplicationDtoToApplication(\n    apps: Array<ApplicationDto | null>,\n  ): EitherAsync<Error, Array<Application | null>> {\n    return EitherAsync(() =>\n      Promise.resolve(\n        apps.map((app) => {\n          if (app === null) {\n            return null;\n          }\n          return this.mapApplicationDto(app);\n        }),\n      ),\n    );\n  }\n\n  private mapApplicationDto(app: ApplicationDto): Application {\n    if (\n      typeof app !== \"object\" ||\n      typeof app.versionId !== \"number\" ||\n      typeof app.versionName !== \"string\" ||\n      (app.versionDisplayName !== null &&\n        typeof app.versionDisplayName !== \"string\") ||\n      typeof app.version !== \"string\" ||\n      (app.currencyId !== null && typeof app.currencyId !== \"string\") ||\n      (app.description !== null && typeof app.description !== \"string\") ||\n      (app.applicationType !== null &&\n        typeof app.applicationType !== \"string\") ||\n      typeof app.dateModified !== \"string\" ||\n      (app.icon !== null && typeof app.icon !== \"string\") ||\n      (app.authorName !== null && typeof app.authorName !== \"string\") ||\n      (app.supportURL !== null && typeof app.supportURL !== \"string\") ||\n      (app.contactURL !== null && typeof app.contactURL !== \"string\") ||\n      (app.sourceURL !== null && typeof app.sourceURL !== \"string\") ||\n      (app.compatibleWallets !== null &&\n        typeof app.compatibleWallets !== \"string\") ||\n      typeof app.hash !== \"string\" ||\n      typeof app.perso !== \"string\" ||\n      typeof app.firmware !== \"string\" ||\n      typeof app.firmwareKey !== \"string\" ||\n      typeof app.delete !== \"string\" ||\n      typeof app.deleteKey !== \"string\" ||\n      (app.bytes !== null && typeof app.bytes !== \"number\") ||\n      (app.warning !== null && typeof app.warning !== \"string\") ||\n      typeof app.isDevTools !== \"boolean\" ||\n      (app.category !== null && typeof app.category !== \"number\") ||\n      (app.parent !== null && typeof app.parent !== \"number\") ||\n      (app.parentName !== null && typeof app.parentName !== \"string\")\n    ) {\n      throw new Error(`Incomplete application: ${JSON.stringify(app)}`);\n    }\n    const {\n      applicationType,\n      hash,\n      perso,\n      firmware,\n      firmwareKey,\n      delete: del,\n      deleteKey,\n      ...rest\n    } = app;\n    const ret: Application = {\n      ...rest,\n      hash: hash!,\n      perso: perso!,\n      firmware: firmware!,\n      firmwareKey: firmwareKey!,\n      delete: del!,\n      deleteKey: deleteKey!,\n      applicationType: this.mapAppTypeDtoToAppType(applicationType),\n    };\n    return ret;\n  }\n\n  private mapMcuDtoToMcu(\n    mcus: Array<McuVersionDto>,\n  ): EitherAsync<Error, Array<McuFirmware>> {\n    return EitherAsync(() =>\n      Promise.resolve(\n        mcus.map((mcu) => {\n          if (\n            typeof mcu !== \"object\" ||\n            typeof mcu.id !== \"number\" ||\n            typeof mcu.name !== \"string\"\n          ) {\n            throw new Error(`Incomplete MCU version: ${JSON.stringify(mcu)}`);\n          }\n          const ret: McuFirmware = {\n            id: mcu.id,\n            name: mcu.name,\n          };\n          return ret;\n        }),\n      ),\n    );\n  }\n\n  private mapDeviceVersionDto(\n    deviceVersion: DeviceVersionDto,\n  ): EitherAsync<Error, DeviceVersion> {\n    return EitherAsync(() => {\n      if (\n        typeof deviceVersion !== \"object\" ||\n        typeof deviceVersion.id !== \"number\"\n      ) {\n        throw new Error(\n          `Incomplete device version: ${JSON.stringify(deviceVersion)}`,\n        );\n      }\n      const ret: DeviceVersion = {\n        id: deviceVersion.id,\n      };\n      return Promise.resolve(ret);\n    });\n  }\n\n  private mapFinalFirmwareDto(\n    finalFirmware: FirmwareFinalVersionDto,\n  ): EitherAsync<Error, FinalFirmware> {\n    return EitherAsync(() => {\n      if (\n        typeof finalFirmware !== \"object\" ||\n        typeof finalFirmware.id !== \"number\" ||\n        typeof finalFirmware.version !== \"string\" ||\n        typeof finalFirmware.perso !== \"string\" ||\n        (finalFirmware.firmware !== null &&\n          typeof finalFirmware.firmware !== \"string\") ||\n        (finalFirmware.firmware_key !== null &&\n          typeof finalFirmware.firmware_key !== \"string\") ||\n        (finalFirmware.hash !== null &&\n          typeof finalFirmware.hash !== \"string\") ||\n        (finalFirmware.bytes !== null &&\n          typeof finalFirmware.bytes !== \"number\") ||\n        !Array.isArray(finalFirmware.mcu_versions)\n      ) {\n        throw new Error(\n          `Incomplete final firmware: ${JSON.stringify(finalFirmware)}`,\n        );\n      }\n      const ret: FinalFirmware = {\n        id: finalFirmware.id,\n        version: finalFirmware.version,\n        perso: finalFirmware.perso,\n        firmware: finalFirmware.firmware,\n        firmwareKey: finalFirmware.firmware_key,\n        hash: finalFirmware.hash,\n        bytes: finalFirmware.bytes,\n        mcuVersions: finalFirmware.mcu_versions,\n      };\n      return Promise.resolve(ret);\n    });\n  }\n\n  private mapLatestFirmwareDto(\n    latestFirmware: LatestFirmwareOsuVersionResponseDto,\n  ): EitherAsync<Error, OsuFirmware> {\n    return EitherAsync<Error, FirmwareOsuVersionDto>(() => {\n      if (\n        latestFirmware.result !== \"success\" ||\n        !latestFirmware.se_firmware_osu_version\n      ) {\n        throw new Error(\n          `Latest firmware could not be retrieved: ${latestFirmware.result}`,\n        );\n      }\n      const osuDto = latestFirmware.se_firmware_osu_version;\n      return Promise.resolve(osuDto);\n    }).chain((osuDto) => this.mapOsuFirmwareDto(osuDto));\n  }\n\n  private mapOsuFirmwareDto(\n    osuDto: FirmwareOsuVersionDto,\n  ): EitherAsync<Error, OsuFirmware> {\n    return EitherAsync(() => {\n      if (\n        typeof osuDto !== \"object\" ||\n        typeof osuDto.id !== \"number\" ||\n        typeof osuDto.perso !== \"string\" ||\n        typeof osuDto.firmware !== \"string\" ||\n        typeof osuDto.firmware_key !== \"string\" ||\n        (osuDto.hash !== null && typeof osuDto.hash !== \"string\") ||\n        typeof osuDto.next_se_firmware_final_version !== \"number\"\n      ) {\n        throw new Error(\n          `Incomplete latest firmware: ${JSON.stringify(osuDto)}`,\n        );\n      }\n      const ret: OsuFirmware = {\n        id: osuDto.id,\n        perso: osuDto.perso,\n        firmware: osuDto.firmware,\n        firmwareKey: osuDto.firmware_key,\n        hash: osuDto.hash,\n        nextFinalFirmware: osuDto.next_se_firmware_final_version,\n      };\n      return Promise.resolve(ret);\n    });\n  }\n\n  private mapLanguagesDtoToLanguages(\n    languages: Array<LanguagePackageVersionDto>,\n  ): EitherAsync<Error, Array<LanguagePackage>> {\n    return EitherAsync(() =>\n      Promise.resolve(\n        languages.map((language) => this.mapLanguageDto(language)),\n      ),\n    );\n  }\n\n  private mapLanguageDto(language: LanguagePackageVersionDto): LanguagePackage {\n    if (\n      typeof language !== \"object\" ||\n      typeof language.language !== \"string\" ||\n      typeof language.languagePackageVersionId !== \"number\" ||\n      typeof language.version !== \"string\" ||\n      typeof language.language_package_id !== \"number\" ||\n      typeof language.apdu_install_url !== \"string\" ||\n      typeof language.apdu_uninstall_url !== \"string\" ||\n      typeof language.bytes !== \"number\" ||\n      typeof language.date_creation !== \"string\" ||\n      typeof language.date_last_modified !== \"string\"\n    ) {\n      throw new Error(\n        `Incomplete language version: ${JSON.stringify(language)}`,\n      );\n    }\n    const ret: LanguagePackage = {\n      language: language.language,\n      languagePackageVersionId: language.languagePackageVersionId,\n      version: language.version,\n      languagePackageId: language.language_package_id,\n      apduInstallUrl: language.apdu_install_url,\n      apduUninstallUrl: language.apdu_uninstall_url,\n      bytes: language.bytes,\n      dateCreation: language.date_creation,\n      dateLastModified: language.date_last_modified,\n    };\n    return ret;\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport { EitherAsync } from \"purify-ts\";\n\nimport { type GetOsVersionResponse } from \"@api/command/os/GetOsVersionCommand\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { HttpFetchApiError } from \"@internal/manager-api/model/Errors\";\nimport {\n  type FinalFirmware,\n  type McuFirmware,\n  type OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport {\n  type GetAppByHashParams,\n  type GetAppListParams,\n  type GetDeviceVersionParams,\n  type GetFirmwareVersionParams,\n  type GetLanguagePackagesParams,\n  type GetLatestFirmwareVersionParams,\n} from \"@internal/manager-api/model/Params\";\n\nimport { type ManagerApiService } from \"./ManagerApiService\";\n\n@injectable()\nexport class DefaultManagerApiService implements ManagerApiService {\n  constructor(\n    @inject(managerApiTypes.ManagerApiDataSource)\n    private readonly dataSource: ManagerApiDataSource,\n  ) {}\n\n  getAppList(\n    deviceInfo: GetOsVersionResponse,\n  ): EitherAsync<HttpFetchApiError, Array<Application>> {\n    const params: GetAppListParams = {\n      targetId: deviceInfo.targetId.toString(),\n      firmwareVersionName: deviceInfo.seVersion,\n    };\n    return this.dataSource.getAppList(params);\n  }\n\n  getDeviceVersion(deviceInfo: GetOsVersionResponse) {\n    const params: GetDeviceVersionParams = {\n      targetId: deviceInfo.targetId.toString(),\n    };\n    return this.dataSource.getDeviceVersion(params);\n  }\n\n  getFirmwareVersion(\n    deviceInfo: GetOsVersionResponse,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetFirmwareVersionParams = {\n      version: deviceInfo.seVersion,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getFirmwareVersion(params);\n  }\n\n  getOsuFirmwareVersion(\n    deviceInfo: GetOsVersionResponse,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetFirmwareVersionParams = {\n      version: deviceInfo.seVersion,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getOsuFirmwareVersion(params);\n  }\n\n  getLatestFirmwareVersion(\n    currentFirmware: FinalFirmware,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetLatestFirmwareVersionParams = {\n      currentFinalFirmwareId: currentFirmware.id,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getLatestFirmwareVersion(params);\n  }\n\n  getNextFirmwareVersion(osuFirmware: OsuFirmware) {\n    return this.dataSource.getFirmwareVersionById(\n      osuFirmware.nextFinalFirmware,\n    );\n  }\n\n  getLanguagePackages(\n    deviceVersion: DeviceVersion,\n    currentFirmware: FinalFirmware,\n  ) {\n    const params: GetLanguagePackagesParams = {\n      deviceId: deviceVersion.id,\n      currentFinalFirmwareId: currentFirmware.id,\n    };\n    return this.dataSource.getLanguagePackages(params);\n  }\n\n  getMcuList(): EitherAsync<HttpFetchApiError, Array<McuFirmware>> {\n    return this.dataSource.getMcuList();\n  }\n\n  getAppsByHash(appHashes: Array<string>) {\n    const params: GetAppByHashParams = {\n      hashes: appHashes,\n    };\n    return EitherAsync<HttpFetchApiError, Array<Application | null>>(\n      async ({ fromPromise, throwE }) => {\n        if (params.hashes.length === 0) {\n          return [];\n        }\n        try {\n          const response = await fromPromise(\n            this.dataSource.getAppsByHash(params),\n          );\n          return response;\n        } catch (error) {\n          if (error instanceof HttpFetchApiError) {\n            return throwE(error);\n          }\n          return throwE(new HttpFetchApiError(error));\n        }\n      },\n    );\n  }\n}\n", "import { inject, injectable } from \"inversify\";\n\nimport { DeviceSessionStateType } from \"@api/device-session/DeviceSessionState\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\n\n/**\n * Use case to set the provider for the Manager API, this is used to set the\n * provider for the Manager API data source at runtime.\n */\n@injectable()\nexport class SetProviderUseCase {\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    private readonly sessionService: DeviceSessionService,\n    @inject(managerApiTypes.ManagerApiDataSource)\n    private readonly managerApiDataSource: ManagerApiDataSource,\n  ) {}\n\n  execute(provider: number) {\n    // Invalidate device session state fields that are dependent on the provider\n    for (const session of this.sessionService.getDeviceSessions()) {\n      const state = session.getDeviceSessionState();\n      if (state.sessionStateType !== DeviceSessionStateType.Connected) {\n        session.setDeviceSessionState({\n          ...state,\n          firmwareUpdateContext: undefined,\n          installedApps: [],\n          appsUpdates: undefined,\n          catalog: undefined,\n        });\n      }\n    }\n\n    // Update the provider in the manager API\n    this.managerApiDataSource.setProvider(provider);\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { AxiosManagerApiDataSource } from \"@internal/manager-api/data/AxiosManagerApiDataSource\";\nimport { DefaultManagerApiService } from \"@internal/manager-api/service/DefaultManagerApiService\";\nimport { SetProviderUseCase } from \"@internal/manager-api/use-case/SetProviderUseCase\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { managerApiTypes } from \"./managerApiTypes\";\n\ntype FactoryProps = {\n  stub?: boolean;\n  config: DmkConfig;\n};\n\nexport const managerApiModuleFactory = ({ stub, config }: FactoryProps) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(managerApiTypes.DmkConfig).toConstantValue(config);\n\n    bind(managerApiTypes.ManagerApiDataSource)\n      .to(AxiosManagerApiDataSource)\n      .inSingletonScope();\n    bind(managerApiTypes.ManagerApiService)\n      .to(DefaultManagerApiService)\n      .inSingletonScope();\n    bind(managerApiTypes.SetProviderUseCase).to(SetProviderUseCase);\n\n    if (stub) {\n      rebindSync(managerApiTypes.ManagerApiDataSource).to(StubUseCase);\n      rebindSync(managerApiTypes.ManagerApiService).to(StubUseCase);\n      rebindSync(managerApiTypes.SetProviderUseCase).to(StubUseCase);\n    }\n  });\n", "import { inject, injectable } from \"inversify\";\nimport WebSocket from \"isomorphic-ws\";\nimport { Either, Left, Right } from \"purify-ts\";\nimport URL from \"url\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { secureChannelTypes } from \"@internal/secure-channel/di/secureChannelTypes\";\nimport { WebSocketConnectionError } from \"@internal/secure-channel/model/Errors\";\nimport {\n  GenuineCheckParams,\n  InstallAppsParams,\n  ListInstalledAppsParams,\n  UninstallAppsParams,\n  UpdateFirmwareParams,\n  UpdateMcuParams,\n} from \"@internal/secure-channel/model/Params\";\n\nimport { SecureChannelDataSource } from \"./SecureChannelDataSource\";\n\n@injectable()\nexport class DefaultSecureChannelDataSource implements SecureChannelDataSource {\n  private readonly webSocketBaseUrl: string;\n\n  constructor(\n    @inject(secureChannelTypes.DmkConfig)\n    { webSocketUrl }: DmkConfig,\n  ) {\n    this.webSocketBaseUrl = webSocketUrl;\n  }\n\n  genuineCheck(\n    params: GenuineCheckParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/genuine`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  installApp(\n    params: InstallAppsParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/install`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  listInstalledApps(\n    params: ListInstalledAppsParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/apps/list`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  uninstallApp(\n    params: UninstallAppsParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/install`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  updateFirmware(\n    params: UpdateFirmwareParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/install`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  updateMcu(\n    params: UpdateMcuParams,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const address = URL.format({\n      pathname: `${this.webSocketBaseUrl}/mcu`,\n      query: params,\n    });\n    return this._connectWebSocket(address);\n  }\n\n  _connectWebSocket(\n    address: string,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    try {\n      return Right(new WebSocket(address));\n    } catch (error) {\n      return Left(new WebSocketConnectionError(error));\n    }\n  }\n}\n", "import { inject, injectable } from \"inversify\";\nimport WebSocket from \"isomorphic-ws\";\nimport { Either } from \"purify-ts\";\n\nimport { type GetOsVersionResponse } from \"@api/index\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport {\n  type FinalFirmware,\n  type OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport { type SecureChannelDataSource } from \"@internal/secure-channel/data/SecureChannelDataSource\";\nimport { secureChannelTypes } from \"@internal/secure-channel/di/secureChannelTypes\";\nimport { WebSocketConnectionError } from \"@internal/secure-channel/model/Errors\";\nimport {\n  type GenuineCheckParams,\n  type InstallAppsParams,\n  type ListInstalledAppsParams,\n  type UninstallAppsParams,\n  type UpdateFirmwareParams,\n  type UpdateMcuParams,\n} from \"@internal/secure-channel/model/Params\";\n\nimport { type SecureChannelService } from \"./SecureChannelService\";\n\n@injectable()\nexport class DefaultSecureChannelService implements SecureChannelService {\n  constructor(\n    @inject(secureChannelTypes.SecureChannelDataSource)\n    private readonly dataSource: SecureChannelDataSource,\n  ) {}\n\n  genuineCheck(\n    deviceInfo: GetOsVersionResponse,\n    finalFirmware: FinalFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: GenuineCheckParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: finalFirmware.perso,\n    };\n    return this.dataSource.genuineCheck(params);\n  }\n\n  installApp(\n    deviceInfo: GetOsVersionResponse,\n    app: Pick<Application, \"perso\" | \"firmware\" | \"firmwareKey\" | \"hash\">,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const { perso, firmware, firmwareKey, hash } = app;\n    const params: InstallAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso,\n      firmware,\n      firmwareKey,\n      hash,\n    };\n    return this.dataSource.installApp(params);\n  }\n\n  listInstalledApps(\n    deviceInfo: GetOsVersionResponse,\n    finalFirmware: FinalFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: ListInstalledAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: finalFirmware.perso,\n    };\n    return this.dataSource.listInstalledApps(params);\n  }\n\n  uninstallApp(\n    deviceInfo: GetOsVersionResponse,\n    app: Pick<Application, \"perso\" | \"delete\" | \"deleteKey\" | \"hash\">,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const { perso, delete: appDelete, deleteKey, hash } = app;\n    const params: UninstallAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso,\n      firmware: appDelete,\n      firmwareKey: deleteKey,\n      hash,\n    };\n    return this.dataSource.uninstallApp(params);\n  }\n\n  updateFirmware(\n    deviceInfo: GetOsVersionResponse,\n    osuFirmware: OsuFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: UpdateFirmwareParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: osuFirmware.perso,\n      firmware: osuFirmware.firmware,\n      firmwareKey: osuFirmware.firmwareKey,\n    };\n    return this.dataSource.updateFirmware(params);\n  }\n\n  updateMcu(\n    deviceInfo: GetOsVersionResponse,\n    param: { version: string },\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: UpdateMcuParams = {\n      targetId: deviceInfo.targetId.toString(),\n      version: param.version,\n    };\n    return this.dataSource.updateMcu(params);\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { DefaultSecureChannelDataSource } from \"@internal/secure-channel/data/DefaultSecureChannelDataSource\";\nimport { DefaultSecureChannelService } from \"@internal/secure-channel/service/DefaultSecureChannelService\";\n\nimport { secureChannelTypes } from \"./secureChannelTypes\";\n\ntype FactoryProps = {\n  stub?: boolean;\n  config: DmkConfig;\n};\n\nexport const secureChannelModuleFactory = ({ stub, config }: FactoryProps) =>\n  new ContainerModule(({ bind }) => {\n    bind(secureChannelTypes.DmkConfig).toConstantValue(config);\n\n    bind(secureChannelTypes.SecureChannelDataSource).to(\n      DefaultSecureChannelDataSource,\n    );\n    bind(secureChannelTypes.SecureChannelService).to(\n      DefaultSecureChannelService,\n    );\n\n    if (stub) {\n      /* empty */\n    }\n  });\n", "export const DEFAULT_WEB_SOCKET_BASE_URL =\n  \"wss://scriptrunner.api.live.ledger.com/update\";\n", "import { inject, injectable } from \"inversify\";\n\nimport { ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { DeviceSessionId } from \"@api/types\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\n/**\n * The arguments for the SendApduUseCase.\n */\nexport type SendApduUseCaseArgs = {\n  /**\n   * Device session identifier from `DeviceManagementKit.connect`.\n   */\n  sessionId: DeviceSessionId;\n  /**\n   * Raw APDU to send to the device.\n   */\n  apdu: Uint8Array;\n  /**\n   * The time, in milliseconds, to wait before aborting an operation.\n   */\n  abortTimeout?: number;\n  /**\n   * Indicates if a device disconnection should be expected after sending the APDU.\n   */\n  triggersDisconnection?: boolean;\n};\n\n/**\n * Sends an APDU to a connected device.\n */\n@injectable()\nexport class SendApduUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"SendApduUseCase\");\n  }\n\n  async execute({\n    sessionId,\n    apdu,\n    abortTimeout,\n    triggersDisconnection,\n  }: SendApduUseCaseArgs): Promise<ApduResponse> {\n    const deviceSessionOrError =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return deviceSessionOrError.caseOf({\n      // Case device session found\n      Right: async (deviceSession) => {\n        const response = await deviceSession.sendApdu(apdu, {\n          abortTimeout,\n          triggersDisconnection,\n        });\n        return response.caseOf({\n          // Case APDU sent and response received successfully\n          Right: (data) => data,\n          // Case error sending or receiving APDU\n          Left: (error) => {\n            this._logger.error(\"Error sending APDU\", {\n              data: { sessionId, apdu, error },\n            });\n            throw error;\n          },\n        });\n      },\n      // Case device session not found\n      Left: (error) => {\n        this._logger.error(\"Error getting deviceSession\", {\n          data: { error },\n        });\n        throw error;\n      },\n    });\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { SendApduUseCase } from \"@internal/send/use-case/SendApduUseCase\";\nimport { StubUseCase } from \"@root/src/di.stub\";\n\nimport { sendTypes } from \"./sendTypes\";\n\ntype FactoryProps = {\n  stub: boolean;\n};\n\nexport const sendModuleFactory = ({ stub = false }: FactoryProps) =>\n  new ContainerModule(({ bind, rebindSync }) => {\n    bind(sendTypes.SendApduUseCase).to(SendApduUseCase);\n    if (stub) {\n      rebindSync(sendTypes.SendApduUseCase).to(StubUseCase);\n    }\n  });\n", "import { inject, injectable } from \"inversify\";\nimport { Either, Left, Maybe, Right } from \"purify-ts\";\n\nimport { type DeviceModelDataSource } from \"@api/device-model/data/DeviceModelDataSource\";\nimport { type ApduReceiverServiceFactory } from \"@api/device-session/service/ApduReceiverService\";\nimport { type ApduSenderServiceFactory } from \"@api/device-session/service/ApduSenderService\";\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport {\n  NoTransportProvidedError,\n  TransportAlreadyExistsError,\n} from \"@api/transport/model/Errors\";\nimport { TransportFactory } from \"@api/transport/model/Transport\";\nimport { TransportConnectedDevice } from \"@api/transport/model/TransportConnectedDevice\";\nimport { Transport } from \"@api/types\";\nimport { deviceModelTypes } from \"@internal/device-model/di/deviceModelTypes\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\n\nimport { TransportService } from \"./TransportService\";\n\n@injectable()\nexport class DefaultTransportService implements TransportService {\n  private _transports: Map<string, Transport> = new Map();\n  private _logger: LoggerPublisherService;\n\n  constructor(\n    @inject(transportDiTypes.TransportsInput)\n    _transports: TransportFactory[],\n    @inject(transportDiTypes.DmkConfig)\n    private readonly _config: DmkConfig,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    private readonly _loggerModuleFactory: (\n      tag: string,\n    ) => LoggerPublisherService,\n    @inject(deviceModelTypes.DeviceModelDataSource)\n    private readonly _deviceModelDataSource: DeviceModelDataSource,\n    @inject(deviceSessionTypes.ApduSenderServiceFactory)\n    private readonly _apduSenderServiceFactory: ApduSenderServiceFactory,\n    @inject(deviceSessionTypes.ApduReceiverServiceFactory)\n    private readonly _apduReceiverServiceFactory: ApduReceiverServiceFactory,\n  ) {\n    this._logger = _loggerModuleFactory(\"TransportService\");\n\n    if (_transports.length === 0) {\n      this._logger.warn(\n        \"No transports provided, please check your configuration\",\n      );\n\n      throw new NoTransportProvidedError(\n        \"No transports provided, please check your configuration\",\n      );\n    }\n\n    for (const transport of _transports) {\n      const either = this.addTransport(transport);\n\n      if (either.isLeft()) {\n        throw either.extract();\n      }\n    }\n  }\n\n  addTransport(\n    factory: TransportFactory,\n  ): Either<TransportAlreadyExistsError, void> {\n    const transport = factory({\n      deviceModelDataSource: this._deviceModelDataSource,\n      loggerServiceFactory: this._loggerModuleFactory,\n      config: this._config,\n      apduSenderServiceFactory: this._apduSenderServiceFactory,\n      apduReceiverServiceFactory: this._apduReceiverServiceFactory,\n    });\n\n    return this.addTransportInternal(transport);\n  }\n\n  private addTransportInternal(\n    transport: Transport,\n  ): Either<TransportAlreadyExistsError, void> {\n    const MaybeTransport = this.getTransport(transport.getIdentifier());\n\n    if (MaybeTransport.isJust()) {\n      this._logger.warn(\n        `Transport ${transport.getIdentifier()} already exists, please check your configuration`,\n      );\n\n      return Left(\n        new TransportAlreadyExistsError(\n          `Transport ${transport.getIdentifier()} already exists, please check your configuration`,\n        ),\n      );\n    }\n\n    this._transports.set(transport.getIdentifier(), transport);\n    return Right(undefined);\n  }\n\n  getTransport(identifier: string): Maybe<Transport> {\n    return Maybe.fromNullable(this._transports.get(identifier));\n  }\n\n  getAllTransports(): Transport[] {\n    return Array.from(this._transports.values());\n  }\n\n  closeConnection(connectedDevice: TransportConnectedDevice) {\n    const transport = this.getTransport(connectedDevice.transport);\n    transport.map((t) =>\n      t.disconnect({\n        connectedDevice,\n      }),\n    );\n  }\n}\n", "import { ContainerModule } from \"inversify\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { type TransportFactory } from \"@api/transport/model/Transport\";\nimport { DefaultTransportService } from \"@internal/transport/service/DefaultTransportService\";\n\nimport { transportDiTypes } from \"./transportDiTypes\";\n\ntype FactoryProps = {\n  stub: boolean;\n  transports: TransportFactory[];\n  config: DmkConfig;\n};\n\nexport const transportModuleFactory = ({\n  stub = false,\n  transports = [],\n  config,\n}: Partial<FactoryProps> = {}) =>\n  new ContainerModule(({ bind }) => {\n    bind(transportDiTypes.TransportsInput).toConstantValue(transports);\n    bind(transportDiTypes.TransportService)\n      .to(DefaultTransportService)\n      .inSingletonScope();\n\n    bind(transportDiTypes.DmkConfig).toConstantValue(config);\n\n    if (stub) {\n      // TODO: Implement stub\n    }\n  });\n", "import { Container } from \"inversify\";\n\nimport { commandModuleFactory } from \"@api/command/di/commandModule\";\nimport { deviceActionModuleFactory } from \"@api/device-action/di/deviceActionModule\";\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { type LoggerSubscriberService } from \"@api/logger-subscriber/service/LoggerSubscriberService\";\nimport { type TransportFactory } from \"@api/transport/model/Transport\";\nimport { configModuleFactory } from \"@internal/config/di/configModule\";\nimport { deviceModelModuleFactory } from \"@internal/device-model/di/deviceModelModule\";\nimport { deviceSessionModuleFactory } from \"@internal/device-session/di/deviceSessionModule\";\nimport { discoveryModuleFactory } from \"@internal/discovery/di/discoveryModule\";\nimport { loggerModuleFactory } from \"@internal/logger-publisher/di/loggerModule\";\nimport { managerApiModuleFactory } from \"@internal/manager-api/di/managerApiModule\";\nimport {\n  DEFAULT_FIRMWARE_DISTRIBUTION_SALT,\n  DEFAULT_MANAGER_API_BASE_URL,\n  DEFAULT_MOCK_SERVER_BASE_URL,\n  DEFAULT_PROVIDER,\n} from \"@internal/manager-api/model/Const\";\nimport { secureChannelModuleFactory } from \"@internal/secure-channel/di/secureChannelModule\";\nimport { DEFAULT_WEB_SOCKET_BASE_URL } from \"@internal/secure-channel/model/Const\";\nimport { sendModuleFactory } from \"@internal/send/di/sendModule\";\nimport { transportModuleFactory } from \"@internal/transport//di/transportModule\";\n\nexport type MakeContainerProps = {\n  stub: boolean;\n  transports: TransportFactory[];\n  loggers: LoggerSubscriberService[];\n  config: DmkConfig;\n};\n\nexport const makeContainer = ({\n  stub = false,\n  transports = [],\n  loggers = [],\n  config = {\n    mockUrl: DEFAULT_MOCK_SERVER_BASE_URL,\n    managerApiUrl: DEFAULT_MANAGER_API_BASE_URL,\n    webSocketUrl: DEFAULT_WEB_SOCKET_BASE_URL,\n    provider: DEFAULT_PROVIDER,\n    firmwareDistributionSalt: DEFAULT_FIRMWARE_DISTRIBUTION_SALT,\n  },\n}: Partial<MakeContainerProps>) => {\n  const container = new Container();\n\n  container.loadSync(\n    configModuleFactory({ stub }),\n    deviceModelModuleFactory({ stub }),\n    transportModuleFactory({ stub, transports, config }),\n    managerApiModuleFactory({ stub, config }),\n    secureChannelModuleFactory({ stub, config }),\n    discoveryModuleFactory({ stub }),\n    loggerModuleFactory({ subscribers: loggers }),\n    deviceSessionModuleFactory({ stub }),\n    sendModuleFactory({ stub }),\n    commandModuleFactory({ stub }),\n    deviceActionModuleFactory({ stub }),\n    // modules go here\n  );\n\n  return container;\n};\n", "import { type Container } from \"inversify\";\nimport { type Observable } from \"rxjs\";\n\nimport { commandTypes } from \"@api/command/di/commandTypes\";\nimport { type CommandResult } from \"@api/command/model/CommandResult\";\nimport {\n  type SendCommandUseCase,\n  type SendCommandUseCaseArgs,\n} from \"@api/command/use-case/SendCommandUseCase\";\nimport {\n  type ExecuteDeviceActionUseCase,\n  type ExecuteDeviceActionUseCaseArgs,\n} from \"@api/device-action/use-case/ExecuteDeviceActionUseCase\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type DeviceSessionState } from \"@api/device-session/DeviceSessionState\";\nimport { type DeviceSessionId } from \"@api/device-session/types\";\nimport { type ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport {\n  type ConnectUseCaseArgs,\n  type DisconnectUseCaseArgs,\n  type DiscoveredDevice,\n  type GetConnectedDeviceUseCaseArgs,\n  type SendApduUseCaseArgs,\n  type StartDiscoveringUseCaseArgs,\n} from \"@api/types\";\nimport { configTypes } from \"@internal/config/di/configTypes\";\nimport { type GetDmkVersionUseCase } from \"@internal/config/use-case/GetDmkVersionUseCase\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport { type CloseSessionsUseCase } from \"@internal/device-session/use-case/CloseSessionsUseCase\";\nimport { type GetDeviceSessionStateUseCase } from \"@internal/device-session/use-case/GetDeviceSessionStateUseCase\";\nimport { discoveryTypes } from \"@internal/discovery/di/discoveryTypes\";\nimport { type ConnectUseCase } from \"@internal/discovery/use-case/ConnectUseCase\";\nimport { type DisconnectUseCase } from \"@internal/discovery/use-case/DisconnectUseCase\";\nimport { type GetConnectedDeviceUseCase } from \"@internal/discovery/use-case/GetConnectedDeviceUseCase\";\nimport { type ListConnectedDevicesUseCase } from \"@internal/discovery/use-case/ListConnectedDevicesUseCase\";\nimport {\n  type ListenToAvailableDevicesUseCase,\n  type ListenToAvailableDevicesUseCaseArgs,\n} from \"@internal/discovery/use-case/ListenToAvailableDevicesUseCase\";\nimport { type ListenToConnectedDeviceUseCase } from \"@internal/discovery/use-case/ListenToConnectedDeviceUseCase\";\nimport {\n  type ReconnectUseCase,\n  type ReconnectUseCaseArgs,\n} from \"@internal/discovery/use-case/ReconnectUseCase\";\nimport type { StartDiscoveringUseCase } from \"@internal/discovery/use-case/StartDiscoveringUseCase\";\nimport type { StopDiscoveringUseCase } from \"@internal/discovery/use-case/StopDiscoveringUseCase\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\nimport { type SetProviderUseCase } from \"@internal/manager-api/use-case/SetProviderUseCase\";\nimport { sendTypes } from \"@internal/send/di/sendTypes\";\nimport { type SendApduUseCase } from \"@internal/send/use-case/SendApduUseCase\";\nimport { transportDiTypes } from \"@internal/transport/di/transportDiTypes\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\nimport { makeContainer, type MakeContainerProps } from \"@root/src/di\";\n\nimport {\n  type DeviceActionIntermediateValue,\n  type ExecuteDeviceActionReturnType,\n} from \"./device-action/DeviceAction\";\nimport { deviceActionTypes } from \"./device-action/di/deviceActionTypes\";\nimport { type DisableDeviceSessionRefresherUseCase } from \"./device-session/use-case/DisableDeviceSessionRefresher\";\nimport { type DmkError } from \"./Error\";\n\n/**\n * The main class to interact with the Device Management Kit.\n *\n * NB: do not instantiate this class directly, instead, use `LedgerDMKBuilder`.\n */\nexport class DeviceManagementKit {\n  readonly container: Container;\n  /** @internal */\n  constructor({\n    stub,\n    transports,\n    loggers,\n    config,\n  }: Partial<MakeContainerProps> = {}) {\n    // NOTE: MakeContainerProps might not be the exact type here\n    // For the init of the project this is sufficient, but we might need to\n    // update the constructor arguments as we go (we might have more than just the container config)\n    this.container = makeContainer({\n      stub,\n      transports,\n      loggers,\n      config,\n    });\n  }\n\n  /**\n   * Returns a promise resolving to the version of the SDK.\n   */\n  getVersion(): Promise<string> {\n    return this.container\n      .get<GetDmkVersionUseCase>(configTypes.GetDmkVersionUseCase)\n      .getDmkVersion();\n  }\n\n  /**\n   * Starts discovering devices connected.\n   *\n   * For the WeHID implementation, this use-case needs to be called as a result\n   * of an user interaction (button \"click\" event for ex).\n   *\n   * @param {StartDiscoveringUseCaseArgs} args - The transport to use for discover, or undefined to discover from all transports.\n   * @returns {Observable<DiscoveredDevice>} An observable of discovered devices.\n   */\n  startDiscovering(\n    args: StartDiscoveringUseCaseArgs,\n  ): Observable<DiscoveredDevice> {\n    return this.container\n      .get<StartDiscoveringUseCase>(discoveryTypes.StartDiscoveringUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Stops discovering devices connected.\n   */\n  stopDiscovering() {\n    return this.container\n      .get<StopDiscoveringUseCase>(discoveryTypes.StopDiscoveringUseCase)\n      .execute();\n  }\n\n  /**\n   * Listen to list of known discovered devices (and later BLE).\n   * @param {ListenToAvailableDevicesUseCaseArgs} args - The transport to use for discover, or undefined to discover from all transports.\n   * @returns {Observable<DiscoveredDevice[]>} An observable of known discovered devices.\n   */\n  listenToAvailableDevices(\n    args: ListenToAvailableDevicesUseCaseArgs,\n  ): Observable<DiscoveredDevice[]> {\n    return this.container\n      .get<ListenToAvailableDevicesUseCase>(\n        discoveryTypes.ListenToAvailableDevicesUseCase,\n      )\n      .execute(args);\n  }\n\n  /**\n   * Reconnects a device session by disconnecting and reconnecting to the device.\n   *\n   * @param args - The arguments for reconnecting the device session.\n   *   - `device`: The connected device.\n   *   - `sessionRefresherOptions` (optional): Configuration for session refreshing.\n   *     - `isRefresherDisabled`: Whether the refresher is disabled.\n   *     - `pollingInterval`: The refresh interval in milliseconds\n   * @returns The session ID to use for further communication with the device.\n   */\n  async reconnect(args: ReconnectUseCaseArgs): Promise<DeviceSessionId> {\n    return this.container\n      .get<ReconnectUseCase>(discoveryTypes.ReconnectUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Connects to a device previously discovered with `DeviceManagementKit.startDiscovering`.\n   * Creates a new device session which:\n   * - Represents the connection to the device.\n   * - Is terminated upon disconnection of the device.\n   * - Exposes the device state through an observable (see `DeviceManagementKit.getDeviceSessionState`)\n   * - Should be used for all subsequent communication with the device.\n   *\n   * @param {ConnectUseCaseArgs} args - The arguments for connecting to the device.\n   *   - `device`: The discovered device obtained from `StartDiscoveringUseCase`.\n   *   - `sessionRefresherOptions` (optional): Configuration for session refreshing.\n   *     - `isRefresherDisabled`: Whether the refresher is disabled.\n   *     - `pollingInterval`: The refresh interval in milliseconds\n   * @returns The session ID to use for further communication with the device.\n   */\n  connect(args: ConnectUseCaseArgs): Promise<DeviceSessionId> {\n    return this.container\n      .get<ConnectUseCase>(discoveryTypes.ConnectUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Disconnects to a discovered device.\n   *\n   * @param {DisconnectUseCaseArgs} args - The session ID to disconnect.\n   */\n  disconnect(args: DisconnectUseCaseArgs): Promise<void> {\n    return this.container\n      .get<DisconnectUseCase>(discoveryTypes.DisconnectUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Sends an APDU command to a device through a device session.\n   *\n   * @param {SendApduUseCaseArgs} args - The device session ID and APDU command to send.\n   */\n  sendApdu(args: SendApduUseCaseArgs): Promise<ApduResponse> {\n    return this.container\n      .get<SendApduUseCase>(sendTypes.SendApduUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Sends a command to a device through a device session.\n   *\n   * @param {SendCommandUseCaseArgs<Response, Args, ErrorCodes>} args - The device session ID, command, command error codes and command parameters to send.\n   * @returns A promise resolving with the response from the command.\n   */\n  sendCommand<Response, Args, ErrorCodes>(\n    args: SendCommandUseCaseArgs<Response, Args, ErrorCodes>,\n  ): Promise<CommandResult<Response, ErrorCodes>> {\n    return this.container\n      .get<SendCommandUseCase>(commandTypes.SendCommandUseCase)\n      .execute(args);\n  }\n\n  executeDeviceAction<\n    Output,\n    Input,\n    Error extends DmkError,\n    IntermediateValue extends DeviceActionIntermediateValue,\n  >(\n    args: ExecuteDeviceActionUseCaseArgs<\n      Output,\n      Input,\n      Error,\n      IntermediateValue\n    >,\n  ): ExecuteDeviceActionReturnType<Output, Error, IntermediateValue> {\n    return this.container\n      .get<ExecuteDeviceActionUseCase>(\n        deviceActionTypes.ExecuteDeviceActionUseCase,\n      )\n      .execute(args);\n  }\n\n  /**\n   * Gets the connected from its device session ID.\n   *\n   * @param {GetConnectedDeviceUseCaseArgs} args - The device session ID.\n   * @returns {ConnectedDevice} The connected device.\n   */\n  getConnectedDevice(args: GetConnectedDeviceUseCaseArgs): ConnectedDevice {\n    return this.container\n      .get<GetConnectedDeviceUseCase>(discoveryTypes.GetConnectedDeviceUseCase)\n      .execute(args);\n  }\n\n  /**\n   * Gets the device state of a session.\n   *\n   * @param {{ sessionId: DeviceSessionId }} args - The device session ID.\n   * @returns {Observable<DeviceSessionState>} An observable of the session device state.\n   */\n  getDeviceSessionState(args: {\n    sessionId: DeviceSessionId;\n  }): Observable<DeviceSessionState> {\n    return this.container\n      .get<GetDeviceSessionStateUseCase>(\n        deviceSessionTypes.GetDeviceSessionStateUseCase,\n      )\n      .execute(args);\n  }\n\n  /**\n   * Close the Device Management kit.\n   *\n   */\n  close() {\n    return this.container\n      .get<CloseSessionsUseCase>(deviceSessionTypes.CloseSessionsUseCase)\n      .execute();\n  }\n\n  /**\n   * Lists all connected devices.\n   *\n   * @returns {ConnectedDevice[]} The list of device sessions.\n   */\n  listConnectedDevices(): ConnectedDevice[] {\n    return this.container\n      .get<ListConnectedDevicesUseCase>(\n        discoveryTypes.ListConnectedDevicesUseCase,\n      )\n      .execute();\n  }\n\n  /**\n   * Listen to connected device.\n   *\n   * @returns {Observable<ConnectedDevice>} An observable of connected device.\n   */\n  listenToConnectedDevice(): Observable<ConnectedDevice> {\n    return this.container\n      .get<ListenToConnectedDeviceUseCase>(\n        discoveryTypes.ListenToConnectedDeviceUseCase,\n      )\n      .execute();\n  }\n\n  /**\n   * Disable the device session refresher.\n   *\n   * @param {DisableDeviceSessionRefresherUseCaseArgs} args - The device session ID and a string to identify the blocker.\n   * @returns {() => void} A function to reenable the device session refresher.\n   */\n  disableDeviceSessionRefresher(args: {\n    sessionId: DeviceSessionId;\n    blockerId: string;\n  }): () => void {\n    return this.container\n      .get<DisableDeviceSessionRefresherUseCase>(\n        deviceSessionTypes.DisableDeviceSessionRefresherUseCase,\n      )\n      .execute(args);\n  }\n  /**\n   * Sets the provider for the manager API.\n   *\n   * @param {number} provider - The provider to set.\n   */\n  setProvider(provider: number): void {\n    return this.container\n      .get<SetProviderUseCase>(managerApiTypes.SetProviderUseCase)\n      .execute(provider);\n  }\n\n  /**\n   * Returns the current provider value from the manager API data source.\n   */\n  getProvider(): number {\n    return this.container\n      .get<ManagerApiDataSource>(managerApiTypes.ManagerApiDataSource)\n      .getProvider();\n  }\n\n  /**\n   * Check if the current environment is supported by any transport.\n   */\n  isEnvironmentSupported(): boolean {\n    return this.container\n      .get<TransportService>(transportDiTypes.TransportService)\n      .getAllTransports()\n      .some((transport) => transport.isSupported());\n  }\n}\n", "import {\n  DEFAULT_FIRMWARE_DISTRIBUTION_SALT,\n  DEFAULT_MANAGER_API_BASE_URL,\n  DEFAULT_MOCK_SERVER_BASE_URL,\n  DEFAULT_PROVIDER,\n} from \"@internal/manager-api/model/Const\";\nimport { DEFAULT_WEB_SOCKET_BASE_URL } from \"@internal/secure-channel/model/Const\";\n\nimport { type LoggerSubscriberService } from \"./logger-subscriber/service/LoggerSubscriberService\";\nimport { type TransportFactory } from \"./transport/model/Transport\";\nimport { DeviceManagementKit } from \"./DeviceManagementKit\";\nimport { type DmkConfig } from \"./DmkConfig\";\n\n/**\n * Builder for the `DeviceManagementKit` class.\n *\n * @example\n * ```\n * const dmk = new LedgerDeviceManagementKitBuilder()\n *  .setStub(false)\n *  .addTransport((args) => transportFactory(args))\n *  .addTransport(transportFactory)\n *  .addLogger(myLogger)\n *  .build();\n * ```\n */\nexport class DeviceManagementKitBuilder {\n  private stub = false;\n  private readonly loggers: LoggerSubscriberService[] = [];\n  private readonly transports: TransportFactory[] = [];\n  private config: DmkConfig = {\n    managerApiUrl: DEFAULT_MANAGER_API_BASE_URL,\n    mockUrl: DEFAULT_MOCK_SERVER_BASE_URL,\n    webSocketUrl: DEFAULT_WEB_SOCKET_BASE_URL,\n    provider: DEFAULT_PROVIDER,\n    firmwareDistributionSalt: DEFAULT_FIRMWARE_DISTRIBUTION_SALT,\n  };\n\n  build(): DeviceManagementKit {\n    return new DeviceManagementKit({\n      stub: this.stub,\n      transports: this.transports,\n      loggers: this.loggers,\n      config: this.config,\n    });\n  }\n\n  setStub(stubbed: boolean): DeviceManagementKitBuilder {\n    this.stub = stubbed;\n    return this;\n  }\n\n  addTransport(transport: TransportFactory): DeviceManagementKitBuilder {\n    this.transports.push(transport);\n    return this;\n  }\n\n  /**\n   * Add a logger to the SDK that will receive its logs\n   */\n  addLogger(logger: LoggerSubscriberService): DeviceManagementKitBuilder {\n    this.loggers.push(logger);\n    return this;\n  }\n\n  addConfig(config: Partial<DmkConfig>): DeviceManagementKitBuilder {\n    this.config = {\n      ...this.config,\n      ...config,\n    };\n    return this;\n  }\n}\n", "import { LogLevel } from \"@api/logger-subscriber/model/LogLevel\";\nimport { type LogSubscriberOptions } from \"@api/logger-subscriber/model/LogSubscriberOptions\";\nimport { type LoggerSubscriberService } from \"@api/logger-subscriber/service/LoggerSubscriberService\";\n\nexport class ConsoleLogger implements LoggerSubscriberService {\n  private readonly maxLevel: LogLevel;\n\n  constructor(level: LogLevel = LogLevel.Debug) {\n    this.maxLevel = level;\n  }\n\n  log(\n    level: LogLevel | null,\n    message: string,\n    options: LogSubscriberOptions,\n  ): void {\n    const tag = `[${options.tag}]`;\n\n    switch (level) {\n      case LogLevel.Info: {\n        if (this.maxLevel >= LogLevel.Info) {\n          this.logWithData(tag, console.info, message, options);\n        }\n        break;\n      }\n      case LogLevel.Warning: {\n        if (this.maxLevel >= LogLevel.Warning) {\n          this.logWithData(tag, console.warn, message, options);\n        }\n        break;\n      }\n      case LogLevel.Debug: {\n        if (this.maxLevel >= LogLevel.Debug) {\n          this.logWithData(tag, console.debug, message, options);\n        }\n        break;\n      }\n      case LogLevel.Error: {\n        if (this.maxLevel >= LogLevel.Error) {\n          this.logWithData(tag, console.error, message, options);\n        }\n        break;\n      }\n      case LogLevel.Fatal: {\n        if (this.maxLevel >= LogLevel.Fatal) {\n          this.logWithData(tag, console.error, message, options);\n        }\n        break;\n      }\n      default:\n        this.logWithData(tag, console.log, message, options);\n    }\n  }\n\n  private logWithData(\n    tag: string,\n    logFunction: (...args: unknown[]) => void,\n    message: string,\n    options: LogSubscriberOptions,\n  ): void {\n    if (options.data) {\n      logFunction(tag, message, options.data);\n    } else {\n      logFunction(tag, message);\n    }\n  }\n}\n", "import { LogLevel } from \"@api/logger-subscriber/model/LogLevel\";\nimport { type LogSubscriberOptions } from \"@api/types\";\nimport { DeviceSession } from \"@internal/device-session/model/DeviceSession\";\n\nimport { type LoggerSubscriberService } from \"./LoggerSubscriberService\";\n\n/**\n * This function is used to format the logs to JSON format,\n * remove circular dependencies and do some extra formatting.\n * */\nexport function getJSONStringifyReplacer(): (\n  key: string,\n  value: unknown,\n) => unknown {\n  const ancestors: unknown[] = [];\n  return function (_: string, value: unknown): unknown {\n    // format Uint8Array values to more readable format\n    if (value instanceof Uint8Array) {\n      const bytesHex = Array.from(value).map((x) =>\n        x.toString(16).padStart(2, \"0\"),\n      );\n      return {\n        hex: \"0x\" + bytesHex.join(\"\"),\n        readableHex: bytesHex.join(\" \"),\n        value: value.toString(),\n      };\n    }\n\n    // format DeviceSession values to avoid huge object in logs\n    if (value instanceof DeviceSession) {\n      const {\n        connectedDevice: { deviceModel, type, id },\n      } = value;\n      return {\n        id: value.id,\n        connectedDevice: {\n          deviceModel,\n          type,\n          id,\n        },\n      };\n    }\n\n    // format circular references to \"[Circular]\"\n    // Taken from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value#circular_references\n    if (typeof value !== \"object\" || value === null) {\n      return value;\n    }\n    // `this` is the object that value is contained in,\n    // i.e., its direct parent.\n    // @ts-expect-error cf. comment above\n    while (ancestors.length > 0 && ancestors.at(-1) !== (this as unknown)) {\n      ancestors.pop();\n    }\n    if (ancestors.includes(value)) {\n      return \"[Circular]\";\n    }\n    ancestors.push(value);\n    return value;\n  };\n}\n\nexport class WebLogsExporterLogger implements LoggerSubscriberService {\n  private logs: Array<\n    [level: LogLevel, message: string, options: LogSubscriberOptions]\n  > = [];\n\n  log(level: LogLevel, message: string, options: LogSubscriberOptions): void {\n    this.logs.push([level, message, options]);\n  }\n\n  private formatLogsToJSON(): string {\n    const remappedLogs = this.logs.map(([level, message, options]) => {\n      const { timestamp, ...restOptions } = options;\n      return {\n        level: LogLevel[level],\n        message,\n        options: {\n          ...restOptions,\n          date: new Date(options.timestamp),\n        },\n      };\n    });\n\n    return JSON.stringify(remappedLogs, getJSONStringifyReplacer(), 2);\n  }\n\n  /**\n   * Export logs to JSON file.\n   */\n  public exportLogsToJSON(): void {\n    const logs = this.formatLogsToJSON();\n    const blob = new Blob([logs], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `ledger-device-management-kit-logs-${new Date().toISOString()}.json`;\n    a.click();\n  }\n}\n", "// import { createBrowserInspector } from \"@statelyai/inspect\";\nimport { type Either, Left, Maybe, Nothing, Right } from \"purify-ts\";\nimport { type Actor, assign, createActor, emit, setup } from \"xstate\";\n\nimport { GetAppAndVersionCommand } from \"@api/command/os/GetAppAndVersionCommand\";\nimport { CommandUtils } from \"@api/command/utils/CommandUtils\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type DmkError, UnknownDeviceExchangeError } from \"@api/Error\";\nimport { type DeviceId } from \"@api/types\";\n\nimport { type DeviceApduSender } from \"./DeviceApduSender\";\nimport {\n  AlreadySendingApduError,\n  DeviceDisconnectedBeforeSendingApdu,\n  DeviceDisconnectedWhileSendingError,\n} from \"./Errors\";\n\n// const { inspect } = createBrowserInspector();\n\ntype DeviceDisconnectedEvent = {\n  type: \"DeviceDisconnected\";\n};\n\ntype DeviceConnectedEvent = {\n  type: \"DeviceConnected\";\n};\n\ntype ApduResponseReceived = {\n  type: \"ApduResponseReceived\";\n  apduResponse: ApduResponse;\n};\n\ntype ApduSendingError = {\n  type: \"ApduSendingError\";\n  error: DmkError;\n};\n\ntype SendApduCalled = {\n  type: \"SendApduCalled\";\n  apdu: Uint8Array;\n  triggersDisconnection: boolean;\n  abortTimeout?: number;\n  responseCallback: (response: Either<DmkError, ApduResponse>) => void;\n};\n\ntype ReconnectionTimedOut = {\n  type: \"ReconnectionTimedOut\";\n};\n\ntype CloseConnectionCalled = {\n  type: \"CloseConnectionCalled\";\n};\n\nexport type Events =\n  | DeviceDisconnectedEvent\n  | DeviceConnectedEvent\n  | ApduResponseReceived\n  | ApduSendingError\n  | SendApduCalled\n  | CloseConnectionCalled\n  | ReconnectionTimedOut;\n\nexport type DeviceConnectionStateMachineParams<Dependencies> = {\n  deviceId: DeviceId;\n  deviceApduSender: DeviceApduSender<Dependencies>;\n  timeoutDuration: number;\n  tryToReconnect: (timeoutDuration: number) => void;\n  onTerminated: () => void;\n};\n\nexport class DeviceConnectionStateMachine<Dependencies> {\n  private deviceId: DeviceId;\n  private deviceAdpuSender: DeviceApduSender<Dependencies>;\n\n  private machineActor: Actor<ReturnType<typeof makeStateMachine>>;\n\n  private timeoutDuration: number;\n  private timeout: ReturnType<typeof setTimeout> | null = null;\n\n  startReconnectionTimeout() {\n    this.timeout = setTimeout(() => {\n      this.machineActor.send({ type: \"ReconnectionTimedOut\" });\n    }, this.timeoutDuration);\n  }\n\n  constructor(params: DeviceConnectionStateMachineParams<Dependencies>) {\n    this.deviceId = params.deviceId;\n    this.deviceAdpuSender = params.deviceApduSender;\n    this.timeoutDuration = params.timeoutDuration;\n    this.machineActor = createActor(\n      makeStateMachine({\n        sendApduFn: (apdu, triggersDisconnection, abortTimeout) =>\n          this.sendApduToDeviceConnection(\n            apdu,\n            triggersDisconnection,\n            abortTimeout,\n          ),\n        startReconnectionTimeout: () => this.startReconnectionTimeout(),\n        cancelReconnectionTimeout: () => {\n          if (this.timeout) {\n            clearTimeout(this.timeout);\n            this.timeout = null;\n          }\n        },\n        tryToReconnect: () => {\n          params.tryToReconnect(this.timeoutDuration);\n        },\n        onTerminated: params.onTerminated,\n        closeConnection: () => {\n          this.deviceAdpuSender.closeConnection();\n        },\n      }),\n      // {\n      //   // inspect,\n      // },\n    );\n    this.machineActor.start();\n  }\n\n  private sendApduToDeviceConnection(\n    apdu: Uint8Array,\n    triggersDisconnection?: boolean,\n    abortTimeout?: number,\n  ) {\n    this.deviceAdpuSender\n      .sendApdu(apdu, triggersDisconnection, abortTimeout)\n      .then((response) => {\n        response.caseOf({\n          Left: (error) => {\n            this.machineActor.send({ type: \"ApduSendingError\", error });\n          },\n          Right: (apduResponse) => {\n            this.machineActor.send({\n              type: \"ApduResponseReceived\",\n              apduResponse,\n            });\n          },\n        });\n      })\n      .catch((error) => {\n        this.machineActor.send({\n          type: \"ApduSendingError\",\n          error: new UnknownDeviceExchangeError(error),\n        });\n      });\n  }\n\n  /**\n   * Called by the transport\n   */\n\n  public getDependencies(): Dependencies {\n    return this.deviceAdpuSender.getDependencies();\n  }\n\n  public setDependencies(dependencies: Dependencies) {\n    this.deviceAdpuSender.setDependencies(dependencies);\n  }\n\n  public getDeviceId() {\n    return this.deviceId;\n  }\n\n  public sendApdu(\n    apdu: Uint8Array,\n    triggersDisconnection?: boolean,\n    abortTimeout?: number,\n  ): Promise<Either<DmkError, ApduResponse>> {\n    return new Promise((responseCallback) => {\n      this.machineActor.send({\n        type: \"SendApduCalled\",\n        apdu,\n        triggersDisconnection: !!triggersDisconnection,\n        abortTimeout,\n        responseCallback,\n      });\n    });\n  }\n\n  public async setupConnection() {\n    await this.deviceAdpuSender.setupConnection();\n  }\n\n  // State Machine Events\n\n  public eventDeviceConnected() {\n    this.machineActor.send({ type: \"DeviceConnected\" });\n  }\n\n  public eventDeviceDisconnected() {\n    this.machineActor.send({ type: \"DeviceDisconnected\" });\n  }\n\n  public closeConnection() {\n    this.machineActor.send({ type: \"CloseConnectionCalled\" });\n  }\n}\n\nfunction makeStateMachine({\n  sendApduFn,\n  startReconnectionTimeout,\n  cancelReconnectionTimeout,\n  tryToReconnect,\n  onTerminated,\n  closeConnection,\n}: {\n  sendApduFn: (\n    apdu: Uint8Array,\n    triggersDisconnection: boolean,\n    abortTimeout?: number,\n  ) => void;\n  startReconnectionTimeout: () => void;\n  cancelReconnectionTimeout: () => void;\n  tryToReconnect: () => void;\n  onTerminated: () => void;\n  closeConnection: () => void;\n}) {\n  return setup({\n    types: {} as {\n      context: {\n        apduInProgress: Maybe<{\n          apdu: Uint8Array;\n          triggersDisconnection: boolean;\n          abortTimeout?: number;\n          responseCallback: (response: Either<DmkError, ApduResponse>) => void;\n        }>;\n        apduResponse: Maybe<ApduResponse>;\n      };\n      events: Events;\n    },\n    actions: {\n      // event transitions\n      startTimer: () => {\n        startReconnectionTimeout();\n      },\n      cancelTimer: () => {\n        cancelReconnectionTimeout();\n      },\n      reconnectionTimeoutEvent: emit({ type: \"ReconnectionTimedOut\" }),\n      sendApdu: ({ context }) => {\n        context.apduInProgress.map(({ apdu, abortTimeout }) => {\n          sendApduFn(apdu, false, abortTimeout);\n        });\n      },\n      sendApduResponse: (\n        { context },\n        params: { response: Either<DmkError, ApduResponse> },\n      ) => {\n        context.apduInProgress.map(({ responseCallback }) =>\n          responseCallback(params.response),\n        );\n      },\n      sendGetAppAndVersion: () => {\n        sendApduFn(new GetAppAndVersionCommand().getApdu().getRawApdu(), false);\n      },\n      tryToReconnect: () => {\n        tryToReconnect();\n      },\n      clearApduInProgress: assign({\n        apduInProgress: Nothing,\n      }),\n      clearApduResponse: assign({\n        apduResponse: Nothing,\n      }),\n      signalTermination: () => {\n        onTerminated();\n      },\n      closeConnection: () => {\n        closeConnection(); // ASK: how do we handle errors ?\n      },\n    },\n    guards: {\n      isApduThatTriggersDisconnection: ({ context, event }) => {\n        if (event.type !== \"ApduResponseReceived\") {\n          return false;\n        }\n        return context.apduInProgress.caseOf({\n          /**\n           * If the apdu is known as one that triggers a disconnection,\n           * and if it's a success response,\n           * then will trigger a disconnection (on Ledger OS prior to the IO revamp).\n           */\n          Just: ({ triggersDisconnection, apdu }) =>\n            (triggersDisconnection ||\n              CommandUtils.isApduThatTriggersDisconnection(apdu)) &&\n            CommandUtils.isSuccessResponse(event.apduResponse),\n          Nothing: () => false,\n        });\n      },\n      isSendApduBusyError: ({ event }) => {\n        if (event.type !== \"ApduResponseReceived\") {\n          return false;\n        }\n        return (\n          event.apduResponse.statusCode[0] === 0x66 &&\n          event.apduResponse.statusCode[1] === 0x01\n        );\n      },\n    },\n  }).createMachine({\n    /** @xstate-layout N4IgpgJg5mDOIC5QTANwJYGMwGED2AdgWJgC7qEB0+RJpkAxACJpZgukCGmAFpANoAGALqJQABzyx05QmJAAPRAA4A7AGZKywQEYAnAFYATMoAsBg6fUA2ADQgAnolUnKBjUdXXVpnUb0aAL6B9igY2DTEZBQE1IRR9BAMAMpgBBAAguIQAK44nAA2BQIi8pLSsgTySgjW6oKU6uo61kbWyh06Vsr2TgjqAZR6HUaWXcrqBmrBoawR8XQxcbRkjDgFUrgL0YT5RSWiSCDlMjHVKnrWjaO6ev6qlnp6vYim1qaN9YLqGuPKOjpVDMQGE2JFFlRUul0AQoFlcgx4TkAEpwSQEWBgVHYdCoA5lKSnORHGpNVSUPwGXQDQSmNTDF4IZTWPRDJotUw+HwAnTA0HzFaVShQiAwuHZHKIiWo2DozHYsC4gQ6Q4SQmVc79TxDIzqG6eJq+VSM94NPQ6CYuUzmQGCax8uZbQVLEVipFS3Ku2EAUQATr68L6hKrjuqziTEJNNHrTG1dIIDE8jLTGVTlJQboI2i56QZeSEQY7wTtYl7xQiWOF2GAuLx8UcThqIwh-OmdBZPF0qQCBoydIJlAZKK0jP4bHntBaHVXi0Ky+71ptZzE9sUIMGCRVw6Aau2dJQ6WZlMM-D9+89HIh++mbndVHpdNYLAnp2DtnO0qLYe6RUjV-W1S3Ykd0QABac1KFpbx3kHCxumNS9ak5SDTHNax0NUDRfFMV8BQSJYAHVOFOWEADFA2xd8YmYR0MlIWs+HXUoGzDYDFEQQx90mVozABJ9BAvPo6iuFpRgtQRdDUWNcKdfCqCIkioHI31KOdQgUk-P9CjXDcWKAqpmx0dR-gpCTaXNUxvh7RkvCHWlaWM9RfC6dCZOXeTiPIMiKJIKj1NUuSCAAFXQABbSAAHkclIXTAKJAyQIQLpBHJAEXB8AS1HvdRGT0a0D2ZZpBxjSc3L82IFK8pSfMwcqGEXTF3IIf8mJDRtt3YpLLPJZMWkmTtzJyxD+1UBofifVQOm8YyWjKtSKs8sVlICiECAImQeAARRyMAdogX8JRoqs6IYgDQ30zUjJ8CkWQmYZbOsFLGWzUyzE5bssx8ObAsoSqlpq8r1tILadr2g6ERWksQvCiAopi5i4qbRKjH7Bo4N1dsvFjOxEIeIwUPQ9o9AGSYvG+1bfsW7yVN8+agZB3bIHByUGtk1aWti874s1FGJOHYy6gTLo3lMVN7wPBNVAtbRRg0IEC35NmS0pxTltpwL6e2xn9s0w7mY5hGuaRzrAWZIYBJpc0pd1E18tNMZLOMAwnOCAsCDwFB4CORWms3bnm1AozWSgrHYMsYyEL6FGKXcDleMMO5rXJ5XZ0gP3jZqB4evaLwXEeqwnJNKYDypWlzHePwcIVotyuFT83QldOOpqWNU30A8rEmrMjPcAJk6FP7qch432rY3dxnN1onlaZ9idy5NILuCxl+UEwrH7wiqeqmnarpjatbB3Xcibser3eckfmd3xOkrnpce0DMjHMeoAgLjeqCCsBfVCmFOESE+EqdSfnmNwLJjBPBSs0QwuV3CQWPN3AwT4LTtldoEIAA */\n    id: \"deviceConnection\",\n    initial: \"Connected\",\n    context: {\n      apduInProgress: Nothing,\n      apduResponse: Nothing,\n    },\n    states: {\n      Connected: {\n        on: {\n          DeviceDisconnected: {\n            target: \"WaitingForReconnection\",\n          },\n          SendApduCalled: {\n            target: \"SendingApdu\",\n            actions: assign({\n              apduInProgress: ({ event }) => {\n                return Maybe.of({\n                  apdu: event.apdu,\n                  triggersDisconnection: event.triggersDisconnection,\n                  abortTimeout: event.abortTimeout,\n                  responseCallback: event.responseCallback,\n                });\n              },\n            }),\n          },\n          CloseConnectionCalled: {\n            target: \"Terminated\",\n          },\n        },\n      },\n      SendingApdu: {\n        entry: \"sendApdu\",\n        on: {\n          ApduResponseReceived: [\n            {\n              guard: \"isApduThatTriggersDisconnection\",\n              target: \"WaitingForDisconnection\",\n              actions: [\n                assign({\n                  apduResponse: ({ event }) => Maybe.of(event.apduResponse),\n                }),\n              ],\n            },\n            {\n              target: \"Connected\",\n              actions: [\n                {\n                  type: \"sendApduResponse\",\n                  // https://stately.ai/docs/actions#dynamic-action-parameters\n                  params: ({ event }) => {\n                    return {\n                      response: Right(event.apduResponse),\n                    };\n                  },\n                },\n                { type: \"clearApduInProgress\" },\n              ],\n            },\n          ],\n          ApduSendingError: {\n            target: \"Connected\",\n            actions: [\n              {\n                type: \"sendApduResponse\",\n                // https://stately.ai/docs/actions#dynamic-action-parameters\n                params: ({ event }) => {\n                  return {\n                    response: Left(event.error),\n                  };\n                },\n              },\n              \"clearApduInProgress\",\n            ],\n          },\n          DeviceDisconnected: {\n            target: \"WaitingForReconnection\",\n            actions: [\n              {\n                type: \"sendApduResponse\",\n                params: {\n                  response: Left(new DeviceDisconnectedWhileSendingError()),\n                },\n              },\n              \"clearApduInProgress\",\n            ],\n          },\n          CloseConnectionCalled: {\n            target: \"Terminated\",\n            actions: [\n              {\n                type: \"sendApduResponse\",\n                params: {\n                  response: Left(new DeviceDisconnectedWhileSendingError()),\n                },\n              },\n              \"clearApduInProgress\",\n            ],\n          },\n          SendApduCalled: {\n            actions: ({ event }) => {\n              event.responseCallback(Left(new AlreadySendingApduError()));\n            },\n          },\n        },\n      },\n      WaitingForDisconnection: {\n        entry: [\"sendGetAppAndVersion\"],\n        exit: [\n          {\n            type: \"sendApduResponse\",\n            params: ({ context }) => {\n              return {\n                response: context.apduResponse.caseOf({\n                  Just: (apduResponse) => Right(apduResponse),\n                  Nothing: () => Left(new UnknownDeviceExchangeError()),\n                }),\n              };\n            },\n          },\n          { type: \"clearApduInProgress\" },\n          { type: \"clearApduResponse\" },\n        ],\n        on: {\n          ApduResponseReceived: [\n            {\n              guard: \"isSendApduBusyError\",\n              actions: [\"sendGetAppAndVersion\"],\n              target: \"WaitingForDisconnection\",\n            },\n            {\n              target: \"Connected\",\n            },\n          ],\n          ApduSendingError: [\n            {\n              target: \"WaitingForReconnection\",\n            },\n          ],\n          SendApduCalled: {\n            actions: ({ event }) => {\n              event.responseCallback(Left(new AlreadySendingApduError()));\n            },\n          },\n          DeviceDisconnected: {\n            target: \"WaitingForReconnection\",\n          },\n          CloseConnectionCalled: {\n            target: \"Terminated\",\n          },\n        },\n      },\n      WaitingForReconnection: {\n        entry: [\"startTimer\", \"tryToReconnect\"],\n        on: {\n          DeviceConnected: {\n            target: \"Connected\",\n            actions: \"cancelTimer\",\n          },\n          SendApduCalled: {\n            target: \"WaitingForReconnectionWithQueuedSendApdu\",\n            actions: assign({\n              apduInProgress: ({ event }) => {\n                return Maybe.of({\n                  apdu: event.apdu,\n                  triggersDisconnection: event.triggersDisconnection,\n                  abortTimeout: event.abortTimeout,\n                  responseCallback: event.responseCallback,\n                });\n              },\n            }),\n          },\n          ReconnectionTimedOut: {\n            target: \"Terminated\",\n          },\n          CloseConnectionCalled: {\n            target: \"Terminated\",\n          },\n        },\n      },\n      WaitingForReconnectionWithQueuedSendApdu: {\n        on: {\n          DeviceConnected: {\n            target: \"SendingApdu\",\n            actions: \"cancelTimer\",\n          },\n          ReconnectionTimedOut: {\n            target: \"Terminated\",\n            actions: [\n              {\n                type: \"sendApduResponse\",\n                params: {\n                  response: Left(new DeviceDisconnectedBeforeSendingApdu()),\n                },\n              },\n              {\n                type: \"clearApduInProgress\",\n              },\n            ],\n          },\n          CloseConnectionCalled: {\n            target: \"Terminated\",\n            actions: [\n              {\n                type: \"sendApduResponse\",\n                params: {\n                  response: Left(new DeviceDisconnectedWhileSendingError()),\n                },\n              },\n              \"clearApduInProgress\",\n            ],\n          },\n          SendApduCalled: {\n            actions: ({ event }) => {\n              event.responseCallback(Left(new AlreadySendingApduError()));\n            },\n          },\n        },\n      },\n      // TODO: ADD INACTIVE STATE\n      Terminated: {\n        entry: [\"signalTermination\", \"closeConnection\"],\n        type: \"final\",\n      },\n    },\n  });\n}\n", "import { type DeviceId } from \"@api/device/DeviceModel\";\nimport { type TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\nimport { type ConnectionType } from \"@api/discovery/ConnectionType\";\nimport { type SendApduFnType } from \"@api/transport/model/DeviceConnection\";\nimport { type TransportIdentifier } from \"@api/transport/model/TransportIdentifier\";\n\n/**\n * The internal connected device.\n */\nexport type ConnectedDeviceConstructorArgs = {\n  id: DeviceId;\n  deviceModel: TransportDeviceModel;\n  type: ConnectionType;\n  transport: TransportIdentifier;\n  sendApdu: SendApduFnType;\n  name?: string;\n};\n\nexport class TransportConnectedDevice {\n  public readonly id: DeviceId;\n  public readonly deviceModel: TransportDeviceModel;\n  public readonly sendApdu: SendApduFnType;\n  public readonly type: ConnectionType;\n  public readonly transport: TransportIdentifier;\n  public readonly name?: string;\n\n  constructor({\n    id,\n    deviceModel,\n    type,\n    transport,\n    sendApdu,\n    name,\n  }: ConnectedDeviceConstructorArgs) {\n    this.id = id;\n    this.deviceModel = deviceModel;\n    this.sendApdu = sendApdu;\n    this.type = type;\n    this.transport = transport;\n    this.name = name;\n  }\n}\n", "import { DeviceModelId } from \"@api/device/DeviceModel\";\nimport { type TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\n\nexport function deviceModelStubBuilder(\n  props: Partial<TransportDeviceModel> = {},\n): TransportDeviceModel {\n  return {\n    id: DeviceModelId.NANO_X,\n    productName: \"Ledger Nano X\",\n    usbProductId: 0x40,\n    bootloaderUsbProductId: 0x0004,\n    usbOnly: false,\n    memorySize: 2 * 1024 * 1024,\n    getBlockSize: () => 4 * 1024,\n    masks: [0x33000000],\n    bluetoothSpec: [\n      {\n        serviceUuid: \"13d63400-2c97-0004-0000-4c6564676572\",\n        notifyUuid: \"13d63400-2c97-0004-0001-4c6564676572\",\n        writeUuid: \"13d63400-2c97-0004-0002-4c6564676572\",\n        writeCmdUuid: \"13d63400-2c97-0004-0003-4c6564676572\",\n      },\n    ],\n    ...props,\n  };\n}\n", "import { ApduResponse, type ApduResponseConstructorArgs } from \"./ApduResponse\";\n\ntype ApduResponseStub = (\n  props?: Partial<ApduResponseConstructorArgs>,\n) => ApduResponse;\n\nexport const defaultApduResponseStubBuilder: ApduResponseStub = ({\n  statusCode = Uint8Array.from([0x90, 0x00]),\n  data = Uint8Array.from([]),\n} = {}) => new ApduResponse({ statusCode, data });\n", "import { Right } from \"purify-ts\";\n\nimport { deviceModelStubBuilder } from \"@api/device-model/model/DeviceModel.stub\";\nimport { defaultApduResponseStubBuilder } from \"@api/device-session/ApduResponse.stub\";\n\nimport {\n  type ConnectedDeviceConstructorArgs,\n  TransportConnectedDevice,\n} from \"./TransportConnectedDevice\";\n\nexport function connectedDeviceStubBuilder(\n  props: Partial<ConnectedDeviceConstructorArgs> = {},\n): TransportConnectedDevice {\n  const deviceModel = deviceModelStubBuilder();\n  return new TransportConnectedDevice({\n    deviceModel,\n    id: \"42\",\n    type: \"MOCK\",\n    transport: \"USB\",\n    sendApdu: vi.fn(async () =>\n      Promise.resolve(Right(defaultApduResponseStubBuilder())),\n    ),\n    ...props,\n  });\n}\n", "export function isBase64String(value: string): boolean {\n  // Valid base64 characters are [A-Za-z0-9+/]\n  // They are always grouped by 4 characters.\n  // Optional padding at the end with one or two '='.\n  // see section 4 of: https://www.rfc-editor.org/rfc/rfc4648.txt\n  return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(\n    value,\n  );\n}\n\nexport function base64StringToBuffer(value: string): Uint8Array | null {\n  if (value.length === 0) {\n    return new Uint8Array();\n  }\n  if (!isBase64String(value)) {\n    return null;\n  }\n  try {\n    // Use the browser implementation of atob\n    const base64Decoded = atob(value);\n    const buffer = new Uint8Array(base64Decoded.length);\n    for (let i = 0; i < base64Decoded.length; i++) {\n      buffer[i] = base64Decoded.charCodeAt(i);\n    }\n    return buffer;\n  } catch (_error: unknown) {\n    // Use the implementation of Buffer for environments such as node\n    return Uint8Array.from(Buffer.from(value, \"base64\"));\n  }\n}\n"],
  "mappings": "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",
  "names": ["re", "t", "R", "max", "a", "b", "re", "t", "m", "i", "a", "b", "parse", "parse", "v", "parse", "clean", "s", "parse", "v2", "a", "a", "a", "parse", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "parse", "re", "t", "range", "r", "c", "first", "i", "k", "cache", "re", "t", "_", "M", "m", "p", "z", "from", "r", "re", "t", "m", "range", "range", "c", "range", "max", "v", "range", "min", "v", "range", "i", "require_valid", "range", "range", "i", "range", "range", "r2", "range", "first", "v", "a", "b", "min", "max", "c", "a", "b", "require_semver", "parse", "clean", "map", "string", "k", "i", "n", "j", "w", "t", "encode", "m", "q", "toStringTag", "O", "isArray", "from", "isRegExp", "s", "i", "isNumber", "isBoolean", "isString", "isDate", "isPlainObject", "e", "f", "m", "x", "l", "c", "n", "k", "j", "require_range", "isNaN", "a", "number", "e", "e", "_", "max", "concatty", "a", "b", "i", "j", "slicy", "bind", "Empty", "bind", "bind", "e", "O", "bind", "undefined", "max", "min", "e", "doEval", "gen", "bind", "stringToPath", "string", "first", "last", "number", "getBaseIntrinsic", "i", "isArray", "i", "compactQueue", "queue", "j", "arrayToObject", "merge", "assign", "e", "encode", "string", "c", "compact", "isRegExp", "isBuffer", "combine", "a", "b", "maybeMap", "repeat", "isArray", "defaults", "date", "isNonNullishPrimitive", "v", "stringify", "filter", "value", "j", "normalizeStringifyOptions", "i", "require_parse", "isArray", "defaults", "i", "normalizeParseOptions", "parse", "u", "i", "l", "j", "k", "p", "h", "ae", "s", "v", "last", "Reflect", "factory", "_", "map", "i", "O", "P", "hasOwn", "_i", "_a", "x", "y", "V", "iterator", "f", "prototype", "first", "metadataRegistry", "metadata", "OrdinaryDefineOwnMetadata", "OrdinaryHasOwnMetadata", "OrdinaryGetOwnMetadata", "OrdinaryOwnMetadataKeys", "k", "e", "defineMetadata", "hasOwnMetadata", "getOwnMetadata", "getOwnMetadataKeys", "deleteMetadata", "MapIterator", "Map", "Set", "WeakMap", "buffer", "Apdu", "cla", "ins", "p1", "p2", "data", "header", "apdu", "isHexaString", "value", "hexaStringToBuffer", "_a", "bytes", "byte", "bufferToHexaString", "withPrefix", "ValueOverflowError", "value", "max", "APDU_MAX_PAYLOAD", "DataOverflowError", "remaining", "HexaStringEncodeError", "MAX_32_BIT_UINT", "maxPayloadSize", "value", "bigEndian", "r", "t", "DataOverflowError", "result", "hexaStringToBuffer", "HexaStringEncodeError", "bytes", "tag", "e", "hasLv", "sizeInBits", "signed", "converted", "sizeInBytes", "buffer", "d", "i", "a", "u", "ValueOverflowError", "limit", "mask", "APDU_MAX_PAYLOAD", "APDU_MAX_SIZE", "ins", "cla", "p1", "d", "ByteArrayBuilder", "Apdu", "value", "t", "p2", "s", "buffer", "e", "length", "bigEndian", "value", "t", "field", "startIndex", "tag", "endIndex", "i", "prefix", "result", "bufferToHexaString", "index", "item", "n", "sizeInBits", "signed", "sizeInBytes", "limit", "u", "ApduParser", "response", "length", "value", "ByteArrayParser", "prefix", "InvalidStatusWordError", "message", "InvalidBatteryStatusTypeError", "InvalidBatteryDataError", "InvalidResponseFormatError", "message", "InvalidGetFirmwareMetadataResponseError", "CommandResultStatus", "CommandResultFactory", "data", "error", "isSuccessCommandResult", "result", "CommandUtils", "statusCode", "apdu", "apduMap", "value", "i", "DeviceExchangeError", "tag", "errorCode", "originalError", "message", "UnknownDeviceExchangeError", "DeviceBusyError", "isCommandErrorCode", "errorCode", "errors", "GlobalCommandError", "s", "r", "o", "e", "apduResponse", "errorCode", "GLOBAL_ERRORS", "a", "i", "e", "ApduBuilder", "CommandResultFactory", "o", "GetAppAndVersionCommand", "getAppAndVersionApduArgs", "r", "CommandUtils", "e", "o", "GlobalCommandErrorHandler", "parser", "ApduParser", "apduResponse", "i", "name", "t", "flags", "p", "BatteryStatusType", "t", "A", "ChargingMode", "e", "i", "c", "n", "ApduBuilder", "s", "ApduParser", "o", "InvalidBatteryDataError", "CommandResultFactory", "flags", "chargingQi", "chargingUSB", "InvalidBatteryStatusTypeError", "DeviceModelId", "DeviceModel", "id", "model", "name", "LEDGER_VENDOR_ID", "SecureElementFlagsParser", "seFlags", "firstByte", "byte", "n", "getOsVersionApduArgs", "r", "CommandUtils", "e", "CommandResultFactory", "o", "GlobalCommandErrorHandler", "apduResponse", "parser", "ApduParser", "d", "targetId", "version", "a", "c", "secureElementFlags", "x", "SecureElementFlagsParser", "isBootloader", "g", "I", "seVersion", "i", "S", "m", "seTargetId", "langId", "recoverState", "l", "A", "mcuBootloaderVersion", "mcuTargetId", "y", "seData", "mcuSephVersion", "n", "p", "langIdBuffer", "V", "recoverStateBuffer", "isOsu", "u", "deviceModelId", "DeviceModelId", "t", "gte", "s", "LIST_APP_ERRORS", "p", "ListAppsCommandError", "s", "e", "ListAppsCommand", "listAppApduArgs", "res", "ApduParser", "i", "CommandUtils", "errorCode", "t", "r", "isCommandErrorCode", "CommandResultFactory", "o", "GlobalCommandErrorHandler", "apduResponse", "parser", "appEntryLength", "a", "appCodeHash", "d", "m", "LOAD_CERTIFICATE_ERRORS", "a", "LoadCertificateCommandError", "s", "e", "o", "LoadCertificateCommand", "providePkiApduArgs", "CommandUtils", "CommandResultFactory", "errorCode", "ApduParser", "i", "isCommandErrorCode", "r", "GlobalCommandErrorHandler", "apduResponse", "OPEN_APP_ERRORS", "n", "OpenAppCommandError", "s", "r", "p", "OpenAppCommand", "f", "openAppApduArgs", "CommandUtils", "e", "CommandResultFactory", "o", "errorCode", "ApduParser", "i", "isCommandErrorCode", "GlobalCommandErrorHandler", "apduResponse", "DeviceStatus", "DeviceActionStatus", "UserInteractionRequired", "value", "f", "list", "e", "x", "m", "_", "left", "x", "e", "_", "g", "f", "x", "_", "_a", "i", "e", "encode", "x", "x", "first", "f", "g", "value", "x", "helpers", "f", "v", "e", "g", "_", "fromPromise", "_a", "helpers", "x", "f", "v", "_", "fromPromise", "w", "i", "context", "self", "_a", "_b", "_c", "isObserver", "delay", "timeout", "_a", "ProcessingStatus", "_b", "err", "reportError", "_", "cancel", "spawnChild", "stop", "context", "resolved", "m", "s", "config", "a", "b", "delay", "t", "s2", "t2", "t3", "_a", "e", "actions", "event", "getMeta", "toJSON", "can", "hasTag", "matches", "_", "self", "raise", "_", "self", "emit", "_a", "_b", "_a", "self", "emit", "_", "context", "assign", "_", "emit", "SpecialTargets", "config", "t", "i", "map", "STATE_IDENTIFIER", "context", "self", "children", "config", "DeviceNotOnboardedError", "message", "DeviceLockedError", "UnsupportedFirmwareDAError", "RefusedByUserDAError", "AppAlreadyInstalledDAError", "OutOfMemoryDAError", "UnknownDAError", "UnsupportedApplicationDAError", "DEFAULT_UNLOCK_TIMEOUT_MS", "d", "b", "p", "P", "e", "_", "t", "f", "y", "g", "n", "v", "o", "s", "m", "i", "n", "r", "e", "from", "i", "l", "v", "g", "q", "f", "n", "a", "b", "e", "settle", "r", "o", "m", "i", "n", "v", "settle", "d", "i", "Subscription", "e", "_a", "empty", "timeout", "_i", "reportUnhandledError", "_a", "Subscriber", "ConsumerObserver", "SafeSubscriber", "reportUnhandledError", "identity", "x", "identity", "Observable", "observable", "_a", "_i", "x", "_a", "OperatorSubscriber", "err", "_a", "ConnectableObservable", "cancel", "timestamp", "_i", "timestamp", "Subject", "_b", "_c", "_a", "observable", "AnonymousSubject", "_b", "_a", "BehaviorSubject", "_a", "ReplaySubject", "_a", "i", "last", "AsyncSubject", "_a", "Action", "delay", "timeout", "_i", "AsyncAction", "delay", "_a", "e", "setImmediate", "_i", "AsapAction", "delay", "_a", "Scheduler", "delay", "AsyncScheduler", "AsapScheduler", "QueueAction", "delay", "QueueScheduler", "AnimationFrameAction", "delay", "_a", "AnimationFrameScheduler", "VirtualTimeScheduler", "_a", "VirtualAction", "delay", "a", "b", "x", "_a", "_b", "fromPromise", "i", "reportUnhandledError", "process", "delay", "repeat", "delay", "delay", "i", "iterator", "_a", "iterator", "_i", "NotificationKind", "Notification", "_a", "_d", "_a", "_b", "_c", "config", "_a", "first", "_b", "_c", "_d", "delay", "isArray", "isArray", "expand", "buffer", "a", "i", "b", "identity", "n", "_i", "isArray", "i", "count", "_a", "_b", "_c", "_d", "refCount", "_i", "E", "args", "internalApi", "stateMachine", "e", "n", "actor", "createActor", "subject", "ReplaySubject", "handleActorSnapshot", "snapshot", "context", "status", "output", "m", "DeviceActionStatus", "err", "c", "result", "p", "observable", "Observable", "subscriber", "subjectSubscription", "r", "actorSubscription", "o", "share", "DeviceSessionStateType", "E", "n", "p", "c", "i", "o", "unlockTimeout", "DEFAULT_UNLOCK_TIMEOUT_MS", "l", "isDeviceOnboarded", "d", "context", "e", "assign", "s", "_", "sessionState", "t", "a", "state", "getDeviceSessionState", "DeviceSessionStateType", "setDeviceSessionState", "args", "v", "A", "Right", "currentAppVersion", "internalApi", "from", "mergeMap", "output", "isSuccessCommandResult", "take", "GeneralDmkError", "err", "DeviceAlreadyConnectedError", "DeviceNotRecognizedError", "NoAccessibleDeviceError", "OpeningConnectionError", "UnknownDeviceError", "TransportNotSupportedError", "SendApduConcurrencyError", "SendApduTimeoutError", "SendApduEmptyResponseError", "DisconnectError", "ReconnectionFailedError", "DeviceNotInitializedError", "NoTransportsProvidedError", "TransportAlreadyExistsError", "DeviceDisconnectedWhileSendingError", "AlreadySendingApduError", "DeviceDisconnectedBeforeSendingApdu", "NoTransportProvidedError", "DASHBOARD_NAMES", "isDashboardName", "name", "E", "r", "getDeviceSessionState", "o", "isDeviceOnboarded", "setDeviceSessionState", "A", "d", "S", "m", "internalApi", "closeApp", "fromPromise", "getDeviceStatusMachine", "s", "e", "context", "k", "n", "assign", "_", "sessionStateType", "a", "p", "UserInteractionRequired", "state", "DeviceSessionStateType", "output", "CloseAppCommand", "arg0", "i", "f", "R", "internalAPI", "a", "r", "fromPromise", "e", "_", "input", "s", "assign", "error", "n", "context", "internalApi", "E", "r", "o", "s", "a", "u", "GetDeviceStatusDeviceAction", "i", "d", "unlockTimeout", "fromPromise", "getAppAndVersion", "e", "isDashboardName", "S", "_", "sessionState", "t", "output", "UnknownDAError", "assign", "DeviceSessionStateType", "state", "Right", "internalApi", "E", "n", "s", "unlockTimeout", "r", "goToDashboardMachine", "GoToDashboardDeviceAction", "o", "context", "t", "_", "UserInteractionRequired", "assign", "p", "internalApi", "ListAppsCommand", "command", "import_semver", "i", "ListLanguagePackCommandError", "s", "message", "r", "e", "ListLanguagePackCommand", "parser", "CommandUtils", "errorCode", "o", "isCommandErrorCode", "A", "GlobalCommandErrorHandler", "apduResponse", "idBuffer", "t", "sizeBuffer", "n", "id", "u", "bufferToHexaString", "size", "g", "CommandResultFactory", "w", "args", "n", "e", "a", "manager", "appHashes", "installedApps", "app", "result", "l", "u", "catalog", "t", "o", "c", "appsWithMetadata", "applications", "index", "apps", "catalogApp", "s", "h", "d", "filteredCatalog", "gt", "i", "r", "language", "installedLanguages", "g", "CommandResultFactory", "A", "f", "s", "GetCustomImageSizeCommandError", "message", "e", "r", "GetCustomImageSizeCommand", "y", "apduArgs", "parser", "apduResponse", "i", "CommandUtils", "errorCode", "m", "isCommandErrorCode", "CommandResultFactory", "o", "GlobalCommandErrorHandler", "size", "t", "R", "e", "api", "GetOsVersionCommand", "isSuccessCommandResult", "s", "m", "osVersion", "r", "n", "manager", "a", "currentFirmware", "i", "result", "o", "InvalidGetFirmwareMetadataResponseError", "availableUpdate", "w", "mcus", "t", "mcu", "l", "mcuUpdateRequired", "data", "firmwareUpdateContext", "f", "customImage", "d", "p", "GetCustomImageSizeCommand", "y", "CommandResultFactory", "installedAppResultGuard", "value", "item", "SecureChannelOperationEnum", "InMessageQueryEnum", "OutMessageResponseEnum", "SecureChannelEventType", "GENUINE_DEVICE_RESULT", "c", "e", "willRequestPermission", "a", "isGetCertificateApdu", "p", "extractPublicKey", "r", "i", "ApduParser", "s", "isDeviceGenuine", "payload", "n", "le", "i", "h", "l", "h", "l", "s", "crypto", "a", "n", "b", "min", "i", "i", "u", "_", "R", "x", "y", "t", "j", "h", "l", "s", "B", "take", "i", "NobleCryptoService", "data", "sha3_256", "SecureChannelErrorType", "r", "a", "WebSocketConnectionError", "i", "e", "E", "c", "l", "_api", "n", "c", "E", "i", "ignoreNetworkEvents", "communicationFinished", "t", "g", "notifyError", "error", "subscriber", "v", "SecureChannelEventType", "f", "o", "l", "input", "event", "e", "a", "s", "data", "p", "SecureChannelError", "apdu", "willRequestPermission", "u", "m", "unsubscribed", "d", "apduResponse", "outMessageResponse", "C", "OutMessageResponseEnum", "isGetCertificateApdu", "publicKey", "deviceId", "_", "k", "deviceError", "message", "nonce", "M", "len", "response", "payload", "InMessageQueryEnum", "reenableRefresher", "SecureChannelErrorType", "CommandUtils", "E", "n", "getFirmwareMetadata", "getApplicationsMetadata", "d", "listAppsSecureChannel", "m", "g", "t", "l", "listAppsMachine", "p", "setup", "goToDashboardMachine", "getDeviceMetadata", "u", "e", "context", "assign", "_", "s", "error", "a", "deviceState", "SecureChannelEventType", "_a", "o", "_b", "app", "firmwareVersion", "firmwareUpdateContext", "v", "S", "w", "h", "D", "M", "y", "A", "internalApi", "GetApplicationsMetadataTask", "arg0", "firmware", "connection", "import_semver", "w", "args", "i", "n", "api", "r", "_a", "_b", "a", "s", "alreadyInstalled", "missingApplications", "t", "app", "deviceState", "l", "e", "installedApp", "catalogApp", "installPlan", "E", "apps", "o", "f", "index", "constraints", "constraint", "gte", "M", "args", "t", "e", "a", "s", "r", "o", "n", "deviceState", "firmwareUpdateContext", "customImage", "firmwareVersion", "installedLanguages", "i", "l", "currentMemoryBlocksUsage", "c", "installPlanBlocksUsage", "m", "totalMemoryBlocks", "size", "blockSize", "firmwareBlocks", "bytesToBlocks", "customImageBlocks", "applicationsBlocks", "installedApps", "app", "p", "languagesBlocks", "lang", "E", "buildInstallPlan", "t", "predictOutOfMemory", "c", "unlockTimeout", "d", "r", "l", "GoToDashboardDeviceAction", "s", "internalApi", "fromPromise", "goToDashboardMachine", "u", "context", "e", "_", "a", "UserInteractionRequired", "assign", "data", "error", "n", "_a", "SecureChannelEventType", "o", "args", "installPlan", "m", "Left", "p", "w", "arg0", "PredictOutOfMemoryTask", "M", "XStateDeviceAction", "E", "a", "getAppsByHash", "c", "i", "r", "s", "DEFAULT_UNLOCK_TIMEOUT_MS", "p", "fromPromise", "t", "e", "app", "A", "o", "getDeviceSessionState", "l", "filterted", "h", "error", "context", "_", "apps", "appsWithMetadata", "acc", "internalApi", "appHashes", "w", "unlockTimeout", "r", "DEFAULT_UNLOCK_TIMEOUT_MS", "getMetadataMachine", "o", "a", "InstallOrUpdateAppsDeviceAction", "c", "OpenAppDeviceAction", "s", "setup", "installAppsMachine", "e", "assign", "_", "data", "t", "error", "context", "args", "deviceMetadata", "p", "l", "Left", "u", "internalAPI", "t", "o", "fromPromise", "e", "_", "input", "s", "assign", "error", "r", "context", "internalApi", "isPromise", "object", "then", "stringifyServiceIdentifier", "serviceIdentifier", "toString", "name", "Error", "islazyServiceIdentifierSymbol", "Symbol", "for", "_a", "LazyServiceIdentifier", "buildServiceId", "this", "value", "unwrap", "getOwnReflectMetadata", "target", "metadataKey", "Reflect", "getOwnMetadata", "setReflectMetadata", "target", "metadataKey", "metadata", "Reflect", "defineMetadata", "updateOwnReflectMetadata", "buildDefaultValue", "callback", "updatedMetadata", "getOwnReflectMetadata", "ID_METADATA", "getBindingId", "bindingId", "getOwnReflectMetadata", "Object", "Number", "MAX_SAFE_INTEGER", "setReflectMetadata", "MIN_SAFE_INTEGER", "updateOwnReflectMetadata", "id", "bindingScopeValues", "Request", "Singleton", "Transient", "bindingTypeValues", "ConstantValue", "DynamicValue", "Factory", "Instance", "Provider", "ResolvedValue", "ServiceRedirection", "chain", "iterables", "iterable", "OneToManyMapStar", "spec", "modelToRelationMap", "relationToModelsMaps", "this", "Map", "specProperty", "Reflect", "ownKeys", "model", "relation", "push", "relationKey", "clone", "properties", "property", "key", "value", "get", "keys", "models", "uniqueModelsSet", "Set", "relations", "Error", "delete", "relationValue", "buildOrGetModelArray", "set", "buildOrGetRelationModels", "pushEntriesIntoMap", "source", "target", "removeModelFromRelationMaps", "removeModelFromRelationMap", "relationModels", "index", "indexOf", "splice", "length", "ActivationRelationKind", "BindingRelationKind", "DeactivationRelationKind", "ActivationsService", "parent", "activationMaps", "moduleId", "isOptional", "serviceId", "activation", "add", "serviceIdentifier", "activationIterables", "activations", "parentActivations", "removeByRelation", "BindingService", "bindingMaps", "getNonParentBindings", "getById", "getByModuleId", "getNonParentBoundServices", "getAllKeys", "binding", "DeactivationsService", "deactivationMaps", "deactivation", "deactivationIterables", "deactivations", "parentDeactivations", "classMetadataReflectKey", "getDefaultClassMetadata", "constructorArguments", "lifecycle", "postConstructMethodName", "preDestroyMethodName", "undefined", "properties", "Map", "scope", "pendingClassMetadataCountReflectKey", "isAppErrorSymbol", "Symbol", "for", "InversifyCoreError", "Error", "kind", "message", "options", "super", "this", "value", "is", "InversifyCoreErrorKind", "MaybeClassElementMetadataKind", "ClassElementMetadataKind", "getClassMetadata", "type", "classMetadata", "getOwnReflectMetadata", "pendingClassMetadataCount", "undefinedIndexes", "length", "missingInjectionDecorator", "name", "toString", "i", "push", "join", "errors", "constructorArgument", "unknown", "propertyKey", "property", "getDefaultPendingClassMetadataCount", "decrementPendingClassMetadataCount", "metadata", "updateOwnReflectMetadata", "count", "buildClassElementMetadataFromMaybeClassElementMetadata", "buildDefaultMetadata", "buildMetadataFromMaybeManagedMetadata", "params", "unmanaged", "injectionDecoratorConflict", "assertMetadataFromTypescriptIfManaged", "isFromTypescriptParamType", "buildManagedMetadataFromMaybeClassElementMetadata", "serviceIdentifier", "optional", "tags", "updateMaybeClassMetadataProperty", "updateMetadata", "propertyMetadata", "get", "set", "DecoratorInfoKind", "handleInjectionError", "target", "parameterIndex", "error", "isErrorOfKind", "info", "parameterIndexOrDescriptor", "targetClass", "constructor", "index", "parameter", "method", "decoratorTargetInfo", "cause", "injectBase", "updatePendingClassMetadataCount", "buildComposedUpdateMetadataFromTarget", "buildComposedUpdateMetadata", "descriptor", "updateTargetPendingClassMetadataCount", "inject", "singleInjection", "classIsInjectableFlagReflectKey", "NON_USERLAND_TYPES", "Array", "BigInt", "Boolean", "Function", "Number", "Object", "String", "updateClassMetadataWithTypescriptParameterTypes", "typescriptConstructorArguments", "forEach", "constructorArgumentType", "includes", "injectable", "setReflectMetadata", "buildDefaultUnmanagedMetadata", "kind", "ClassElementMetadataKind", "unmanaged", "buildUnmanagedMetadataFromMaybeClassElementMetadata", "buildClassElementMetadataFromMaybeClassElementMetadata", "metadata", "assertMetadataFromTypescriptIfManaged", "name", "optional", "tags", "size", "InversifyCoreError", "InversifyCoreErrorKind", "injectionDecoratorConflict", "ResolvedValueElementMetadataKind", "BindingConstraintsImplementation", "node", "this", "name", "elem", "serviceIdentifier", "tags", "getAncestor", "previous", "SingleInmutableLinkedList", "last", "Symbol", "iterator", "next", "done", "value", "undefined", "buildFilteredServiceBindings", "params", "bindingConstraints", "options", "customServiceIdentifier", "filteredBindings", "getBindings", "filter", "binding", "isSatisfiedBy", "length", "autobindOptions", "classMetadata", "getClassMetadata", "scope", "cache", "isRight", "id", "getBindingId", "implementationType", "moduleId", "onActivation", "onDeactivation", "type", "bindingTypeValues", "Instance", "setBinding", "push", "isPlanServiceRedirectionBindingNode", "redirections", "throwErrorWhenUnexpectedBindingsAmountFound", "bindings", "isOptional", "parentServiceIdentifier", "targetServiceIdentifier", "parent", "Array", "isArray", "errorMessage", "stringifyServiceIdentifier", "map", "ServiceRedirection", "join", "stringifyParentServiceIdentifier", "stringifyBindingConstraints", "InversifyCoreError", "InversifyCoreErrorKind", "planning", "throwBindingNotFoundError", "stringifiedTags", "size", "keys", "key", "toString", "checkPlanServiceRedirectionBindingNodeSingleInjectionBindings", "serviceRedirectionBindingNode", "planBindingNode", "checkServiceNodeSingleInjectionBindings", "serviceNode", "handlePlanError", "error", "Error", "RangeError", "test", "message", "stringifiedCircularDependencies", "serviceIdentifiers", "serviceIdentifiersArray", "Set", "servicesBranch", "has", "add", "cause", "plan", "Map", "rootConstraints", "tag", "set", "bindingConstraintsList", "filteredServiceBindings", "serviceNodeBindings", "buildServiceNodeBindings", "isMultiple", "tree", "root", "buildInstancePlanBindingNode", "parentNode", "childNode", "constructorParams", "propertyParams", "subplan", "buildPlanServiceNodeFromClassElementMetadata", "elementMetadata", "kind", "ClassElementMetadataKind", "unmanaged", "LazyServiceIdentifier", "is", "unwrap", "updatedBindingConstraintsList", "concat", "singleInjection", "optional", "buildPlanServiceNodeFromResolvedValueElementMetadata", "buildResolvedValuePlanBindingNode", "serviceBindings", "planBindingNodes", "ResolvedValue", "buildServiceRedirectionPlanBindingNode", "pop", "index", "constructorArguments", "entries", "propertyKey", "properties", "planServiceNode", "resolvedValueMetadata", "metadata", "arguments", "GetPlanBooleanOptionsMask", "PlanResultCacheService", "constructor", "serviceIdToValuePlanMap", "namedServiceIdToValuePlanMap", "taggedServiceIdToValuePlanMap", "namedTaggedServiceIdToValuePlanMap", "subscribers", "clearCache", "clear", "subscriber", "get", "planResult", "singleMandatory", "buildInitializedMapArray", "mapArray", "i", "getOrBuildMapValueFromMapMap", "valueMap", "getMapFromMapArray", "getMaps", "getMapArrayIndex", "multipleOptional", "multipleMandatory", "singleOptional", "cacheResolvedValue", "resolvedValue", "isPromise", "then", "syncResolvedValue", "cacheSyncResolvedValue", "resolveBindingServiceActivations", "activations", "getActivations", "resolveBindingActivationsFromIteratorAsync", "activationsIterator", "activatedValue", "activationIteratorResult", "nextActivatedValue", "context", "async", "resolveBindingActivations", "activationResult", "resolved", "resolveSingletonScopedBinding", "resolve", "resolveConstantValueBinding", "_params", "getSelf", "self", "resolveScoped", "getBinding", "arg", "bindingScopeValues", "Singleton", "Request", "requestScopeCache", "Transient", "resolveDynamicValueBinding", "resolveFactoryBinding", "factory", "resolvePostConstruct", "instance", "postConstructMethodName", "postConstructResult", "resolution", "resolveInstanceBindingNodeFromConstructorParams", "setInstanceProperties", "constructorValues", "propertiesAssignmentResult", "lifecycle", "resolveProviderBinding", "provider", "getInstanceNodeBinding", "getResolvedValueNodeBinding", "resolveServiceNode", "propertyAssignmentPromises", "propertyNode", "Promise", "all", "resolveServiceRedirectionBindingNode", "resolveBindingNode", "innerResolveServiceRedirectionBindingNode", "resolvedValues", "redirection", "resolveInstanceBindingNode", "resolveInstanceBindingConstructorParams", "resolveInstanceBindingNodeAsyncFromConstructorParams", "constructorResolvedValues", "constructorParam", "some", "resolveResolvedValueBindingNode", "resolveResolvedValueBindingParams", "paramValues", "resolvedParamValues", "paramsResolvedValues", "param", "resolveScopedInstanceBindingNode", "resolveScopedResolvedValueBindingNode", "ConstantValue", "DynamicValue", "Factory", "Provider", "isScopedBinding", "resolveInstancePreDestroy", "preDestroyMethodName", "resolveBindingServiceDeactivations", "deactivations", "getDeactivations", "resolveBindingDeactivationsFromIteratorAsync", "deactivationsIterator", "deactivationIteratorResult", "nextDeactivationValue", "resolveBindingDeactivations", "preDestroyResult", "resolveBindingDeactivationsAfterPreDestroy", "bindingCache", "resolveBindingDeactivationsAfterPreDestroyFromValue", "deactivationResult", "bindingDeactivation", "resolveBindingsDeactivations", "singletonScopedBindings", "deactivationPromiseResults", "resolveModuleDeactivations", "getBindingsFromModule", "resolveServiceDeactivations", "ID_METADATA", "ContainerModule", "load", "id", "this", "bindingId", "getOwnReflectMetadata", "Object", "Number", "MAX_SAFE_INTEGER", "setReflectMetadata", "MIN_SAFE_INTEGER", "updateOwnReflectMetadata", "getContainerModuleId", "options", "bindingIdentifierSymbol", "Symbol", "for", "isBindingIdentifier", "value", "BindingConstraintUtils", "static", "_bindingConstraints", "buildBindingIdentifier", "binding", "isAnyAncestorBindingConstraints", "condition", "constraints", "ancestorMetadata", "getAncestor", "isBindingConstraintsWithName", "name", "isBindingConstraintsWithServiceId", "serviceId", "serviceIdentifier", "isBindingConstraintsWithTag", "tag", "tags", "has", "get", "isBindingConstraintsWithNoNameNorTags", "size", "isNoAncestorBindingConstraints", "isAnyAncestorBindingConstraintsConstraint", "isNotParentBindingConstraints", "isParentBindingConstraints", "BindInFluentSyntaxImplementation", "getIdentifier", "inRequestScope", "scope", "bindingScopeValues", "Request", "BindWhenOnFluentSyntaxImplementation", "inSingletonScope", "Singleton", "inTransientScope", "Transient", "BindToFluentSyntaxImplementation", "callback", "containerModuleId", "defaultScope", "type", "classMetadata", "getClassMetadata", "cache", "isRight", "undefined", "getBindingId", "implementationType", "isSatisfiedBy", "always", "moduleId", "onActivation", "onDeactivation", "bindingTypeValues", "Instance", "BindInWhenOnFluentSyntaxImplementation", "toSelf", "Error", "to", "ConstantValue", "builder", "DynamicValue", "factory", "injectOptions", "metadata", "ResolvedValue", "Factory", "provider", "Provider", "service", "targetServiceIdentifier", "ServiceRedirection", "injectOption", "o_fn", "buildResolvedValueMetadata", "arguments", "map", "LazyServiceIdentifier", "is", "kind", "isMultiple", "ResolvedValueElementMetadataKind", "multipleInjection", "singleInjection", "optional", "Map", "key", "BindOnFluentSyntaxImplementation", "activation", "BindWhenFluentSyntaxImplementation", "deactivation", "constraint", "when", "tagValue", "whenDefault", "super", "bindOnFluentSyntax", "bindInFluentSyntax", "isAppErrorSymbol", "InversifyContainerError", "message", "InversifyContainerErrorKind", "DEFAULT_DEFAULT_SCOPE", "Container", "activationService", "bindingService", "deactivationParams", "deactivationService", "getActivationsResolutionParam", "getBindingsPlanParams", "planResultCacheService", "resolutionContext", "setBindingParamsPlan", "snapshots", "PlanResultCacheService", "buildResolutionContext", "parent", "ActivationsService", "build", "BindingService", "DeactivationsService", "subscribe", "bind", "autobind", "planResult", "buildPlanResult", "resolvedValue", "isPromise", "invalidOperation", "stringifyServiceIdentifier", "bindings", "getNonParentBindings", "modules", "Promise", "all", "results", "result", "add", "restore", "snapshot", "pop", "resetComputedProperties", "unbind", "unbindSync", "push", "clone", "identifier", "unbindAll", "nonParentBoundServiceIds", "getNonParentBoundServices", "async", "resolveServiceDeactivations", "removeAllByServiceId", "clearCache", "unload", "buildContainerModuleLoadOptions", "isBound", "rebind", "rebindSync", "w_fn", "buildDeactivationParams", "getBindings", "getBindingsFromModule", "getByModuleId", "getDeactivations", "buildGetPlanOptions", "buildPlanParams", "planParams", "autobindOptions", "rootConstraints", "servicesBranch", "setBinding", "getPlanOptions", "planResultFromCache", "plan", "set", "I_fn", "getAll", "getAllAsync", "getAsync", "getFromPlanResult", "resolve", "context", "getActivations", "requestScopeCache", "handlePlanParamsRootConstraints", "isOptional", "isAnyValidBinding", "bindingConstraints", "module", "resolveModuleDeactivations", "throwUnexpectedAsyncUnbindOperation", "errorMessage", "bindingsById", "getById", "bindingServiceIdentifier", "iterable", "iterator", "firstIteratorResult", "next", "done", "M_fn", "unbindBindingIdentifier", "resolveBindingsDeactivations", "then", "clearAfterUnbindBindingIdentifier", "removeById", "clearAfterUnloadModules", "removeAllByModuleId", "unbindServiceIdentifier", "clearAfterUnbindServiceIdentifier", "import_semver", "BleDeviceInfos", "deviceModel", "serviceUuid", "writeUuid", "writeCmdUuid", "notifyUuid", "TransportDeviceModel", "props", "i", "e", "d", "key", "value", "t", "o", "deviceModel", "acc", "bluetoothSpec", "bleSpec", "serviceToModel", "s", "spec", "__publicField", "StaticDeviceModelDataSource", "DeviceModelId", "semver", "v", "__decorateClass", "injectable", "z", "ApduResponse", "statusCode", "data", "HEAD_TAG", "HEAD_TAG_LENGTH", "CHANNEL_LENGTH", "INDEX_LENGTH", "APDU_DATA_LENGTH_LENGTH", "P", "E", "getOsVersion", "n", "getDeviceVersion", "getFirmwareVersion", "l", "getDeviceSessionState", "S", "r", "i", "GoToDashboardDeviceAction", "a", "c", "fromPromise", "h", "fromObservable", "_", "e", "s", "error", "t", "d", "currentState", "assign", "_a", "o", "SecureChannelEventType", "_b", "Right", "deviceInfo", "internalApi", "eitherConnection", "internalApi", "_", "E", "n", "u", "d", "m", "S", "r", "s", "GoToDashboardDeviceAction", "c", "o", "goToDashboardMachine", "fromPromise", "e", "assign", "error", "t", "isSecureConnectionAllowed", "v", "a", "_a", "SecureChannelEventType", "_b", "GetOsVersionCommand", "input", "ConnectToSecureChannelTask", "E", "n", "c", "u", "d", "r", "o", "i", "p", "_", "internalApi", "I", "goToDashboardMachine", "t", "app", "e", "appToInstall", "s", "UnknownDAError", "state", "a", "UserInteractionRequired", "error", "assign", "_a", "_b", "SecureChannelEventType", "context", "input", "deviceInfo", "P", "E", "n", "uninstallApp", "c", "u", "d", "r", "s", "o", "p", "internalApi", "h", "_", "goToDashboardMachine", "t", "app", "e", "UnknownDAError", "state", "a", "UserInteractionRequired", "installedApps", "error", "assign", "g", "_a", "SecureChannelEventType", "context", "input", "deviceInfo", "v", "i", "i", "x", "a", "b", "c", "d", "y", "q", "s", "t", "i", "URL", "v3", "URL", "v4", "i", "f", "s", "x", "y", "z", "n", "K", "H", "l", "N", "M", "i", "j", "W", "t", "a", "b", "c", "d", "e", "T", "URL", "FramerUtils", "array", "size", "acc", "val", "index", "number", "_el", "APDU_RESPONSE_STATUS_CODE_LENGTH", "PINGER_TIMEOUT", "FramerOverflowError", "FramerApduError", "ReceiverApduError", "message", "DeviceSessionNotFound", "originalError", "d", "header", "t", "r", "bufferToHexaString", "headerRaw", "raw", "d", "t", "index", "r", "headTag", "a", "length", "n", "channel", "i", "e", "FramerUtils", "u", "_a", "_b", "dataSize", "loggerTypes", "DefaultApduReceiverService", "g", "e", "loggerModuleFactory", "r", "value", "t", "n", "u", "data", "FramerUtils", "statusCode", "i", "E", "Just", "ApduResponse", "a", "CHANNEL_LENGTH", "headTag", "rawFrame", "HEAD_TAG_LENGTH", "index", "channelSize", "INDEX_LENGTH", "isFirstIndex", "val", "curr", "L", "b", "ReceiverApduError", "s", "dataSizeLength", "APDU_DATA_LENGTH_LENGTH", "H", "A", "m", "Nothing", "dataIndex", "dataSizeIndex", "v", "frame", "Frame", "d", "FrameHeader", "f", "prev", "dataSize", "__decorateClass", "injectable", "__decorateParam", "inject", "loggerTypes", "loggerFactory", "DefaultApduReceiverService", "g", "Maybe", "e", "r", "DefaultApduSenderService", "frameSize", "channel", "Maybe", "padding", "loggerServiceFactory", "apdu", "frames", "count", "frame", "error", "FramerOverflowError", "frameIndex", "header", "frameOffset", "Left", "FramerApduError", "dataMaxSize", "data", "frameData", "Frame", "Right", "apduSize", "FrameHeader", "v4", "FramerUtils", "CHANNEL_LENGTH", "HEAD_TAG", "INDEX_LENGTH", "APDU_DATA_LENGTH_LENGTH", "sum", "i", "HEAD_TAG_LENGTH", "__decorateClass", "injectable", "__decorateParam", "inject", "loggerTypes", "loggerFactory", "DefaultApduSenderService", "o", "Maybe", "e", "r", "commandTypes", "configTypes", "deviceSessionTypes", "discoveryTypes", "managerApiTypes", "sendTypes", "transportDiTypes", "n", "e", "r", "sessionService", "loggerFactory", "s", "deviceSession", "i", "abortTimeout", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "g", "z", "a", "SendCommandUseCase", "StubUseCase", "__decorateClass", "injectable", "commandModuleFactory", "i", "stub", "e", "w", "bind", "m", "commandTypes", "rebindSync", "a", "r", "s", "r", "i", "sessionService", "loggerFactory", "deviceSession", "e", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "v", "z", "u", "ExecuteDeviceActionUseCase", "deviceActionTypes", "deviceActionModuleFactory", "l", "stub", "o", "w", "bind", "t", "deviceActionTypes", "e", "rebindSync", "i", "r", "isConfig", "obj", "ApiCallError", "err", "ParseResponseError", "JSONParseError", "ReadFileError", "E", "version", "pkg", "h", "stubFsReadFile", "i", "FileLocalConfigDataSource", "Either", "r", "error", "ReadFileError", "str", "o", "config", "isConfig", "l", "JSONParseError", "__decorateClass", "injectable", "StubLocalConfigDataSource", "Either", "__decorateClass", "injectable", "t", "r", "a", "ApiCallError", "e", "l", "o", "dto", "config", "name", "version", "Either", "res", "p", "RestRemoteConfigDataSource", "__decorateClass", "injectable", "StubRemoteConfigDataSource", "res", "Either", "__decorateClass", "injectable", "g", "e", "o", "r", "DefaultConfigService", "loggerServiceFactory", "error", "f", "z", "__decorateClass", "injectable", "__decorateParam", "a", "n", "i", "g", "GetDmkVersionUseCase", "__decorateClass", "injectable", "__decorateParam", "o", "inject", "configTypes", "r", "w", "t", "e", "o", "bind", "i", "n", "g", "rebindSync", "m", "deviceModelTypes", "p", "o", "ContainerModule", "w", "deviceModelTypes", "e", "i", "t", "loggerFactory", "r", "i", "_sessionService", "error", "e", "deviceSession", "__decorateParam", "inject", "deviceSessionTypes", "v", "z", "n", "DisableDeviceSessionRefresherUseCase", "t", "e", "DefaultDeviceSessionService", "loggerModuleFactory", "i", "s", "deviceSession", "sessionId", "found", "n", "length", "v", "z", "__decorateClass", "injectable", "__decorateParam", "c", "e", "i", "CloseSessionsUseCase", "transportService", "dSession", "S", "z", "__decorateClass", "injectable", "__decorateParam", "v", "r", "t", "i", "r", "GetDeviceSessionStateUseCase", "loggerFactory", "e", "error", "deviceSession", "g", "z", "__decorateClass", "injectable", "__decorateParam", "v", "b", "p", "deviceSessionModuleFactory", "w", "r", "ContainerModule", "i", "e", "rebindSync", "o", "context", "logger", "t", "args", "DefaultApduSenderService", "s", "DefaultApduReceiverService", "c", "DEVICE_SESSION_REFRESHER_POLLING_INTERVAL", "DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL", "DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS", "MutexService", "resolve", "release", "next", "RefresherService", "loggerModuleFactory", "_refresher", "id", "uniqueId", "uuidv4", "hasBeenReenabled", "blockerId", "prevBlockersCount", "SessionEvents", "DeviceSessionEventDispatcher", "Subject", "event", "D", "_sessionEventDispatcher", "sendCommandFunction", "r", "n", "e", "t", "s", "error", "GetAppAndVersionCommand", "T", "GetOsVersionCommand", "timeoutPromise", "resolve", "E", "resultOrTimeout", "result", "DeviceSessionRefresher", "loggerModuleFactory", "refresherOptions", "_sessionEventDispatcher", "connectedDevice", "logger", "pollingInterval", "DeviceModelId", "defaultNanoPollingInterval", "DEVICE_SESSION_REFRESHER_POLLING_INTERVAL", "DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL", "timer", "SessionEvents", "d", "_connectedDevice", "_deviceState", "setDeviceSessionState", "c", "r", "e", "t", "n", "a", "newDeviceStatus", "state", "s", "L", "e", "r", "id", "s", "t", "i", "n", "u", "managerApiService", "S", "DeviceSessionStateType", "a", "DevicePinger", "loggerModuleFactory", "D", "c", "p", "d", "state", "l", "options", "SessionEvents", "rawApdu", "response", "CommandUtils", "command", "abortTimeout", "apdu", "err", "result", "deviceAction", "observable", "cancel", "blockerId", "DeviceStatus", "deviceStatus", "secureChannelTypes", "v", "e", "s", "i", "o", "r", "transportService", "loggerFactory", "deviceSessions", "deviceId", "deviceSessionId", "transport", "n", "dId", "error", "device", "connectedDevice", "p", "z", "ConnectUseCase", "t", "v", "r", "e", "transportService", "sessionService", "i", "sessionId", "session", "n", "error", "o", "transportIdentifier", "t", "p", "DisconnectUseCase", "__decorateClass", "injectable", "__decorateParam", "inject", "c", "ConnectedDevice", "id", "deviceModelId", "productName", "type", "transport", "name", "sessionId", "GetConnectedDeviceUseCase", "sessionService", "loggerFactory", "sessionId", "deviceSession", "ConnectedDevice", "error", "__decorateClass", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "loggerTypes", "ListConnectedDevicesUseCase", "sessionService", "loggerFactory", "session", "ConnectedDevice", "__decorateClass", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "loggerTypes", "ListenToAvailableDevicesUseCase", "transportService", "loggerFactory", "discoveredDevice", "deviceModel", "DeviceModel", "transport", "from", "observablesWithIndex", "t", "index", "map", "arr", "merge", "scan", "acc", "of", "devices", "__decorateClass", "injectable", "__decorateParam", "inject", "transportDiTypes", "loggerTypes", "ListenToConnectedDeviceUseCase", "_sessionService", "loggerFactory", "map", "deviceSession", "ConnectedDevice", "__decorateClass", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "loggerTypes", "n", "ReconnectUseCase", "e", "s", "o", "loggerFactory", "sessionRefresherOptions", "z", "__decorateClass", "injectable", "__decorateParam", "t", "p", "_transportService", "r", "DeviceModel", "device", "i", "deviceModel", "transport", "t", "transports", "mergeMap", "instance", "e", "s", "TransportNotSupportedError", "injectable", "__decorateParam", "inject", "transportDiTypes", "z", "c", "StartDiscoveringUseCase", "s", "StopDiscoveringUseCase", "r", "e", "loggerFactory", "transport", "a", "z", "__decorateClass", "injectable", "__decorateParam", "c", "discoveryTypes", "a", "w", "discoveryModuleFactory", "s", "o", "ContainerModule", "v", "rebindSync", "e", "bind", "ConnectUseCase", "n", "ReconnectUseCase", "c", "ListConnectedDevicesUseCase", "stub", "r", "StubUseCase", "LogLevel", "e", "r", "i", "level", "message", "s", "subscriber", "o", "subscriberOptions", "t", "options", "n", "DefaultLoggerPublisherService", "__decorateClass", "injectable", "u", "loggerModuleFactory", "r", "subscribers", "w", "ContainerModule", "e", "bind", "g", "o", "_context", "DefaultLoggerPublisherService", "tag", "bind", "iterator", "cache", "isArray", "isFunction", "isObject", "prototype", "e", "i", "l", "context", "merge", "a", "b", "bind", "descriptors", "filter", "toArray", "matches", "m", "p2", "hasOwnProperty", "define", "noop", "asap", "isIterable", "config", "toJSON", "filter", "i", "filter", "prototype", "toString", "encode", "h", "browser_default", "browser_default", "helpers", "i", "e", "isFormData", "isFileList", "transitional", "i", "context", "filter", "w", "self", "i", "first", "prototype", "config", "context", "config", "validateStatus", "min", "i", "throttle", "timestamp", "timer", "e", "origin", "config", "a", "b", "mergeMap", "merge", "config", "config", "transitional", "cancel", "timeout", "timer", "signal", "iterator", "e", "done", "isFunction", "ReadableStream", "TextEncoder", "e", "config", "timeout", "fetch", "i", "map", "e", "adapter", "config", "i", "s", "config", "adapter", "i", "validators", "config", "e", "transitional", "i", "cancel", "i", "config", "c", "context", "bind", "Axios", "AxiosError", "CanceledError", "isCancel", "CancelToken", "VERSION", "all", "isAxiosError", "spread", "toFormData", "AxiosHeaders", "HttpStatusCode", "getAdapter", "mergeConfig", "AppType", "DEFAULT_MANAGER_API_BASE_URL", "DEFAULT_MOCK_SERVER_BASE_URL", "DEFAULT_PROVIDER", "DEFAULT_FIRMWARE_DISTRIBUTION_SALT", "HttpFetchApiError", "error", "AppTypeDto", "AppTypeDto", "y", "e", "r", "i", "o", "A", "provider", "params", "firmwareVersionName", "EitherAsync", "t", "res", "targetId", "version", "deviceId", "n", "HttpFetchApiError", "error", "hashes", "currentFinalFirmwareId", "appType", "AppType", "app", "hash", "m", "f", "firmwareKey", "v", "del", "deleteKey", "mcus", "mcu", "deviceVersion", "finalFirmware", "ret", "latestFirmware", "osuDto", "language", "u", "z", "g", "injectable", "__decorateParam", "n", "DefaultManagerApiService", "e", "dataSource", "deviceInfo", "r", "deviceVersion", "t", "currentFirmware", "appHashes", "EitherAsync", "fromPromise", "params", "i", "error", "HttpFetchApiError", "throwE", "p", "z", "__decorateClass", "injectable", "__decorateParam", "SetProviderUseCase", "sessionService", "managerApiDataSource", "provider", "session", "state", "DeviceSessionStateType", "__decorateClass", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "managerApiTypes", "C", "a", "i", "w", "e", "r", "rebindSync", "y", "n", "stub", "a", "e", "DefaultSecureChannelDataSource", "params", "n", "URL", "t", "Right", "i", "Left", "WebSocketConnectionError", "m", "z", "__decorateClass", "injectable", "__decorateParam", "i", "e", "r", "deviceInfo", "t", "a", "o", "s", "p", "app", "c", "DefaultSecureChannelService", "__decorateClass", "injectable", "__decorateParam", "inject", "i", "secureChannelModuleFactory", "stub", "w", "ContainerModule", "e", "bind", "t", "a", "DEFAULT_WEB_SOCKET_BASE_URL", "g", "e", "r", "SendApduUseCase", "loggerFactory", "sessionId", "s", "i", "o", "deviceSession", "c", "data", "error", "apdu", "S", "z", "__decorateClass", "injectable", "__decorateParam", "v", "f", "o", "w", "s", "r", "bind", "sendTypes", "e", "g", "stub", "c", "DefaultTransportService", "r", "e", "t", "o", "_transports", "_config", "_loggerModuleFactory", "_apduReceiverServiceFactory", "s", "p", "A", "l", "transport", "d", "either", "factory", "g", "Left", "Right", "connectedDevice", "z", "__decorateClass", "injectable", "__decorateParam", "i", "f", "transportModuleFactory", "r", "stub", "a", "transports", "n", "config", "w", "ContainerModule", "o", "bind", "c", "x", "o", "transports", "t", "loggers", "config", "DEFAULT_MOCK_SERVER_BASE_URL", "_", "DEFAULT_PROVIDER", "A", "container", "Container", "e", "L", "configModuleFactory", "deviceModelModuleFactory", "stub", "transportModuleFactory", "f", "managerApiModuleFactory", "C", "secureChannelModuleFactory", "i", "discoveryModuleFactory", "loggerModuleFactory", "u", "sendModuleFactory", "commandModuleFactory", "deviceActionModuleFactory", "l", "x", "e", "i", "loggers", "config", "n", "stub", "o", "args", "r", "transport", "c", "t", "_", "e", "o", "A", "DeviceManagementKit", "x", "r", "g", "level", "LogLevel", "t", "message", "options", "tag", "r", "logFunction", "getJSONStringifyReplacer", "p", "n", "_", "value", "t", "x", "o", "bytesHex", "e", "L", "i", "ancestors", "l", "message", "options", "r", "s", "level", "url", "a", "W", "n", "makeStateMachine", "b", "triggersDisconnection", "abortTimeout", "s", "t", "r", "c", "a", "u", "e", "i", "d", "apdu", "params", "context", "R", "CommandUtils", "event", "k", "Right", "TransportConnectedDevice", "id", "deviceModel", "type", "transport", "sendApdu", "name", "deviceModelStubBuilder", "props", "DeviceModelId", "e", "defaultApduResponseStubBuilder", "statusCode", "data", "ApduResponse", "props", "e", "deviceModelStubBuilder", "r", "d", "defaultApduResponseStubBuilder", "isBase64String", "value", "base64StringToBuffer", "base64Decoded", "buffer", "i"]
}
