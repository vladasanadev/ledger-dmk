{
  "version": 3,
  "sources": ["../../../../../../src/internal/config/service/DefaultConfigService.test.ts"],
  "sourcesContent": ["import { Either, Left } from \"purify-ts\";\nimport { type Mocked } from \"vitest\";\n\nimport { FileLocalConfigDataSource } from \"@internal/config/data/LocalConfigDataSource\";\nimport { RestRemoteConfigDataSource } from \"@internal/config/data/RemoteConfigDataSource\";\nimport { JSONParseError } from \"@internal/config/model/Errors\";\nimport { DefaultLoggerPublisherService } from \"@internal/logger-publisher/service/DefaultLoggerPublisherService\";\n\nimport { type ConfigService } from \"./ConfigService\";\nimport { DefaultConfigService } from \"./DefaultConfigService\";\n\nvi.mock(\"@internal/config/data/LocalConfigDataSource\");\nvi.mock(\"@internal/config/data/RemoteConfigDataSource\");\n\nlet localDataSource: Mocked<FileLocalConfigDataSource>;\nlet remoteDataSource: Mocked<RestRemoteConfigDataSource>;\nlet loggerService: Mocked<DefaultLoggerPublisherService>;\n\nlet service: ConfigService;\ndescribe(\"DefaultConfigService\", () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    localDataSource =\n      new FileLocalConfigDataSource() as Mocked<FileLocalConfigDataSource>;\n    remoteDataSource =\n      new RestRemoteConfigDataSource() as Mocked<RestRemoteConfigDataSource>;\n\n    loggerService = new DefaultLoggerPublisherService(\n      [],\n      \"config\",\n    ) as Mocked<DefaultLoggerPublisherService>;\n\n    service = new DefaultConfigService(\n      localDataSource,\n      remoteDataSource,\n      () => loggerService,\n    );\n  });\n\n  describe(\"when the local config is available\", () => {\n    it(\"should return the `local` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(\n        Either.of({\n          name: \"DeviceSDK\",\n          version: \"1.0.0-local\",\n        }),\n      );\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeviceSDK\",\n        version: \"1.0.0-local\",\n      });\n    });\n  });\n\n  describe(\"when the local config is not available, use remote\", () => {\n    it(\"should return the `remote` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(Left(new JSONParseError()));\n      remoteDataSource.getConfig.mockResolvedValue(\n        Either.of({\n          name: \"DeviceSDK\",\n          version: \"1.0.0-remote\",\n        }),\n      );\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeviceSDK\",\n        version: \"1.0.0-remote\",\n      });\n    });\n  });\n\n  describe(\"when the local remote config are not available\", () => {\n    it(\"should return the `default` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(Left(new JSONParseError()));\n      remoteDataSource.getConfig.mockResolvedValue(Left(new JSONParseError()));\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeadDmk\",\n        version: \"0.0.0-dead.1\",\n      });\n    });\n  });\n});\n"],
  "mappings": "AAAA,OAAS,UAAAA,EAAQ,QAAAC,MAAY,YAG7B,OAAS,6BAAAC,MAAiC,8CAC1C,OAAS,8BAAAC,MAAkC,+CAC3C,OAAS,kBAAAC,MAAsB,gCAC/B,OAAS,iCAAAC,MAAqC,mEAG9C,OAAS,wBAAAC,MAA4B,yBAErC,GAAG,KAAK,6CAA6C,EACrD,GAAG,KAAK,8CAA8C,EAEtD,IAAIC,EACAC,EACAC,EAEAC,EACJ,SAAS,uBAAwB,IAAM,CACrC,WAAW,IAAM,CACf,GAAG,cAAc,EACjBH,EACE,IAAIL,EACNM,EACE,IAAIL,EAENM,EAAgB,IAAIJ,EAClB,CAAC,EACD,QACF,EAEAK,EAAU,IAAIJ,EACZC,EACAC,EACA,IAAMC,CACR,CACF,CAAC,EAED,SAAS,qCAAsC,IAAM,CACnD,GAAG,oCAAqC,SAAY,CAClDF,EAAgB,UAAU,gBACxBP,EAAO,GAAG,CACR,KAAM,YACN,QAAS,aACX,CAAC,CACH,EAEA,OAAO,MAAMU,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,YACN,QAAS,aACX,CAAC,CACH,CAAC,CACH,CAAC,EAED,SAAS,qDAAsD,IAAM,CACnE,GAAG,qCAAsC,SAAY,CACnDH,EAAgB,UAAU,gBAAgBN,EAAK,IAAIG,CAAgB,CAAC,EACpEI,EAAiB,UAAU,kBACzBR,EAAO,GAAG,CACR,KAAM,YACN,QAAS,cACX,CAAC,CACH,EAEA,OAAO,MAAMU,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,YACN,QAAS,cACX,CAAC,CACH,CAAC,CACH,CAAC,EAED,SAAS,iDAAkD,IAAM,CAC/D,GAAG,sCAAuC,SAAY,CACpDH,EAAgB,UAAU,gBAAgBN,EAAK,IAAIG,CAAgB,CAAC,EACpEI,EAAiB,UAAU,kBAAkBP,EAAK,IAAIG,CAAgB,CAAC,EAEvE,OAAO,MAAMM,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,UACN,QAAS,cACX,CAAC,CACH,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["Either", "Left", "FileLocalConfigDataSource", "RestRemoteConfigDataSource", "JSONParseError", "DefaultLoggerPublisherService", "DefaultConfigService", "localDataSource", "remoteDataSource", "loggerService", "service"]
}
