import{Either as a,Left as i}from"purify-ts";import{JSONParseError as s,ReadFileError as c}from"../../config/model/Errors";import l from"../../../../package.json";import*as o from"./LocalConfigDataSource";const{FileLocalConfigDataSource:f}=o,t=vi.spyOn(o,"stubFsReadFile"),n=vi.spyOn(JSON,"parse"),u=vi.spyOn(JSON,"stringify");let r;describe("LocalConfigDataSource",()=>{describe("FileLocalConfigDataSource",()=>{beforeEach(()=>{vi.resetAllMocks(),r=new f}),afterAll(()=>{vi.resetAllMocks()}),it("should return an Either<never, Config>",()=>{t.mockReturnValue(JSON.stringify({name:"DeviceSDK",version:"0.0.0-spied.1"})),n.mockReturnValue({name:"DeviceSDK",version:"0.0.0-spied.1"}),expect(r.getConfig()).toStrictEqual(a.of({name:"DeviceSDK",version:"0.0.0-spied.1"}))}),it("should return an Either<ReadFileError, never> if readFileSync throws",()=>{const e=new Error("readFileSync error");u.mockImplementation(()=>{throw e}),expect(r.getConfig()).toEqual(i(new c(e)))}),it("should return an Either<JSONParseError, never> if JSON.parse throws",()=>{const e=new Error("JSON.parse error");t.mockReturnValue(JSON.stringify({name:"DeviceSDK",version:"0.0.0-spied.1"})),n.mockImplementation(()=>{throw e}),expect(r.getConfig()).toEqual(i(new s(e)))})}),describe("stubFsReadFile",()=>{it("should return a stringified version of the version object",()=>{expect(o.stubFsReadFile()).toEqual(JSON.stringify({name:"@ledgerhq/device-management-kit",version:l.version}))})})});
//# sourceMappingURL=LocalConfigDataSource.test.js.map
