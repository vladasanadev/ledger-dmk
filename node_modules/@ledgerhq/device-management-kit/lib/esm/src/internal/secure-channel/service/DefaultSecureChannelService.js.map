{
  "version": 3,
  "sources": ["../../../../../../src/internal/secure-channel/service/DefaultSecureChannelService.ts"],
  "sourcesContent": ["import { inject, injectable } from \"inversify\";\nimport WebSocket from \"isomorphic-ws\";\nimport { Either } from \"purify-ts\";\n\nimport { type GetOsVersionResponse } from \"@api/index\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport {\n  type FinalFirmware,\n  type OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport { type SecureChannelDataSource } from \"@internal/secure-channel/data/SecureChannelDataSource\";\nimport { secureChannelTypes } from \"@internal/secure-channel/di/secureChannelTypes\";\nimport { WebSocketConnectionError } from \"@internal/secure-channel/model/Errors\";\nimport {\n  type GenuineCheckParams,\n  type InstallAppsParams,\n  type ListInstalledAppsParams,\n  type UninstallAppsParams,\n  type UpdateFirmwareParams,\n  type UpdateMcuParams,\n} from \"@internal/secure-channel/model/Params\";\n\nimport { type SecureChannelService } from \"./SecureChannelService\";\n\n@injectable()\nexport class DefaultSecureChannelService implements SecureChannelService {\n  constructor(\n    @inject(secureChannelTypes.SecureChannelDataSource)\n    private readonly dataSource: SecureChannelDataSource,\n  ) {}\n\n  genuineCheck(\n    deviceInfo: GetOsVersionResponse,\n    finalFirmware: FinalFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: GenuineCheckParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: finalFirmware.perso,\n    };\n    return this.dataSource.genuineCheck(params);\n  }\n\n  installApp(\n    deviceInfo: GetOsVersionResponse,\n    app: Pick<Application, \"perso\" | \"firmware\" | \"firmwareKey\" | \"hash\">,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const { perso, firmware, firmwareKey, hash } = app;\n    const params: InstallAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso,\n      firmware,\n      firmwareKey,\n      hash,\n    };\n    return this.dataSource.installApp(params);\n  }\n\n  listInstalledApps(\n    deviceInfo: GetOsVersionResponse,\n    finalFirmware: FinalFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: ListInstalledAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: finalFirmware.perso,\n    };\n    return this.dataSource.listInstalledApps(params);\n  }\n\n  uninstallApp(\n    deviceInfo: GetOsVersionResponse,\n    app: Pick<Application, \"perso\" | \"delete\" | \"deleteKey\" | \"hash\">,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const { perso, delete: appDelete, deleteKey, hash } = app;\n    const params: UninstallAppsParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso,\n      firmware: appDelete,\n      firmwareKey: deleteKey,\n      hash,\n    };\n    return this.dataSource.uninstallApp(params);\n  }\n\n  updateFirmware(\n    deviceInfo: GetOsVersionResponse,\n    osuFirmware: OsuFirmware,\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: UpdateFirmwareParams = {\n      targetId: deviceInfo.targetId.toString(),\n      perso: osuFirmware.perso,\n      firmware: osuFirmware.firmware,\n      firmwareKey: osuFirmware.firmwareKey,\n    };\n    return this.dataSource.updateFirmware(params);\n  }\n\n  updateMcu(\n    deviceInfo: GetOsVersionResponse,\n    param: { version: string },\n  ): Either<WebSocketConnectionError, WebSocket> {\n    const params: UpdateMcuParams = {\n      targetId: deviceInfo.targetId.toString(),\n      version: param.version,\n    };\n    return this.dataSource.updateMcu(params);\n  }\n}\n"],
  "mappings": "iOAAA,OAAS,UAAAA,EAAQ,cAAAC,MAAkB,YAWnC,OAAS,sBAAAC,MAA0B,iDAc5B,IAAMC,EAAN,KAAkE,CACvE,YAEmBC,EACjB,CADiB,gBAAAA,CAChB,CAEH,aACEC,EACAC,EAC6C,CAC7C,MAAMC,EAA6B,CACjC,SAAUF,EAAW,SAAS,SAAS,EACvC,MAAOC,EAAc,KACvB,EACA,OAAO,KAAK,WAAW,aAAaC,CAAM,CAC5C,CAEA,WACEF,EACAG,EAC6C,CAC7C,KAAM,CAAE,MAAAC,EAAO,SAAAC,EAAU,YAAAC,EAAa,KAAAC,CAAK,EAAIJ,EACzCD,EAA4B,CAChC,SAAUF,EAAW,SAAS,SAAS,EACvC,MAAAI,EACA,SAAAC,EACA,YAAAC,EACA,KAAAC,CACF,EACA,OAAO,KAAK,WAAW,WAAWL,CAAM,CAC1C,CAEA,kBACEF,EACAC,EAC6C,CAC7C,MAAMC,EAAkC,CACtC,SAAUF,EAAW,SAAS,SAAS,EACvC,MAAOC,EAAc,KACvB,EACA,OAAO,KAAK,WAAW,kBAAkBC,CAAM,CACjD,CAEA,aACEF,EACAG,EAC6C,CAC7C,KAAM,CAAE,MAAAC,EAAO,OAAQI,EAAW,UAAAC,EAAW,KAAAF,CAAK,EAAIJ,EAChDD,EAA8B,CAClC,SAAUF,EAAW,SAAS,SAAS,EACvC,MAAAI,EACA,SAAUI,EACV,YAAaC,EACb,KAAAF,CACF,EACA,OAAO,KAAK,WAAW,aAAaL,CAAM,CAC5C,CAEA,eACEF,EACAU,EAC6C,CAC7C,MAAMR,EAA+B,CACnC,SAAUF,EAAW,SAAS,SAAS,EACvC,MAAOU,EAAY,MACnB,SAAUA,EAAY,SACtB,YAAaA,EAAY,WAC3B,EACA,OAAO,KAAK,WAAW,eAAeR,CAAM,CAC9C,CAEA,UACEF,EACAW,EAC6C,CAC7C,MAAMT,EAA0B,CAC9B,SAAUF,EAAW,SAAS,SAAS,EACvC,QAASW,EAAM,OACjB,EACA,OAAO,KAAK,WAAW,UAAUT,CAAM,CACzC,CACF,EAjFaJ,EAANc,EAAA,CADNC,EAAW,EAGPC,EAAA,EAAAC,EAAOC,EAAmB,uBAAuB,IAFzClB",
  "names": ["inject", "injectable", "secureChannelTypes", "DefaultSecureChannelService", "dataSource", "deviceInfo", "finalFirmware", "params", "app", "perso", "firmware", "firmwareKey", "hash", "appDelete", "deleteKey", "osuFirmware", "param", "__decorateClass", "injectable", "__decorateParam", "inject", "secureChannelTypes"]
}
