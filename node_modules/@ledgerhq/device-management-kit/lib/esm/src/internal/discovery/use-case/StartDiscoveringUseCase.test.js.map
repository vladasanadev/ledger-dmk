{
  "version": 3,
  "sources": ["../../../../../../src/internal/discovery/use-case/StartDiscoveringUseCase.test.ts"],
  "sourcesContent": ["import { Maybe } from \"purify-ts\";\nimport { of } from \"rxjs\";\n\nimport { DeviceModel } from \"@api/device/DeviceModel\";\nimport { type TransportDeviceModel } from \"@api/device-model/model/DeviceModel\";\nimport { TransportMock } from \"@api/transport/model/__mocks__/TransportMock\";\nimport { type TransportDiscoveredDevice } from \"@api/transport/model/TransportDiscoveredDevice\";\nimport {\n  type DeviceModelId,\n  type DiscoveredDevice,\n  type Transport,\n} from \"@api/types\";\nimport { DefaultTransportService } from \"@internal/transport/service/DefaultTransportService\";\nimport { type TransportService } from \"@internal/transport/service/TransportService\";\n\nimport { StartDiscoveringUseCase } from \"./StartDiscoveringUseCase\";\n\nvi.mock(\"@internal/transport/service/DefaultTransportService\");\n\nlet transport: Transport;\nlet transportService: TransportService;\n\ndescribe(\"StartDiscoveringUseCase\", () => {\n  const stubDiscoveredDevice: TransportDiscoveredDevice = {\n    id: \"internal-discovered-device-id\",\n    deviceModel: {\n      id: \"nanoSP\" as DeviceModelId,\n      productName: \"productName\",\n    } as TransportDeviceModel,\n    transport: \"USB\",\n    rssi: undefined,\n  };\n\n  beforeEach(() => {\n    transport = new TransportMock();\n    // @ts-expect-error mock\n    transportService = new DefaultTransportService();\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  test(\"If connect use case encounter an error, return it\", () =>\n    new Promise<void>((resolve, reject) => {\n      const mockedStartDiscovering = vi.fn(() => {\n        return of(stubDiscoveredDevice);\n      });\n      vi.spyOn(transport, \"startDiscovering\").mockImplementation(\n        mockedStartDiscovering,\n      );\n\n      vi.spyOn(transportService, \"getTransport\").mockReturnValue(\n        Maybe.of(transport),\n      );\n\n      const usecase = new StartDiscoveringUseCase(transportService);\n\n      const discover = usecase.execute({ transport: \"USB\" });\n\n      expect(mockedStartDiscovering).toHaveBeenCalled();\n\n      discover.subscribe({\n        next: (discoveredDevice) => {\n          try {\n            expect(discoveredDevice).toStrictEqual({\n              id: \"internal-discovered-device-id\",\n              transport: \"USB\",\n              name: \"productName\",\n              deviceModel: new DeviceModel({\n                id: \"internal-discovered-device-id\",\n                model: \"nanoSP\" as DeviceModelId,\n                name: \"productName\",\n              }),\n              rssi: undefined,\n            } as DiscoveredDevice);\n            resolve();\n          } catch (error) {\n            reject(error);\n          }\n        },\n        error: (error) => {\n          reject(error);\n        },\n      });\n    }));\n});\n"],
  "mappings": "AAAA,OAAS,SAAAA,MAAa,YACtB,OAAS,MAAAC,MAAU,OAEnB,OAAS,eAAAC,MAAmB,0BAE5B,OAAS,iBAAAC,MAAqB,+CAO9B,OAAS,2BAAAC,MAA+B,sDAGxC,OAAS,2BAAAC,MAA+B,4BAExC,GAAG,KAAK,qDAAqD,EAE7D,IAAIC,EACAC,EAEJ,SAAS,0BAA2B,IAAM,CACxC,MAAMC,EAAkD,CACtD,GAAI,gCACJ,YAAa,CACX,GAAI,SACJ,YAAa,aACf,EACA,UAAW,MACX,KAAM,MACR,EAEA,WAAW,IAAM,CACfF,EAAY,IAAIH,EAEhBI,EAAmB,IAAIH,CACzB,CAAC,EAED,UAAU,IAAM,CACd,GAAG,gBAAgB,CACrB,CAAC,EAED,KAAK,oDAAqD,IACxD,IAAI,QAAc,CAACK,EAASC,IAAW,CACrC,MAAMC,EAAyB,GAAG,GAAG,IAC5BV,EAAGO,CAAoB,CAC/B,EACD,GAAG,MAAMF,EAAW,kBAAkB,EAAE,mBACtCK,CACF,EAEA,GAAG,MAAMJ,EAAkB,cAAc,EAAE,gBACzCP,EAAM,GAAGM,CAAS,CACpB,EAIA,MAAMM,EAFU,IAAIP,EAAwBE,CAAgB,EAEnC,QAAQ,CAAE,UAAW,KAAM,CAAC,EAErD,OAAOI,CAAsB,EAAE,iBAAiB,EAEhDC,EAAS,UAAU,CACjB,KAAOC,GAAqB,CAC1B,GAAI,CACF,OAAOA,CAAgB,EAAE,cAAc,CACrC,GAAI,gCACJ,UAAW,MACX,KAAM,cACN,YAAa,IAAIX,EAAY,CAC3B,GAAI,gCACJ,MAAO,SACP,KAAM,aACR,CAAC,EACD,KAAM,MACR,CAAqB,EACrBO,EAAQ,CACV,OAASK,EAAO,CACdJ,EAAOI,CAAK,CACd,CACF,EACA,MAAQA,GAAU,CAChBJ,EAAOI,CAAK,CACd,CACF,CAAC,CACH,CAAC,CAAC,CACN,CAAC",
  "names": ["Maybe", "of", "DeviceModel", "TransportMock", "DefaultTransportService", "StartDiscoveringUseCase", "transport", "transportService", "stubDiscoveredDevice", "resolve", "reject", "mockedStartDiscovering", "discover", "discoveredDevice", "error"]
}
