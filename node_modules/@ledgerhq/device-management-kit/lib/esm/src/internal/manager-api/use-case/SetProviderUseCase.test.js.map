{
  "version": 3,
  "sources": ["../../../../../../src/internal/manager-api/use-case/SetProviderUseCase.test.ts"],
  "sourcesContent": ["import { describe, expect, it, vi } from \"vitest\";\n\nimport { DeviceStatus } from \"@api/device/DeviceStatus\";\nimport {\n  type Catalog,\n  type DeviceSessionState,\n  type FirmwareUpdateContext,\n  type FirmwareVersion,\n} from \"@api/device-session/DeviceSessionState\";\nimport { DeviceSessionStateType } from \"@api/device-session/DeviceSessionState\";\nimport { type DeviceSession } from \"@internal/device-session/model/DeviceSession\";\nimport { type DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\n\nimport { SetProviderUseCase } from \"./SetProviderUseCase\";\n\ndescribe(\"SetProviderUseCase\", () => {\n  const getDeviceSessionStateMock = vi.fn();\n  const setDeviceSessionStateMock = vi.fn();\n  const getDeviceSessionsMock = vi.fn();\n  const mockDeviceSession = {\n    addDeviceSession: vi.fn(),\n    getDeviceSessionById: vi.fn(),\n    getDeviceSessionByDeviceId: vi.fn(),\n    removeDeviceSession: vi.fn(),\n    getDeviceSessions: getDeviceSessionsMock,\n    sessionsObs: vi.fn(),\n  } as unknown as DeviceSessionService;\n\n  const mockManagerApiDataSource: ManagerApiDataSource = {\n    setProvider: vi.fn(),\n  } as unknown as ManagerApiDataSource;\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    getDeviceSessionsMock.mockReturnValue([\n      {\n        getDeviceSessionState: getDeviceSessionStateMock,\n        setDeviceSessionState: setDeviceSessionStateMock,\n      } as unknown as DeviceSession,\n    ]);\n  });\n\n  it(\"should call setProvider on ManagerApiDataSource with the correct provider\", () => {\n    // GIVEN\n    const useCase = new SetProviderUseCase(\n      mockDeviceSession,\n      mockManagerApiDataSource,\n    );\n    const provider = 123;\n    getDeviceSessionStateMock.mockReturnValue({\n      sessionStateType: DeviceSessionStateType.Connected,\n      deviceStatus: DeviceStatus.CONNECTED,\n    } as DeviceSessionState);\n\n    // WHEN\n    useCase.execute(provider);\n\n    // THEN\n    expect(mockManagerApiDataSource.setProvider).toHaveBeenCalledWith(provider);\n    expect(setDeviceSessionStateMock).not.toHaveBeenCalled();\n  });\n\n  it(\"should clean the device session\", () => {\n    // GIVEN\n    const useCase = new SetProviderUseCase(\n      mockDeviceSession,\n      mockManagerApiDataSource,\n    );\n    const provider = 123;\n    getDeviceSessionStateMock.mockReturnValue({\n      sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel,\n      deviceStatus: DeviceStatus.CONNECTED,\n      firmwareVersion: \"firmwareVersion\" as unknown as FirmwareVersion,\n      firmwareUpdateContext:\n        \"firmwareUpdateContext\" as unknown as FirmwareUpdateContext,\n      installedApps: \"apps\" as unknown as Application[],\n      appsUpdates: \"appsUpdate\" as unknown as Application[],\n      catalog: \"catalog\" as unknown as Catalog,\n    } as DeviceSessionState);\n\n    // WHEN\n    useCase.execute(provider);\n\n    // THEN\n    expect(mockManagerApiDataSource.setProvider).toHaveBeenCalledWith(provider);\n    expect(setDeviceSessionStateMock).toHaveBeenCalledWith({\n      sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel,\n      deviceStatus: DeviceStatus.CONNECTED,\n      firmwareVersion: \"firmwareVersion\" as unknown as FirmwareVersion,\n      firmwareUpdateContext: undefined,\n      installedApps: [],\n      appsUpdates: undefined,\n      catalog: undefined,\n    });\n  });\n});\n"],
  "mappings": "AAAA,OAAS,YAAAA,EAAU,UAAAC,EAAQ,MAAAC,EAAI,MAAAC,MAAU,SAEzC,OAAS,gBAAAC,MAAoB,2BAO7B,OAAS,0BAAAC,MAA8B,yCAMvC,OAAS,sBAAAC,MAA0B,uBAEnCN,EAAS,qBAAsB,IAAM,CACnC,MAAMO,EAA4BJ,EAAG,GAAG,EAClCK,EAA4BL,EAAG,GAAG,EAClCM,EAAwBN,EAAG,GAAG,EAC9BO,EAAoB,CACxB,iBAAkBP,EAAG,GAAG,EACxB,qBAAsBA,EAAG,GAAG,EAC5B,2BAA4BA,EAAG,GAAG,EAClC,oBAAqBA,EAAG,GAAG,EAC3B,kBAAmBM,EACnB,YAAaN,EAAG,GAAG,CACrB,EAEMQ,EAAiD,CACrD,YAAaR,EAAG,GAAG,CACrB,EAEA,WAAW,IAAM,CACfA,EAAG,cAAc,EACjBM,EAAsB,gBAAgB,CACpC,CACE,sBAAuBF,EACvB,sBAAuBC,CACzB,CACF,CAAC,CACH,CAAC,EAEDN,EAAG,4EAA6E,IAAM,CAEpF,MAAMU,EAAU,IAAIN,EAClBI,EACAC,CACF,EACME,EAAW,IACjBN,EAA0B,gBAAgB,CACxC,iBAAkBF,EAAuB,UACzC,aAAcD,EAAa,SAC7B,CAAuB,EAGvBQ,EAAQ,QAAQC,CAAQ,EAGxBZ,EAAOU,EAAyB,WAAW,EAAE,qBAAqBE,CAAQ,EAC1EZ,EAAOO,CAAyB,EAAE,IAAI,iBAAiB,CACzD,CAAC,EAEDN,EAAG,kCAAmC,IAAM,CAE1C,MAAMU,EAAU,IAAIN,EAClBI,EACAC,CACF,EACME,EAAW,IACjBN,EAA0B,gBAAgB,CACxC,iBAAkBF,EAAuB,0BACzC,aAAcD,EAAa,UAC3B,gBAAiB,kBACjB,sBACE,wBACF,cAAe,OACf,YAAa,aACb,QAAS,SACX,CAAuB,EAGvBQ,EAAQ,QAAQC,CAAQ,EAGxBZ,EAAOU,EAAyB,WAAW,EAAE,qBAAqBE,CAAQ,EAC1EZ,EAAOO,CAAyB,EAAE,qBAAqB,CACrD,iBAAkBH,EAAuB,0BACzC,aAAcD,EAAa,UAC3B,gBAAiB,kBACjB,sBAAuB,OACvB,cAAe,CAAC,EAChB,YAAa,OACb,QAAS,MACX,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["describe", "expect", "it", "vi", "DeviceStatus", "DeviceSessionStateType", "SetProviderUseCase", "getDeviceSessionStateMock", "setDeviceSessionStateMock", "getDeviceSessionsMock", "mockDeviceSession", "mockManagerApiDataSource", "useCase", "provider"]
}
