{
  "version": 3,
  "sources": ["../../../../../../src/internal/manager-api/service/DefaultManagerApiService.ts"],
  "sourcesContent": ["import { inject, injectable } from \"inversify\";\nimport { EitherAsync } from \"purify-ts\";\n\nimport { type GetOsVersionResponse } from \"@api/command/os/GetOsVersionCommand\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { managerApiTypes } from \"@internal/manager-api/di/managerApiTypes\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\nimport { type DeviceVersion } from \"@internal/manager-api/model/Device\";\nimport { HttpFetchApiError } from \"@internal/manager-api/model/Errors\";\nimport {\n  type FinalFirmware,\n  type McuFirmware,\n  type OsuFirmware,\n} from \"@internal/manager-api/model/Firmware\";\nimport {\n  type GetAppByHashParams,\n  type GetAppListParams,\n  type GetDeviceVersionParams,\n  type GetFirmwareVersionParams,\n  type GetLanguagePackagesParams,\n  type GetLatestFirmwareVersionParams,\n} from \"@internal/manager-api/model/Params\";\n\nimport { type ManagerApiService } from \"./ManagerApiService\";\n\n@injectable()\nexport class DefaultManagerApiService implements ManagerApiService {\n  constructor(\n    @inject(managerApiTypes.ManagerApiDataSource)\n    private readonly dataSource: ManagerApiDataSource,\n  ) {}\n\n  getAppList(\n    deviceInfo: GetOsVersionResponse,\n  ): EitherAsync<HttpFetchApiError, Array<Application>> {\n    const params: GetAppListParams = {\n      targetId: deviceInfo.targetId.toString(),\n      firmwareVersionName: deviceInfo.seVersion,\n    };\n    return this.dataSource.getAppList(params);\n  }\n\n  getDeviceVersion(deviceInfo: GetOsVersionResponse) {\n    const params: GetDeviceVersionParams = {\n      targetId: deviceInfo.targetId.toString(),\n    };\n    return this.dataSource.getDeviceVersion(params);\n  }\n\n  getFirmwareVersion(\n    deviceInfo: GetOsVersionResponse,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetFirmwareVersionParams = {\n      version: deviceInfo.seVersion,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getFirmwareVersion(params);\n  }\n\n  getOsuFirmwareVersion(\n    deviceInfo: GetOsVersionResponse,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetFirmwareVersionParams = {\n      version: deviceInfo.seVersion,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getOsuFirmwareVersion(params);\n  }\n\n  getLatestFirmwareVersion(\n    currentFirmware: FinalFirmware,\n    deviceVersion: DeviceVersion,\n  ) {\n    const params: GetLatestFirmwareVersionParams = {\n      currentFinalFirmwareId: currentFirmware.id,\n      deviceId: deviceVersion.id,\n    };\n    return this.dataSource.getLatestFirmwareVersion(params);\n  }\n\n  getNextFirmwareVersion(osuFirmware: OsuFirmware) {\n    return this.dataSource.getFirmwareVersionById(\n      osuFirmware.nextFinalFirmware,\n    );\n  }\n\n  getLanguagePackages(\n    deviceVersion: DeviceVersion,\n    currentFirmware: FinalFirmware,\n  ) {\n    const params: GetLanguagePackagesParams = {\n      deviceId: deviceVersion.id,\n      currentFinalFirmwareId: currentFirmware.id,\n    };\n    return this.dataSource.getLanguagePackages(params);\n  }\n\n  getMcuList(): EitherAsync<HttpFetchApiError, Array<McuFirmware>> {\n    return this.dataSource.getMcuList();\n  }\n\n  getAppsByHash(appHashes: Array<string>) {\n    const params: GetAppByHashParams = {\n      hashes: appHashes,\n    };\n    return EitherAsync<HttpFetchApiError, Array<Application | null>>(\n      async ({ fromPromise, throwE }) => {\n        if (params.hashes.length === 0) {\n          return [];\n        }\n        try {\n          const response = await fromPromise(\n            this.dataSource.getAppsByHash(params),\n          );\n          return response;\n        } catch (error) {\n          if (error instanceof HttpFetchApiError) {\n            return throwE(error);\n          }\n          return throwE(new HttpFetchApiError(error));\n        }\n      },\n    );\n  }\n}\n"],
  "mappings": "iOAAA,OAAS,UAAAA,EAAQ,cAAAC,MAAkB,YACnC,OAAS,eAAAC,MAAmB,YAI5B,OAAS,mBAAAC,MAAuB,2CAGhC,OAAS,qBAAAC,MAAyB,qCAkB3B,IAAMC,EAAN,KAA4D,CACjE,YAEmBC,EACjB,CADiB,gBAAAA,CAChB,CAEH,WACEC,EACoD,CACpD,MAAMC,EAA2B,CAC/B,SAAUD,EAAW,SAAS,SAAS,EACvC,oBAAqBA,EAAW,SAClC,EACA,OAAO,KAAK,WAAW,WAAWC,CAAM,CAC1C,CAEA,iBAAiBD,EAAkC,CACjD,MAAMC,EAAiC,CACrC,SAAUD,EAAW,SAAS,SAAS,CACzC,EACA,OAAO,KAAK,WAAW,iBAAiBC,CAAM,CAChD,CAEA,mBACED,EACAE,EACA,CACA,MAAMD,EAAmC,CACvC,QAASD,EAAW,UACpB,SAAUE,EAAc,EAC1B,EACA,OAAO,KAAK,WAAW,mBAAmBD,CAAM,CAClD,CAEA,sBACED,EACAE,EACA,CACA,MAAMD,EAAmC,CACvC,QAASD,EAAW,UACpB,SAAUE,EAAc,EAC1B,EACA,OAAO,KAAK,WAAW,sBAAsBD,CAAM,CACrD,CAEA,yBACEE,EACAD,EACA,CACA,MAAMD,EAAyC,CAC7C,uBAAwBE,EAAgB,GACxC,SAAUD,EAAc,EAC1B,EACA,OAAO,KAAK,WAAW,yBAAyBD,CAAM,CACxD,CAEA,uBAAuBG,EAA0B,CAC/C,OAAO,KAAK,WAAW,uBACrBA,EAAY,iBACd,CACF,CAEA,oBACEF,EACAC,EACA,CACA,MAAMF,EAAoC,CACxC,SAAUC,EAAc,GACxB,uBAAwBC,EAAgB,EAC1C,EACA,OAAO,KAAK,WAAW,oBAAoBF,CAAM,CACnD,CAEA,YAAiE,CAC/D,OAAO,KAAK,WAAW,WAAW,CACpC,CAEA,cAAcI,EAA0B,CACtC,MAAMJ,EAA6B,CACjC,OAAQI,CACV,EACA,OAAOC,EACL,MAAO,CAAE,YAAAC,EAAa,OAAAC,CAAO,IAAM,CACjC,GAAIP,EAAO,OAAO,SAAW,EAC3B,MAAO,CAAC,EAEV,GAAI,CAIF,OAHiB,MAAMM,EACrB,KAAK,WAAW,cAAcN,CAAM,CACtC,CAEF,OAASQ,EAAO,CACd,OAAIA,aAAiBC,EACZF,EAAOC,CAAK,EAEdD,EAAO,IAAIE,EAAkBD,CAAK,CAAC,CAC5C,CACF,CACF,CACF,CACF,EApGaX,EAANa,EAAA,CADNC,EAAW,EAGPC,EAAA,EAAAC,EAAOC,EAAgB,oBAAoB,IAFnCjB",
  "names": ["inject", "injectable", "EitherAsync", "managerApiTypes", "HttpFetchApiError", "DefaultManagerApiService", "dataSource", "deviceInfo", "params", "deviceVersion", "currentFirmware", "osuFirmware", "appHashes", "EitherAsync", "fromPromise", "throwE", "error", "HttpFetchApiError", "__decorateClass", "injectable", "__decorateParam", "inject", "managerApiTypes"]
}
