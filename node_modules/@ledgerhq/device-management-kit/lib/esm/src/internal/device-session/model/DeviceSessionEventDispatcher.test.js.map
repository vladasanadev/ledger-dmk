{
  "version": 3,
  "sources": ["../../../../../../src/internal/device-session/model/DeviceSessionEventDispatcher.test.ts"],
  "sourcesContent": ["import { describe, expect, it } from \"vitest\";\n\nimport { type GetAppAndVersionResponse } from \"@api/index\";\nimport type { CommandResult } from \"@api/types\";\n\nimport {\n  DeviceSessionEventDispatcher,\n  type NewEvent,\n  SessionEvents,\n} from \"./DeviceSessionEventDispatcher\";\n\ndescribe(\"DeviceSessionEventDispatcher\", () => {\n  let dispatcher: DeviceSessionEventDispatcher;\n\n  beforeEach(() => {\n    dispatcher = new DeviceSessionEventDispatcher();\n  });\n\n  it(\"should dispatch and receive an event without payload\", () =>\n    new Promise((resolve, reject) => {\n      // given\n      const expectedEvent: NewEvent = {\n        eventName: SessionEvents.REFRESH_NEEDED,\n        eventData: undefined,\n      };\n\n      // when\n      const subscription = dispatcher.listen().subscribe((event) => {\n        // then\n        try {\n          expect(event).toEqual(expectedEvent);\n          resolve(undefined);\n        } catch (error) {\n          reject(error);\n        } finally {\n          subscription.unsubscribe();\n        }\n      });\n\n      dispatcher.dispatch(expectedEvent);\n    }));\n\n  it(\"should dispatch and receive a COMMAND_SUCCEEDED event with payload\", () =>\n    new Promise((resolve, reject) => {\n      // given\n      const dummyCommandResult = {\n        status: \"success\",\n        data: { someField: \"dummyValue\" },\n      } as unknown as CommandResult<GetAppAndVersionResponse>;\n\n      const expectedEvent: NewEvent = {\n        eventName: SessionEvents.COMMAND_SUCCEEDED,\n        eventData: dummyCommandResult,\n      };\n\n      // when\n      const subscription = dispatcher.listen().subscribe((event) => {\n        if (event.eventName === SessionEvents.COMMAND_SUCCEEDED) {\n          // then\n          try {\n            expect(event).toEqual(expectedEvent);\n            resolve(undefined);\n          } catch (error) {\n            reject(error);\n          } finally {\n            subscription.unsubscribe();\n          }\n        }\n      });\n\n      dispatcher.dispatch(expectedEvent);\n    }));\n\n  it(\"should dispatch multiple events\", () =>\n    new Promise((resolve, reject) => {\n      // given\n      const events: NewEvent[] = [\n        {\n          eventName: SessionEvents.DEVICE_STATE_UPDATE_BUSY,\n          eventData: undefined,\n        },\n        {\n          eventName: SessionEvents.DEVICE_STATE_UPDATE_CONNECTED,\n          eventData: undefined,\n        },\n      ];\n      const received: NewEvent[] = [];\n\n      // when\n      const subscription = dispatcher.listen().subscribe((event) => {\n        received.push(event);\n\n        // then\n        if (received.length === events.length) {\n          try {\n            expect(received).toEqual(events);\n            resolve(undefined);\n          } catch (error) {\n            reject(error);\n          } finally {\n            subscription.unsubscribe();\n          }\n        }\n      });\n\n      events.forEach((event) => dispatcher.dispatch(event));\n    }));\n});\n"],
  "mappings": "AAAA,OAAS,YAAAA,EAAU,UAAAC,EAAQ,MAAAC,MAAU,SAKrC,OACE,gCAAAC,EAEA,iBAAAC,MACK,iCAEPJ,EAAS,+BAAgC,IAAM,CAC7C,IAAIK,EAEJ,WAAW,IAAM,CACfA,EAAa,IAAIF,CACnB,CAAC,EAEDD,EAAG,uDAAwD,IACzD,IAAI,QAAQ,CAACI,EAASC,IAAW,CAE/B,MAAMC,EAA0B,CAC9B,UAAWJ,EAAc,eACzB,UAAW,MACb,EAGMK,EAAeJ,EAAW,OAAO,EAAE,UAAWK,GAAU,CAE5D,GAAI,CACFT,EAAOS,CAAK,EAAE,QAAQF,CAAa,EACnCF,EAAQ,MAAS,CACnB,OAASK,EAAO,CACdJ,EAAOI,CAAK,CACd,QAAE,CACAF,EAAa,YAAY,CAC3B,CACF,CAAC,EAEDJ,EAAW,SAASG,CAAa,CACnC,CAAC,CAAC,EAEJN,EAAG,qEAAsE,IACvE,IAAI,QAAQ,CAACI,EAASC,IAAW,CAE/B,MAAMK,EAAqB,CACzB,OAAQ,UACR,KAAM,CAAE,UAAW,YAAa,CAClC,EAEMJ,EAA0B,CAC9B,UAAWJ,EAAc,kBACzB,UAAWQ,CACb,EAGMH,EAAeJ,EAAW,OAAO,EAAE,UAAWK,GAAU,CAC5D,GAAIA,EAAM,YAAcN,EAAc,kBAEpC,GAAI,CACFH,EAAOS,CAAK,EAAE,QAAQF,CAAa,EACnCF,EAAQ,MAAS,CACnB,OAASK,EAAO,CACdJ,EAAOI,CAAK,CACd,QAAE,CACAF,EAAa,YAAY,CAC3B,CAEJ,CAAC,EAEDJ,EAAW,SAASG,CAAa,CACnC,CAAC,CAAC,EAEJN,EAAG,kCAAmC,IACpC,IAAI,QAAQ,CAACI,EAASC,IAAW,CAE/B,MAAMM,EAAqB,CACzB,CACE,UAAWT,EAAc,yBACzB,UAAW,MACb,EACA,CACE,UAAWA,EAAc,8BACzB,UAAW,MACb,CACF,EACMU,EAAuB,CAAC,EAGxBL,EAAeJ,EAAW,OAAO,EAAE,UAAWK,GAAU,CAI5D,GAHAI,EAAS,KAAKJ,CAAK,EAGfI,EAAS,SAAWD,EAAO,OAC7B,GAAI,CACFZ,EAAOa,CAAQ,EAAE,QAAQD,CAAM,EAC/BP,EAAQ,MAAS,CACnB,OAASK,EAAO,CACdJ,EAAOI,CAAK,CACd,QAAE,CACAF,EAAa,YAAY,CAC3B,CAEJ,CAAC,EAEDI,EAAO,QAASH,GAAUL,EAAW,SAASK,CAAK,CAAC,CACtD,CAAC,CAAC,CACN,CAAC",
  "names": ["describe", "expect", "it", "DeviceSessionEventDispatcher", "SessionEvents", "dispatcher", "resolve", "reject", "expectedEvent", "subscription", "event", "error", "dummyCommandResult", "events", "received"]
}
