{
  "version": 3,
  "sources": ["../../../../../../src/internal/device-session/service/RefresherService.test.ts"],
  "sourcesContent": ["import { type LoggerPublisherService } from \"@api/types\";\n\nimport { type RefresherController, RefresherService } from \"./RefresherService\";\n\nlet refresher: RefresherController;\ndescribe(\"RefresherService\", () => {\n  let mockLogger: LoggerPublisherService & {\n    debug: ReturnType<typeof vi.fn>;\n  };\n  const mockedLoggerModuleFactory = vi.fn(() => mockLogger);\n\n  beforeEach(() => {\n    refresher = {\n      start: vi.fn(),\n      stop: vi.fn(),\n    };\n    mockLogger = {\n      info: vi.fn(),\n      warn: vi.fn(),\n      error: vi.fn(),\n      debug: vi.fn(),\n      subscribers: [],\n    };\n  });\n\n  it(\"should be created\", () => {\n    const refresherService = new RefresherService(\n      mockedLoggerModuleFactory,\n      refresher,\n    );\n    expect(refresherService).toBeDefined();\n  });\n\n  describe(\"with only 1 blocker\", () => {\n    it(\"should disable the refresher\", () => {\n      const refresherService = new RefresherService(\n        mockedLoggerModuleFactory,\n        refresher,\n      );\n      refresherService.disableRefresher(\"test\");\n      expect(refresher.stop).toHaveBeenCalled();\n    });\n\n    it(\"should reenable the refresher\", () => {\n      const refresherService = new RefresherService(\n        mockedLoggerModuleFactory,\n        refresher,\n      );\n      const reenableRefresher = refresherService.disableRefresher(\"test\");\n      reenableRefresher();\n      expect(refresher.stop).toHaveBeenCalled();\n      expect(refresher.start).toHaveBeenCalled();\n    });\n  });\n\n  describe(\"with 2+ blockers\", () => {\n    it(\"should not disable the refresher a second time\", () => {\n      const refresherService = new RefresherService(\n        mockedLoggerModuleFactory,\n        refresher,\n      );\n      refresherService.disableRefresher(\"test\");\n      refresherService.disableRefresher(\"test-2\");\n      expect(refresher.stop).toHaveBeenCalledTimes(1);\n    });\n\n    it(\"should reenable the refresher when the last blocker is removed\", () => {\n      const refresherService = new RefresherService(\n        mockedLoggerModuleFactory,\n        refresher,\n      );\n      const reenableRefresher1 = refresherService.disableRefresher(\"test\");\n      const reenableRefresher2 = refresherService.disableRefresher(\"test-2\");\n      expect(refresher.stop).toHaveBeenCalledTimes(1);\n      reenableRefresher1();\n      expect(refresher.start).not.toHaveBeenCalled();\n      reenableRefresher2();\n      expect(refresher.start).toHaveBeenCalled();\n    });\n  });\n});\n"],
  "mappings": "AAEA,OAAmC,oBAAAA,MAAwB,qBAE3D,IAAIC,EACJ,SAAS,mBAAoB,IAAM,CACjC,IAAIC,EAGJ,MAAMC,EAA4B,GAAG,GAAG,IAAMD,CAAU,EAExD,WAAW,IAAM,CACfD,EAAY,CACV,MAAO,GAAG,GAAG,EACb,KAAM,GAAG,GAAG,CACd,EACAC,EAAa,CACX,KAAM,GAAG,GAAG,EACZ,KAAM,GAAG,GAAG,EACZ,MAAO,GAAG,GAAG,EACb,MAAO,GAAG,GAAG,EACb,YAAa,CAAC,CAChB,CACF,CAAC,EAED,GAAG,oBAAqB,IAAM,CAC5B,MAAME,EAAmB,IAAIJ,EAC3BG,EACAF,CACF,EACA,OAAOG,CAAgB,EAAE,YAAY,CACvC,CAAC,EAED,SAAS,sBAAuB,IAAM,CACpC,GAAG,+BAAgC,IAAM,CACd,IAAIJ,EAC3BG,EACAF,CACF,EACiB,iBAAiB,MAAM,EACxC,OAAOA,EAAU,IAAI,EAAE,iBAAiB,CAC1C,CAAC,EAED,GAAG,gCAAiC,IAAM,CACf,IAAID,EAC3BG,EACAF,CACF,EAC2C,iBAAiB,MAAM,EAChD,EAClB,OAAOA,EAAU,IAAI,EAAE,iBAAiB,EACxC,OAAOA,EAAU,KAAK,EAAE,iBAAiB,CAC3C,CAAC,CACH,CAAC,EAED,SAAS,mBAAoB,IAAM,CACjC,GAAG,iDAAkD,IAAM,CACzD,MAAMG,EAAmB,IAAIJ,EAC3BG,EACAF,CACF,EACAG,EAAiB,iBAAiB,MAAM,EACxCA,EAAiB,iBAAiB,QAAQ,EAC1C,OAAOH,EAAU,IAAI,EAAE,sBAAsB,CAAC,CAChD,CAAC,EAED,GAAG,iEAAkE,IAAM,CACzE,MAAMG,EAAmB,IAAIJ,EAC3BG,EACAF,CACF,EACMI,EAAqBD,EAAiB,iBAAiB,MAAM,EAC7DE,EAAqBF,EAAiB,iBAAiB,QAAQ,EACrE,OAAOH,EAAU,IAAI,EAAE,sBAAsB,CAAC,EAC9CI,EAAmB,EACnB,OAAOJ,EAAU,KAAK,EAAE,IAAI,iBAAiB,EAC7CK,EAAmB,EACnB,OAAOL,EAAU,KAAK,EAAE,iBAAiB,CAC3C,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["RefresherService", "refresher", "mockLogger", "mockedLoggerModuleFactory", "refresherService", "reenableRefresher1", "reenableRefresher2"]
}
