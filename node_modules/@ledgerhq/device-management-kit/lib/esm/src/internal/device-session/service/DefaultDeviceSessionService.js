var S=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var v=(r,e,s,i)=>{for(var o=i>1?void 0:i?a(e,s):e,n=r.length-1,c;n>=0;n--)(c=r[n])&&(o=(i?c(e,s,o):c(o))||o);return i&&o&&S(e,s,o),o},h=(r,e)=>(s,i)=>e(s,i,r);import{inject as l,injectable as u}from"inversify";import{Maybe as d}from"purify-ts";import{ReplaySubject as m}from"rxjs";import{DeviceSessionNotFound as g}from"../../device-session/model/Errors";import{loggerTypes as D}from"../../logger-publisher/di/loggerTypes";let t=class{_sessions;_sessionsSubject;_logger;constructor(e){this._sessions=[],this._sessionsSubject=new m,this._logger=e("DeviceSessionService")}get sessionsObs(){return this._sessionsSubject.asObservable()}addDeviceSession(e){return this._sessions.find(i=>i.id===e.id)?(this._logger.warn("DeviceSession already exists",{data:{deviceSession:e}}),this):(this._sessions.push(e),this._sessionsSubject.next(e),this._logger.info("DeviceSession added",{data:{sessionId:e.id}}),this)}removeDeviceSession(e){const s=this._sessions.find(i=>i.id===e);return s?(s.close(),this._sessions=this._sessions.filter(i=>i.id!==e),this._logger.info("DeviceSession removed",{data:{sessionId:e}}),this):(this._logger.warn("DeviceSession not found",{data:{sessionId:e}}),this)}getDeviceSessionById(e){return d.fromNullable(this._sessions.find(s=>s.id===e)).toEither(new g)}getDeviceSessionsByDeviceId(e){return d.fromPredicate(({length:s})=>s>0,this._sessions.filter(s=>s.connectedDevice.id===e)).toEither(new g)}getDeviceSessions(){return this._sessions}};t=v([u(),h(0,l(D.LoggerPublisherServiceFactory))],t);export{t as DefaultDeviceSessionService};
//# sourceMappingURL=DefaultDeviceSessionService.js.map
