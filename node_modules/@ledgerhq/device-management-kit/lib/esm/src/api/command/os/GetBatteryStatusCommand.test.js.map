{
  "version": 3,
  "sources": ["../../../../../../src/api/command/os/GetBatteryStatusCommand.test.ts"],
  "sourcesContent": ["import {\n  CommandResultFactory,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { ApduResponse } from \"@api/device-session/ApduResponse\";\n\nimport {\n  BatteryStatusType,\n  ChargingMode,\n  GetBatteryStatusCommand,\n} from \"./GetBatteryStatusCommand\";\n\nconst GET_BATTERY_STATUS_APDU_PERCENTAGE = Uint8Array.from([\n  0xe0, 0x10, 0x00, 0x00, 0x00,\n]);\nconst GET_BATTERY_STATUS_APDU_VOLTAGE = Uint8Array.from([\n  0xe0, 0x10, 0x00, 0x01, 0x00,\n]);\nconst GET_BATTERY_STATUS_APDU_TEMPERATURE = Uint8Array.from([\n  0xe0, 0x10, 0x00, 0x02, 0x00,\n]);\nconst GET_BATTERY_STATUS_APDU_CURRENT = Uint8Array.from([\n  0xe0, 0x10, 0x00, 0x03, 0x00,\n]);\nconst GET_BATTERY_STATUS_APDU_FLAGS = Uint8Array.from([\n  0xe0, 0x10, 0x00, 0x04, 0x00,\n]);\n\nconst PERCENTAGE_RESPONSE_HEX = Uint8Array.from([0x37, 0x90, 0x00]);\nconst VOLTAGE_RESPONSE_HEX = Uint8Array.from([0x0f, 0xff, 0x90, 0x00]);\nconst TEMPERATURE_RESPONSE_HEX = Uint8Array.from([0x10, 0x90, 0x00]);\nconst FLAGS_RESPONSE_HEX = Uint8Array.from([\n  0x00, 0x00, 0x00, 0x0f, 0x90, 0x00,\n]);\nconst FAILED_RESPONSE_HEX = Uint8Array.from([0x67, 0x00]);\n\ndescribe(\"GetBatteryStatus\", () => {\n  describe(\"name\", () => {\n    it(\"should be 'getBatteryStatus'\", () => {\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_PERCENTAGE,\n      });\n      expect(command.name).toBe(\"getBatteryStatus\");\n    });\n  });\n\n  describe(\"getApdu\", () => {\n    it(\"should return the GetBatteryStatus APDU\", () => {\n      expect(\n        new GetBatteryStatusCommand({\n          statusType: BatteryStatusType.BATTERY_PERCENTAGE,\n        })\n          .getApdu()\n          .getRawApdu(),\n      ).toStrictEqual(GET_BATTERY_STATUS_APDU_PERCENTAGE);\n      expect(\n        new GetBatteryStatusCommand({\n          statusType: BatteryStatusType.BATTERY_VOLTAGE,\n        })\n          .getApdu()\n          .getRawApdu(),\n      ).toStrictEqual(GET_BATTERY_STATUS_APDU_VOLTAGE);\n      expect(\n        new GetBatteryStatusCommand({\n          statusType: BatteryStatusType.BATTERY_TEMPERATURE,\n        })\n          .getApdu()\n          .getRawApdu(),\n      ).toStrictEqual(GET_BATTERY_STATUS_APDU_TEMPERATURE);\n      expect(\n        new GetBatteryStatusCommand({\n          statusType: BatteryStatusType.BATTERY_CURRENT,\n        })\n          .getApdu()\n          .getRawApdu(),\n      ).toStrictEqual(GET_BATTERY_STATUS_APDU_CURRENT);\n      expect(\n        new GetBatteryStatusCommand({\n          statusType: BatteryStatusType.BATTERY_FLAGS,\n        })\n          .getApdu()\n          .getRawApdu(),\n      ).toStrictEqual(GET_BATTERY_STATUS_APDU_FLAGS);\n    });\n  });\n  describe(\"parseResponse\", () => {\n    it(\"should parse the response when querying percentage\", () => {\n      const PERCENTAGE_RESPONSE = new ApduResponse({\n        statusCode: PERCENTAGE_RESPONSE_HEX.slice(-2),\n        data: PERCENTAGE_RESPONSE_HEX.slice(0, -2),\n      });\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_PERCENTAGE,\n      });\n      const parsed = command.parseResponse(PERCENTAGE_RESPONSE);\n      expect(parsed).toStrictEqual(CommandResultFactory({ data: 55 }));\n    });\n    it(\"should parse the response when querying voltage\", () => {\n      const VOLTAGE_RESPONSE = new ApduResponse({\n        statusCode: VOLTAGE_RESPONSE_HEX.slice(-2),\n        data: VOLTAGE_RESPONSE_HEX.slice(0, -2),\n      });\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_VOLTAGE,\n      });\n      const parsed = command.parseResponse(VOLTAGE_RESPONSE);\n      expect(parsed).toStrictEqual(CommandResultFactory({ data: 4095 }));\n    });\n    it(\"should parse the response when querying temperature\", () => {\n      const TEMPERATURE_RESPONSE = new ApduResponse({\n        statusCode: TEMPERATURE_RESPONSE_HEX.slice(-2),\n        data: TEMPERATURE_RESPONSE_HEX.slice(0, -2),\n      });\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_TEMPERATURE,\n      });\n      const parsed = command.parseResponse(TEMPERATURE_RESPONSE);\n      expect(parsed).toStrictEqual(CommandResultFactory({ data: 16 }));\n    });\n    it(\"should parse the response when querying flags\", () => {\n      const FLAGS_RESPONSE = new ApduResponse({\n        statusCode: FLAGS_RESPONSE_HEX.slice(-2),\n        data: FLAGS_RESPONSE_HEX.slice(0, -2),\n      });\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_FLAGS,\n      });\n      const parsed = command.parseResponse(FLAGS_RESPONSE);\n      expect(parsed).toStrictEqual(\n        CommandResultFactory({\n          data: {\n            charging: ChargingMode.USB,\n            issueCharging: false,\n            issueTemperature: false,\n            issueBattery: false,\n          },\n        }),\n      );\n    });\n    it(\"should return an error if the response returned unsupported format\", () => {\n      const FAILED_RESPONSE = new ApduResponse({\n        statusCode: FAILED_RESPONSE_HEX.slice(-2),\n        data: FAILED_RESPONSE_HEX.slice(0, -2),\n      });\n      const command = new GetBatteryStatusCommand({\n        statusType: BatteryStatusType.BATTERY_PERCENTAGE,\n      });\n      const result = command.parseResponse(FAILED_RESPONSE);\n      expect(isSuccessCommandResult(result)).toBeFalsy();\n    });\n  });\n});\n"],
  "mappings": "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",
  "names": ["CommandResultFactory", "isSuccessCommandResult", "ApduResponse", "BatteryStatusType", "ChargingMode", "GetBatteryStatusCommand", "GET_BATTERY_STATUS_APDU_PERCENTAGE", "GET_BATTERY_STATUS_APDU_VOLTAGE", "GET_BATTERY_STATUS_APDU_TEMPERATURE", "GET_BATTERY_STATUS_APDU_CURRENT", "GET_BATTERY_STATUS_APDU_FLAGS", "PERCENTAGE_RESPONSE_HEX", "VOLTAGE_RESPONSE_HEX", "TEMPERATURE_RESPONSE_HEX", "FLAGS_RESPONSE_HEX", "FAILED_RESPONSE_HEX", "command", "PERCENTAGE_RESPONSE", "parsed", "VOLTAGE_RESPONSE", "TEMPERATURE_RESPONSE", "FLAGS_RESPONSE", "FAILED_RESPONSE", "result"]
}
