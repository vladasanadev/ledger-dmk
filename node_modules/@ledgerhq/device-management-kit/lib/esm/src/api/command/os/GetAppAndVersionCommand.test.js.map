{
  "version": 3,
  "sources": ["../../../../../../src/api/command/os/GetAppAndVersionCommand.test.ts"],
  "sourcesContent": ["import {\n  CommandResultFactory,\n  isSuccessCommandResult,\n} from \"@api/command/model/CommandResult\";\nimport { ApduResponse } from \"@api/device-session/ApduResponse\";\n\nimport { GetAppAndVersionCommand } from \"./GetAppAndVersionCommand\";\n\nconst GET_APP_AND_VERSION_APDU = Uint8Array.from([\n  0xb0, 0x01, 0x00, 0x00, 0x00,\n]);\n\nconst OS_RESPONSE_HEX = Uint8Array.from([\n  0x01, 0x05, 0x42, 0x4f, 0x4c, 0x4f, 0x53, 0x09, 0x31, 0x2e, 0x34, 0x2e, 0x30,\n  0x2d, 0x72, 0x63, 0x32, 0x90, 0x00,\n]);\n\nconst APP_RESPONSE_HEX = Uint8Array.from([\n  0x01, 0x07, 0x42, 0x69, 0x74, 0x63, 0x6f, 0x69, 0x6e, 0x0b, 0x32, 0x2e, 0x31,\n  0x2e, 0x35, 0x2d, 0x61, 0x6c, 0x70, 0x68, 0x61, 0x01, 0x02, 0x90, 0x00,\n]);\n\nconst FAILED_RESPONSE_HEX = Uint8Array.from([0x67, 0x00]);\n\nconst ERROR_RESPONSE_HEX = Uint8Array.from([0x04, 0x90, 0x00]);\n\ndescribe(\"GetAppAndVersionCommand\", () => {\n  let command: GetAppAndVersionCommand;\n\n  beforeEach(() => {\n    command = new GetAppAndVersionCommand();\n  });\n\n  describe(\"name\", () => {\n    it(\"should be 'getAppAndVersion'\", () => {\n      expect(command.name).toBe(\"getAppAndVersion\");\n    });\n  });\n\n  describe(\"getApdu\", () => {\n    it(\"should return the GetAppAndVersion APDU\", () => {\n      const apdu = command.getApdu();\n      expect(apdu.getRawApdu()).toStrictEqual(GET_APP_AND_VERSION_APDU);\n    });\n  });\n\n  describe(\"parseResponse\", () => {\n    it(\"should parse the response when launching OS (dashboard)\", () => {\n      const OS_RESPONSE = new ApduResponse({\n        statusCode: OS_RESPONSE_HEX.slice(-2),\n        data: OS_RESPONSE_HEX.slice(0, -2),\n      });\n      const parsed = command.parseResponse(OS_RESPONSE);\n      const expected = CommandResultFactory({\n        data: {\n          name: \"BOLOS\",\n          version: \"1.4.0-rc2\",\n        },\n      });\n      expect(parsed).toStrictEqual(expected);\n    });\n    it(\"should parse the response when launching App\", () => {\n      const APP_RESPONSE = new ApduResponse({\n        statusCode: APP_RESPONSE_HEX.slice(-2),\n        data: APP_RESPONSE_HEX.slice(0, -2),\n      });\n      const parsed = command.parseResponse(APP_RESPONSE);\n      const expected = CommandResultFactory({\n        data: {\n          name: \"Bitcoin\",\n          version: \"2.1.5-alpha\",\n          flags: Uint8Array.from([2]),\n        },\n      });\n      expect(parsed).toStrictEqual(expected);\n    });\n    it(\"should throw an error if the command failed\", () => {\n      // given\n      const FAILED_RESPONSE = new ApduResponse({\n        statusCode: FAILED_RESPONSE_HEX.slice(-2),\n        data: FAILED_RESPONSE_HEX.slice(0, -2),\n      });\n      // when\n      const result = command.parseResponse(FAILED_RESPONSE);\n\n      // then\n      expect(isSuccessCommandResult(result)).toBeFalsy();\n    });\n    it(\"should return an error if the response returned unsupported format\", () => {\n      // given\n      const ERROR_RESPONSE = new ApduResponse({\n        statusCode: ERROR_RESPONSE_HEX.slice(-2),\n        data: ERROR_RESPONSE_HEX.slice(0, -2),\n      });\n      // when\n      const response = command.parseResponse(ERROR_RESPONSE);\n\n      // then\n      expect(isSuccessCommandResult(response)).toBeFalsy();\n    });\n  });\n});\n"],
  "mappings": "AAAA,OACE,wBAAAA,EACA,0BAAAC,MACK,mCACP,OAAS,gBAAAC,MAAoB,mCAE7B,OAAS,2BAAAC,MAA+B,4BAExC,MAAMC,EAA2B,WAAW,KAAK,CAC/C,IAAM,EAAM,EAAM,EAAM,CAC1B,CAAC,EAEKC,EAAkB,WAAW,KAAK,CACtC,EAAM,EAAM,GAAM,GAAM,GAAM,GAAM,GAAM,EAAM,GAAM,GAAM,GAAM,GAAM,GACxE,GAAM,IAAM,GAAM,GAAM,IAAM,CAChC,CAAC,EAEKC,EAAmB,WAAW,KAAK,CACvC,EAAM,EAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GACxE,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,EAAM,EAAM,IAAM,CACpE,CAAC,EAEKC,EAAsB,WAAW,KAAK,CAAC,IAAM,CAAI,CAAC,EAElDC,EAAqB,WAAW,KAAK,CAAC,EAAM,IAAM,CAAI,CAAC,EAE7D,SAAS,0BAA2B,IAAM,CACxC,IAAIC,EAEJ,WAAW,IAAM,CACfA,EAAU,IAAIN,CAChB,CAAC,EAED,SAAS,OAAQ,IAAM,CACrB,GAAG,+BAAgC,IAAM,CACvC,OAAOM,EAAQ,IAAI,EAAE,KAAK,kBAAkB,CAC9C,CAAC,CACH,CAAC,EAED,SAAS,UAAW,IAAM,CACxB,GAAG,0CAA2C,IAAM,CAClD,MAAMC,EAAOD,EAAQ,QAAQ,EAC7B,OAAOC,EAAK,WAAW,CAAC,EAAE,cAAcN,CAAwB,CAClE,CAAC,CACH,CAAC,EAED,SAAS,gBAAiB,IAAM,CAC9B,GAAG,0DAA2D,IAAM,CAClE,MAAMO,EAAc,IAAIT,EAAa,CACnC,WAAYG,EAAgB,MAAM,EAAE,EACpC,KAAMA,EAAgB,MAAM,EAAG,EAAE,CACnC,CAAC,EACKO,EAASH,EAAQ,cAAcE,CAAW,EAC1CE,EAAWb,EAAqB,CACpC,KAAM,CACJ,KAAM,QACN,QAAS,WACX,CACF,CAAC,EACD,OAAOY,CAAM,EAAE,cAAcC,CAAQ,CACvC,CAAC,EACD,GAAG,+CAAgD,IAAM,CACvD,MAAMC,EAAe,IAAIZ,EAAa,CACpC,WAAYI,EAAiB,MAAM,EAAE,EACrC,KAAMA,EAAiB,MAAM,EAAG,EAAE,CACpC,CAAC,EACKM,EAASH,EAAQ,cAAcK,CAAY,EAC3CD,EAAWb,EAAqB,CACpC,KAAM,CACJ,KAAM,UACN,QAAS,cACT,MAAO,WAAW,KAAK,CAAC,CAAC,CAAC,CAC5B,CACF,CAAC,EACD,OAAOY,CAAM,EAAE,cAAcC,CAAQ,CACvC,CAAC,EACD,GAAG,8CAA+C,IAAM,CAEtD,MAAME,EAAkB,IAAIb,EAAa,CACvC,WAAYK,EAAoB,MAAM,EAAE,EACxC,KAAMA,EAAoB,MAAM,EAAG,EAAE,CACvC,CAAC,EAEKS,EAASP,EAAQ,cAAcM,CAAe,EAGpD,OAAOd,EAAuBe,CAAM,CAAC,EAAE,UAAU,CACnD,CAAC,EACD,GAAG,qEAAsE,IAAM,CAE7E,MAAMC,EAAiB,IAAIf,EAAa,CACtC,WAAYM,EAAmB,MAAM,EAAE,EACvC,KAAMA,EAAmB,MAAM,EAAG,EAAE,CACtC,CAAC,EAEKU,EAAWT,EAAQ,cAAcQ,CAAc,EAGrD,OAAOhB,EAAuBiB,CAAQ,CAAC,EAAE,UAAU,CACrD,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["CommandResultFactory", "isSuccessCommandResult", "ApduResponse", "GetAppAndVersionCommand", "GET_APP_AND_VERSION_APDU", "OS_RESPONSE_HEX", "APP_RESPONSE_HEX", "FAILED_RESPONSE_HEX", "ERROR_RESPONSE_HEX", "command", "apdu", "OS_RESPONSE", "parsed", "expected", "APP_RESPONSE", "FAILED_RESPONSE", "result", "ERROR_RESPONSE", "response"]
}
