import{ApduBuilder as l}from"../../apdu/utils/ApduBuilder";import{ApduParser as A}from"../../apdu/utils/ApduParser";import{CommandResultFactory as o}from"../../command/model/CommandResult";import{isCommandErrorCode as c}from"../../command/utils/CommandErrors";import{CommandUtils as u}from"../../command/utils/CommandUtils";import{GlobalCommandErrorHandler as C}from"../../command/utils/GlobalCommandError";import{DeviceExchangeError as g}from"../../Error";const p={6624:{message:"Invalid state (List applications command must be sent)"}};class x extends g{constructor({message:e,errorCode:s}){super({message:e,errorCode:s,tag:"ListAppsCommandError"})}}class S{name="listApps";args;constructor(e={isContinue:!1}){this.args=e}getApdu(){const e={cla:224,ins:this.args.isContinue?223:222,p1:0,p2:0};return new l(e).build()}parseResponse(e){const s=[],r=new A(e);if(!u.isSuccessResponse(e)){const t=r.encodeToHexaString(e.statusCode);return c(t,p)?o({error:new x({...p[t],errorCode:t})}):o({error:C.handle(e)})}if(e.data.length<=0)return o({data:[]});for(r.extract8BitUInt();r.getUnparsedRemainingLength()>0;){const t=r.extract8BitUInt(),a=r.extract16BitUInt();r.extract16BitUInt();const i=r.encodeToHexaString(r.extractFieldByLength(32)),d=r.encodeToHexaString(r.extractFieldByLength(32)),m=r.encodeToString(r.extractFieldLVEncoded());s.push({appEntryLength:t,appSizeInBlocks:a,appCodeHash:i,appFullHash:d,appName:m})}return o({data:s})}}export{S as ListAppsCommand,x as ListAppsCommandError};
//# sourceMappingURL=ListAppsCommand.js.map
