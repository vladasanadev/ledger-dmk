import{ApduBuilder as i}from"../../apdu/utils/ApduBuilder";import{ApduParser as n}from"../../apdu/utils/ApduParser";import{CommandResultFactory as t}from"../../command/model/CommandResult";import{isCommandErrorCode as d}from"../../command/utils/CommandErrors";import{CommandUtils as m}from"../../command/utils/CommandUtils";import{GlobalCommandErrorHandler as c}from"../../command/utils/GlobalCommandError";import{DeviceExchangeError as f}from"../../Error";const a={"422f":{message:"Incorrect structure type"},4230:{message:"Incorrect certificate version"},4231:{message:"Incorrect certificate validity"},4232:{message:"Incorrect certificate validity index"},4233:{message:"Unknown signer key ID"},4234:{message:"Unknown signature algorithm"},4235:{message:"Unknown public key ID"},4236:{message:"Unknown public key usage"},4237:{message:"Incorrect elliptic curve ID"},4238:{message:"Incorrect signature algorithm associated to the public key"},4239:{message:"Unknown target device"},"422d":{message:"Unknown certificate tag"},3301:{message:"Failed to hash data"},"422e":{message:"expected_key_usage doesn't match certificate key usage"},5720:{message:"Failed to verify signature"},4118:{message:"trusted_name buffer is too small to contain the trusted name"},ffff:{message:"Cryptography-related error"}};class g extends f{constructor({message:e,errorCode:o}){super({tag:"ProvidePkiCertificateCommandError",message:e,errorCode:o})}}class k{name="loadCertificate";args;triggersDisconnection=!1;constructor(e){this.args=e}getApdu(){const e={cla:176,ins:6,p1:this.args.keyUsage,p2:0};return new i(e).addBufferToData(this.args.certificate).build()}parseResponse(e){if(m.isSuccessResponse(e))return t({data:void 0});const r=new n(e).encodeToHexaString(e.statusCode);return d(r,a)?t({error:new g({...a[r],errorCode:r})}):t({error:c.handle(e)})}}export{k as LoadCertificateCommand,g as LoadCertificateCommandError};
//# sourceMappingURL=LoadCertificateCommand.js.map
