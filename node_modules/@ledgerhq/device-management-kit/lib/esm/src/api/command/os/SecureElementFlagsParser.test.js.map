{
  "version": 3,
  "sources": ["../../../../../../src/api/command/os/SecureElementFlagsParser.test.ts"],
  "sourcesContent": ["import { describe, expect, it } from \"vitest\";\n\nimport { type DeviceGeneralState } from \"@api/device/SecureElementFlags\";\n\nimport { SecureElementFlagsParser } from \"./SecureElementFlagsParser\";\n\ndescribe(\"SecureElementFlagsParser\", () => {\n  it(\"should throw an error if the secure element flags length is not 4\", () => {\n    expect(\n      () => new SecureElementFlagsParser(new Uint8Array([0x00, 0x01, 0x02])),\n    ).toThrow(\"Invalid secure element flags length\");\n  });\n\n  it(\"should correctly parse the general device state\", () => {\n    const seFlags = new Uint8Array([0b10101010, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    const expectedState: DeviceGeneralState = {\n      isPinValidated: true,\n      hasMcuSerialNumber: false,\n      hasValidCertificate: true,\n      isCustomAuthorityConnectionAllowed: false,\n      isSecureConnectionAllowed: true,\n      isOnboarded: false,\n      isMcuCodeSigned: true,\n      isInRecoveryMode: false,\n    };\n    expect(parser.generalDeviceState()).toEqual(expectedState);\n  });\n\n  it(\"should throw an error for endorsementInformation method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.endorsementInformation()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should throw an error for wordsInformation method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.wordsInformation()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should throw an error for onboardingStatus method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.onboardingStatus()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should correctly check the nth bit in a byte\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    const byte = 0b10101010;\n    expect(parser._checkNthBitInByte(byte, 1)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 2)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 3)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 4)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 5)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 6)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 7)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 8)).toBe(false);\n  });\n});\n"],
  "mappings": "AAAA,OAAS,YAAAA,EAAU,UAAAC,EAAQ,MAAAC,MAAU,SAIrC,OAAS,4BAAAC,MAAgC,6BAEzCH,EAAS,2BAA4B,IAAM,CACzCE,EAAG,oEAAqE,IAAM,CAC5ED,EACE,IAAM,IAAIE,EAAyB,IAAI,WAAW,CAAC,EAAM,EAAM,CAAI,CAAC,CAAC,CACvE,EAAE,QAAQ,qCAAqC,CACjD,CAAC,EAEDD,EAAG,kDAAmD,IAAM,CAC1D,MAAME,EAAU,IAAI,WAAW,CAAC,IAAY,EAAM,EAAM,CAAI,CAAC,EACvDC,EAAS,IAAIF,EAAyBC,CAAO,EAC7CE,EAAoC,CACxC,eAAgB,GAChB,mBAAoB,GACpB,oBAAqB,GACrB,mCAAoC,GACpC,0BAA2B,GAC3B,YAAa,GACb,gBAAiB,GACjB,iBAAkB,EACpB,EACAL,EAAOI,EAAO,mBAAmB,CAAC,EAAE,QAAQC,CAAa,CAC3D,CAAC,EAEDJ,EAAG,0DAA2D,IAAM,CAClE,MAAME,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAIF,EAAyBC,CAAO,EACnDH,EAAO,IAAMI,EAAO,uBAAuB,CAAC,EAAE,QAAQ,iBAAiB,CACzE,CAAC,EAEDH,EAAG,oDAAqD,IAAM,CAC5D,MAAME,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAIF,EAAyBC,CAAO,EACnDH,EAAO,IAAMI,EAAO,iBAAiB,CAAC,EAAE,QAAQ,iBAAiB,CACnE,CAAC,EAEDH,EAAG,oDAAqD,IAAM,CAC5D,MAAME,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAIF,EAAyBC,CAAO,EACnDH,EAAO,IAAMI,EAAO,iBAAiB,CAAC,EAAE,QAAQ,iBAAiB,CACnE,CAAC,EAEDH,EAAG,+CAAgD,IAAM,CACvD,MAAME,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAIF,EAAyBC,CAAO,EAC7CG,EAAO,IACbN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,EACpDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,EACrDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,EACpDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,EACrDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,EACpDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,EACrDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,EACpDN,EAAOI,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,CACvD,CAAC,CACH,CAAC",
  "names": ["describe", "expect", "it", "SecureElementFlagsParser", "seFlags", "parser", "expectedState", "byte"]
}
