{
  "version": 3,
  "sources": ["../../../../../../src/api/device-action/use-case/ExecuteDeviceActionUseCase.ts"],
  "sourcesContent": ["import { inject, injectable } from \"inversify\";\n\nimport {\n  DeviceAction,\n  DeviceActionIntermediateValue,\n  ExecuteDeviceActionReturnType,\n} from \"@api/device-action/DeviceAction\";\nimport { DmkError } from \"@api/Error\";\nimport { LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { deviceSessionTypes } from \"@internal/device-session/di/deviceSessionTypes\";\nimport type { DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { loggerTypes } from \"@internal/logger-publisher/di/loggerTypes\";\n\nexport type ExecuteDeviceActionUseCaseArgs<\n  Output,\n  Input,\n  Error extends DmkError,\n  IntermediateValue extends DeviceActionIntermediateValue,\n> = {\n  /**\n   * The device session id.\n   */\n  readonly sessionId: string;\n  /**\n   * The device action to execute.\n   */\n  readonly deviceAction: DeviceAction<Output, Input, Error, IntermediateValue>;\n};\n\n/**\n * Executes a device action to a device through a device session.\n */\n@injectable()\nexport class ExecuteDeviceActionUseCase {\n  private readonly _sessionService: DeviceSessionService;\n  private readonly _logger: LoggerPublisherService;\n  constructor(\n    @inject(deviceSessionTypes.DeviceSessionService)\n    sessionService: DeviceSessionService,\n    @inject(loggerTypes.LoggerPublisherServiceFactory)\n    loggerFactory: (tag: string) => LoggerPublisherService,\n  ) {\n    this._sessionService = sessionService;\n    this._logger = loggerFactory(\"ExecuteDeviceActionUseCase\");\n  }\n\n  /**\n   * Executes a device action to a device through a device session.\n   *\n   * @param sessionId - The device session id.\n   * @param deviceAction - The device action to execute\n   * @returns An object containing an observable of the device action state, and a cancel function.\n   */\n  execute<\n    Output,\n    Error extends DmkError,\n    IntermediateValue extends DeviceActionIntermediateValue,\n    Input,\n  >({\n    sessionId,\n    deviceAction,\n  }: ExecuteDeviceActionUseCaseArgs<\n    Output,\n    Input,\n    Error,\n    IntermediateValue\n  >): ExecuteDeviceActionReturnType<Output, Error, IntermediateValue> {\n    const deviceSessionOrError =\n      this._sessionService.getDeviceSessionById(sessionId);\n\n    return deviceSessionOrError.caseOf({\n      // Case device session found\n      Right: (deviceSession) =>\n        deviceSession.executeDeviceAction<\n          Output,\n          Input,\n          Error,\n          IntermediateValue\n        >(deviceAction),\n      // Case device session not found\n      Left: (error) => {\n        this._logger.error(\"Error getting session\", {\n          data: { error },\n        });\n        throw error;\n      },\n    });\n  }\n}\n"],
  "mappings": "iOAAA,OAAS,UAAAA,EAAQ,cAAAC,MAAkB,YASnC,OAAS,sBAAAC,MAA0B,iDAEnC,OAAS,eAAAC,MAAmB,4CAsBrB,IAAMC,EAAN,KAAiC,CACrB,gBACA,QACjB,YAEEC,EAEAC,EACA,CACA,KAAK,gBAAkBD,EACvB,KAAK,QAAUC,EAAc,4BAA4B,CAC3D,CASA,QAKE,CACA,UAAAC,EACA,aAAAC,CACF,EAKoE,CAIlE,OAFE,KAAK,gBAAgB,qBAAqBD,CAAS,EAEzB,OAAO,CAEjC,MAAQE,GACNA,EAAc,oBAKZD,CAAY,EAEhB,KAAOE,GAAU,CACf,WAAK,QAAQ,MAAM,wBAAyB,CAC1C,KAAM,CAAE,MAAAA,CAAM,CAChB,CAAC,EACKA,CACR,CACF,CAAC,CACH,CACF,EAvDaN,EAANO,EAAA,CADNC,EAAW,EAKPC,EAAA,EAAAC,EAAOC,EAAmB,oBAAoB,GAE9CF,EAAA,EAAAC,EAAOE,EAAY,6BAA6B,IANxCZ",
  "names": ["inject", "injectable", "deviceSessionTypes", "loggerTypes", "ExecuteDeviceActionUseCase", "sessionService", "loggerFactory", "sessionId", "deviceAction", "deviceSession", "error", "__decorateClass", "injectable", "__decorateParam", "inject", "deviceSessionTypes", "loggerTypes"]
}
