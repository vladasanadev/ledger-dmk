import{APDU_MAX_PAYLOAD as o,ApduBuilder as a}from"./ApduBuilder";import{ValueOverflowError as i}from"./AppBuilderError";const x=new Uint8Array([224,1,0,0,0]),n=new Uint8Array([224,1,0,0,1,1]),d=new Uint8Array([224,1,0,0,2,51,2]),l=new Uint8Array([224,1,0,0,4,1,35,69,103]),u=new Uint8Array([224,1,0,0,5,128,129,130,131,132]),c=new Uint8Array([224,1,0,0,4,133,134,135,136]),s=new Uint8Array([224,1,0,0,4,3,161,162,163]),A=new Uint8Array([224,1,0,0,6,5,109,97,109,97,110]),r=new Uint8Array([224,1,0,0,3,2,240,241]),p=new Uint8Array([224,1,0,0,255,...Array(255).fill(170)]);let e;describe("ApduBuilder",()=>{describe("clean",()=>{beforeEach(()=>{e=new a({cla:224,ins:1,p1:0,p2:0})}),it("should create an instance",()=>{expect(e).toBeDefined(),expect(e).toBeInstanceOf(a)})}),describe("simple",()=>{beforeEach(()=>{e=new a({cla:224,ins:1,p1:0,p2:0})}),it("should serialize with an empty body",()=>{expect(e.build().getRawApdu()).toEqual(x)}),it("should serialize with an single byte body",()=>{e.add8BitUIntToData(1),expect(e.build().getRawApdu()).toEqual(n),expect(e.getErrors()).toEqual([])}),it("should serialize with an 2 byte body",()=>{e.add16BitUIntToData(13058),expect(e.build().getRawApdu()).toEqual(d),expect(e.getErrors()).toEqual([])}),it("should serialize with an 8 byte body from an hexastring",()=>{e.add32BitUIntToData(19088743),expect(e.build().getRawApdu()).toEqual(l),expect(e.getErrors()).toEqual([])}),it("should serialize with an 5 byte body from an hexastring",()=>{e.addHexaStringToData("0x8081828384"),expect(e.build().getRawApdu()).toEqual(u),expect(e.getErrors()).toEqual([])}),it("should serialize with an 4 byte body from an hexastring without '0x'",()=>{e.addHexaStringToData("85868788"),expect(e.build().getRawApdu()).toEqual(c),expect(e.getErrors()).toEqual([])}),it("should serialize with an 4 byte body LV encoded from an hexastring",()=>{e.encodeInLVFromHexa("0xA1A2A3"),expect(e.build().getRawApdu()).toEqual(s),expect(e.getErrors()).toEqual([])}),it("should serialize with an 4 byte body LV encoded from an ascci string",()=>{e.encodeInLVFromAscii("maman"),expect(e.build().getRawApdu()).toEqual(A),expect(e.getErrors()).toEqual([])}),it("should serialize with an 4 byte body LV encoded from a buffer",()=>{const t=new Uint8Array([240,241]);e.encodeInLVFromBuffer(t),expect(e.build().getRawApdu()).toEqual(r),expect(e.getErrors()).toEqual([])}),it("should serialize with an 4 byte body LV encoded from a buffer",()=>{const t=new Uint8Array([240,241]);e.encodeInLVFromBuffer(t),expect(e.build().getRawApdu()).toEqual(r),expect(e.getErrors()).toEqual([])}),it("should serialize with an complete body of 0xAA",()=>{const t=new Uint8Array(255).fill(170,0,255);e.addBufferToData(t),expect(e.build().getRawApdu()).toEqual(p),expect(e.getErrors()).toEqual([])})}),describe("error",()=>{beforeEach(()=>{e=new a({cla:224,ins:1,p1:0,p2:0})}),it("error due value greater than 8-bit integer",()=>{e.add8BitUIntToData(256),expect(e.build().getRawApdu()).toEqual(x),expect(e.getAvailablePayloadLength()).toBe(o),expect(e.getErrors()).toEqual([new i("256",255)])})})});
//# sourceMappingURL=ApduBuilder.test.js.map
