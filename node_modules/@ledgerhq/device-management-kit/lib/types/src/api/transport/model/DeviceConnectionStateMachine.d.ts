import { type Either } from "purify-ts";
import { type ApduResponse } from "../../device-session/ApduResponse";
import { type DmkError } from "../../Error";
import { type DeviceId } from "../../types";
import { type DeviceApduSender } from "./DeviceApduSender";
type DeviceDisconnectedEvent = {
    type: "DeviceDisconnected";
};
type DeviceConnectedEvent = {
    type: "DeviceConnected";
};
type ApduResponseReceived = {
    type: "ApduResponseReceived";
    apduResponse: ApduResponse;
};
type ApduSendingError = {
    type: "ApduSendingError";
    error: DmkError;
};
type SendApduCalled = {
    type: "SendApduCalled";
    apdu: Uint8Array;
    triggersDisconnection: boolean;
    abortTimeout?: number;
    responseCallback: (response: Either<DmkError, ApduResponse>) => void;
};
type ReconnectionTimedOut = {
    type: "ReconnectionTimedOut";
};
type CloseConnectionCalled = {
    type: "CloseConnectionCalled";
};
export type Events = DeviceDisconnectedEvent | DeviceConnectedEvent | ApduResponseReceived | ApduSendingError | SendApduCalled | CloseConnectionCalled | ReconnectionTimedOut;
export type DeviceConnectionStateMachineParams<Dependencies> = {
    deviceId: DeviceId;
    deviceApduSender: DeviceApduSender<Dependencies>;
    timeoutDuration: number;
    tryToReconnect: (timeoutDuration: number) => void;
    onTerminated: () => void;
};
export declare class DeviceConnectionStateMachine<Dependencies> {
    private deviceId;
    private deviceAdpuSender;
    private machineActor;
    private timeoutDuration;
    private timeout;
    startReconnectionTimeout(): void;
    constructor(params: DeviceConnectionStateMachineParams<Dependencies>);
    private sendApduToDeviceConnection;
    /**
     * Called by the transport
     */
    getDependencies(): Dependencies;
    setDependencies(dependencies: Dependencies): void;
    getDeviceId(): string;
    sendApdu(apdu: Uint8Array, triggersDisconnection?: boolean, abortTimeout?: number): Promise<Either<DmkError, ApduResponse>>;
    setupConnection(): Promise<void>;
    eventDeviceConnected(): void;
    eventDeviceDisconnected(): void;
    closeConnection(): void;
}
export {};
//# sourceMappingURL=DeviceConnectionStateMachine.d.ts.map