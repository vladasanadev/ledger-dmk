import { type Either } from "purify-ts";
import { type Observable } from "rxjs";
import { type Command } from "../../../api/command/Command";
import { type CommandResult } from "../../../api/command/model/CommandResult";
import { type DeviceAction, type DeviceActionIntermediateValue, type ExecuteDeviceActionReturnType } from "../../../api/device-action/DeviceAction";
import { type ApduResponse } from "../../../api/device-session/ApduResponse";
import { type DeviceSessionState } from "../../../api/device-session/DeviceSessionState";
import { type DeviceSessionId } from "../../../api/device-session/types";
import { type DmkError } from "../../../api/Error";
import { type LoggerPublisherService } from "../../../api/logger-publisher/service/LoggerPublisherService";
import { type TransportConnectedDevice } from "../../../api/transport/model/TransportConnectedDevice";
import { type ManagerApiService } from "../../manager-api/service/ManagerApiService";
import { type SecureChannelService } from "../../secure-channel/service/SecureChannelService";
export type SessionConstructorArgs = {
    connectedDevice: TransportConnectedDevice;
    id?: DeviceSessionId;
};
export type DeviceSessionRefresherOptions = {
    isRefresherDisabled: boolean;
    pollingInterval?: number;
};
type SendApduOptions = {
    isPolling?: boolean;
    triggersDisconnection?: boolean;
    abortTimeout?: number;
};
/**
 * Represents a session with a device.
 */
export declare class DeviceSession {
    private readonly _id;
    private readonly _connectedDevice;
    private readonly _deviceState;
    private readonly _managerApiService;
    private readonly _secureChannelService;
    private readonly _logger;
    private readonly _refresherOptions;
    private _pinger;
    private _deviceSessionRefresher;
    private readonly _refresherService;
    private _commandMutex;
    private _sessionEventDispatcher;
    constructor({ connectedDevice, id }: SessionConstructorArgs, loggerModuleFactory: (tag: string) => LoggerPublisherService, managerApiService: ManagerApiService, secureChannelService: SecureChannelService, deviceSessionRefresherOptions: DeviceSessionRefresherOptions | undefined);
    initialiseSession(): Promise<void>;
    get id(): DeviceSessionId;
    get connectedDevice(): TransportConnectedDevice;
    get state(): Observable<DeviceSessionState>;
    getDeviceSessionState(): DeviceSessionState;
    setDeviceSessionState(state: DeviceSessionState): void;
    sendApdu(rawApdu: Uint8Array, options?: SendApduOptions): Promise<Either<DmkError, ApduResponse>>;
    sendCommand<Response, Args, ErrorStatusCodes>(command: Command<Response, Args, ErrorStatusCodes>, abortTimeout?: number): Promise<CommandResult<Response, ErrorStatusCodes>>;
    executeDeviceAction<Output, Input, E extends DmkError, IntermediateValue extends DeviceActionIntermediateValue>(deviceAction: DeviceAction<Output, Input, E, IntermediateValue>): ExecuteDeviceActionReturnType<Output, E, IntermediateValue>;
    close(): void;
    disableRefresher(id: string): () => void;
    private _updateDeviceStatus;
}
export {};
//# sourceMappingURL=DeviceSession.d.ts.map