{
  "version": 3,
  "sources": ["../../../../../../src/internal/config/service/DefaultConfigService.test.ts"],
  "sourcesContent": ["import { Either, Left } from \"purify-ts\";\nimport { type Mocked } from \"vitest\";\n\nimport { FileLocalConfigDataSource } from \"@internal/config/data/LocalConfigDataSource\";\nimport { RestRemoteConfigDataSource } from \"@internal/config/data/RemoteConfigDataSource\";\nimport { JSONParseError } from \"@internal/config/model/Errors\";\nimport { DefaultLoggerPublisherService } from \"@internal/logger-publisher/service/DefaultLoggerPublisherService\";\n\nimport { type ConfigService } from \"./ConfigService\";\nimport { DefaultConfigService } from \"./DefaultConfigService\";\n\nvi.mock(\"@internal/config/data/LocalConfigDataSource\");\nvi.mock(\"@internal/config/data/RemoteConfigDataSource\");\n\nlet localDataSource: Mocked<FileLocalConfigDataSource>;\nlet remoteDataSource: Mocked<RestRemoteConfigDataSource>;\nlet loggerService: Mocked<DefaultLoggerPublisherService>;\n\nlet service: ConfigService;\ndescribe(\"DefaultConfigService\", () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    localDataSource =\n      new FileLocalConfigDataSource() as Mocked<FileLocalConfigDataSource>;\n    remoteDataSource =\n      new RestRemoteConfigDataSource() as Mocked<RestRemoteConfigDataSource>;\n\n    loggerService = new DefaultLoggerPublisherService(\n      [],\n      \"config\",\n    ) as Mocked<DefaultLoggerPublisherService>;\n\n    service = new DefaultConfigService(\n      localDataSource,\n      remoteDataSource,\n      () => loggerService,\n    );\n  });\n\n  describe(\"when the local config is available\", () => {\n    it(\"should return the `local` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(\n        Either.of({\n          name: \"DeviceSDK\",\n          version: \"1.0.0-local\",\n        }),\n      );\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeviceSDK\",\n        version: \"1.0.0-local\",\n      });\n    });\n  });\n\n  describe(\"when the local config is not available, use remote\", () => {\n    it(\"should return the `remote` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(Left(new JSONParseError()));\n      remoteDataSource.getConfig.mockResolvedValue(\n        Either.of({\n          name: \"DeviceSDK\",\n          version: \"1.0.0-remote\",\n        }),\n      );\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeviceSDK\",\n        version: \"1.0.0-remote\",\n      });\n    });\n  });\n\n  describe(\"when the local remote config are not available\", () => {\n    it(\"should return the `default` version\", async () => {\n      localDataSource.getConfig.mockReturnValue(Left(new JSONParseError()));\n      remoteDataSource.getConfig.mockResolvedValue(Left(new JSONParseError()));\n\n      expect(await service.getDmkConfig()).toStrictEqual({\n        name: \"DeadDmk\",\n        version: \"0.0.0-dead.1\",\n      });\n    });\n  });\n});\n"],
  "mappings": "aAAA,IAAAA,EAA6B,qBAG7BC,EAA0C,uDAC1CC,EAA2C,wDAC3CC,EAA+B,yCAC/BC,EAA8C,4EAG9CC,EAAqC,kCAErC,GAAG,KAAK,6CAA6C,EACrD,GAAG,KAAK,8CAA8C,EAEtD,IAAIC,EACAC,EACAC,EAEAC,EACJ,SAAS,uBAAwB,IAAM,CACrC,WAAW,IAAM,CACf,GAAG,cAAc,EACjBH,EACE,IAAI,4BACNC,EACE,IAAI,6BAENC,EAAgB,IAAI,gCAClB,CAAC,EACD,QACF,EAEAC,EAAU,IAAI,uBACZH,EACAC,EACA,IAAMC,CACR,CACF,CAAC,EAED,SAAS,qCAAsC,IAAM,CACnD,GAAG,oCAAqC,SAAY,CAClDF,EAAgB,UAAU,gBACxB,SAAO,GAAG,CACR,KAAM,YACN,QAAS,aACX,CAAC,CACH,EAEA,OAAO,MAAMG,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,YACN,QAAS,aACX,CAAC,CACH,CAAC,CACH,CAAC,EAED,SAAS,qDAAsD,IAAM,CACnE,GAAG,qCAAsC,SAAY,CACnDH,EAAgB,UAAU,mBAAgB,QAAK,IAAI,gBAAgB,CAAC,EACpEC,EAAiB,UAAU,kBACzB,SAAO,GAAG,CACR,KAAM,YACN,QAAS,cACX,CAAC,CACH,EAEA,OAAO,MAAME,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,YACN,QAAS,cACX,CAAC,CACH,CAAC,CACH,CAAC,EAED,SAAS,iDAAkD,IAAM,CAC/D,GAAG,sCAAuC,SAAY,CACpDH,EAAgB,UAAU,mBAAgB,QAAK,IAAI,gBAAgB,CAAC,EACpEC,EAAiB,UAAU,qBAAkB,QAAK,IAAI,gBAAgB,CAAC,EAEvE,OAAO,MAAME,EAAQ,aAAa,CAAC,EAAE,cAAc,CACjD,KAAM,UACN,QAAS,cACX,CAAC,CACH,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["import_purify_ts", "import_LocalConfigDataSource", "import_RemoteConfigDataSource", "import_Errors", "import_DefaultLoggerPublisherService", "import_DefaultConfigService", "localDataSource", "remoteDataSource", "loggerService", "service"]
}
