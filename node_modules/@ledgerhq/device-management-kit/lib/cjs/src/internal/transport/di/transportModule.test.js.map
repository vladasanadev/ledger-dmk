{
  "version": 3,
  "sources": ["../../../../../../src/internal/transport/di/transportModule.test.ts"],
  "sourcesContent": ["import { Container } from \"inversify\";\n\nimport { type DmkConfig } from \"@api/DmkConfig\";\nimport { TransportMock } from \"@api/transport/model/__mocks__/TransportMock\";\nimport { deviceModelModuleFactory } from \"@internal/device-model/di/deviceModelModule\";\nimport { deviceSessionModuleFactory } from \"@internal/device-session/di/deviceSessionModule\";\nimport { loggerModuleFactory } from \"@internal/logger-publisher/di/loggerModule\";\n\nimport { transportDiTypes } from \"./transportDiTypes\";\nimport { transportModuleFactory } from \"./transportModule\";\n\ndescribe(\"transportModuleFactory\", () => {\n  describe(\"Default\", () => {\n    let container: Container;\n    let mod: ReturnType<typeof transportModuleFactory>;\n    beforeEach(() => {\n      mod = transportModuleFactory();\n      container = new Container();\n      container.loadSync(mod);\n    });\n\n    it(\"should create the transport module\", () => {\n      expect(mod).toBeDefined();\n    });\n\n    it(\"should not bind the TransportService when transports is empty\", () => {\n      try {\n        container.get(transportDiTypes.TransportService);\n      } catch (error) {\n        expect(error).toBeDefined();\n      }\n    });\n  });\n\n  describe(\"With transports\", () => {\n    let container: Container;\n    let mod: ReturnType<typeof transportModuleFactory>;\n    let transport: TransportMock;\n    beforeEach(() => {\n      transport = new TransportMock();\n      vi.spyOn(transport, \"getIdentifier\").mockReturnValue(\"MOCK\");\n      const logger = loggerModuleFactory();\n      const deviceModel = deviceModelModuleFactory({ stub: true });\n      const deviceSession = deviceSessionModuleFactory({ stub: true });\n      mod = transportModuleFactory({\n        transports: [() => transport],\n        config: {\n          managerApiUrl: \"http://fake.url/api\",\n          mockUrl: \"http://fake.url\",\n          webSocketUrl: \"ws://fake.websocket.url\",\n          firmwareDistributionSalt: \"salt\",\n        } as DmkConfig,\n      });\n      container = new Container();\n      container.loadSync(logger, deviceModel, deviceSession, mod);\n    });\n\n    it(\"should bind the TransportService\", () => {\n      expect(container.get(transportDiTypes.TransportService)).toBeDefined();\n    });\n  });\n\n  describe(\"With stub\", () => {\n    let container: Container;\n    let mod: ReturnType<typeof transportModuleFactory>;\n    let transport: TransportMock;\n    beforeEach(() => {\n      transport = new TransportMock();\n      vi.spyOn(transport, \"getIdentifier\").mockReturnValue(\"MOCK\");\n      mod = transportModuleFactory({\n        stub: true,\n        transports: [() => transport],\n      });\n      container = new Container();\n      container.loadSync(mod);\n    });\n\n    it(\"should create the transport module\", () => {\n      expect(mod).toBeDefined();\n    });\n  });\n});\n"],
  "mappings": "aAAA,IAAAA,EAA0B,qBAG1BC,EAA8B,wDAC9BC,EAAyC,uDACzCC,EAA2C,2DAC3CC,EAAoC,sDAEpCC,EAAiC,8BACjCC,EAAuC,6BAEvC,SAAS,yBAA0B,IAAM,CACvC,SAAS,UAAW,IAAM,CACxB,IAAIC,EACAC,EACJ,WAAW,IAAM,CACfA,KAAM,0BAAuB,EAC7BD,EAAY,IAAI,YAChBA,EAAU,SAASC,CAAG,CACxB,CAAC,EAED,GAAG,qCAAsC,IAAM,CAC7C,OAAOA,CAAG,EAAE,YAAY,CAC1B,CAAC,EAED,GAAG,gEAAiE,IAAM,CACxE,GAAI,CACFD,EAAU,IAAI,mBAAiB,gBAAgB,CACjD,OAASE,EAAO,CACd,OAAOA,CAAK,EAAE,YAAY,CAC5B,CACF,CAAC,CACH,CAAC,EAED,SAAS,kBAAmB,IAAM,CAChC,IAAIF,EACAC,EACAE,EACJ,WAAW,IAAM,CACfA,EAAY,IAAI,gBAChB,GAAG,MAAMA,EAAW,eAAe,EAAE,gBAAgB,MAAM,EAC3D,MAAMC,KAAS,uBAAoB,EAC7BC,KAAc,4BAAyB,CAAE,KAAM,EAAK,CAAC,EACrDC,KAAgB,8BAA2B,CAAE,KAAM,EAAK,CAAC,EAC/DL,KAAM,0BAAuB,CAC3B,WAAY,CAAC,IAAME,CAAS,EAC5B,OAAQ,CACN,cAAe,sBACf,QAAS,kBACT,aAAc,0BACd,yBAA0B,MAC5B,CACF,CAAC,EACDH,EAAY,IAAI,YAChBA,EAAU,SAASI,EAAQC,EAAaC,EAAeL,CAAG,CAC5D,CAAC,EAED,GAAG,mCAAoC,IAAM,CAC3C,OAAOD,EAAU,IAAI,mBAAiB,gBAAgB,CAAC,EAAE,YAAY,CACvE,CAAC,CACH,CAAC,EAED,SAAS,YAAa,IAAM,CAC1B,IAAIA,EACAC,EACAE,EACJ,WAAW,IAAM,CACfA,EAAY,IAAI,gBAChB,GAAG,MAAMA,EAAW,eAAe,EAAE,gBAAgB,MAAM,EAC3DF,KAAM,0BAAuB,CAC3B,KAAM,GACN,WAAY,CAAC,IAAME,CAAS,CAC9B,CAAC,EACDH,EAAY,IAAI,YAChBA,EAAU,SAASC,CAAG,CACxB,CAAC,EAED,GAAG,qCAAsC,IAAM,CAC7C,OAAOA,CAAG,EAAE,YAAY,CAC1B,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["import_inversify", "import_TransportMock", "import_deviceModelModule", "import_deviceSessionModule", "import_loggerModule", "import_transportDiTypes", "import_transportModule", "container", "mod", "error", "transport", "logger", "deviceModel", "deviceSession"]
}
