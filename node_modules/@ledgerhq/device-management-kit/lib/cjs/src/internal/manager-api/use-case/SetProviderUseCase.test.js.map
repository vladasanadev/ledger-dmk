{
  "version": 3,
  "sources": ["../../../../../../src/internal/manager-api/use-case/SetProviderUseCase.test.ts"],
  "sourcesContent": ["import { describe, expect, it, vi } from \"vitest\";\n\nimport { DeviceStatus } from \"@api/device/DeviceStatus\";\nimport {\n  type Catalog,\n  type DeviceSessionState,\n  type FirmwareUpdateContext,\n  type FirmwareVersion,\n} from \"@api/device-session/DeviceSessionState\";\nimport { DeviceSessionStateType } from \"@api/device-session/DeviceSessionState\";\nimport { type DeviceSession } from \"@internal/device-session/model/DeviceSession\";\nimport { type DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { type Application } from \"@internal/manager-api/model/Application\";\n\nimport { SetProviderUseCase } from \"./SetProviderUseCase\";\n\ndescribe(\"SetProviderUseCase\", () => {\n  const getDeviceSessionStateMock = vi.fn();\n  const setDeviceSessionStateMock = vi.fn();\n  const getDeviceSessionsMock = vi.fn();\n  const mockDeviceSession = {\n    addDeviceSession: vi.fn(),\n    getDeviceSessionById: vi.fn(),\n    getDeviceSessionByDeviceId: vi.fn(),\n    removeDeviceSession: vi.fn(),\n    getDeviceSessions: getDeviceSessionsMock,\n    sessionsObs: vi.fn(),\n  } as unknown as DeviceSessionService;\n\n  const mockManagerApiDataSource: ManagerApiDataSource = {\n    setProvider: vi.fn(),\n  } as unknown as ManagerApiDataSource;\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    getDeviceSessionsMock.mockReturnValue([\n      {\n        getDeviceSessionState: getDeviceSessionStateMock,\n        setDeviceSessionState: setDeviceSessionStateMock,\n      } as unknown as DeviceSession,\n    ]);\n  });\n\n  it(\"should call setProvider on ManagerApiDataSource with the correct provider\", () => {\n    // GIVEN\n    const useCase = new SetProviderUseCase(\n      mockDeviceSession,\n      mockManagerApiDataSource,\n    );\n    const provider = 123;\n    getDeviceSessionStateMock.mockReturnValue({\n      sessionStateType: DeviceSessionStateType.Connected,\n      deviceStatus: DeviceStatus.CONNECTED,\n    } as DeviceSessionState);\n\n    // WHEN\n    useCase.execute(provider);\n\n    // THEN\n    expect(mockManagerApiDataSource.setProvider).toHaveBeenCalledWith(provider);\n    expect(setDeviceSessionStateMock).not.toHaveBeenCalled();\n  });\n\n  it(\"should clean the device session\", () => {\n    // GIVEN\n    const useCase = new SetProviderUseCase(\n      mockDeviceSession,\n      mockManagerApiDataSource,\n    );\n    const provider = 123;\n    getDeviceSessionStateMock.mockReturnValue({\n      sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel,\n      deviceStatus: DeviceStatus.CONNECTED,\n      firmwareVersion: \"firmwareVersion\" as unknown as FirmwareVersion,\n      firmwareUpdateContext:\n        \"firmwareUpdateContext\" as unknown as FirmwareUpdateContext,\n      installedApps: \"apps\" as unknown as Application[],\n      appsUpdates: \"appsUpdate\" as unknown as Application[],\n      catalog: \"catalog\" as unknown as Catalog,\n    } as DeviceSessionState);\n\n    // WHEN\n    useCase.execute(provider);\n\n    // THEN\n    expect(mockManagerApiDataSource.setProvider).toHaveBeenCalledWith(provider);\n    expect(setDeviceSessionStateMock).toHaveBeenCalledWith({\n      sessionStateType: DeviceSessionStateType.ReadyWithoutSecureChannel,\n      deviceStatus: DeviceStatus.CONNECTED,\n      firmwareVersion: \"firmwareVersion\" as unknown as FirmwareVersion,\n      firmwareUpdateContext: undefined,\n      installedApps: [],\n      appsUpdates: undefined,\n      catalog: undefined,\n    });\n  });\n});\n"],
  "mappings": "aAAA,IAAAA,EAAyC,kBAEzCC,EAA6B,oCAO7BC,EAAuC,kDAMvCC,EAAmC,mCAEnC,YAAS,qBAAsB,IAAM,CACnC,MAAMC,EAA4B,KAAG,GAAG,EAClCC,EAA4B,KAAG,GAAG,EAClCC,EAAwB,KAAG,GAAG,EAC9BC,EAAoB,CACxB,iBAAkB,KAAG,GAAG,EACxB,qBAAsB,KAAG,GAAG,EAC5B,2BAA4B,KAAG,GAAG,EAClC,oBAAqB,KAAG,GAAG,EAC3B,kBAAmBD,EACnB,YAAa,KAAG,GAAG,CACrB,EAEME,EAAiD,CACrD,YAAa,KAAG,GAAG,CACrB,EAEA,WAAW,IAAM,CACf,KAAG,cAAc,EACjBF,EAAsB,gBAAgB,CACpC,CACE,sBAAuBF,EACvB,sBAAuBC,CACzB,CACF,CAAC,CACH,CAAC,KAED,MAAG,4EAA6E,IAAM,CAEpF,MAAMI,EAAU,IAAI,qBAClBF,EACAC,CACF,EACME,EAAW,IACjBN,EAA0B,gBAAgB,CACxC,iBAAkB,yBAAuB,UACzC,aAAc,eAAa,SAC7B,CAAuB,EAGvBK,EAAQ,QAAQC,CAAQ,KAGxB,UAAOF,EAAyB,WAAW,EAAE,qBAAqBE,CAAQ,KAC1E,UAAOL,CAAyB,EAAE,IAAI,iBAAiB,CACzD,CAAC,KAED,MAAG,kCAAmC,IAAM,CAE1C,MAAMI,EAAU,IAAI,qBAClBF,EACAC,CACF,EACME,EAAW,IACjBN,EAA0B,gBAAgB,CACxC,iBAAkB,yBAAuB,0BACzC,aAAc,eAAa,UAC3B,gBAAiB,kBACjB,sBACE,wBACF,cAAe,OACf,YAAa,aACb,QAAS,SACX,CAAuB,EAGvBK,EAAQ,QAAQC,CAAQ,KAGxB,UAAOF,EAAyB,WAAW,EAAE,qBAAqBE,CAAQ,KAC1E,UAAOL,CAAyB,EAAE,qBAAqB,CACrD,iBAAkB,yBAAuB,0BACzC,aAAc,eAAa,UAC3B,gBAAiB,kBACjB,sBAAuB,OACvB,cAAe,CAAC,EAChB,YAAa,OACb,QAAS,MACX,CAAC,CACH,CAAC,CACH,CAAC",
  "names": ["import_vitest", "import_DeviceStatus", "import_DeviceSessionState", "import_SetProviderUseCase", "getDeviceSessionStateMock", "setDeviceSessionStateMock", "getDeviceSessionsMock", "mockDeviceSession", "mockManagerApiDataSource", "useCase", "provider"]
}
