"use strict";var n=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var a=(t,e)=>{for(var s in e)n(t,s,{get:e[s],enumerable:!0})},d=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of f(e))!v.call(t,i)&&i!==s&&n(t,i,{get:()=>e[i],enumerable:!(r=l(e,i))||r.enumerable});return t};var u=t=>d(n({},"__esModule",{value:!0}),t);var _={};a(_,{DeviceSessionRefresher:()=>g});module.exports=u(_);var c=require("rxjs"),h=require("../../../api/device/DeviceModel"),o=require("../../device-session/data/DeviceSessionRefresherConst"),p=require("../../device-session/model/DeviceSessionEventDispatcher");class g{constructor(e,s,r,i){this._sessionEventDispatcher=r;this._refresherOptions=s,this._logger=e("device-session-refresher"),this._connectedDeviceID=i.deviceModel.id}_refresherSubscription;_refresherOptions;_logger;_connectedDeviceID;startRefresher(){if(this._refresherOptions.isRefresherDisabled)return;const e=this.getValidPollingInterval(this._refresherOptions,this._logger)*2;this._refresherSubscription=(0,c.timer)(0,e).subscribe(()=>{this._sessionEventDispatcher.dispatch({eventName:p.SessionEvents.REFRESH_NEEDED})})}stopRefresher(){this._refresherSubscription&&(this._refresherSubscription.unsubscribe(),this._refresherSubscription=void 0,this._logger.info("Refresher stopped."))}restartRefresher(){this.stopRefresher(),this.startRefresher(),this._logger.info("Refresher restarted.")}destroy(){this.stopRefresher()}getValidPollingInterval=(e,s)=>{const{pollingInterval:r}=e;switch(this._connectedDeviceID){case h.DeviceModelId.NANO_S:{const i=o.DEVICE_SESSION_REFRESHER_POLLING_INTERVAL*2;return r!==void 0&&r<i?(s.warn(`Polling interval of ${r} is too low, setting to minimum as ${i}`),i):r??i}default:return r!==void 0&&r<o.DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL?(s.warn(`Polling interval of ${r} is too low, setting to minimum as ${o.DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL}`),o.DEVICE_SESSION_REFRESHER_MINIMUM_POLLING_INTERVAL):r??o.DEVICE_SESSION_REFRESHER_POLLING_INTERVAL}}}0&&(module.exports={DeviceSessionRefresher});
//# sourceMappingURL=DeviceSessionRefresher.js.map
