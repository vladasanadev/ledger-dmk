{
  "version": 3,
  "sources": ["../../../../../../src/internal/discovery/use-case/ListConnectedDevicesUseCase.test.ts"],
  "sourcesContent": ["import { type LoggerPublisherService } from \"@api/logger-publisher/service/LoggerPublisherService\";\nimport { ConnectedDevice } from \"@api/transport/model/ConnectedDevice\";\nimport { DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS } from \"@internal/device-session/data/DeviceSessionRefresherConst\";\nimport { deviceSessionStubBuilder } from \"@internal/device-session/model/DeviceSession.stub\";\nimport { DefaultDeviceSessionService } from \"@internal/device-session/service/DefaultDeviceSessionService\";\nimport { type DeviceSessionService } from \"@internal/device-session/service/DeviceSessionService\";\nimport { ListConnectedDevicesUseCase } from \"@internal/discovery/use-case/ListConnectedDevicesUseCase\";\nimport { DefaultLoggerPublisherService } from \"@internal/logger-publisher/service/DefaultLoggerPublisherService\";\nimport { AxiosManagerApiDataSource } from \"@internal/manager-api/data/AxiosManagerApiDataSource\";\nimport { type ManagerApiDataSource } from \"@internal/manager-api/data/ManagerApiDataSource\";\nimport { DefaultManagerApiService } from \"@internal/manager-api/service/DefaultManagerApiService\";\nimport { type ManagerApiService } from \"@internal/manager-api/service/ManagerApiService\";\nimport { DefaultSecureChannelDataSource } from \"@internal/secure-channel/data/DefaultSecureChannelDataSource\";\nimport { type SecureChannelDataSource } from \"@internal/secure-channel/data/SecureChannelDataSource\";\nimport { DefaultSecureChannelService } from \"@internal/secure-channel/service/DefaultSecureChannelService\";\nimport { type SecureChannelService } from \"@internal/secure-channel/service/SecureChannelService\";\nimport { type DmkConfig } from \"@root/src\";\n\nlet logger: LoggerPublisherService;\nlet sessionService: DeviceSessionService;\nlet managerApiDataSource: ManagerApiDataSource;\nlet managerApi: ManagerApiService;\nlet secureChannelDataSource: SecureChannelDataSource;\nlet secureChannel: SecureChannelService;\n\ndescribe(\"ListDeviceSessionsUseCase\", () => {\n  beforeEach(() => {\n    logger = new DefaultLoggerPublisherService(\n      [],\n      \"list-device-sessions-use-case-test\",\n    );\n    managerApiDataSource = new AxiosManagerApiDataSource({} as DmkConfig);\n    managerApi = new DefaultManagerApiService(managerApiDataSource);\n    secureChannelDataSource = new DefaultSecureChannelDataSource(\n      {} as DmkConfig,\n    );\n    secureChannel = new DefaultSecureChannelService(secureChannelDataSource);\n    sessionService = new DefaultDeviceSessionService(() => logger);\n  });\n\n  it(\"should list all device sessions\", () => {\n    // given\n    const deviceSession1 = deviceSessionStubBuilder(\n      { id: \"1\" },\n      () => logger,\n      managerApi,\n      secureChannel,\n      DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS,\n    );\n    const deviceSession2 = deviceSessionStubBuilder(\n      { id: \"2\" },\n      () => logger,\n      managerApi,\n      secureChannel,\n      DEVICE_SESSION_REFRESHER_DEFAULT_OPTIONS,\n    );\n    sessionService.addDeviceSession(deviceSession1);\n    sessionService.addDeviceSession(deviceSession2);\n    const useCase = new ListConnectedDevicesUseCase(\n      sessionService,\n      () => logger,\n    );\n\n    // when\n    const response = useCase.execute();\n\n    deviceSession1.close();\n    deviceSession2.close();\n\n    // then\n    expect(response).toStrictEqual([\n      new ConnectedDevice({\n        transportConnectedDevice: deviceSession1.connectedDevice,\n        sessionId: deviceSession1.id,\n      }),\n      new ConnectedDevice({\n        transportConnectedDevice: deviceSession2.connectedDevice,\n        sessionId: deviceSession2.id,\n      }),\n    ]);\n  });\n\n  it(\"should return empty array if no device sessions\", () => {\n    // given\n    const useCase = new ListConnectedDevicesUseCase(\n      sessionService,\n      () => logger,\n    );\n\n    // when\n    const response = useCase.execute();\n\n    // then\n    expect(response).toStrictEqual([]);\n  });\n});\n"],
  "mappings": "aACA,IAAAA,EAAgC,gDAChCC,EAAyD,qEACzDC,EAAyC,6DACzCC,EAA4C,wEAE5CC,EAA4C,oEAC5CC,EAA8C,4EAC9CC,EAA0C,gEAE1CC,EAAyC,kEAEzCC,EAA+C,wEAE/CC,EAA4C,wEAI5C,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EAEJ,SAAS,4BAA6B,IAAM,CAC1C,WAAW,IAAM,CACfL,EAAS,IAAI,gCACX,CAAC,EACD,oCACF,EACAE,EAAuB,IAAI,4BAA0B,CAAC,CAAc,EACpEC,EAAa,IAAI,2BAAyBD,CAAoB,EAC9DE,EAA0B,IAAI,iCAC5B,CAAC,CACH,EACAC,EAAgB,IAAI,8BAA4BD,CAAuB,EACvEH,EAAiB,IAAI,8BAA4B,IAAMD,CAAM,CAC/D,CAAC,EAED,GAAG,kCAAmC,IAAM,CAE1C,MAAMM,KAAiB,4BACrB,CAAE,GAAI,GAAI,EACV,IAAMN,EACNG,EACAE,EACA,0CACF,EACME,KAAiB,4BACrB,CAAE,GAAI,GAAI,EACV,IAAMP,EACNG,EACAE,EACA,0CACF,EACAJ,EAAe,iBAAiBK,CAAc,EAC9CL,EAAe,iBAAiBM,CAAc,EAO9C,MAAMC,EANU,IAAI,8BAClBP,EACA,IAAMD,CACR,EAGyB,QAAQ,EAEjCM,EAAe,MAAM,EACrBC,EAAe,MAAM,EAGrB,OAAOC,CAAQ,EAAE,cAAc,CAC7B,IAAI,kBAAgB,CAClB,yBAA0BF,EAAe,gBACzC,UAAWA,EAAe,EAC5B,CAAC,EACD,IAAI,kBAAgB,CAClB,yBAA0BC,EAAe,gBACzC,UAAWA,EAAe,EAC5B,CAAC,CACH,CAAC,CACH,CAAC,EAED,GAAG,kDAAmD,IAAM,CAQ1D,MAAMC,EANU,IAAI,8BAClBP,EACA,IAAMD,CACR,EAGyB,QAAQ,EAGjC,OAAOQ,CAAQ,EAAE,cAAc,CAAC,CAAC,CACnC,CAAC,CACH,CAAC",
  "names": ["import_ConnectedDevice", "import_DeviceSessionRefresherConst", "import_DeviceSession", "import_DefaultDeviceSessionService", "import_ListConnectedDevicesUseCase", "import_DefaultLoggerPublisherService", "import_AxiosManagerApiDataSource", "import_DefaultManagerApiService", "import_DefaultSecureChannelDataSource", "import_DefaultSecureChannelService", "logger", "sessionService", "managerApiDataSource", "managerApi", "secureChannelDataSource", "secureChannel", "deviceSession1", "deviceSession2", "response"]
}
