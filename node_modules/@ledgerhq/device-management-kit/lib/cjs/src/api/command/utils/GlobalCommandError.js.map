{
  "version": 3,
  "sources": ["../../../../../../src/api/command/utils/GlobalCommandError.ts"],
  "sourcesContent": ["import { ApduParser } from \"@api/apdu/utils/ApduParser\";\nimport { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport {\n  type CommandErrorArgs,\n  DeviceExchangeError,\n  UnknownDeviceExchangeError,\n} from \"@api/Error\";\n\nimport { type CommandErrors, isCommandErrorCode } from \"./CommandErrors\";\n\n/**\n * Status word list of global errors that any command could result\n */\nexport type GlobalCommandErrorStatusCode =\n  | \"5515\"\n  | \"5501\"\n  | \"5502\"\n  | \"5223\"\n  | \"6e00\"\n  | \"6d00\";\n\n/**\n * Global command error class\n */\nexport class GlobalCommandError extends DeviceExchangeError<GlobalCommandErrorStatusCode> {\n  constructor(args: CommandErrorArgs<GlobalCommandErrorStatusCode>) {\n    super({ tag: \"GlobalCommandError\", ...args });\n  }\n}\n\n/**\n * Global errors dictionary that links a global status code to an error message\n */\nexport const GLOBAL_ERRORS: CommandErrors<GlobalCommandErrorStatusCode> = {\n  \"5515\": { message: \"Device is locked.\", tag: \"DeviceLockedError\" },\n  \"5501\": { message: \"Action refused on device.\", tag: \"ActionRefusedError\" },\n  \"5502\": { message: \"Pin is not set\", tag: \"PinNotSetError\" },\n  \"5223\": { message: \"Device internal error\", tag: \"DeviceInternalError\" },\n  \"6e00\": { message: \"CLA not supported\", tag: \"DeviceInternalError\" },\n  \"6d00\": { message: \"INS not supported\", tag: \"DeviceInternalError\" },\n};\n\n/**\n * Global error handler utility class\n */\nexport class GlobalCommandErrorHandler {\n  /**\n   * Static method to get a handled GlobalCommandError or an unhandled DmkError from an apdu response\n   * @param apduResponse\n   */\n  static handle(\n    apduResponse: ApduResponse,\n  ): GlobalCommandError | UnknownDeviceExchangeError {\n    const parser = new ApduParser(apduResponse);\n    const errorCode = parser.encodeToHexaString(apduResponse.statusCode);\n    if (isCommandErrorCode(errorCode, GLOBAL_ERRORS)) {\n      return new GlobalCommandError({ ...GLOBAL_ERRORS[errorCode], errorCode });\n    }\n    return new UnknownDeviceExchangeError({\n      message: \"UnknownError\",\n      errorCode,\n    });\n  }\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,mBAAAE,EAAA,uBAAAC,EAAA,8BAAAC,IAAA,eAAAC,EAAAL,GAAA,IAAAM,EAA2B,sCAE3BC,EAIO,sBAEPC,EAAuD,2BAgBhD,MAAML,UAA2B,qBAAkD,CACxF,YAAYM,EAAsD,CAChE,MAAM,CAAE,IAAK,qBAAsB,GAAGA,CAAK,CAAC,CAC9C,CACF,CAKO,MAAMP,EAA6D,CACxE,KAAQ,CAAE,QAAS,oBAAqB,IAAK,mBAAoB,EACjE,KAAQ,CAAE,QAAS,4BAA6B,IAAK,oBAAqB,EAC1E,KAAQ,CAAE,QAAS,iBAAkB,IAAK,gBAAiB,EAC3D,KAAQ,CAAE,QAAS,wBAAyB,IAAK,qBAAsB,EACvE,OAAQ,CAAE,QAAS,oBAAqB,IAAK,qBAAsB,EACnE,OAAQ,CAAE,QAAS,oBAAqB,IAAK,qBAAsB,CACrE,EAKO,MAAME,CAA0B,CAKrC,OAAO,OACLM,EACiD,CAEjD,MAAMC,EADS,IAAI,aAAWD,CAAY,EACjB,mBAAmBA,EAAa,UAAU,EACnE,SAAI,sBAAmBC,EAAWT,CAAa,EACtC,IAAIC,EAAmB,CAAE,GAAGD,EAAcS,CAAS,EAAG,UAAAA,CAAU,CAAC,EAEnE,IAAI,6BAA2B,CACpC,QAAS,eACT,UAAAA,CACF,CAAC,CACH,CACF",
  "names": ["GlobalCommandError_exports", "__export", "GLOBAL_ERRORS", "GlobalCommandError", "GlobalCommandErrorHandler", "__toCommonJS", "import_ApduParser", "import_Error", "import_CommandErrors", "args", "apduResponse", "errorCode"]
}
