{
  "version": 3,
  "sources": ["../../../../../../src/api/command/os/SecureElementFlagsParser.test.ts"],
  "sourcesContent": ["import { describe, expect, it } from \"vitest\";\n\nimport { type DeviceGeneralState } from \"@api/device/SecureElementFlags\";\n\nimport { SecureElementFlagsParser } from \"./SecureElementFlagsParser\";\n\ndescribe(\"SecureElementFlagsParser\", () => {\n  it(\"should throw an error if the secure element flags length is not 4\", () => {\n    expect(\n      () => new SecureElementFlagsParser(new Uint8Array([0x00, 0x01, 0x02])),\n    ).toThrow(\"Invalid secure element flags length\");\n  });\n\n  it(\"should correctly parse the general device state\", () => {\n    const seFlags = new Uint8Array([0b10101010, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    const expectedState: DeviceGeneralState = {\n      isPinValidated: true,\n      hasMcuSerialNumber: false,\n      hasValidCertificate: true,\n      isCustomAuthorityConnectionAllowed: false,\n      isSecureConnectionAllowed: true,\n      isOnboarded: false,\n      isMcuCodeSigned: true,\n      isInRecoveryMode: false,\n    };\n    expect(parser.generalDeviceState()).toEqual(expectedState);\n  });\n\n  it(\"should throw an error for endorsementInformation method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.endorsementInformation()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should throw an error for wordsInformation method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.wordsInformation()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should throw an error for onboardingStatus method\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    expect(() => parser.onboardingStatus()).toThrow(\"Not implemented\");\n  });\n\n  it(\"should correctly check the nth bit in a byte\", () => {\n    const seFlags = new Uint8Array([0x00, 0x00, 0x00, 0x00]);\n    const parser = new SecureElementFlagsParser(seFlags);\n    const byte = 0b10101010;\n    expect(parser._checkNthBitInByte(byte, 1)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 2)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 3)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 4)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 5)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 6)).toBe(false);\n    expect(parser._checkNthBitInByte(byte, 7)).toBe(true);\n    expect(parser._checkNthBitInByte(byte, 8)).toBe(false);\n  });\n});\n"],
  "mappings": "aAAA,IAAAA,EAAqC,kBAIrCC,EAAyC,yCAEzC,YAAS,2BAA4B,IAAM,IACzC,MAAG,oEAAqE,IAAM,IAC5E,UACE,IAAM,IAAI,2BAAyB,IAAI,WAAW,CAAC,EAAM,EAAM,CAAI,CAAC,CAAC,CACvE,EAAE,QAAQ,qCAAqC,CACjD,CAAC,KAED,MAAG,kDAAmD,IAAM,CAC1D,MAAMC,EAAU,IAAI,WAAW,CAAC,IAAY,EAAM,EAAM,CAAI,CAAC,EACvDC,EAAS,IAAI,2BAAyBD,CAAO,EAC7CE,EAAoC,CACxC,eAAgB,GAChB,mBAAoB,GACpB,oBAAqB,GACrB,mCAAoC,GACpC,0BAA2B,GAC3B,YAAa,GACb,gBAAiB,GACjB,iBAAkB,EACpB,KACA,UAAOD,EAAO,mBAAmB,CAAC,EAAE,QAAQC,CAAa,CAC3D,CAAC,KAED,MAAG,0DAA2D,IAAM,CAClE,MAAMF,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAI,2BAAyBD,CAAO,KACnD,UAAO,IAAMC,EAAO,uBAAuB,CAAC,EAAE,QAAQ,iBAAiB,CACzE,CAAC,KAED,MAAG,oDAAqD,IAAM,CAC5D,MAAMD,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAI,2BAAyBD,CAAO,KACnD,UAAO,IAAMC,EAAO,iBAAiB,CAAC,EAAE,QAAQ,iBAAiB,CACnE,CAAC,KAED,MAAG,oDAAqD,IAAM,CAC5D,MAAMD,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAI,2BAAyBD,CAAO,KACnD,UAAO,IAAMC,EAAO,iBAAiB,CAAC,EAAE,QAAQ,iBAAiB,CACnE,CAAC,KAED,MAAG,+CAAgD,IAAM,CACvD,MAAMD,EAAU,IAAI,WAAW,CAAC,EAAM,EAAM,EAAM,CAAI,CAAC,EACjDC,EAAS,IAAI,2BAAyBD,CAAO,EAC7CG,EAAO,OACb,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,KACpD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,KACrD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,KACpD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,KACrD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,KACpD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,KACrD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAI,KACpD,UAAOF,EAAO,mBAAmBE,EAAM,CAAC,CAAC,EAAE,KAAK,EAAK,CACvD,CAAC,CACH,CAAC",
  "names": ["import_vitest", "import_SecureElementFlagsParser", "seFlags", "parser", "expectedState", "byte"]
}
