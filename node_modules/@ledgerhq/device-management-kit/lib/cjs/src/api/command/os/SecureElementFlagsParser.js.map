{
  "version": 3,
  "sources": ["../../../../../../src/api/command/os/SecureElementFlagsParser.ts"],
  "sourcesContent": ["import {\n  type DeviceGeneralState,\n  type EndorsementInformation,\n  type OnboardingStatus,\n  type WordsInformation,\n} from \"@api/device/SecureElementFlags\";\n\n/**\n * Secure element flags parser class.\n */\nexport class SecureElementFlagsParser {\n  /**\n   * Creates an instance of SecureElementFlags parser.\n   * @param seFlags - The secure element flags as an Uint8Array, it comes from the response of the GetOsVersionCommand.\n   */\n  constructor(private readonly seFlags: Uint8Array) {\n    if (this.seFlags.length !== 4) {\n      throw new Error(\"Invalid secure element flags length\");\n    }\n  }\n\n  /**\n   * Retrieves the general device state based on the secure element flags, which is the first byte of the flags.\n   * @returns {DeviceGeneralState}\n   */\n  generalDeviceState(): DeviceGeneralState {\n    const firstByte = this.seFlags[0] ?? 0x00;\n\n    return {\n      isPinValidated: this._checkNthBitInByte(firstByte, 1),\n      hasMcuSerialNumber: this._checkNthBitInByte(firstByte, 2),\n      hasValidCertificate: this._checkNthBitInByte(firstByte, 3),\n      isCustomAuthorityConnectionAllowed: this._checkNthBitInByte(firstByte, 4),\n      isSecureConnectionAllowed: this._checkNthBitInByte(firstByte, 5),\n      isOnboarded: this._checkNthBitInByte(firstByte, 6),\n      isMcuCodeSigned: this._checkNthBitInByte(firstByte, 7),\n      isInRecoveryMode: this._checkNthBitInByte(firstByte, 8),\n    };\n  }\n\n  /**\n   * Retrieves the endorsement information based on the secure element flags, which is the second byte of the flags.\n   * @returns {EndorsementInformation}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  endorsementInformation(): EndorsementInformation {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Retrieves the words information based on the secure element flags, which is the third byte of the flags.\n   * @returns {WordsInformation}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  wordsInformation(): WordsInformation {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Retrieves the onboarding status based on the secure element flags, which is the fourth byte of the flags.\n   * @returns {OnboardingStatus}\n   * @throws Will throw an error if the method is not implemented.\n   */\n  onboardingStatus(): OnboardingStatus {\n    throw new Error(\"Not implemented\");\n  }\n\n  /**\n   * Check the nth bit in a byte, returns true if the bit is set, false otherwise.\n   * @param byte - The byte to check.\n   * @param n - The bit number to check.\n   * @returns {boolean} - True if the bit is set, false otherwise.\n   */\n  _checkNthBitInByte(byte: number, n: number): boolean {\n    return ((byte >> (8 - n)) & 1) === 1;\n  }\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,8BAAAE,IAAA,eAAAC,EAAAH,GAUO,MAAME,CAAyB,CAKpC,YAA6BE,EAAqB,CAArB,aAAAA,EAC3B,GAAI,KAAK,QAAQ,SAAW,EAC1B,MAAM,IAAI,MAAM,qCAAqC,CAEzD,CAMA,oBAAyC,CACvC,MAAMC,EAAY,KAAK,QAAQ,CAAC,GAAK,EAErC,MAAO,CACL,eAAgB,KAAK,mBAAmBA,EAAW,CAAC,EACpD,mBAAoB,KAAK,mBAAmBA,EAAW,CAAC,EACxD,oBAAqB,KAAK,mBAAmBA,EAAW,CAAC,EACzD,mCAAoC,KAAK,mBAAmBA,EAAW,CAAC,EACxE,0BAA2B,KAAK,mBAAmBA,EAAW,CAAC,EAC/D,YAAa,KAAK,mBAAmBA,EAAW,CAAC,EACjD,gBAAiB,KAAK,mBAAmBA,EAAW,CAAC,EACrD,iBAAkB,KAAK,mBAAmBA,EAAW,CAAC,CACxD,CACF,CAOA,wBAAiD,CAC/C,MAAM,IAAI,MAAM,iBAAiB,CACnC,CAOA,kBAAqC,CACnC,MAAM,IAAI,MAAM,iBAAiB,CACnC,CAOA,kBAAqC,CACnC,MAAM,IAAI,MAAM,iBAAiB,CACnC,CAQA,mBAAmBC,EAAc,EAAoB,CACnD,OAASA,GAAS,EAAI,EAAM,KAAO,CACrC,CACF",
  "names": ["SecureElementFlagsParser_exports", "__export", "SecureElementFlagsParser", "__toCommonJS", "seFlags", "firstByte", "byte"]
}
