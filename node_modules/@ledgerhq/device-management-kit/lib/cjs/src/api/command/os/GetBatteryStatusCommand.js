"use strict";var p=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var m=(a,t)=>{for(var s in t)p(a,s,{get:t[s],enumerable:!0})},c=(a,t,s,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of T(t))!B.call(a,o)&&o!==s&&p(a,o,{get:()=>t[o],enumerable:!(e=R(t,o))||e.enumerable});return a};var S=a=>c(p({},"__esModule",{value:!0}),a);var y={};m(y,{BatteryStatusType:()=>i,ChargingMode:()=>d,GetBatteryStatusCommand:()=>x});module.exports=S(y);var E=require("../../apdu/utils/ApduBuilder"),A=require("../../apdu/utils/ApduParser"),u=require("../../command/Errors"),n=require("../../command/model/CommandResult"),i=(r=>(r[r.BATTERY_PERCENTAGE=0]="BATTERY_PERCENTAGE",r[r.BATTERY_VOLTAGE=1]="BATTERY_VOLTAGE",r[r.BATTERY_TEMPERATURE=2]="BATTERY_TEMPERATURE",r[r.BATTERY_CURRENT=3]="BATTERY_CURRENT",r[r.BATTERY_FLAGS=4]="BATTERY_FLAGS",r))(i||{}),d=(e=>(e[e.NONE=0]="NONE",e[e.USB=1]="USB",e[e.QI=2]="QI",e))(d||{});class x{name="getBatteryStatus";args;constructor(t){this.args=t}getApdu(){const t={cla:224,ins:16,p1:0,p2:this.args.statusType};return new E.ApduBuilder(t).build()}parseResponse(t){const s=new A.ApduParser(t);switch(this.args.statusType){case 0:{const e=s.extract8BitUInt();return e===void 0?(0,n.CommandResultFactory)({error:new u.InvalidBatteryDataError("Cannot parse APDU response")}):(0,n.CommandResultFactory)({data:e>100?-1:e})}case 1:{const e=s.extract16BitUInt();return e===void 0?(0,n.CommandResultFactory)({error:new u.InvalidBatteryDataError("Cannot parse APDU response")}):(0,n.CommandResultFactory)({data:e})}case 2:case 3:{const e=s.extract8BitUInt();return e===void 0?(0,n.CommandResultFactory)({error:new u.InvalidBatteryDataError("Cannot parse APDU response")}):(0,n.CommandResultFactory)({data:e<<24>>24})}case 4:{const e=s.extract32BitUInt();if(e===void 0)return(0,n.CommandResultFactory)({error:new u.InvalidBatteryDataError("Cannot parse APDU response")});const o=!!(e&8),r=!o&&!!(e&1);return(0,n.CommandResultFactory)({data:{charging:r?2:o?1:0,issueCharging:!!(e&16),issueTemperature:!!(e&32),issueBattery:!!(e&128)}})}default:return(0,n.CommandResultFactory)({error:new u.InvalidBatteryStatusTypeError("One or some case(s) not covered")})}}}0&&(module.exports={BatteryStatusType,ChargingMode,GetBatteryStatusCommand});
//# sourceMappingURL=GetBatteryStatusCommand.js.map
