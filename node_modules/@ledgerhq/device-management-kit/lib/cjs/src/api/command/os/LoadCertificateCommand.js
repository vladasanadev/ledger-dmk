"use strict";var i=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var A=(r,e)=>{for(var t in e)i(r,t,{get:e[t],enumerable:!0})},E=(r,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of l(e))!y.call(r,a)&&a!==t&&i(r,a,{get:()=>e[a],enumerable:!(o=u(e,a))||o.enumerable});return r};var k=r=>E(i({},"__esModule",{value:!0}),r);var h={};A(h,{LoadCertificateCommand:()=>L,LoadCertificateCommandError:()=>C});module.exports=k(h);var d=require("../../apdu/utils/ApduBuilder"),m=require("../../apdu/utils/ApduParser"),s=require("../../command/model/CommandResult"),c=require("../../command/utils/CommandErrors"),f=require("../../command/utils/CommandUtils"),g=require("../../command/utils/GlobalCommandError"),p=require("../../Error");const n={"422f":{message:"Incorrect structure type"},4230:{message:"Incorrect certificate version"},4231:{message:"Incorrect certificate validity"},4232:{message:"Incorrect certificate validity index"},4233:{message:"Unknown signer key ID"},4234:{message:"Unknown signature algorithm"},4235:{message:"Unknown public key ID"},4236:{message:"Unknown public key usage"},4237:{message:"Incorrect elliptic curve ID"},4238:{message:"Incorrect signature algorithm associated to the public key"},4239:{message:"Unknown target device"},"422d":{message:"Unknown certificate tag"},3301:{message:"Failed to hash data"},"422e":{message:"expected_key_usage doesn't match certificate key usage"},5720:{message:"Failed to verify signature"},4118:{message:"trusted_name buffer is too small to contain the trusted name"},ffff:{message:"Cryptography-related error"}};class C extends p.DeviceExchangeError{constructor({message:e,errorCode:t}){super({tag:"ProvidePkiCertificateCommandError",message:e,errorCode:t})}}class L{name="loadCertificate";args;triggersDisconnection=!1;constructor(e){this.args=e}getApdu(){const e={cla:176,ins:6,p1:this.args.keyUsage,p2:0};return new d.ApduBuilder(e).addBufferToData(this.args.certificate).build()}parseResponse(e){if(f.CommandUtils.isSuccessResponse(e))return(0,s.CommandResultFactory)({data:void 0});const o=new m.ApduParser(e).encodeToHexaString(e.statusCode);return(0,c.isCommandErrorCode)(o,n)?(0,s.CommandResultFactory)({error:new C({...n[o],errorCode:o})}):(0,s.CommandResultFactory)({error:g.GlobalCommandErrorHandler.handle(e)})}}0&&(module.exports={LoadCertificateCommand,LoadCertificateCommandError});
//# sourceMappingURL=LoadCertificateCommand.js.map
