"use strict";var s=require("../../command/model/CommandResult"),o=require("../../command/os/LoadCertificateCommand"),n=require("../../command/utils/GlobalCommandError"),c=require("../../utils/HexaString");describe("LoadCertificateCommand",()=>{describe("name",()=>{it("should be 'loadCertificate'",()=>{const t=new o.LoadCertificateCommand({keyUsage:1,certificate:new Uint8Array});expect(t.name).toBe("loadCertificate")})}),describe("getApdu",()=>{it("should return the APDU with key equal to 1",()=>{const t={keyUsage:66,certificate:new Uint8Array([1,2,3])},e=new o.LoadCertificateCommand(t).getApdu();expect(e.cla).toBe(176),expect(e.ins).toBe(6),expect(e.p1).toBe(66),expect(e.p2).toBe(0),expect(e.data).toStrictEqual(new Uint8Array([1,2,3]))})}),describe("parseResponse",()=>{let t;beforeEach(()=>{t=new o.LoadCertificateCommand({keyUsage:1,certificate:new Uint8Array})}),it("should return success if the response status code is success",()=>{const r={statusCode:new Uint8Array([144,0]),data:new Uint8Array},e=t.parseResponse(r);expect(e).toStrictEqual((0,s.CommandResultFactory)({data:void 0}))}),describe("errors",()=>{it("should return error command result if the device is locked",()=>{const r={statusCode:new Uint8Array([85,21]),data:new Uint8Array},e=t.parseResponse(r);(0,s.isSuccessCommandResult)(e)?assert.fail("Expected error command result"):expect(e.error).toBeInstanceOf(n.GlobalCommandError)}),it.each(["422f","4230","4231","4232","4233","4234","4235","4236","4237","4238","4239","422d","3301","422e","5720","4118","ffff"])("should return a ProvidePkiCertificateCommandError if the response is a %s specific error code",r=>{const e={statusCode:(0,c.hexaStringToBuffer)(r),data:new Uint8Array},a=t.parseResponse(e);(0,s.isSuccessCommandResult)(a)?assert.fail("Expected error command result"):(expect(a.error).toBeInstanceOf(o.LoadCertificateCommandError),expect(a.error.errorCode).toBe(r))})})})});
//# sourceMappingURL=LoadCertificateCommand.test.js.map
