{
  "version": 3,
  "sources": ["../../../../../../src/api/device-action/__test-utils__/testDeviceActionStates.ts"],
  "sourcesContent": ["import {\n  type DeviceAction,\n  type DeviceActionIntermediateValue,\n  type InternalApi,\n} from \"@api/device-action/DeviceAction\";\nimport { type DeviceActionState } from \"@api/device-action/model/DeviceActionState\";\nimport { type DmkError } from \"@api/Error\";\n\n/**\n * Test that the states emitted by a device action match the expected states.\n * @param deviceAction The device action to test.\n * @param expectedStates The expected states.\n * @param internalApi\n * @param callbacks { onDone, onError } The callbacks to call when the test is done or an error occurs.\n */\nexport function testDeviceActionStates<\n  Output,\n  Input,\n  Error extends DmkError,\n  IntermediateValue extends DeviceActionIntermediateValue,\n>(\n  deviceAction: DeviceAction<Output, Input, Error, IntermediateValue>,\n  expectedStates: Array<DeviceActionState<Output, Error, IntermediateValue>>,\n  internalApi: InternalApi,\n  {\n    onDone,\n    onError,\n  }: {\n    onDone: () => void;\n    onError: (error: Error) => void;\n  },\n) {\n  const observedStates: Array<\n    DeviceActionState<Output, Error, IntermediateValue>\n  > = [];\n\n  const { observable, cancel } = deviceAction._execute(internalApi);\n\n  observable.subscribe({\n    next: (state) => {\n      observedStates.push(state);\n    },\n    error: (error) => {\n      onError(error);\n    },\n    complete: () => {\n      try {\n        expect(observedStates).toEqual(expectedStates);\n        onDone();\n      } catch (e) {\n        onError(e as Error);\n      }\n    },\n  });\n\n  return { observable, cancel };\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,4BAAAE,IAAA,eAAAC,EAAAH,GAeO,SAASE,EAMdE,EACAC,EACAC,EACA,CACE,OAAAC,EACA,QAAAC,CACF,EAIA,CACA,MAAMC,EAEF,CAAC,EAEC,CAAE,WAAAC,EAAY,OAAAC,CAAO,EAAIP,EAAa,SAASE,CAAW,EAEhE,OAAAI,EAAW,UAAU,CACnB,KAAOE,GAAU,CACfH,EAAe,KAAKG,CAAK,CAC3B,EACA,MAAQC,GAAU,CAChBL,EAAQK,CAAK,CACf,EACA,SAAU,IAAM,CACd,GAAI,CACF,OAAOJ,CAAc,EAAE,QAAQJ,CAAc,EAC7CE,EAAO,CACT,OAASO,EAAG,CACVN,EAAQM,CAAU,CACpB,CACF,CACF,CAAC,EAEM,CAAE,WAAAJ,EAAY,OAAAC,CAAO,CAC9B",
  "names": ["testDeviceActionStates_exports", "__export", "testDeviceActionStates", "__toCommonJS", "deviceAction", "expectedStates", "internalApi", "onDone", "onError", "observedStates", "observable", "cancel", "state", "error", "e"]
}
