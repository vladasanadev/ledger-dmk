{
  "version": 3,
  "sources": ["../../../../../../src/api/apdu/utils/ApduParser.ts"],
  "sourcesContent": ["import { type ApduResponse } from \"@api/device-session/ApduResponse\";\nimport { type HexaString } from \"@api/utils/HexaString\";\n\nimport { ByteArrayParser } from \"./ByteArrayParser\";\n\nexport type TaggedField = {\n  readonly tag: number;\n  readonly value: Uint8Array;\n};\n\n/**\n * ApduParser is a utility class to help parse APDU responses.\n *\n * It provides methods to extract fields of different types from the response.\n *\n * @example\n * ```\n * const parser = new ApduParser(apduResponse);\n * const targetId = parser.encodeToHexaString(parser.extractFieldByLength(4));\n * const seVersion = parser.encodeToString(parser.extractFieldLVEncoded());\n * ```\n */\nexport class ApduParser {\n  private parser: ByteArrayParser;\n\n  constructor(response: ApduResponse) {\n    this.parser = new ByteArrayParser(response.data);\n  }\n\n  /**\n   * Test if the length is greater than the response length\n   * @param length: number\n   * @returns {boolean} - Returns false if the length is greater than the response length\n   */\n  testMinimalLength = (length: number): boolean =>\n    this.parser.testMinimalLength(length);\n\n  /**\n   * Extract a single byte from the response\n   * @returns {number | undefined} - Returns the byte extracted from the response\n   */\n  extract8BitUInt = (): number | undefined => this.parser.extract8BitUInt();\n\n  /**\n   * Extract a 16-bit unsigned integer (Big Endian coding) from the response\n   * @returns {number | undefined} - Returns the 16-bit unsigned integer extracted from the response\n   */\n  extract16BitUInt = (): number | undefined => this.parser.extract16BitUInt();\n\n  /**\n   * Extract a 32-bit unsigned integer (Big Endian coding) from the response\n   * @returns {number | undefined} - Returns the 32-bit unsigned integer extracted from the response\n   */\n  extract32BitUInt = (): number | undefined => this.parser.extract32BitUInt();\n\n  /**\n   * Extract a field of a specified length from the response\n   * @param length: number - The length of the field to extract\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldByLength = (length: number): Uint8Array | undefined =>\n    this.parser.extractFieldByLength(length);\n\n  /**\n   * Extract a field from the response that is length-value encoded\n   * @returns {Uint8Array | undefined} - Returns the field extracted from the response\n   */\n  extractFieldLVEncoded = (): Uint8Array | undefined =>\n    this.parser.extractFieldLVEncoded();\n\n  /**\n   * Extract a field from the response that is tag-length-value encoded\n   * @returns {TaggedField | undefined} - Returns the field extracted from the response\n   */\n  extractFieldTLVEncoded = (): TaggedField | undefined =>\n    this.parser.extractFieldTLVEncoded();\n\n  /**\n   * Encode a value to a hexadecimal string\n   * @param value {Uint8Array} - The value to encode\n   * @param prefix {boolean} - Whether to add a prefix to the encoded value\n   * @returns {string} - The encoded value as a hexadecimal string\n   */\n  encodeToHexaString(value?: Uint8Array, prefix?: false): string;\n  encodeToHexaString(value?: Uint8Array, prefix?: true): HexaString;\n  encodeToHexaString(\n    value?: Uint8Array,\n    prefix: boolean = false,\n  ): HexaString | string {\n    return prefix\n      ? this.parser.encodeToHexaString(value, true)\n      : this.parser.encodeToHexaString(value, false);\n  }\n\n  /**\n   * Encode a value to an ASCII string\n   * @param value {Uint8Array} - The value to encode\n   * @returns {string} - The encoded value as an ASCII string\n   */\n  encodeToString = (value?: Uint8Array): string =>\n    this.parser.encodeToString(value);\n\n  /**\n   * Get the remaining length of the response\n   * @returns {number} - The remaining length of the response\n   */\n  getUnparsedRemainingLength = (): number =>\n    this.parser.getUnparsedRemainingLength();\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,gBAAAE,IAAA,eAAAC,EAAAH,GAGA,IAAAI,EAAgC,6BAmBzB,MAAMF,CAAW,CACd,OAER,YAAYG,EAAwB,CAClC,KAAK,OAAS,IAAI,kBAAgBA,EAAS,IAAI,CACjD,CAOA,kBAAqBC,GACnB,KAAK,OAAO,kBAAkBA,CAAM,EAMtC,gBAAkB,IAA0B,KAAK,OAAO,gBAAgB,EAMxE,iBAAmB,IAA0B,KAAK,OAAO,iBAAiB,EAM1E,iBAAmB,IAA0B,KAAK,OAAO,iBAAiB,EAO1E,qBAAwBA,GACtB,KAAK,OAAO,qBAAqBA,CAAM,EAMzC,sBAAwB,IACtB,KAAK,OAAO,sBAAsB,EAMpC,uBAAyB,IACvB,KAAK,OAAO,uBAAuB,EAUrC,mBACEC,EACAC,EAAkB,GACG,CACrB,OAAOA,EACH,KAAK,OAAO,mBAAmBD,EAAO,EAAI,EAC1C,KAAK,OAAO,mBAAmBA,EAAO,EAAK,CACjD,CAOA,eAAkBA,GAChB,KAAK,OAAO,eAAeA,CAAK,EAMlC,2BAA6B,IAC3B,KAAK,OAAO,2BAA2B,CAC3C",
  "names": ["ApduParser_exports", "__export", "ApduParser", "__toCommonJS", "import_ByteArrayParser", "response", "length", "value", "prefix"]
}
